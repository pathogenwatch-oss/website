(this.webpackJsonp=this.webpackJsonp||[]).push([[0],[function(e,t,a){const n=a(381),r=a(515),s=a(1);n.createClass=r,n.PropTypes=s,e.exports=n},,,,,,function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(15);function r(e){return n.a.api?`${n.a.api.address}${e}`:e}function s(e){return new Promise((t,a)=>{$.ajax(e).done(e=>t(e)).fail(e=>a(e))})}function o(e,t,a,n){return s({type:e,url:r(t),contentType:"application/json; charset=UTF-8",data:"GET"===e?a:JSON.stringify(a),dataType:"json",headers:n})}function l(e,t,a,n,o){return s({type:e,url:r(t),contentType:a,data:n,processData:!1,dataType:"json",xhr:o?function(){const e=new window.XMLHttpRequest;let t=0;return e.upload.addEventListener("progress",e=>{if(e.lengthComputable){const a=e.loaded/e.total*100,n=10*Math.floor(a/10);n>t&&(o(n),t=n)}},!1),e}:void 0})}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s}));const n={READY:"READY",PROCESSING:"PROCESSING",NOT_FOUND:"NOT_FOUND",FAILED:"FAILED",ABORTED:"ABORTED"},r={metadata:"metadata",typing:"typing",stats:"stats",antibiotics:"antibiotics",snps:"snps",genes:"genes",kleborateAMR:"kleborateAMR",timeline:"timeline"},s={[r.antibiotics]:"Antibiotics",[r.genes]:"Genes",[r.kleborateAMR]:"Kleborate AMR",[r.metadata]:"Metadata",[r.stats]:"Stats",[r.snps]:"SNPs",[r.timeline]:"Timeline",[r.typing]:"Typing"}},function(e,t,a){"use strict";a(229);var n=a(126);a.d(t,"a",(function(){return n.FormattedName})),a.d(t,"c",(function(){return n.getOrganismName})),a.d(t,"d",(function(){return n.taxIdMap})),a.d(t,"b",(function(){return n.default}))},,,function(e,t,a){"use strict";a.d(t,"f",(function(){return i})),a.d(t,"d",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"g",(function(){return m})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"e",(function(){return h}));var n=a(2),r=a(296),s=a.n(r),o=a(20),l=a(10);const i=({viewer:e})=>e,c=({viewer:e})=>e.history,u=e=>i(e).entities.collection,m=e=>u(e).isClusterView,d=Object(n.createSelector)(u,({title:e})=>e?s()(e):null),p=Object(n.createSelector)(u,e=>({title:e.title,description:e.description,dateCreated:new Date(e.createdAt),pmid:e.pmid,owner:e.owner,access:e.access})),h=Object(n.createSelector)(u,e=>e.size<3?o.b:l.b.uiOptions.noPopulation?o.a:null)},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(297);const r=["ATTEMPT","SUCCESS","FAILURE"];function s(e){return r.reduce((t,a)=>({...t,[a]:`${e}::${a}`}),{})}function o(e,t){return(a,r)=>{const s=r(),o=t(s),l=e(o),{promise:i,...c}=l.payload;return a({type:l.type,payload:{...c,promise:i.then(e=>{const a=r(),s=t(a);return o!==s?n.a:e})}})}}},function(e,t,a){"use strict";(function(e){t.a=function(){if("PW_CONFIG"in e){const e=Object.assign({},PW_CONFIG);return PW_CONFIG=void 0,e}return{}}()}).call(this,a(45))},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"d",(function(){return l}));const n={COLOURS:{GREEN_LIGHT:"#d0e9dc",GREEN_MID:"#87c7a6",GREEN:"#48996F",TURQUOISE:"#3c7383",PURPLE_LIGHT:"#a386bd",PURPLE_WARM:"#AC65A6",PURPLE:"#673c90",GREY:"#e5e5e5",GREY_LIGHT:"#efefef",GREY_DARK:"#ababab"}},r=[".fa",".fas",".fna",".ffn",".faa",".frn",".fasta",".genome",".contig",".dna"],s={SHAPE:"circle",COLOUR:"#555555",DANGER_COLOUR:"#d11b1b",WARNING_COLOUR:"#d19b1b",TREE_TYPE:"rectangular",NODE_SIZE:10,LABEL_SIZE:10,LAYOUT:{MINIMUM_CONTAINER_WIDTH:150,MINIMUM_CONTAINER_HEIGHT:50},SELECTED_TREE_NODE_LABEL:"id",MAP:{CENTER:{LATITUDE:47.34452036,LONGITUDE:5.85082183}}},o={LOADING:0,ERROR:1,SUCCESS:2},l={cgmlst:"cgMLST",core:"Core SNPs",genotyphi:"Genotyphi",inctyper:"Inctyper",kleborate:"Kleborate",metrics:"Stats",mlst:"MLST",mlst2:"MLST",ngmast:"NG-MAST",ngstar:"NG-STAR",paarsnp:"AMR",poppunk:"Strain",serotype:"Serotype",speciator:"Species prediction",spn_pbp_amr:"AMR (PBPs)"}},,function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"h",(function(){return l})),a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return u})),a.d(t,"b",(function(){return m})),a.d(t,"f",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"g",(function(){return h}));var n=a(14),r=a(28),s=a(186);const o=Object(n.b)("FETCH_GENOME_SUMMARY");function l(e){return{type:o,payload:{filter:e,promise:Object(s.e)(e)}}}const i=Object(n.b)("FETCH_GENOME_LIST"),c=e=>null!=e;function u(e,t){let a=void 0,n=void 0;c(e)&&(a=e,c(t)&&(n=t-e+1));const o={skip:a,limit:n};return(e,t)=>{const a=Object(r.a)(t());return e({type:i,payload:{filter:a,options:o,promise:Object(s.b)({...a,...o})}})}}const m=Object(n.b)("FETCH_GENOME_MAP");function d(){return(e,t)=>{const a=Object(r.a)(t());e({type:m,payload:{filter:a,promise:Object(s.c)(a)}})}}const p=Object(n.b)("FETCH_GENOME_STATS");function h(){return(e,t)=>{const a=Object(r.a)(t());e({type:p,payload:{filter:a,promise:Object(s.d)(a)}})}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));const n="collection",r="population"},function(e,t,a){"use strict";a.d(t,"e",(function(){return g})),a.d(t,"h",(function(){return b})),a.d(t,"g",(function(){return y})),a.d(t,"b",(function(){return E})),a.d(t,"c",(function(){return v})),a.d(t,"d",(function(){return C})),a.d(t,"i",(function(){return w})),a.d(t,"f",(function(){return S})),a.d(t,"j",(function(){return N})),a.d(t,"a",(function(){return x})),a.d(t,"k",(function(){return k}));var n=a(2),r=a(43),s=a.n(r),o=a(78),l=a.n(o),i=a(51),c=a(142),u=a(95),m=a(28),d=a(122),p=a(6),h=a(16);const f=({genomes:e})=>e.selection,g=e=>f(e).genomes,b=e=>f(e).dropdown,y=e=>f(e).download,E=e=>f(e).lastSelectedIndex,v=Object(n.createSelector)(g,m.d,(e,t)=>{const a=Object.keys(e);return"bin"===t?a.filter(t=>e[t].binned):a}),C=Object(n.createSelector)(g,v,(e,t)=>t.map(t=>e[t])),w=e=>C(e).length,S=Object(n.createSelector)(C,u.a,(e,t)=>e.filter(e=>t.has(e.organismId))),N=(Object(n.createSelector)(v,e=>Object(d.c)(e.length)),Object(n.createSelector)(v,i.a,c.c,(e,t,a)=>0===e.length?"UNCHECKED":t.length===a&&t.every(({id:t})=>-1!==e.indexOf(t))?"CHECKED":"INDETERMINATE"));function O(e,t,a){const n=Object(p.c)(`/download/analysis/${e}`),r={};"serotype"===e&&(r.speciesId=a.speciesId),"mlst"===e&&(r.filename=`mlst-${t[0]}.csv`),"mlst2"===e&&(r.filename=`mlst-${t[0]}.csv`);const s=l.a.stringify(r);return s?`${n}?${s}`:n}const x=Object(n.createSelector)(y,({summary:e})=>e?e.map(e=>{const t=new Set,a=[];for(const{task:n,ids:r,sources:s}of e.tasks){"paarsnp"===n?a.push({ids:r,sources:s,name:"paarsnp",label:"AMR antibiogram",link:O("paarsnp")},{ids:r,sources:s,name:"paarsnp-snps-genes",label:"AMR SNPs/genes",link:O("paarsnp-snps-genes")}):a.push({ids:r,sources:s,name:n,label:h.d[n]||n,link:O(n,s,e)});for(const e of r)t.add(e)}return{speciesId:e.speciesId,speciesName:e.speciesName,total:e.total,ids:Array.from(t),tasks:s()(a,e=>e.label.toUpperCase())}}):[]),k=Object(n.createSelector)(c.a,m.d,(e,t)=>"all"===t&&e.visible===e.total)},,function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){return c})),a.d(t,"f",(function(){return m})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return p}));var n=a(2),r=a(13),s=a(298),o=a(37);const l=Object(n.createSelector)(e=>e.viewer.entities.genomes,s.a,(e,t)=>{const a={...e},n=new Set;for(const[r,s]of Object.entries(e)){if(!(s.name in t)||n.has(s.name))continue;const{userDefined:e,...o}=t[s.name];a[r]={...s,...o,userDefined:{...s.userDefined,...e}}}return a}),i=Object(n.createSelector)(l,o.e,o.j,(e,t,a)=>{const n=[];for(const r of Object.values(e))a||null===t?r.__isCollection&&n.push(r.uuid):r.analysis&&r.analysis.core.fp.reference===t&&n.push(r.uuid);return n}),c=Object(n.createSelector)(l,i,(e,t)=>Array.from(t).map(t=>e[t])),u=Object(n.createSelector)(c,r.a,(e,{isClusterView:t})=>{let a=!1,n=!1,r=!1;for(const s of e){if(!a){const{year:e,pmid:t,userDefined:n}=s;(e||t||n&&Object.keys(n).length)&&(a=!0)}if(s.analysis&&!t&&(!n&&s.analysis.paarsnp&&(n=!0),!r&&s.analysis.kleborate&&(r=!0),a&&(t||n&&r)))break}return{hasMetadata:a,hasAMR:!t&&n,hasKleborateAMR:!t&&r}}),m=Object(n.createSelector)(u,e=>e.hasMetadata),d=Object(n.createSelector)(u,e=>e.hasAMR),p=Object(n.createSelector)(u,e=>e.hasKleborateAMR)},function(e,t,a){"use strict";a(949);var n=a(0),r=a.n(n),s=a(113),o=a.n(s),l=({className:e,children:t,out:a=!1})=>r.a.createElement(o.a,{className:e,transitionName:"wgsa-fade",transitionLeave:a,transitionEnterTimeout:280,transitionLeaveTimeout:280},t);a.d(t,"a",(function(){return l}))},,function(e,t,a){"use strict";var n=a(14),r=a(18),s=a(51),o=a(142),l=a(21),i=a(122),c=a(6);function u(e){return Object(c.a)("POST","/api/download",{ids:e})}a.d(t,"d",(function(){return m})),a.d(t,"m",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"h",(function(){return h})),a.d(t,"f",(function(){return f})),a.d(t,"l",(function(){return g})),a.d(t,"b",(function(){return b})),a.d(t,"g",(function(){return y})),a.d(t,"a",(function(){return E})),a.d(t,"c",(function(){return C})),a.d(t,"i",(function(){return w})),a.d(t,"n",(function(){return S})),a.d(t,"k",(function(){return N})),a.d(t,"j",(function(){return O}));const m="SELECTION_DROPDOWN_OPENED";function d(e=null){return{type:m,payload:e}}const p=Object(n.b)("SELECTION_FETCH_DOWNLOADS");function h(){return(e,t)=>{const a=Object(l.c)(t());e({type:p,payload:{promise:u(a)}})}}const f="SET_GENOME_SELECTION";function g(e){return Object(i.e)(e),{type:f,payload:{genomes:e}}}const b="CLEAR_GENOME_SELECTION";function y(){return Object(i.e)(),{type:b}}const E="APPEND_GENOME_SELECTION";function v(e,t){return Object(i.a)(e),{type:E,payload:{genomes:e,index:t}}}const C="REMOVE_GENOME_SELECTION";function w(e){return Object(i.d)(e),{type:C,payload:{genomes:e}}}function S(e,t){return(a,n)=>{const r=n(),s=Object(l.e)(r);e.every(e=>e.id in s)?a(w(e)):a(v(e,t))}}function N(e,t){return(a,n)=>{const o=n(),l=Object(s.c)(o),i=Object(s.e)(o),c=Math.min(e,t),u=Math.max(e,t),m=u-c+1,d=[];for(let e=c;e<=u;e++){const t=i[e];t in l&&d.push(l[t])}return d.length===m?(a(v(d)),Promise.resolve()):a(Object(r.e)(c,u)).then(e=>a(v(e)))}}function O(){return(e,t)=>{const a=t();if("CHECKED"===Object(l.j)(a)){return e(w(Object(s.a)(a))),Promise.resolve()}const n=Object(o.c)(a),r=Object(l.e)(a),i=Object(s.e)(a);let c=0;for(let e=0;e<n;e++){if(!(i[e]in r)){c=e;break}}return e(N(c,n-1))}}},function(e,t,a){"use strict";a.d(t,"g",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"h",(function(){return f})),a.d(t,"k",(function(){return g})),a.d(t,"j",(function(){return y})),a.d(t,"e",(function(){return E})),a.d(t,"i",(function(){return v})),a.d(t,"c",(function(){return C})),a.d(t,"d",(function(){return w})),a.d(t,"b",(function(){return S})),a.d(t,"l",(function(){return N})),a.d(t,"f",(function(){return O}));var n=a(2),r=a(13),s=a(23),o=a(74),l=a(39),i=a(9);const c=e=>Object(r.f)(e).table,u=e=>c(e).activeAMR,m=e=>c(e).entities,d=Object(n.createSelector)(s.a,e=>{const{leading:t,trailing:a,userDefined:n}=Object(o.a)(e),r=Object(o.b)(t),s=Object(o.c)(a);return[...r,...Object(o.d)(n),...s]}),p=Object(n.createSelector)(d,e=>m(e).metadata.activeColumn,(e,t)=>{for(const a of e)if(a.columnKey===t.columnKey)return t;return l.e}),h=Object(n.createSelector)(m,d,p,s.f,({metadata:e},t,a,n)=>({...e,active:n,activeColumn:a,columns:t})),f=Object(n.createSelector)(m,h,(e,t)=>({...e,metadata:t})),g=Object(n.createSelector)(f,e=>e.typing.active),b=Object(n.createSelector)(s.f,g,(e,t)=>e?i.c.metadata:t?i.c.typing:i.c.stats),y=Object(n.createSelector)(e=>c(e).visible,b,e=>!Object(s.f)(e),(e,t,a)=>null===e?t:e===i.c.metadata&&a?t:e),E=Object(n.createSelector)(e=>c(e).activeData,b,e=>!Object(s.f)(e),(e,t,a)=>null===e?t:e===i.c.metadata&&a?t:e),v=e=>{const t=y(e);return f(e)[t]},C=Object(n.createSelector)(v,({activeColumn:e,activeColumns:t})=>new Set(e?[e.columnKey]:Array.from(t).filter(e=>e).map(e=>e.columnKey))),w=Object(n.createSelector)(f,E,(e,t)=>e[t]),S=Object(n.createSelector)(f,u,(e,t)=>e[t]),N=Object(n.createSelector)(y,u,(e,t)=>e===t),O=Object(n.createSelector)(s.d,N,(e,t)=>{if(!e)return null;let a=88;return t&&(a+=48),a})},function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"f",(function(){return b})),a.d(t,"d",(function(){return y})),a.d(t,"e",(function(){return E})),a.d(t,"g",(function(){return C})),a.d(t,"c",(function(){return w})),a.d(t,"b",(function(){return W}));var n=a(2),r=a(43),s=a.n(r),o=a(296),l=a.n(o),i=a(65),c=a(95),u=a(85),m=a(157),d=a(10),p=a(141),h=a(49),f=a(86);const g=e=>i.d.getFilter(e,{stateKey:u.b}),b=e=>i.d.isActive(e,{stateKey:u.b}),y=e=>g(e).prefilter,E=Object(n.createSelector)(g,({searchText:e})=>e||""),v=({genomes:e})=>e.filter,C=e=>v(e).isOpen,w=e=>v(e).listFilters,S=(e,t)=>Object(n.createSelector)(t=>w(t)[e],e=>{try{const a=new RegExp(e,"i");return e=>a.test(t?e[t]:e)}catch(e){return()=>!0}}),N=({genomes:e})=>e.summary,O=Object(n.createSelector)(N,e=>g(e).organismId,c.a,S("organismId","title"),({organismId:e={}},t,a,n)=>s()(Object.keys(e).filter(e=>a.has(e)).map(a=>{const n=d.d.get(a);return{value:a,active:t===a,label:n.formattedName,title:n.name,activeTitle:`Organism: ${n.name}`,count:e[a].count}}).filter(n),"title")),x=Object(n.createSelector)(N,e=>g(e).mlst,S("mlst"),({mlst:e={},sources:t},a,n)=>s()(Object.keys(e).filter(n).map(n=>({value:n,active:a===n,activeTitle:`MLST - ${t.mlst}: ST ${n}`,title:`ST ${n}`,count:e[n].count,novel:Object(f.c)(n)})),"novel",e=>Number(e.value))),k=Object(n.createSelector)(N,e=>g(e).mlst2,S("mlst2"),({mlst2:e={},sources:t},a,n)=>s()(Object.keys(e).filter(n).map(n=>({value:n,active:a===n,activeTitle:`MLST - ${t.mlst2}: ST ${n}`,title:`ST ${n}`,count:e[n].count,novel:Object(f.c)(n)})),"novel",e=>Number(e.value))),_=Object(n.createSelector)(N,e=>g(e).speciesId,S("speciesId","label"),({speciesId:e={}},t,a)=>s()(Object.keys(e).map(a=>({value:a,label:e[a].label,count:e[a].count,active:t===a})).filter(a),"label")),I=Object(n.createSelector)(N,e=>g(e).genusId,S("genusId","label"),({genusId:e={}},t,a)=>s()(Object.keys(e).map(a=>({value:a,label:e[a].label,count:e[a].count,active:t===a})).filter(a),"label")),T=Object(n.createSelector)(N,e=>g(e).country,S("country","label"),({country:e={}},t,a)=>s()(Object.keys(e).map(a=>({value:a,label:Object(m.b)(a),count:e[a].count,active:t===a})).filter(a),"label")),L=Object(n.createSelector)(N,e=>g(e).access,({access:e={}},t)=>s()(Object.keys(e).map(a=>({value:a,label:`${a[0].toUpperCase()}${a.slice(1)}`,count:e[a].count,active:t===a})),"label")),j=Object(n.createSelector)(Object(n.createSelector)(N,({uploadedAt:e={}})=>Object.keys(e).sort((e,t)=>new Date(t)-new Date(e)).map(e=>{const t=new Date(e);return{value:e,label:Object(h.b)(t)}})),N,e=>g(e).uploadedAt,S("uploadedAt","label"),(e,{uploadedAt:t={}},a,n)=>e.filter(n).map(e=>({...e,count:t[e.value].count,active:a===e.value}))),A=Object(n.createSelector)(N,e=>g(e).resistance,S("resistance"),({resistance:e={}},t,a)=>s()(Object.keys(e).filter(a).map(a=>({value:a,count:e[a].count,active:t===a})),"value")),P=Object(n.createSelector)(N,e=>g(e).subspecies,S("subspecies"),({subspecies:e={}},t,a)=>s()(Object.keys(e).filter(a).map(a=>({value:a,count:e[a].count,active:t===a})),"value")),R=Object(n.createSelector)(e=>N(e).speciesId,(e={})=>{const t=Object.keys(e);return 1===t.length?Object(p.b)(e[t[0]].label):"serotype"}),M=Object(n.createSelector)(N,e=>g(e).serotype,S("serotype"),R,({serotype:e={}},t,a,n)=>s()(Object.keys(e).filter(a).map(a=>({value:a,count:e[a].count,active:t===a,activeTitle:`${n[0].toUpperCase()}${n.slice(1)}: ${a}`})),"value")),D=Object(n.createSelector)(N,e=>g(e).strain,S("strain"),({strain:e={}},t,a)=>s()(Object.keys(e).filter(a).map(a=>({value:a,label:`GPSC ${a}`,count:e[a].count,active:t===a})),e=>Number(e.value))),F=Object(n.createSelector)(N,e=>g(e).ngmast,S("ngmast"),({ngmast:e={}},t,a)=>s()(Object.keys(e).filter(a).map(a=>({value:a,active:t===a,activeTitle:`NG-MAST: ST ${a}`,count:e[a].count,title:`ST ${a}`})),"value")),z=Object(n.createSelector)(N,e=>g(e).ngstar,S("ngstar"),({ngstar:e={}},t,a)=>s()(Object.keys(e).filter(a).map(a=>({value:a,active:t===a,activeTitle:`NG-STAR: ST ${a}`,count:e[a].count,novel:Object(f.c)(a),title:`ST ${a}`})),"novel",e=>Number(e.value))),G=Object(n.createSelector)(N,e=>g(e).genotype,S("genotype"),({genotype:e={}},t,a)=>s()(Object.keys(e).filter(a).map(a=>({value:a,active:t===a,count:e[a].count})),"value")),U=Object(n.createSelector)(Object(n.createSelector)(N,({reference:e={}})=>Object.keys(e).sort()),N,e=>g(e).reference,S("reference"),(e,{reference:t={}},a,n)=>e.filter(n).map(e=>({value:e,active:a===e,count:t[e].count}))),B=Object(n.createSelector)(N,e=>g(e).klocus,S("klocus"),({klocus:e={}},t,a)=>s()(Object.keys(e).filter(a).map(a=>({value:a,active:t===a,count:e[a].count})),"value")),$=Object(n.createSelector)(N,e=>g(e).minDate,e=>g(e).maxDate,({date:e={}},t,a)=>e.min&&e.max?{bounds:[e.min,e.max],values:[t,a]}:null),H="(untitled collection)",V=(e,t)=>e.title===H&&t.title!==H?1:e.title!==H&&t.title===H?-1:e.title>t.title?1:e.title<t.title?-1:0,K=Object(n.createSelector)(N,({collection:e={}})=>Object.keys(e).map(t=>{const a=e[t].label||H;return{value:t,label:a,title:l()(a)}}).sort(V)),q=Object(n.createSelector)(K,N,e=>g(e).collection,S("collection","title"),(e,{collection:t={}},a,n)=>e.filter(n).map(e=>({...e,activeTitle:`Collection: ${e.title}`,active:a===e.value,count:t[e.value].count}))),W=Object(n.createSelector)(N,L,q,T,$,G,I,B,k,x,F,z,O,U,A,M,_,D,P,j,({loading:e,sources:t={},visible:a},...n)=>{const[r,s,o,l,i,c,u,m,d,p,h,f,g,b,y,E,v,C,w]=n;return{loading:e,sources:t,visible:a,access:r,collection:s,country:o,date:l,genotype:i,genusId:c,klocus:u,mlst:d,mlst2:m,ngmast:p,ngstar:h,organismId:f,reference:g,resistance:b,serotype:y,speciesId:E,strain:v,subspecies:C,uploadedAt:w}})},,,function(e,t,a){"use strict";var n=a(14),r=a(6),s=a(161);function o(e){return console.log(`[Pathogenwatch] Getting collection ${e}`),Object(r.a)("GET",`/api/collection/${e}`).then(e=>{const t=e.collection||e;return{...t,genomes:Object(s.a)(t.genomes)}})}a(319);var l=a(10);a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"f",(function(){return m})),a.d(t,"b",(function(){return d})),a.d(t,"e",(function(){return p}));const i=Object(n.b)("FETCH_COLLECTION");function c(e){return{type:i,payload:{promise:o(e).then(e=>(l.b.current=e.organismId,e))}}}const u="UPDATE_COLLECTION_PROGRESS";function m(e){return{type:u,payload:e}}const d="RESET_COLLECTION_VIEW";function p(){return{type:d}}Object(n.b)("COLLECTION_FETCH_POSITION")},function(e,t,a){"use strict";a.d(t,"g",(function(){return l})),a.d(t,"e",(function(){return i})),a.d(t,"i",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"l",(function(){return m})),a.d(t,"k",(function(){return d})),a.d(t,"h",(function(){return p})),a.d(t,"f",(function(){return h})),a.d(t,"d",(function(){return f})),a.d(t,"a",(function(){return g})),a.d(t,"j",(function(){return b})),a.d(t,"b",(function(){return y}));var n=a(2),r=a(323),s=a(53);const o=e=>e.upload.progress.files,l=e=>o(e).queue.pending,i=e=>o(e).queue.processing,c=e=>o(e).entities,u=(Object(n.createSelector)(c,e=>Object.values(e)),Object(n.createSelector)(l,i,(e,t)=>e.length+t.size)),m=Object(n.createSelector)(i,e=>e.size>0),d=Object(n.createSelector)(u,e=>e>0),p=e=>o(e).status,h=Object(n.createSelector)(p,e=>{const t={},a=Object.values(e);for(const e of a)t[e]=(t[e]||0)+1;return{total:a.length,completed:t[s.a.SUCCESS]||0,errored:t[s.a.ERROR]||0,pending:t[s.a.PENDING]||0}}),f=Object(n.createSelector)(h,({completed:e})=>e),g=Object(n.createSelector)(h,({errored:e})=>e),b=Object(n.createSelector)(e=>o(e).entities,e=>o(e).errors,(e,t)=>{const a=[];for(const n of Object.keys(t))t[n]instanceof r.a&&a.push({filename:Object.keys(e[n])[0],error:t[n]});return a}),y=Object(n.createSelector)(e=>o(e).errors,b,(e,t)=>Object.keys(e).length-t.length)},function(e,t,a){"use strict";t.a={DELAY:64,FONT_SIZE:14,HALO_WIDTH:4,MAX_FONT_SIZE:64,MAX_NODE_SIZE:64,MIN_FONT_SIZE:1,MIN_NODE_SIZE:1,NODE_BORDER_STYLE:"rgba(0, 0, 0, 0.54)",NODE_BORDER_WIDTH:1,NODE_RADIUS:7,NODE_SIZE:14,FONT:'"Roboto", "Helvetica", "Arial", sans-serif'}},function(e,t,a){"use strict";a.d(t,"l",(function(){return n})),a.d(t,"h",(function(){return r})),a.d(t,"m",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"r",(function(){return l})),a.d(t,"f",(function(){return i})),a.d(t,"k",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"p",(function(){return m})),a.d(t,"b",(function(){return d})),a.d(t,"n",(function(){return p})),a.d(t,"c",(function(){return h})),a.d(t,"o",(function(){return f})),a.d(t,"e",(function(){return g})),a.d(t,"s",(function(){return b})),a.d(t,"d",(function(){return y})),a.d(t,"q",(function(){return E})),a.d(t,"j",(function(){return v})),a.d(t,"u",(function(){return C})),a.d(t,"i",(function(){return w})),a.d(t,"t",(function(){return S}));function n(e){return{type:"SEARCH_DROPDOWN_VISIBILITY",payload:e}}const r="SEARCH_TEXT_CHANGED";function s(e){return{type:r,payload:e}}const o="SEARCH_CATEGORY_SELECTED";function l(e){return{type:o,payload:{category:e}}}const i="SEARCH_TERM_ADDED";function c(e){return{type:i,payload:e}}const u="SEARCH_TERM_REMOVED";function m(e,t){return{type:u,payload:{term:e,intersection:t}}}const d="SEARCH_CURSOR_MOVED";function p(e){return{type:d,payload:{delta:e}}}const h="SEARCH_INTERSECTION_MOVED";function f(e){return{type:h,payload:{delta:e}}}const g="SEARCH_SORT_SELECTED";function b(e){return{type:g,payload:e}}const y="SEARCH_OPERATOR_SELECTED";function E(e){return{type:y,payload:e}}const v="SEARCH_TOGGLE_MODE";function C(){return{type:v}}const w="SEARCH_TOGGLE_EXACT_MATCH";function S(e){return{type:w,payload:e}}},,,function(e,t,a){"use strict";a.d(t,"d",(function(){return l})),a.d(t,"e",(function(){return i})),a.d(t,"i",(function(){return c})),a.d(t,"j",(function(){return u})),a.d(t,"b",(function(){return m})),a.d(t,"h",(function(){return d})),a.d(t,"a",(function(){return p})),a.d(t,"g",(function(){return h})),a.d(t,"f",(function(){return f})),a.d(t,"c",(function(){return g}));var n=a(2),r=a(301),s=a(13),o=a(107);const l=e=>Object(s.f)(e).tree,i=e=>l(e).visible,c=e=>l(e).loading,u=Object(n.createSelector)(i,e=>o.b.has(e)),m=e=>l(e).titles,d=Object(n.createSelector)(i,m,(e,t)=>t[e]||o.a[e]||""),p=Object(n.createSelector)(e=>l(e).libmicroreact,e=>{const t={};for(const[a,{current:n}]of Object.entries(e))t[a]=n;return t}),h=Object(n.createSelector)(i,p,(e,t)=>e in t?t[e]:Object(r.a)(void 0,{})),f=Object(n.createSelector)(e=>h(e).subtreeIds,e=>null===e?[]:e),g=Object(n.createSelector)(e=>h(e).ids,e=>null!==e?e:[])},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"b",(function(){return i})),a.d(t,"f",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"e",(function(){return m}));var n=a(14),r=a(183);const s=Object(n.b)("UPLOAD_ADD_GENOMES");function o(e,t){return{type:s,payload:{genomes:e,uploadedAt:t,promise:r.d(e,t).then(t=>{for(const a of e)a.id in t&&(a.id=t[a.id]);return t})}}}function l(e){return{type:"UPLOAD_ERROR_MESSAGE",payload:e}}const i=Object(n.b)("UPLOAD_FETCH_ASSEMBLER_USAGE");function c(e){return{type:i,payload:{promise:r.c(e)}}}const u="UPLOAD_SETTING_CHANGED";function m(e,t){return{type:u,payload:{setting:e,value:t}}}},function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(129),o=a(16),l=({url:e,name:t})=>r.a.createElement("a",{href:e,download:`${t}.fa`,target:"_blank",rel:"noopener",title:"Download genome",className:"wgsa-download-button mdl-button mdl-button--icon"},r.a.createElement(s.a,{color:o.b.COLOURS.PURPLE,label:".fa"})),i=({action:e,title:t,ids:a,children:n})=>r.a.createElement("form",{action:e,method:"POST",target:"_blank",style:{display:"inline"}},r.a.createElement("button",{title:t,className:"wgsa-download-button mdl-button mdl-button--icon"},n),r.a.createElement("input",{type:"hidden",name:"ids",value:a}));const{COLOURS:c}=o.b;var u=({url:e,ids:t})=>r.a.createElement(i,{action:e,title:"Download genomes",ids:t},r.a.createElement(s.a,{isArchive:!0,color:c.PURPLE})),m=a(6),d=({uuid:e,id:t,name:a})=>r.a.createElement("a",{href:Object(m.c)(`/download/collection/${e}/annotations?ids=${t}`),download:`${a}.gff`,target:"_blank",rel:"noopener",title:"Download annotations",className:"wgsa-download-button mdl-button mdl-button--icon"},r.a.createElement(s.a,{color:o.b.COLOURS.GREEN,label:".gff"}));const{COLOURS:p}=o.b;var h=({uuid:e,ids:t,filename:a})=>r.a.createElement(i,{action:Object(m.c)(`/download/collection/${e}/annotations?filename=${a}`),title:"Download annotations",ids:t},r.a.createElement(s.a,{isArchive:!0,color:p.GREEN})),f=a(70),g=a(9),b=a(10);a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return E})),a.d(t,"d",(function(){return v})),a.d(t,"f",(function(){return C})),a.d(t,"c",(function(){return S})),a.d(t,"e",(function(){return O}));const y=new Set([g.c.metadata,g.c.typing,g.c.stats]),E=new Set([g.c.antibiotics,g.c.snps,g.c.genes,g.c.kleborateAMR]),v={columnKey:"__spacer_l",system:!0,getHeaderContent(){},fixed:!0,fixedWidth:1,flexGrow:1,getCellContents(){}},C={columnKey:"__spacer_r",system:!0,getHeaderContent(){},fixedWidth:24,flexGrow:1,getCellContents(){}},w={columnKey:"__name",valueGetter:({name:e})=>e},S={columnKey:"__downloads",system:!0,fixed:!0,headerClasses:"wgsa-table-cell--skinny",getHeaderContent({collection:e,archiveDownloads:t}){const{ids:a,filenames:n}=t,{uuid:s,isClusterView:o}=e;return o?r.a.createElement("span",{className:"wgsa-table-downloads",onClick:e=>e.stopPropagation()},r.a.createElement(u,{url:Object(m.c)(`/download/genome/fasta?filename=${n.genome}`),ids:a})):r.a.createElement("span",{className:"wgsa-table-downloads",onClick:e=>e.stopPropagation()},r.a.createElement(u,{url:Object(m.c)(`/download/collection/${s}/fastas?filename=${n.genome}`),ids:a}),r.a.createElement(h,{uuid:s,ids:a,filename:n.annotation}))},cellClasses:"wgsa-table-cell--skinny",flexGrow:0,getCellContents({collection:e},{id:t,_id:a=t,name:n}){const{uuid:s,isClusterView:o}=e;return o?r.a.createElement("span",{className:"wgsa-table-downloads",onClick:e=>e.stopPropagation()},r.a.createElement(l,{url:Object(m.c)(`/download/genome/${a}/fasta`),name:n})):r.a.createElement("span",{className:"wgsa-table-downloads",onClick:e=>e.stopPropagation()},r.a.createElement(l,{url:Object(m.c)(`/download/collection/${s}/fastas?ids=${a}`),name:n}),r.a.createElement(d,{uuid:s,id:t||a,name:n}))},addState({collection:e,genomes:t}){return{...this,collection:e,width:e.isClusterView?44:68,archiveDownloads:{ids:t.map(e=>e.id||e._id),filenames:{genome:Object(f.a)(e,"genomes.zip"),annotation:Object(f.a)(e,"annotations.zip")}}}}},N={color:o.b.COLOURS.PURPLE};const O={...w,fixed:!0,getCellContents:({valueGetter:e},t)=>r.a.createElement("div",{className:"wgsa-genome-name-cell"},function(e,t){const a=t(e);return e.__isCollection?r.a.createElement("strong",{style:N},a):e.__isReference||e.reference?r.a.createElement("strong",null,a):r.a.createElement("span",null,a)}(t,e),r.a.createElement("div",{onClick:e=>e.stopPropagation()},t.__isPublic&&t.collectionId?r.a.createElement("a",{className:"mdl-button mdl-button--icon",href:`/${b.b.nickname}/collection/${t.collectionId}`,title:"View original collection",target:"_blank",rel:"noopener"},r.a.createElement("i",{className:"material-icons"},"open_in_new")):null))}},function(e,t,a){"use strict";var n=a(78),r=a.n(n),s=a(228),o=a(0),l=a.n(o),i=a(3);const c=l.a.createClass({displayName:"LocationListener",propTypes:{query:l.a.PropTypes.object,onChange:l.a.PropTypes.func.isRequired},componentDidUpdate(e){e.query!==this.props.query&&this.props.onChange(this.props.query)},render:()=>null});var u=Object(i.a)((function({location:e}){return{query:e.query}}),(function(e,{update:t}){return{onChange:a=>e(t(a))}}))(c),m=a(375),d=a(4),p=a.n(d);function h(e,t,a=!1){return!!e&&(a?t===e:0===e.indexOf(t))}var f=Object(i.a)((function({location:e}){return{activePathname:e.pathname}}))(({className:e,icon:t,to:a,activeOnIndexOnly:n,activePathname:r,external:s,badge:o=null,children:i})=>s?l.a.createElement("a",{href:a,target:"_blank",rel:"noopener",className:p()("mdl-navigation__link",e)},t&&l.a.createElement("i",{className:"material-icons"},t),l.a.createElement("span",null,i)):l.a.createElement(m.a,{className:p()("mdl-navigation__link",e,{"mdl-navigation__link--active":h(r,a,n)}),to:a},"string"==typeof t?l.a.createElement("i",{className:"material-icons"},t):t,l.a.createElement("span",{className:"wgsa-nav-label"},i),null!==o&&l.a.createElement("span",{className:"wgsa-nav-badge pw-pill-purple"},o)));function g(e=""){s.b.push({pathname:location.pathname,search:e.length?`?${e.replace(/%20/g,"+")}`:""})}function b(e){const t=r.a.parse(location.search);g(r.a.stringify({...t,...Object.keys(e).reduce((a,n)=>{const r=e[n];return a[n]=r===t[n]?void 0:r,a},{})}))}function y(){g()}a.d(t,"f",(function(){return b})),a.d(t,"c",(function(){return y})),a.d(t,"a",(function(){return E})),a.d(t,"e",(function(){return v})),a.d(t,"b",(function(){return u})),a.d(t,"d",(function(){return f}));const E="LOCATION_CHANGE";function v(e){return{type:E,payload:{location:e}}}},function(e,t,a){"use strict";var n=a(14),r=a(6),s=a(15);function o(e,t,a,n,s){return Object(r.a)("POST",`/api/genome/${e}/clusters/edges`,{scheme:t,version:a,threshold:Number(n),sts:s})}a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return i})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"d",(function(){return m})),a.d(t,"g",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"h",(function(){return h})),a.d(t,"i",(function(){return f})),a.d(t,"p",(function(){return g})),a.d(t,"j",(function(){return b})),a.d(t,"k",(function(){return y})),a.d(t,"l",(function(){return E})),a.d(t,"n",(function(){return C})),a.d(t,"o",(function(){return w})),a.d(t,"m",(function(){return S}));const l=Object(n.b)("REQUEST_BUILD_CLUSTERS"),i="SET_CLUSTERING_PROGRESS",c=Object(n.b)("FETCH_CLUSTERS"),u=Object(n.b)("FETCH_CLUSTER_EDGES"),m=Object(n.b)("RUN_CLUSTER_LAYOUT"),d="SET_CLUSTER_THRESHOLD",p="SET_CLUSTER_GENOME",h="SKIP_LAYOUT";function f(e){return{type:l,payload:{promise:(t=e,Object(r.a)("POST",`/api/genome/${t}/clusters`,{clientId:s.a.clientId})),genomeId:e}};var t}function g(e){return{type:i,payload:e}}function b(e){return{type:c,payload:{promise:(t=e,Object(r.a)("GET",`/api/genome/${t}/clusters`)),genomeId:e}};var t}function y(e,t,a,n,r){return{type:u,payload:{promise:o(e,t,a,n,r),genomeId:e,threshold:n,sts:r,scheme:t,version:a}}}function E(e){return{type:d,payload:e}}function v(e){const t={};for(const a of e){const{x:e,y:n,id:r}=a;t[r]={x:e,y:n}}return t}function C(){return{type:m.ATTEMPT,payload:{}}}function w(e){return{type:m.SUCCESS,payload:{result:{coordinates:e}}}}function S(e){return{type:h,payload:v(e)}}},function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(4),o=a.n(s);t.a=r.a.createClass({displayName:"Spinner.react",componentDidMount(){componentHandler.upgradeElement(this.refs.spinner)},render(){return r.a.createElement("div",{ref:"spinner",className:o()("mdl-spinner mdl-js-spinner is-active",{"mdl-spinner--single-colour":this.props.singleColour})})}})},,function(e,t,a){"use strict";a.d(t,"d",(function(){return n})),a.d(t,"g",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"e",(function(){return i})),a.d(t,"a",(function(){return c})),a.d(t,"h",(function(){return u}));const n="SET_TABLE";function r(e){return{type:n,payload:{name:e}}}const s="SET_LABEL_COLUMN";function o(e,t){return{type:s,payload:{table:e,column:t}}}const l="SET_COLOUR_COLUMNS";function i(e,t){return{type:l,payload:{table:e,columns:t}}}const c="AMR_TOGGLE_MULTI";function u(){return{type:c}}},,,,,function(e,t,a){"use strict";a.d(t,"e",(function(){return h})),a.d(t,"c",(function(){return g})),a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return E})),a.d(t,"d",(function(){return v}));var n=a(483),r=a.n(n),s=a(484),o=a.n(s),l=a(233),i=a.n(l),c=a(373),u=a.n(c),m=a(485),d=a.n(m);const p=/^[0-9]{4}$/;const h=["January","February","March","April","May","June","July","August","September","October","November","December"].map((e,t)=>({text:e,value:t})),f=e=>h[e-1].text;function g(e){if(!function({year:e,month:t,day:a}){return!(!e||a&&!t)&&((!a||a>=1&&a<=31)&&(!t||t>=1&&t<=12)&&p.test(e))}(e))return"";const{year:t,month:a,day:n}=e;return t&&a&&n?`${function(e){const t=e%10;return e+(1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}(n)} ${f(a)} ${t}`:t&&a?`${f(a)} ${t}`:t}function b(e){return e?r()(e)?`Today, ${i()(e,"HH:mm")}`:o()(e)?`Yesterday, ${i()(e,"HH:mm")}`:i()(e,"D MMMM, HH:mm"):null}const y=new Date("0001-01-01T00:00:00Z");function E(e){return u()(e,y)}function v(e){return d()(y,e)}},function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(3),o=a(212);class l extends r.a.Component{componentWillMount(){this.updateTitle()}componentDidUpdate(){this.updateTitle()}updateTitle(){const e=this.props.children||this.props.title,t=o.b[this.props.brandingId];document.title=`${t} | ${e}`}render(){return null}}t.a=Object(s.a)((function(e){return{brandingId:e.branding.id}}))(l)},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"g",(function(){return l})),a.d(t,"h",(function(){return i})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"e",(function(){return m}));var n=a(2);const r=({genomes:e})=>e,s=e=>r(e).entities,o=Object(n.createSelector)(s,e=>Object.keys(e).map(t=>e[t])),l=(Object(n.createSelector)(o,e=>e.map(e=>e.id)),e=>o(e).length),i=e=>r(e).waiting,c=e=>r(e).status,u=o,m=e=>r(e).indices},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={VISIBILITY:"VISIBILITY",TREE:"TREE",MAP:"MAP"}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(89);a.d(t,"b",(function(){return n.a}));const r={PENDING:0,QUEUED:1,UPLOADING:2,COMPRESSING:3,ERROR:4,SUCCESS:5}},function(e,t,a){"use strict";a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return m})),a.d(t,"a",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"b",(function(){return h})),a.d(t,"i",(function(){return f})),a.d(t,"g",(function(){return g})),a.d(t,"f",(function(){return b})),a.d(t,"h",(function(){return y}));var n=a(2),r=a(121),s=a(99),o=a(58),l=a(32),i=a(226);const c=({upload:e})=>e.progress,u=e=>c(e)._.view,m=e=>c(e)._.uploadedAt,d=Object(n.createSelector)((e,t)=>Object(o.e)(e)[t],(e,t)=>Object(l.i)(e)[t],(e,t)=>Object(i.a)(e)[t],(e,t)=>Object(l.h)(e)[t],(e,t,a,n)=>({...e,files:Object.values(t),recovery:a,status:n})),p=Object(n.createSelector)(l.e,o.e,l.i,l.h,(e,t,a,n)=>Array.from(e).map(e=>({...t[e],files:Object.values(a[e]),status:n[e]}))),h=Object(n.createSelector)(s.d,r.a,(e,t)=>{const a={pending:0,done:0,total:0},n={pending:0,done:0,total:0};let r=0;for(const e of Object.values(t))for(const t of Object.keys(e)){const s=null===e[t];!1===e[t]&&r++,"speciator"===t&&(a.total++,s&&a.pending++),n.total++,s&&n.pending++}return a.done=a.total-a.pending,n.done=n.total-n.pending,{assembly:e,speciation:a,analyses:n,errors:r}}),f=Object(n.createSelector)(o.a,h,(e,{speciation:t})=>t.total>0&&t.done===e),g=Object(n.createSelector)(h,({analyses:e})=>e.total>0&&e.done===e.total),b=Object(n.createSelector)(h,({errors:e})=>e>0),y=Object(n.createSelector)(o.a,l.k,o.f,s.f,(e,t,a,n)=>!(e>0)||!t&&(!!a&&!n))},function(e,t,a){"use strict";a.d(t,"h",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"e",(function(){return i})),a.d(t,"g",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"a",(function(){return h}));var n=a(16);const r={RESISTANT:n.c.DANGER_COLOUR,INDUCIBLE:"#E68D44",INTERMEDIATE:n.c.WARNING_COLOUR},s="#fff",o=Object.keys(r).reduce((e,t)=>e.set(r[t],t),new Map([[s,"UNKNOWN"]])),l=e=>o.get(e);function i(e){return r[e]||r.RESISTANT}function c({antibiotics:e},t){if(!(t in e))return!1;const{state:a}=e[t];return a in r}function u(e,t,a){const{paarsnp:n}=e.analysis;return!!n&&-1!==n[t].indexOf(a)}function m(e){return e&&e.__isCollection?n.b.COLOURS.PURPLE_LIGHT:n.b.COLOURS.GREY}function d(e,t){const{paarsnp:a}=t.analysis;return a?c(a,e)?i(a.antibiotics[e].state):s:m(t)}function p({key:e,effect:t},a,n){const{paarsnp:o}=n.analysis;return o?u(n,a,e)?r[t]||r.RESISTANT:s:m(n)}function h(e,t){return function(a){const n=function(e,t){const a=[];if(e.size)for(const n of e)a.push(n.valueGetter(t));else a.push(m(t));return new Set(a)}(e.activeColumns,a);if(1===n.size)return Array.from(n)[0];if(t&&n.has(s))return s;n.delete(s);const o=Array.from(n);return 1===o.length?o[0]:r.RESISTANT}}},,function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return o}));var n=a(49);a.d(t,"b",(function(){return n.c}));const r=(e,{userDefined:t})=>t?t[e]:void 0;function s(e){return e.label?e.label:e.getLabel?e.getLabel():e.columnKey.replace(/_?_autocolou?r$/,"").replace(/^__/,"").replace(/_/g," ").toUpperCase()}function o(e,t,a){if(!t)return;if(!e[0].group)return e[0].flexGrow=1,void(e[0].width=null);const[n,r,s]=e[0].columns,o=r.width+s.width,l=function e(t){return t.reduce((t,a)=>a.group?t+e(a.columns):a.hidden?t:a.width?t+a.width:a.fixedWidth?t+a.fixedWidth+(a.cellPadding||0):t,0)}(e.slice(1))+o;Math.max(t-l,0)/2+o<a+8?(n.flexGrow=0,n.width=a-o+8):(n.flexGrow=1,n.width=null)}},function(e,t,a){"use strict";a.d(t,"e",(function(){return o})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return m})),a.d(t,"f",(function(){return d}));var n=a(2),r=a(32),s=a(53);const o=e=>e.upload.progress.genomes,l=Object(n.createSelector)(o,e=>Object.keys(e).map(t=>e[t])),i=Object(n.createSelector)(l,e=>e.length),c=Object(n.createSelector)(l,r.h,(e,t)=>{let a=0;for(const n of e)n.type===s.b.READS&&t[n.id]===s.a.ERROR&&a++;return a}),u=Object(n.createSelector)(l,e=>{let t=0,a=0;for(const n of e)n.type===s.b.ASSEMBLY&&a++,n.type===s.b.READS&&t++;return{reads:t,assemblies:a}}),m=(Object(n.createSelector)(u,e=>e.assemblies),Object(n.createSelector)(u,e=>e.reads)),d=e=>m(e)>0},function(e,t,a){"use strict";var n=a(14),r=a(32),s=a(54),o=a(103),l=a(265),i=a(159),c=a(323),u=a(492),m=a.n(u);a(15);function d(e){return m()().compress(e)}var p=a(227),h=a(89);a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return g})),a.d(t,"d",(function(){return b})),a.d(t,"c",(function(){return C})),a.d(t,"e",(function(){return w}));const f="GENOME_UPLOAD_PROGRESS";const g=Object(n.b)("COMPRESS_GENOME");const b=Object(n.b)("UPLOAD_GENOME");function y(e,t){return a=>{const{id:n,metadata:r}=e;return a({type:b,payload:{id:n,promise:l.b(e,t,e=>a(function(e,t){return{type:f,payload:{id:e,progress:t}}}(n,e))).then(e=>r?l.a(e.id,r).then(t=>({...e,...t})):e)}})}}function E(e,t,a){return function(e){return Promise.resolve(e.files[0].handle).then(i.readAsText).then(c.b)}(a).then(n=>{return Object(o.b)(t(),"compression")?e((r=a.id,{type:g,payload:{id:r,promise:d(n)}})):n;var r}).then(t=>e(y(a,t)))}function v(e,t,a){const n=t(),r=Object(s.d)(n),o=n.auth.token;return Object(p.c)(a,{token:o,uploadedAt:r},e)}const C=Object(n.b)("PROCESS_GENOME");function w(){return(e,t)=>{if(r.l(t()))return;const a=Object(o.b)(t(),"individual");let n=1;!function o(){const l=t(),i=r.g(l),c=r.e(l);if(i.length&&c.size<n){const r=i[0],c=Object(s.a)(l,r);c.type===h.a.ASSEMBLY&&(n=a?1:5),e({type:C,payload:{id:r,promise:c.type===h.a.READS?v(e,t,c):E(e,t,c)}}).then(o).catch(o),o()}}()}}},,,function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"e",(function(){return i})),a.d(t,"c",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return m}));var n=a(2),r=a(37),s=a(107);const o=e=>Object(r.d)(e).entities,l=e=>Object.keys(o(e)).length>0,i=Object(n.createSelector)(r.d,({visible:e,entities:t})=>e?t[e]:null),c=(Object(n.createSelector)(i,e=>!!e.newick),Object(n.createSelector)(o,e=>Object.keys(e).filter(e=>!s.b.has(e)))),u=(Object(n.createSelector)(e=>Object(r.d)(e).selectedInternalNode,({trees:e,active:t})=>e[t]),Object(n.createSelector)(o,e=>{for(const t of Object.keys(e))if("READY"!==e[t].status)return!1;return!0})),m=Object(n.createSelector)(r.b,o,(e,t)=>{const a=[];for(const n of Object.keys(e).sort())n in t&&"READY"===t[n].status&&a.push([n,e[n]]);return a})},function(e,t,a){"use strict";a(931);var n=a(0),r=a.n(n),s=a(3),o=a(113),l=a.n(o);const i=r.a.createClass({displayName:"ToastContainer",componentDidUpdate(e){if(this.timeout&&clearTimeout(this.timeout),e.visible&&!this.props.visible)return;this.props.action&&this.refs.actionButton?this.refs.actionButton.focus():this.refs.closeButton&&this.refs.closeButton.focus();const{autohide:t=!0,onCloseButtonClick:a}=this.props;t&&(this.timeout=setTimeout(a,5e3))},render(){const{visible:e,message:t,action:a,onCloseButtonClick:n,closeButton:s=!0}=this.props;return r.a.createElement(l.a,{className:"wgsa-toast-container",transitionName:"wgsa-toast",transitionEnterTimeout:280,transitionLeaveTimeout:280},e&&r.a.createElement("aside",{className:"wgsa-toast",key:t},r.a.createElement("span",{className:"wgsa-toast__message"},t),a&&r.a.createElement("button",{ref:"actionButton",onClick:()=>{a.onClick(),n()},className:"wgsa-toast__action mdl-button"},a.label),s&&r.a.createElement("button",{ref:"closeButton",onClick:n,className:"wgsa-toast__dismiss mdl-button mdl-button--icon"},r.a.createElement("i",{className:"material-icons"},"close"))))}});var c=Object(s.a)((function({toast:e}){return e}),(function(e){return{onCloseButtonClick:()=>e(m())}}))(i);a.d(t,"c",(function(){return u})),a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return c}));function u(e){return{type:"TOAST_SHOW",payload:e}}function m(){return{type:"TOAST_HIDE"}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"f",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"e",(function(){return i})),a.d(t,"h",(function(){return c})),a.d(t,"c",(function(){return u})),a.d(t,"g",(function(){return m}));var n=a(52);const r="ACTIVATE_FILTER";function s(e,t=n.a.VISIBILITY){return{type:r,payload:{ids:new Set(e),key:t}}}const o="APPEND_TO_FILTER";const l="REMOVE_FROM_FILTER";const i="RESET_FILTER";function c(e=n.a.VISIBILITY){return{type:i,payload:{key:e}}}const u="CLEAR_FILTERS";function m(){return{type:u,payload:{}}}},function(e,t,a){"use strict";a(961);var n=a(140),r=a(155),s=a(0),o=a.n(s),l=a(3),i=a(4),c=a.n(i),u=a(2);const m=Object(u.createSelector)(r.getFilter,e=>e.sort),d=(e,t)=>{const a=m(e,t);return a&&0===a.indexOf(t.sortKey)},p=Object(u.createSelector)(m,(e="")=>"-"!==e.slice(-1)),h=({className:e,onClick:t,children:a,active:n,sortOrder:r})=>o.a.createElement("button",{onClick:e=>{e.preventDefault(),t(!n||!r)},className:c()(e,{active:n})},a,n&&o.a.createElement("i",{className:"material-icons"},r?"arrow_drop_up":"arrow_drop_down"));h.propTypes={stateKey:o.a.PropTypes.string.isRequired,sortKey:o.a.PropTypes.string.isRequired,sortOrder:o.a.PropTypes.bool,onClick:o.a.PropTypes.func};var f=Object(l.a)((function(e,t){return{active:d(e,t),sortOrder:p(e,t)}}),(function(e,{sortKey:t,update:a}){return{onClick:n=>{e(a({sort:`${t}${n?"":"-"}`}))}}}))(h);a.d(t,"b",(function(){return n})),a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return f})),a.d(t,"c",(function(){return r.isActive}))},,,function(e,t,a){"use strict";a.d(t,"h",(function(){return i})),a.d(t,"c",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"d",(function(){return m})),a.d(t,"a",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"b",(function(){return h})),a.d(t,"e",(function(){return f}));var n=a(85),r=a(65),s=a(18),o=a(14),l=a(28);function i(e){return r.b.update(n.b,e)}function c(){return Object(o.a)(s.h,l.a)}function u(e,t=!0){return a=>{a(t?i(e):r.b.setFilter(n.b,e));const o=Object.keys(e);1===o.length&&"sort"===o[0]?a(Object(s.e)()):a(c())}}function m(){return(e,t)=>{e(r.b.clear(n.b));const a=Object(l.a)(t());return e(Object(s.h)(a))}}const d="GENOMES_FILTER_OPENED";function p(){return{type:d}}const h="GENOMES_FILTER_SUMMARY_LIST";function f(e,t){return{type:h,payload:{filterKey:e,text:t}}}},function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"f",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return i}));const n="SET_HIGHLIGHT";function r(e,t){return{type:n,payload:{ids:e,append:t}}}const s="REMOVE_FROM_HIGHLIGHT";function o(e){return{type:s,payload:{ids:e}}}const l="CLEAR_HIGHLIGHT";function i(){return{type:l,payload:{}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(6),r=a(10);encodeURIComponent,Object(n.c)("/download/file");function s(e,t=""){return e.isClusterView?`pathogenwatch-${t}`:["pathogenwatch",r.b.nickname,e.uuid,t].join("-")}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"f",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return c}));function n(){return localforage.getItem("offline-collections").then(e=>e||[]).then(e=>e.map(e=>({...e,token:e.token||e.slug})))}function r(e){return localforage.setItem("offline-collections",e)}function s(e){return n().then(t=>t.concat({token:e.token,size:e.size,title:e.title,description:e.description,createdAt:e.createdAt,organismId:e.organismId})).then(r)}function o(){return"caches"in window&&"serviceWorker"in navigator}function l(){return!navigator.onLine}function i(e){return`wgsa-collection-${e}`}function c(e){return Promise.all([n().then(t=>t.filter(t=>t.token!==e)).then(r),caches.delete(i(e))])}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return i}));var n=a(14),r=a(262);const s=Object(n.b)("FETCH_COLLECTION_SUMMARY");function o(e){return{type:s,payload:{promise:r.c(e)}}}const l=Object(n.b)("FETCH_COLLECTIONS");function i(e){return{type:l,payload:{promise:r.b(e)}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"e",(function(){return m}));var n=a(57),r=a(39),s=a(88);function o(e){const t=new Set,a=new Set,n=new Set;return e.forEach(e=>{e.userDefined&&Object.keys(e.userDefined).filter(e=>e.length&&!/__colou?r$/.test(e)).forEach(e=>a.add(e)),e.year&&t.add("__date"),e.pmid&&n.add("__pmid")}),{leading:t,userDefined:a,trailing:n}}function l(e){return Array.from(e).map(e=>({columnKey:e,valueGetter:t=>Object(n.c)(e,t)}))}function i(e){return[r.d,r.c,r.e].concat(Array.from(e).map(e=>s.a[e]))}function c(e){return Array.from(e).map(e=>s.a[e]).concat([r.f])}let u={};function m(){u={}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"d",(function(){return m})),a.d(t,"a",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"c",(function(){return h})),a.d(t,"g",(function(){return f}));var n=a(2),r=a(43),s=a.n(r),o=a(65),l=a(10),i=a(150);const c=e=>o.d.getFilter(e,{stateKey:i.b}),u=e=>o.d.isActive(e,{stateKey:i.b}),m=e=>c(e).prefilter,d=e=>c(e).sort,p=Object(n.createSelector)(c,({searchText:e})=>e||""),h=Object(n.createSelector)(({collections:e})=>e.summary,c,({loading:e,visible:t,organismId:a,access:n={},publicationYear:r,createdAt:o},i)=>({loading:e,visible:t,organism:s()(Object.keys(a).map(e=>{const t=l.d.get(e);return{value:e,label:t.formattedName,title:t.name,count:a[e].count,active:i.organismId===e}}),"title"),access:s()(Object.keys(n).map(e=>({value:e,label:`${e[0].toUpperCase()}${e.slice(1)}`,count:n[e].count,active:i.access===e})),"label"),publicationYear:s()(Object.keys(r).map(e=>({value:e,label:e,count:r[e].count,active:i.publicationYear===e})),"label"),date:o.min&&o.max?{bounds:[o.min,o.max],values:[i.minDate,i.maxDate]}:null})),f=e=>(({collections:e})=>e.filter)(e).isOpen},,,,function(e,t,a){"use strict";a.r(t),a.d(t,"MAP_STORE_BOUNDS",(function(){return n})),a.d(t,"storeBounds",(function(){return r})),a.d(t,"MAP_LASSO_CHANGE",(function(){return s})),a.d(t,"changeLassoPath",(function(){return o})),a.d(t,"MAP_VIEW_BY_COUNTRY",(function(){return l})),a.d(t,"viewByCountry",(function(){return i})),a.d(t,"MAP_MARKER_SIZE_CHANGED",(function(){return c})),a.d(t,"markerSizeChanged",(function(){return u}));const n="MAP_STORE_BOUNDS";function r(e,t){return{type:n,payload:{stateKey:e,bounds:t}}}const s="MAP_LASSO_CHANGE";function o(e,t){return{type:s,payload:{stateKey:e,path:t}}}const l="MAP_VIEW_BY_COUNTRY";function i(e,t){return{type:l,payload:{stateKey:e,active:t}}}const c="MAP_MARKER_SIZE_CHANGED";function u(e,t){return{type:c,payload:{stateKey:e,size:t}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return i}));var n=a(14),r=a(183);const s=Object(n.b)("UPLOAD_FETCH_GENOMES");function o(e){return{type:s,payload:{uploadedAt:e,promise:r.a(e)}}}const l="UPLOAD_RESET";function i(){return{type:l}}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));const n=e=>40===e.length;function r(e,t){return e.map(({hits:e})=>e.length?e.map(e=>t&&n(e)?`(${e.slice(0,t)})`:e).join(","):"?").join("_")}},function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return c})),a.d(t,"e",(function(){return u}));var n=a(14),r=a(318);const s="SET_TREE";function o(e){return{type:s,payload:{name:e}}}const l=Object(n.b)("FETCH_TREE");function i(e,t){return{type:l,payload:{stateKey:e,promise:t}}}const c=Object(n.b)("FETCH_TREE_POSITION");function u(e,t){return{type:c,payload:{stateKey:e,promise:r.a(t)}}}},,function(e,t,a){"use strict";var n=a(267),r=a(0),s=a.n(r),o=a(3),l=a(40),i=a(329),c=a(165),u=a(326),m=a(86),d=a(17),p=a.n(d),h=a(277),f=({autoSelect:e=!0,disabled:t=!1,listFilterActive:a,summary:n,children:r,...o})=>s.a.createElement(h.a,p()({},o,{autoSelect:e&&!a,disabled:t&&!a,summary:n}),0===n.length&&a?s.a.createElement("p",null,"No matches"):r),g=a(28),b=a(68);var y=Object(o.a)((function(e,{filterKey:t}){return{value:Object(g.c)(e)[t]}}),(function(e,{filterKey:t,summary:a}){return{onChange:a=>e(Object(b.e)(t,a.target.value)),onSubmit:n=>{n.preventDefault(),1===a.length&&e(Object(b.g)({[t]:a[0].value}))}}}))(({filterKey:e,heading:t,isOpen:a,onChange:n,onSubmit:r,value:o})=>{const l=s.a.createRef();s.a.useEffect(()=>{componentHandler.upgradeElement(l.current.parentElement)},[]),s.a.useEffect(()=>{const e=l.current;a?(e.parentElement.MaterialTextfield.checkDirty(),e.focus()):(e.value=null,e.parentElement.MaterialTextfield.checkDirty())},[a]);const i=`${e}-filter`;return s.a.createElement("form",{action:"#",onClick:a?e=>e.stopPropagation():null,onSubmit:r,autoComplete:"off",autoCorrect:"off"},s.a.createElement("div",{className:"mdl-textfield mdl-js-textfield"},s.a.createElement("input",{className:"mdl-textfield__input",readOnly:!a,id:i,onChange:n,onFocus:()=>{o&&o.length&&l.current.setSelectionRange(o.length,o.length)},ref:l,tabIndex:a?void 0:"-1",title:t,type:"text",value:o}),s.a.createElement("label",{className:"mdl-textfield__label",htmlFor:i},t)))});var E=Object(o.a)((function(e,{filterKey:t}){const a=Object(g.c)(e);return{listFilterActive:a[t]&&a[t].length}}))(e=>s.a.createElement(f,p()({},e,{headerComponent:y}))),v=a(158),C=a(65);const w=["subspecies","serotype","strain","mlst","mlst2","ngmast","ngstar","genotype","reference"],S=w.concat(["speciesId","klocus","collection"]),N=w.concat(["klocus"]);var O=Object(o.a)((function(e){return{filterState:g.a(e,{stateKey:n.b}),filterSummary:g.b(e,{stateKey:n.b}),isActive:C.d.isActive(e,{stateKey:n.b}),isOpen:g.g(e),listFilters:g.c(e),prefilter:g.d(e),textValue:g.e(e)}}),(function(e){return{clearFilter:()=>e(b.d()),updateFilterValue:(t,a)=>e(b.h({[t]:a})),applyFilter:()=>e(b.c()),updateFilter:(t,a)=>e(b.g({[t]:a})),clearDependants:(t,a)=>(n,r)=>{const s={[n]:r};for(const[e,n]of Object.entries(t))a.includes(e)&&(s[e]=n);e(b.g(s))}}}))(({applyFilter:e,clearFilter:t,filterSummary:a,filterState:n,isActive:r,prefilter:o,textValue:d,updateFilter:p,updateFilterValue:h,clearDependants:f})=>{return s.a.createElement(i.a,{active:r,clear:t,prefilter:o,summary:a,textOnChange:e=>h("searchText",e),textOnChangeEffect:e,textValue:d,updateFilter:p},s.a.createElement(E,{autoSelect:!1,disabled:!a.organismId.length,disabledText:"No supported organisms in current filter.",filterKey:"organismId",heading:"Supported organism",hidden:!a.visible,icon:"bug_report",updateFilter:f(n,S)}),s.a.createElement(E,{filterKey:"collection",heading:"Collection",icon:"collections",renderLabel:({label:e})=>s.a.createElement(v.a,null,e),updateFilter:f(n,N)}),s.a.createElement(E,{filterKey:"genusId",heading:"Genus",icon:"bug_report",hidden:n.organismId,renderLabel:({label:e})=>s.a.createElement("em",null,e),updateFilter:f(n,S)}),s.a.createElement(E,{disabled:!a.speciesId.length,disabledText:"Select a genus to filter by species.",filterKey:"speciesId",heading:"Species",hidden:!a.genusId.length||n.organismId,icon:"bug_report",renderLabel:({label:e})=>s.a.createElement("em",null,e),updateFilter:f(n,w)}),s.a.createElement(E,{filterKey:"subspecies",heading:"Subspecies",hidden:n.organismId,icon:"bug_report",renderLabel:({value:e})=>s.a.createElement(s.a.Fragment,null,"subsp. ",s.a.createElement("em",null,e)),updateFilter:f(n,["serotype"])}),s.a.createElement(E,{filterKey:"serotype",heading:(g=n.genusId,"590"===g?"Serovar":"Serotype"),hidden:n.organismId,icon:"bug_report",renderLabel:({value:e})=>`ser. ${e}`}),s.a.createElement(E,{filterKey:"strain",heading:"Strain",icon:"scatter_plot"}),s.a.createElement(E,{filterKey:"mlst",heading:`MLST - ${a.sources.mlst}`,icon:"label",renderLabel:({active:e,value:t})=>s.a.createElement(s.a.Fragment,null,e&&(a.mlst2.length?`${a.sources.mlst}:`:"MLST:")," ST ",s.a.createElement(m.b,{id:t}))}),s.a.createElement(E,{filterKey:"mlst2",heading:`MLST - ${a.sources.mlst2}`,icon:"label",renderLabel:({active:e,value:t})=>s.a.createElement(s.a.Fragment,null,e&&(a.mlst.length?`${a.sources.mlst2}:`:"MLST:")," ST ",s.a.createElement(m.b,{id:t}))}),s.a.createElement(E,{filterKey:"ngstar",heading:"NG-STAR",icon:"label",renderLabel:({active:e,value:t})=>s.a.createElement(s.a.Fragment,null,e?"NG-STAR: ST":"ST"," ",s.a.createElement(m.b,{id:t}))}),s.a.createElement(E,{filterKey:"ngmast",heading:"NG-MAST",icon:"label",renderLabel:({active:e,value:t})=>s.a.createElement(s.a.Fragment,null,e?"NG-MAST: ST":"ST"," ",s.a.createElement(m.b,{id:t}))}),s.a.createElement(E,{filterKey:"genotype",heading:"Genotype",icon:"label",renderLabel:({value:e,active:t})=>t?`Genotype ${e}`:e}),s.a.createElement(E,{filterKey:"klocus",heading:"K Locus",icon:"label"}),s.a.createElement(E,{filterKey:"reference",heading:"PW Reference",icon:"book"}),s.a.createElement(E,{filterKey:"resistance",heading:"Resistance",icon:"local_pharmacy"}),s.a.createElement(E,{filterKey:"country",heading:"Country",icon:"language"}),s.a.createElement(u.a,{summary:a.date}),s.a.createElement(c.a,{filterKey:"access",headerComponent:({heading:e})=>s.a.createElement("span",null,e),heading:"Access",icon:"person"}),s.a.createElement(E,{autoSelect:1===a.access.length,filterKey:"uploadedAt",heading:"Uploaded at",icon:"cloud_upload"}),s.a.createElement(l.b,{update:p}));var g});a.d(t,"b",(function(){return n.b})),a.d(t,"a",(function(){return O}))},function(e,t,a){"use strict";a(959);var n=a(210);a.d(t,"b",(function(){return n.a}));var r=a(285);a.d(t,"a",(function(){return r.a}));a(211);var s=a(82);a.d(t,"c",(function(){return s.b}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(0),r=a.n(n),s=a(210),o=a(211),l=a(82),i=a(57),c=a(74);const u={__date:{columnKey:"__date",valueGetter:e=>Object(i.b)(e)},__pmid:{columnKey:"__pmid",valueGetter:({pmid:e})=>e,getCellContents({valueGetter:e},t){const a=e(t);return a?r.a.createElement("a",{href:`http://www.ncbi.nlm.nih.gov/pubmed/${a}`,target:"_blank",rel:"noopener",title:"View publication",style:{color:"#369"},onClick:e=>e.stopPropagation()},a):null}},__reference:{columnKey:"__reference",valueGetter:({analysis:e})=>e.core&&e.core.fp?e.core.fp.reference:null},__mlst:{columnKey:"__mlst",label:"ST",get displayName(){return c.f.mlst?`MLST ST (${c.f.mlst})`:"MLST ST"},valueGetter({analysis:e}){if(!e.mlst)return null;const{st:t}=e.mlst;return Object(l.b)(t)?`*${t.slice(0,4)}`:t},display:({analysis:e})=>e.mlst?r.a.createElement(s.a,{id:e.mlst.st}):null},__mlst_profile:{columnKey:"__mlst_profile",label:"PROFILE",get displayName(){return c.f.mlst?`MLST PROFILE (${c.f.mlst})`:"MLST PROFILE"},valueGetter:({analysis:e})=>e.mlst?Object(l.a)(e.mlst.alleles,4):null,display:({analysis:e})=>e.mlst?r.a.createElement(o.a,{alleles:e.mlst.alleles}):null},__mlst2:{columnKey:"__mlst2",label:"ST",get displayName(){return c.f.mlst2?`MLST ST (${c.f.mlst2})`:"MLST ST"},valueGetter({analysis:e}){if(!e.mlst2)return null;const{st:t}=e.mlst2;return Object(l.b)(t)?`*${t.slice(0,4)}`:t},display:({analysis:e})=>e.mlst2?r.a.createElement(s.a,{id:e.mlst2.st}):null},__mlst2_profile:{columnKey:"__mlst2_profile",label:"PROFILE",get displayName(){return c.f.mlst2?`MLST PROFILE (${c.f.mlst2})`:"MLST PROFILE"},valueGetter:({analysis:e})=>e.mlst2?Object(l.a)(e.mlst2.alleles,4):null,display:({analysis:e})=>e.mlst2?r.a.createElement(o.a,{alleles:e.mlst2.alleles}):null},__ngstar:{columnKey:"__ngstar",label:"TYPE",get displayName(){return"NG-STAR TYPE"},valueGetter({analysis:e}){if(!e.ngstar)return null;const{st:t}=e.ngstar;return Object(l.b)(t)?`*${t.slice(0,4)}`:t},display:({analysis:e})=>e.ngstar?r.a.createElement(s.a,{id:e.ngstar.st}):null},__ngstar_profile:{columnKey:"__ngstar_profile",label:"PROFILE",get displayName(){return"NG-STAR PROFILE"},valueGetter:({analysis:e})=>e.ngstar?Object(l.a)(e.ngstar.alleles,4):null,display:({analysis:e})=>e.ngstar?r.a.createElement(o.a,{alleles:e.ngstar.alleles}):null},__inc_types:{columnKey:"__inc_types",displayName:"Inc Types",valueGetter:({analysis:e})=>e.inctyper?0===Object.keys(e.inctyper).length&&e.inctyper.constructor===Object?null:Object.values(e.inctyper["Inc Matches"].reduce((e,t)=>(e.hasOwnProperty(t.Contig)||(e[t.Contig]=[]),e[t.Contig].push(t),e),{})).map(t=>t.map(t=>"gram_negative"===e.inctyper.Library?t["Inc Match"].replace(/_\d+$/,""):t.Group).sort().join("/")).sort().join("; "):null},__Virulence_Score:{columnKey:"__Virulence_Score",displayName:"Virulence Score",label:"Virulence Score",valueGetter:({analysis:e})=>e.kleborate?`${e.kleborate.virulence_score}`:null},__K_locus:{columnKey:"__K_locus",displayName:"K LOCUS (wzi)",label:"K LOCUS (wzi)",valueGetter:({analysis:e})=>e.kleborate?`${e.kleborate.typing.K_locus} (${e.kleborate.typing.wzi})`:null},__O_locus:{columnKey:"__O_locus",valueGetter:({analysis:e})=>e.kleborate?e.kleborate.typing.O_locus:null},__Aerobactin:{columnKey:"__Aerobactin",displayName:"AEROBACTIN (AbST)",label:"AEROBACTIN (AbST)",valueGetter:({analysis:e})=>e.kleborate?"-"===e.kleborate.Aerobactin?null:`${e.kleborate.virulence.Aerobactin} (${e.kleborate.virulence.AbST})`:null},__Colibactin:{columnKey:"__Colibactin",displayName:"COLIBACTIN (CbST)",label:"COLIBACTIN (CbST)",valueGetter:({analysis:e})=>e.kleborate?"-"===e.kleborate.Colibactin?null:`${e.kleborate.virulence.Colibactin} (${e.kleborate.virulence.CbST})`:null},__Salmochelin:{columnKey:"__Salmochelin",displayName:"SALMOCHELIN (SmST)",label:"SALMOCHELIN (SmST)",valueGetter:({analysis:e})=>e.kleborate?"-"===e.kleborate.Salmochelin?null:`${e.kleborate.virulence.Salmochelin} (${e.kleborate.virulence.SmST})`:null},__Yersiniabactin:{columnKey:"__Yersiniabactin",displayName:"YERSINIABACTIN (YbST)",label:"YERSINIABACTIN (YbST)",valueGetter:({analysis:e})=>e.kleborate?"-"===e.kleborate.Yersiniabactin?null:`${e.kleborate.virulence.Yersiniabactin} (${e.kleborate.virulence.YbST})`:null},__rmpA:{columnKey:"__rmpA",displayName:"rmpA",valueGetter:({analysis:e})=>e.kleborate?"-"===e.kleborate.rmpA?null:e.kleborate.virulence.rmpA:null},__rmpA2:{columnKey:"__rmpA2",displayName:"rmpA2",valueGetter:({analysis:e})=>e.kleborate?"-"===e.kleborate.rmpA2?null:e.kleborate.virulence.rmpA2:null},"__ng-mast":{columnKey:"__ng-mast",displayName:"NG-MAST TYPE",valueGetter:({analysis:e})=>e.ngmast?e.ngmast.ngmast:null},__por:{columnKey:"__por",displayName:"NG-MAST POR",valueGetter:({analysis:e})=>e.ngmast?e.ngmast.por:null},__tbpb:{columnKey:"__tbpb",displayName:"NG-MAST TBQB",valueGetter:({analysis:e})=>e.ngmast?e.ngmast.tbpb:null},__genotyphi_type:{columnKey:"__genotyphi_type",label:"GENOTYPE",displayName:"GENOTYPHI GENOTYPE",valueGetter:({analysis:e})=>e.genotyphi?e.genotyphi.genotype:null},__genotyphi_snps:{columnKey:"__genotyphi_snps",label:"SNPs",valueGetter:({analysis:e})=>e.genotyphi?e.genotyphi.snps:null},__genotyphi_snps_called:{columnKey:"__genotyphi_snps_called",label:"SNPs CALLED",displayName:"GENOTYPHI SNPs CALLED",valueGetter:({analysis:e})=>e.genotyphi?e.genotyphi.foundLoci:null,numeric:!0},__core_matches:{columnKey:"__core_matches",valueGetter:({analysis:e})=>e.core&&e.core.summary?e.core.summary.kernelSize:null,numeric:!0},"__%_core_families":{columnKey:"__%_core_families",valueGetter:({analysis:e})=>e.core&&e.core.summary?e.core.summary.percentKernelMatched:null,numeric:!0},"__%_non-core":{columnKey:"__%_non-core",valueGetter({analysis:e}){const{core:t={}}=e;return t.summary&&t.summary.percentAssemblyMatched?(100-t.summary.percentAssemblyMatched).toFixed(1):null},numeric:!0},__genome_length:{columnKey:"__genome_length",valueGetter:({analysis:e})=>e.metrics?e.metrics.length:null,numeric:!0},__n50:{columnKey:"__n50",valueGetter:({analysis:e})=>e.metrics?e.metrics.N50:null,numeric:!0},"__no._contigs":{columnKey:"__no._contigs",valueGetter:({analysis:e})=>e.metrics?e.metrics.contigs:null,numeric:!0},"__non-ATCG":{columnKey:"__non-ATCG",valueGetter:({analysis:e})=>e.metrics?e.metrics.nonATCG:null,numeric:!0},"__%_GC_Content":{columnKey:"__%_GC_Content",label:"% GC CONTENT",valueGetter:({analysis:e})=>e.metrics?e.metrics.gcContent:null,numeric:!0}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));const n={RECOVERY:1,PROGRESS:2},r={READS:"reads",ASSEMBLY:"assembly"}},function(e,t,a){"use strict";a(965);var n=a(0),r=a.n(n),s=a(4),o=a.n(s),l=a(295);var i=({className:e,children:t,tooltip:a,title:n,icon:s,fadeOverflow:i})=>r.a.createElement("div",{className:o()(e,"wgsa-card-metadata",{"wgsa-overflow-fade":i}),title:a},function(e,t){return e?"wgsa_genome"===e?r.a.createElement(l.a,{title:t,viewBox:"4 4 60 60"}):r.a.createElement("i",{title:t,className:"material-icons"},e):null}(s,n),t),c=({className:e,children:t})=>r.a.createElement("article",{className:o()("wgsa-card",e)},t);a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return c}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={UNSAVED:0,SAVING:1,SAVED:2,ERRORED:3}},,,,function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(2);const r=e=>e.summary,s=Object(n.createSelector)(r,e=>{const t={};for(const[a,n]of Object.entries(e))t[a]=Number(n).toLocaleString();return t}),o=({summary:e})=>new Set(e.deployedOrganisms)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return c}));var n=a(2);const r={center:[0,0],zoom:1};function s(e,{stateKey:t}){return e.maps[t]||{}}const o=Object(n.createSelector)(s,({bounds:e=r})=>e),l=Object(n.createSelector)(s,({lassoPath:e})=>e),i=Object(n.createSelector)(s,({viewByCountry:e=!1})=>e),c=Object(n.createSelector)(s,({markerSize:e=1})=>e)},,function(e,t,a){"use strict";a.d(t,"f",(function(){return i})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"g",(function(){return m})),a.d(t,"d",(function(){return d})),a.d(t,"a",(function(){return h})),a.d(t,"e",(function(){return f})),a.d(t,"h",(function(){return g}));var n=a(2),r=a(58),s=a(16);const o=({upload:e})=>e.progress.assembly,l=e=>o(e).status,i=e=>o(e).loaded,c=e=>l(e).pending,u=Object(n.createSelector)(r.d,l,e=>o(e).tick,({reads:e,assemblies:t},{runningSince:a=[],failed:n=0,complete:r=0},o=Date.now())=>{if(0===e)return null;const l=e+t;let i=0;for(const e of a){i+=(o-1e3*e)/18e5*(100/l)}const c=a.length>0?Math.max(Math.min(99,i),1):0,u=(r+t)/l*100,m=n/l*100,d=c*((100-u-m)/100);return{label:"Assembly progress",data:[u,m,d,100-u-m-d],backgroundColor:["#3c7383",s.c.DANGER_COLOUR,"#ac65a6","rgba(0, 0, 0, .14)"],labels:["Assembled","Failed","Assembling","Remaining"],tooltips:[`${r+t} / ${l}, ${u.toFixed(1)}%`,`${n} / ${l}`,`${a.length} / ${l}, ${c.toFixed(1)}%`,`${l-a.length-n-r} / ${l}`],parents:[],total:100}}),m=Object(n.createSelector)(l,({runningSince:e=[]})=>e.length>0),d=Object(n.createSelector)(r.c,l,(e,{complete:t=0,failed:a=0})=>({total:e,complete:t,failed:a,done:t+a,pending:e-a-t})),p=Object(n.createSelector)(d,r.b,({pending:e},t)=>e-t>0),h=Object(n.createSelector)(e=>o(e).errors,r.e,(e,t)=>{const a=[];for(const[n,r]of Object.entries(e))n in t&&!r.includes("quality")&&a.push({name:t[n].name,message:r});return a}),f=Object(n.createSelector)(h,e=>e.length),g=Object(n.createSelector)(p,l,f,(e,{failed:t=0},a)=>!!e||t>0&&a<t)},function(e,t,a){"use strict";a.d(t,"f",(function(){return i})),a.d(t,"b",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"c",(function(){return m})),a.d(t,"a",(function(){return d})),a.d(t,"d",(function(){return p}));var n=a(150),r=a(65),s=a(73),o=a(75),l=a(14);function i(e){return r.b.update(n.b,e)}function c(){return Object(l.a)(s.d,o.b)}function u(e,t=!0){return a=>{a(t?i(e):r.b.setFilter(n.b,e)),a(c())}}function m(){return(e,t)=>{e(r.b.clear(n.b));const a=Object(o.b)(t());e(Object(s.d)(a))}}const d="COLLECTIONS_FILTER_OPENED";function p(){return{type:d}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"e",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return l}));const n={iterationsPerRender:100,worker:!0,barnesHutOptimize:!1},r={edgeColor:"default",labelColor:"node",labelThreshold:0,hideEdgesOnMove:!0},s=1e3,o=10,l=50},function(e,t,a){window,e.exports=function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/dist/",a(a.s=3)}([function(e,t,a){e.exports=a(1),e.exports.parse_nhx=a(2)},function(e,t){e.exports.parse_newick=function(e){for(var t=[],a={},n=e.split(/\s*(;|\(|\)|,|:)\s*/),r=0;r<n.length;r++){var s=n[r];switch(s){case"(":var o={};a.children=[o],t.push(a),a=o;break;case",":o={},t[t.length-1].children.push(o),a=o;break;case")":a=t.pop();break;case":":break;default:var l=n[r-1];")"==l||"("==l||","==l?a.name=s:":"==l&&(a.branch_length=parseFloat(s))}}return a},e.exports.parse_json=function(e){return function e(t){var a="";if(t.hasOwnProperty("children")){var n=[];t.children.forEach((function(t){var a=e(t);n.push(a)}));var r=n.join();t.hasOwnProperty("name")&&(a="("+r+")"+t.name),t.hasOwnProperty("branch_length")&&(a=a+":"+t.branch_length)}else{var s="";t.hasOwnProperty("name")&&(s=t.name),t.hasOwnProperty("branch_length")&&(s=s+":"+t.branch_length),a+=s}return a}(e)+";"}},function(e,t){e.exports=parse_nhx=function(e){for(var t=[],a={},n=e.split(/\s*(;|\(|\)|\[|\]|,|:|=)\s*/),r=0;r<n.length;r++){var s=n[r];switch(s){case"(":var o={};a.children=[o],t.push(a),a=o;break;case",":o={},t[t.length-1].children.push(o),a=o;break;case")":a=t.pop();break;case":":break;default:var l=n[r-1];if(")"==l||"("==l||","==l)a.name=s;else if(":"==l)isNaN(s)||(a.branch_length=parseFloat(s));else if("="==l)switch(n[r-2]){case"D":a.duplication=s;break;case"G":a.gene_id=s;break;case"T":a.taxon_id=s}}}return a}},function(e,t,a){"use strict";a.r(t);var n={};a.r(n),a.d(n,"Angles",(function(){return r})),a.d(n,"TreeTypes",(function(){return s})),a.d(n,"EmptyArray",(function(){return o}));var r={Degrees0:0,Degrees45:.25*Math.PI,Degrees90:.5*Math.PI,Degrees180:Math.PI,Degrees270:1.5*Math.PI,Degrees360:2*Math.PI},s={Radial:"rd",Rectangular:"rc",Circular:"cr",Diagonal:"dg",Hierarchical:"hr"},o=[],l={alignLabels:!1,branchScale:null,collapsedIds:o,fillStyle:"#222",fontFamily:"serif",fontSize:16,fontWeight:"normal",haloRadius:12,haloStyle:"#3C7383",haloWidth:4,highlightedId:null,highlightedStyle:"#3C7383",internalNodeStyle:{shape:"none"},labelThreshold:8,leafNodeStyle:{shape:"circle"},lineWidth:1,nodeSize:14,nodesPowRatio:.5,padding:32,renderInternalLabels:!1,renderLabels:!0,renderLeafLabels:!0,rootId:null,rotatedIds:o,selectableInternalNodes:!0,selectableLeafNodes:!0,selectedIds:o,showLabels:!1,showNodes:!0,stepScale:8,strokeStyle:"#222",styleLeafLabels:!1,styleNodeLines:!1,styles:{},type:s.Rectangular,zoomFactor:3};function i(e,t){var a=this[e];this[e]=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.call(this,a.bind(this),n)}}var c=function(e,t){var a=!0,n=!1,r=void 0;try{for(var s,o=t[Symbol.iterator]();!(a=(s=o.next()).done);a=!0){var l=s.value;if("function"!=typeof l)throw new Error("Invalid plugin provided.");l.call(e,e,i.bind(e),l.options)}}catch(e){n=!0,r=e}finally{try{a||null==o.return||o.return()}finally{if(n)throw r}}},u=function(e,t,a){var n=e.state.zoomFactor;return 0===a?t:Math.pow(10,Math.log(t)/Math.log(10)+a*n*.01)},m=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(a){var n=e.indexOf(t);if(-1===n)return e.concat(t);var r=e.concat();return r.splice(n,1),r}return[t]},d={rd:{alignableLabels:!1,branchScalingAxis:"xy",drawLine:function(e,t,a){e.ctx.beginPath(),e.ctx.moveTo(a.x,a.y),e.ctx.lineTo(a.parent.x,a.parent.y),e.ctx.stroke(),e.ctx.closePath()},getBranchScale:function(e){var t=function(e){return Math.min(e.ctx.canvas.width,e.ctx.canvas.height)}(e)/2,a=e.getVirtualTree(),n=a.rootNode.totalLeafLength-a.rootNode.branchLength;return n>0?t/n:n<0?t*n:0},getNodeAtPoint:function(e,t,a,n){for(var r=e.layout(),s=r.rootNode,o=r.postorderTraversal,l=s.postIndex-s.totalNodes+1;l<=s.postIndex;l++){var i=o[l];if(i.parent&&(i.x>i.parent.x?t<i.x&&t>i.parent.x:t<i.parent.x&&t>i.x))if(isNaN(i.slope)){if(i.y>i.parent.y?a<i.y&&a>i.parent.y:a<i.parent.y&&a>i.y)return i}else if(a>i.slope*t+i.intercept-n&&a<i.slope*t+i.intercept+n)return i}return null},layoutNodes:function(e,t){for(var a=0,n=t.rootNode,s=n.postIndex-n.totalNodes+1;s<=n.postIndex;s++){var o=t.postorderTraversal[s];if(o.isLeaf)o.angle=a*(r.Degrees360/n.visibleLeaves);else{var l=0,i=!0,c=!1,u=void 0;try{for(var m,d=o.children[Symbol.iterator]();!(i=(m=d.next()).done);i=!0){var p=m.value;l+=p.angle*p.totalLeaves}}catch(e){c=!0,u=e}finally{try{i||null==d.return||d.return()}finally{if(c)throw u}}o.angle=l/o.totalLeaves}(o.isLeaf&&!o.isHidden||o.isCollapsed&&!o.isHidden)&&(a+=1)}for(var h=n.preIndex;h<n.preIndex+n.totalNodes;h++){var f=t.preorderTraversal[h],g=f.branchLength*e.state.branchScale;f.x=(f!==n?f.parent.x:0)+g*Math.cos(f.angle),f.y=(f!==n?f.parent.y:0)+g*Math.sin(f.angle),f!==n&&(f.slope=(f.parent.y-f.y)/(f.parent.x-f.x),f.intercept=f.y-f.slope*f.x)}}},rc:{alignableLabels:!0,branchScalingAxis:"x",drawLine:function(e,t,a){a!==t.rootNode&&(e.ctx.beginPath(),e.ctx.moveTo(a.x,a.y),e.ctx.lineTo(a.parent.x,a.y),e.ctx.lineTo(a.parent.x,a.parent.y),e.ctx.stroke(),e.ctx.closePath())},getBranchScale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.state.stepScale,a=e.getVirtualTree(),n=a.rootNode.totalLeaves*t,r=e.ctx.canvas.width/e.ctx.canvas.height*n,s=a.rootNode.totalLeafLength-a.rootNode.branchLength;return 0===s&&e.error(501),r/s},getNodeAtPoint:function(e,t,a,n){for(var r=e.layout(),s=r.rootNode,o=r.postorderTraversal,l=s.postIndex-s.totalNodes+1;l<=s.postIndex;l++){var i=o[l];if(i.parent&&(t<i.x+n&&t>i.parent.x-n&&a<i.y+n&&a>i.y-n||t<i.parent.x+n&&t>i.parent.x-n&&(a<i.parent.y?a>i.y-n:a<i.y+n)))return i}return null},mainAxis:"x",layoutNodes:function(e,t){for(var a=0,n=t.rootNode,s=n.postIndex-n.totalNodes+1;s<=n.postIndex;s++){var o=t.postorderTraversal[s];if(o.angle=r.Degrees0,o.x=o.distanceFromRoot*e.state.branchScale,o.isLeaf)o.y=a*e.state.stepScale;else if(o.isCollapsed)o.y=a*e.state.stepScale;else{var l=o.children[0].y,i=o.children[o.children.length-1].y;o.y=(i+l)/2}(o.isLeaf&&!o.isHidden||o.isCollapsed&&!o.isHidden)&&(a+=1)}},stepScalingAxis:"y"},cr:{alignableLabels:!0,branchScalingAxis:"xy",drawLine:function(e,t,a){var n=t.rootNode,r=a.parent.distanceFromRoot-n.distanceFromRoot;if(e.ctx.beginPath(),e.ctx.moveTo(a.x,a.y),e.ctx.lineTo(r*e.state.branchScale*Math.cos(a.angle),r*e.state.branchScale*Math.sin(a.angle)),e.ctx.stroke(),e.ctx.closePath(),a.children&&a.children.length&&!a.isCollapsed){var s=a.children[0].angle,o=a.children[a.children.length-1].angle,l=Math.abs(a.distanceFromRoot-n.distanceFromRoot);e.ctx.beginPath(),e.ctx.arc(0,0,l*e.state.branchScale,s,o,o<s),e.ctx.stroke(),e.ctx.closePath()}},getBranchScale:function(e){var t=function(e){return Math.min(e.ctx.canvas.width,e.ctx.canvas.height)}(e)/2,a=e.getVirtualTree().rootNode;return a.totalLeafLength>0?t/a.totalLeafLength:a.totalLeafLength<0?t*a.totalLeafLength:0},getNodeAtPoint:function(e,t,a,n){for(var r=e.layout(),s=r.rootNode,o=r.postorderTraversal,l=s.postIndex-s.totalNodes+1;l<=s.postIndex;l++){var i=o[l];if(i.parent){var c=i.parent.distanceFromRoot-s.distanceFromRoot,u=c*e.state.branchScale*Math.cos(i.angle);if(i.x>u?t<i.x&&t>u:t<u&&t>i.x)if(isNaN(i.slope)){var m=c*e.state.branchScale*Math.sin(i.angle);if(i.y>m?a<i.y&&a>m:a<m&&a>i.y)return i}else if(a>i.slope*t+i.intercept-n&&a<i.slope*t+i.intercept+n)return i}}return null},layoutNodes:function(e,t){for(var a=0,n=t.rootNode,s=n.postIndex-n.totalNodes+1;s<=n.postIndex;s++){var o=t.postorderTraversal[s];if(o.isLeaf)o.angle=a*(r.Degrees360/t.rootNode.visibleLeaves);else{var l=o.children[0].angle,i=o.children[o.children.length-1].angle;o.angle=(i+l)/2}var c=(o.distanceFromRoot-t.rootNode.distanceFromRoot)*e.state.branchScale;o.x=c*Math.cos(o.angle),o.y=c*Math.sin(o.angle),(o.isLeaf&&!o.isHidden||o.isCollapsed&&!o.isHidden)&&(a+=1),o.parent&&(o.slope=Math.tan(o.angle),o.intercept=o.y-o.slope*o.x)}}},dg:{alignableLabels:!1,getBranchScale:function(e){var t=e.getVirtualTree().rootNode,a=e.ctx.canvas.width-2*e.state.padding;return t.totalLeafLength>0?a/t.totalLeafLength:t.totalLeafLength<0?a*t.totalLeafLength:0},getNodeAtPoint:function(e,t,a,n){for(var r=e.getVirtualTree(),s=r.rootNode,o=r.postorderTraversal,l=s.postIndex-s.totalNodes+1;l<=s.postIndex;l++){var i=o[l];if(i&&i.parent&&t<i.x&&t>i.parent.x&&a>i.slope*t+i.intercept-n&&a<i.slope*t+i.intercept+n)return i}return null},drawLine:function(e,t,a){a!==t.rootNode&&(e.ctx.beginPath(),e.ctx.moveTo(a.x,a.y),e.ctx.lineTo(a.parent.x,a.parent.y),e.ctx.stroke(),e.ctx.closePath())},layoutNodes:function(e,t){for(var a=0,n=t.rootNode,s=n.postIndex-n.totalNodes+1;s<=n.postIndex;s++){var o=t.postorderTraversal[s];if(o.angle=r.Degrees0,o.x=(t.rootNode.visibleLeaves-o.visibleLeaves)*e.state.stepScale/2,o.isLeaf)o.y=a*e.state.stepScale;else if(o.isCollapsed)o.y=a*e.state.stepScale;else{var l=o.children[0].y,i=(o.visibleLeaves-o.children[0].visibleLeaves)*e.state.stepScale;o.y=l+i/2}o.isLeaf&&a++}for(var c=n.preIndex;c<n.preIndex+n.totalNodes;c++){var u=t.preorderTraversal[c];u.parent&&(u.slope=(u.parent.y-u.y)/(u.parent.x-u.x),u.intercept=u.y-u.slope*u.x)}},mainAxis:"x",stepScalingAxis:"y"},hr:{alignableLabels:!0,drawLine:function(e,t,a){a!==t.rootNode&&(e.ctx.beginPath(),e.ctx.moveTo(a.x,a.y),e.ctx.lineTo(a.x,a.parent.y),e.ctx.lineTo(a.parent.x,a.parent.y),e.ctx.stroke(),e.ctx.closePath())},branchScalingAxis:"y",getBranchScale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.state.stepScale,a=e.getVirtualTree(),n=a.rootNode.totalLeaves*t,r=e.ctx.canvas.height/e.ctx.canvas.width*n,s=a.rootNode.totalLeafLength-a.rootNode.branchLength;return 0===s&&e.error(501),r/s},getNodeAtPoint:function(e,t,a,n){for(var r=e.layout(),s=r.rootNode,o=r.preorderTraversal,l=s.preIndex;l<s.preIndex+s.totalNodes;l++){var i=o[l];if(i.parent&&(t<i.x+n&&t>i.x-n&&a<i.y+n&&a>i.parent.y-n||a<i.parent.y+n&&a>i.parent.y-n&&(t<i.parent.x?t>i.x-n:t<i.x+n)))return i}return null},mainAxis:"y",layoutNodes:function(e,t){for(var a=0,n=t.rootNode,s=n.postIndex-n.totalNodes+1;s<=n.postIndex;s++){var o=t.postorderTraversal[s];if(o.angle=r.Degrees90,o.y=o.distanceFromRoot*e.state.branchScale,o.isLeaf)o.x=-1*a*e.state.stepScale;else if(o.isCollapsed)o.x=a*e.state.stepScale;else{var l=o.children[0].x,i=o.children[o.children.length-1].x;o.x=(i+l)/2}(o.isLeaf&&!o.isHidden||o.isCollapsed&&!o.isHidden)&&(a+=1)}},stepScalingAxis:"x"}},p=function(e){return{minScale:e/2,maxScale:Math.max(e,16)}},h=function(e){var t=e.getBounds(!1),a=e.getDrawingArea(),n=t.maxX-t.minX,r=t.maxY-t.minY,s=Math.max(.333*a.width,a.right-a.left-e.state.nodeSize),o=Math.max(.333*a.height,a.bottom-a.top-e.state.nodeSize),l=s/n,i=o/r,c=Math.min(l,i),u=e.state.padding+Math.max(e.state.nodeSize,e.state.fontSize)/2,m=-1*t.minX*c,h=-1*t.minY*c;l>i?(m+=u+(s-n*c)/2,h+=u):l<i?(m+=u,h+=u+(o-r*c)/2):(m+=u,h+=u),void 0===d[e.state.type].mainAxis&&(m+=(a.width-s)/2-u,h+=(a.height-o)/2-u);var f=p(c);return{offsetX:m,offsetY:h,scale:c,minScale:f.minScale,maxScale:f.maxScale}},f=function(e,t,a){var n=m(e.state.collapsedIds,t);return e.chain((function(){return{collapsedIds:n}}),a?h:null)},g=function(e,t){return t/e.state.scale},b={},y=function(e){e.setState(h(e))};function E(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function C(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function w(e){for(var t=[],a=[e];a.length;){var n=a.shift();t.push(n),Array.isArray(n.children)&&a.unshift.apply(a,C(n.children))}return t}function S(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function N(e){for(var t=[],a=[e];a.length;){var n=a.pop();Array.isArray(n.children)&&a.push.apply(a,S(n.children)),t.push(n)}return t.reverse()}var O=a(0),x=function(e){var t=e;"string"==typeof e&&(t={type:"newick",data:e});var a=t,n=a.type,r=a.data,s=function(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}(a,["type","data"]),o=null;if("newick"===n||void 0===n)o=O.parse_newick(r);else{if("biojs"!==n)throw new Error("Source type is not supported: ".concat(n));o=r}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.trimQuotes,n=void 0===a||a,r=N(e),s=w(e),o=r.every((function(e){return 0===(e.branchLength||e.branch_length||0)}));if(o){e.branchLength=0;for(var l=0;l<s.length;l++){var i=s[l];if(i.children){var c=!0,u=!1,m=void 0;try{for(var d,p=i.children[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var h=d.value;h.branchLength=i.branchLength+1}}catch(e){u=!0,m=e}finally{try{c||null==p.return||p.return()}finally{if(u)throw m}}}}}for(var f=0;f<r.length;f++){var g=r[f];if(g.postIndex=f,g.isLeaf=!Array.isArray(g.children),g.branchLength=Math.abs(g.branchLength||g.branch_length||0),delete g.branch_length,g.isLeaf&&"string"==typeof g.name&&(g.id=n?g.name.trim().replace(/^['"]|['"]$/g,""):g.name,delete g.name),g.totalNodes=1,g.totalLeaves=1,g.totalLeafLength=g.branchLength,!g.isLeaf){g.totalNodes=1,g.totalLeaves=0;var b=0,y=!0,E=!1,v=void 0;try{for(var C,S=g.children[Symbol.iterator]();!(y=(C=S.next()).done);y=!0){var O=C.value;g.totalNodes+=O.totalNodes,g.totalLeaves+=O.totalLeaves,O.totalLeafLength>b&&(b=O.totalLeafLength),O.parent=g}}catch(e){E=!0,v=e}finally{try{y||null==S.return||S.return()}finally{if(E)throw v}}g.totalLeafLength=g.branchLength+b,g.longestLeaf=b}}for(var x={},k=[],_=0;_<s.length;_++){var I=s[_];I.preIndex=_,I.id||(I.id=_.toString()),x[I.id]=I,I.distanceFromRoot=(I.parent?I.parent.distanceFromRoot:0)+I.branchLength,I.isLeaf&&k.push(I),I.visibleLeaves=I.totalLeaves}return{nodeById:x,rootNode:e,leafNodes:k,postorderTraversal:r,preorderTraversal:s}}(o,s)};function k(e){var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||1;return(window.devicePixelRatio||1)/t}function _(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function I(e,t,a){var n=[],r=!0,s=!1,o=void 0;try{for(var l,i=a.children[Symbol.iterator]();!(r=(l=i.next()).done);r=!0){var c=l.value,u=e.splice(t,c.totalNodes);n.push(u)}}catch(e){s=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(s)throw o}}for(var m=0,d=n;m<d.length;m++){var p=d[m];e.splice.apply(e,[t,0].concat(_(p)))}}var T=function(e,t,a){var n=t.preorderTraversal,r=t.postorderTraversal;I(n,n.indexOf(a)+1,a);for(var s=0;s<n.length;s++)n[s].preIndex=s;I(r,r.indexOf(a)-a.totalNodes+1,a);for(var o=0;o<r.length;o++)r[o].postIndex=o;a.children.reverse()};function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function A(e){var t=N(e),a=[],n=!0,r=!1,s=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var i=o.value;if(i.isLeaf)a.push("".concat(i.id,":").concat(i.branchLength));else if(i!==e){var c=a.splice(a.length-i.children.length,i.children.length);a.push("(".concat(c.join(","),"):").concat(i.branchLength))}}}catch(e){r=!0,s=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}return"(".concat(a.join(","),");")}var P=function(e){return{branchScale:d[e.state.type].getBranchScale(e,l.stepScale)}},R=function(e){return{stepScale:l.stepScale}},M=function(e){return e.chain(R,P,h)},D=function(e){return{collapsedIds:o}},F=function(e,t,a){return e.pixelRatio=k(e.ctx),{size:{width:t,height:a}}},z=function(e,t,a){var n=m(e.state.rotatedIds,t);return e.chain((function(){return{rotatedIds:n}}),a?h:null)},G=function(e){return{minScale:h(e).minScale}},U=function(e,t,a){var n=a.x,r=a.y,s=e.state.offsetX,o=e.state.offsetY;if(a){var l=d[e.state.type].branchScalingAxis,i=t/e.state.branchScale;if("x"===l||"xy"===l){var c=e.state.offsetX;s=c+(n-((n-c)*i+c))}if("y"===l||"xy"===l){var u=e.state.offsetY;o=u+(r-((r-u)*i+u))}}return e.chain((function(){return{branchScale:t,offsetX:s,offsetY:o}}),G)};function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var H=function(e){return{rootId:l.rootId}},V=function(e){return{rotatedIds:o}},K=function(e,t,a){var n=a.x,r=a.y,s=e.state.offsetX,o=e.state.offsetY,l=t/e.state.stepScale;if(a){var i=d[e.state.type].stepScalingAxis;if("x"===i||"xy"===i){var c=e.state.offsetX;s=c+(n-((n-c)*l+c))}if("y"===i||"xy"===i){var u=e.state.offsetY;o=u+(r-((r-u)*l+u))}}return e.chain((function(){return{stepScale:t,offsetX:s,offsetY:o}}),G)};function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4?arguments[4]:void 0,s=r.x,o=r.y,l=e.state.offsetX+t,i=e.state.offsetY+a;if(0===n)return{offsetX:l,offsetY:i};var c=u(e,e.state.scale,n),m=e.state.scale;return{offsetX:-1*((-1*l+s)/m*c-s),offsetY:-1*((-1*i+o)/m*c-o),scale:c}},Y={cache:function(e,t){return e._.cache[t]||(e._.cache[t]=new Map)},chain:function(e){for(var t={},a=arguments.length,n=new Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];for(var s=0,o=n;s<o.length;s++){var l=o[s];if("function"==typeof l){var i=l(e);Object.assign(t,i),Object.assign(e.state,i)}}return t},changeBranchScale:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getCentrePoint();e.setBranchScale(u(e,e.state.branchScale,t),a)},changeScale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getCentrePoint();e.transform(0,0,t,a)},changeStepScale:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getCentrePoint();e.setStepScale(u(e,e.state.stepScale,t),a)},collapseNode:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.refit,r=void 0!==n&&n,s=e.getNodeById(t);s&&e.setState(f(e,s.id,r))},destroy:function(e){},drawHighlight:function(e,t){var a=e.ctx,n=e.state,s=e._,o=s.actualNodeSize,i=s.actualHaloWidth;a.lineWidth=i,a.strokeWidth=i,a.strokeStyle=n.haloStyle;var c=o/2,u=g(e,l.nodeSize/2),m=t.isLeaf?n.leafNodeStyle:n.internalNodeStyle,d=(n.styles[t.id]||m).shape,p="none"===(void 0===d?m.shape:d)?1.5*i:c+u+Math.floor(c/u/2);a.beginPath(),a.arc(t.x,t.y,p,0,r.Degrees360,!1),a.closePath(),a.stroke()},drawNode:function(e,t,a){var n=e.ctx,s=e.state;n.translate(a.x,a.y),n.rotate(a.angle);var o=(s.styles?s.styles[a.id]:void 0)||b,l=a.isLeaf?s.leafNodeStyle:s.internalNodeStyle;n.fillStyle=o.fillStyle||s.fillStyle||l.fillStyle,n.strokeStyle=e.state.strokeStyle;var i=e._.actualNodeSize,c=e._.actualNodeSize/2;if(e._.renderShapes){var u=(o?o.shape:void 0)||l.shape;e.drawNodeShape(a,u,i)}if((e.state.showLabels||e._.renderLabels)&&(a.isLeaf&&s.renderLeafLabels||!a.isLeaf&&s.renderInternalLabels)){var m=a.isLeaf&&s.alignLabels&&!1!==d[s.type].alignableLabels?s.branchScale*(t.rootNode.longestLeaf-a.distanceFromRoot):0;if(m>0&&e.state.lineWidth*e.state.scale>1){var p=e.ctx.lineWidth;e.ctx.lineWidth=e.ctx.lineWidth/4,e.ctx.strokeWidth=e.ctx.lineWidth,n.beginPath(),n.moveTo(c,0),n.lineTo(c+m,0),n.stroke(),n.closePath(),e.ctx.lineWidth=p,e.ctx.strokeWidth=e.ctx.lineWidth}var h=(a.isLeaf?2:0)*c+m,f=a.angle>r.Degrees90&&a.angle<r.Degrees270;f&&n.rotate(r.Degrees180),n.textAlign=f?"right":"left";var g=n.font;o.fontStyle&&(n.font="".concat(o.fontStyle," ").concat(e._.actualFontSize,"px ").concat(e.state.fontFamily)),!1===s.styleLeafLabels&&(n.fillStyle=o.labelFillStyle||s.fillStyle||l.fillStyle),n.fillText(e.getLabel(a),f?-h:h,0),n.font=g,f&&n.rotate(-r.Degrees180)}n.rotate(-a.angle),n.translate(-a.x,-a.y)},drawNodeShape:function(e,t,a,n){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n/2,o=e.ctx;if(o.beginPath(),"dot"===a)o.arc(0,0,2*o.lineWidth,r.Degrees0,r.Degrees360);else if("circle"===a)o.arc(0,0,s,r.Degrees0,r.Degrees360);else if("square"===a)o.rect(-s,-s,n,n);else if("triangle"===a)o.moveTo(0,-s),o.lineTo(s,s),o.lineTo(-s,s),o.lineTo(0,-s);else if("star"===a){var l=Math.PI/5,i=Math.PI/2*3;o.moveTo(0,-s);for(var c=0;c<5;c++)o.lineTo(Math.cos(i)*s,Math.sin(i)*s),i+=l,o.lineTo(Math.cos(i)*s*.5,Math.sin(i)*s*.5),i+=l;o.lineTo(0,-s)}o.fill(),o.stroke(),o.closePath()},exportPNG:function(e){return e.ctx.canvas.toDataURL()},fitInPanel:y,getBounds:function(e){for(var t=e.state,a=e.layout(),n=Number.MAX_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER,i=t.type===s.Circular&&t.alignLabels,c=a.rootNode,u=c.preIndex;u<c.preIndex+c.totalNodes;u++){var m=a.preorderTraversal[u],d=m.x,p=m.x,h=m.y,f=m.y;if(m.isLeaf){var g=0;i&&(g+=t.branchScale*(a.rootNode.totalLeafLength-m.distanceFromRoot)),p+=g*Math.cos(m.angle),f+=g*Math.sin(m.angle)}d<n&&(n=d),p<n&&(n=p),d>o&&(o=d),p>o&&(o=p),h<r&&(r=h),f<r&&(r=f),h>l&&(l=h),f>l&&(l=f),m.isCollapsed&&(u+=m.totalNodes-1)}return{minX:n,maxX:o,minY:r,maxY:l}},getCentrePoint:function(e){return{x:e.ctx.canvas.width/2/e.pixelRatio,y:e.ctx.canvas.height/2/e.pixelRatio}},getDrawingArea:function(e){var t=e.state.size.width,a=e.state.size.height,n=e.state.padding;return{width:t,height:a,left:n,top:n,right:t-n,bottom:a-n}},getInitialState:function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?E(Object(a),!0).forEach((function(t){v(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):E(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},l,{},t)},getLabel:function(e,t){var a=e.state.styles;return t.id in a&&a[t.id].label||t.label||t.id},getLeafIds:function(e,t){for(var a=e.getVirtualTree(),n=e.getNodeById(t||a.rootNode),r=[],s=n.preIndex;s<n.preIndex+n.totalNodes;s++)a.preorderTraversal[s].isLeaf&&r.push(a.preorderTraversal[s].id);return r},getLeafLabels:function(e,t){for(var a=e.getVirtualTree(),n=e.getNodeById(t||a.rootNode),r=[],s=n.preIndex;s<n.preIndex+n.totalNodes;s++){var o=a.preorderTraversal[s];o.isLeaf&&r.push(e.getLabel(o))}return r},getNewick:function(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e.layout(),r=t?e.getNodeById(t):n.rootNode,s=a.excludeCollapsed,o=void 0===s||s,l=[],i=r.postIndex-r.totalNodes+1;i<r.postIndex;i++){var c=n.postorderTraversal[i];if(c.isLeaf)l.push("".concat(e.getLabel(c),":").concat(c.branchLength));else{var u=l.splice(l.length-c.children.length,c.children.length);o&&c.isCollapsed?l.push("[".concat(c.totalLeaves," hidden ").concat(1===c.totalLeaves?"leaf":"leaves","]:").concat(c.branchLength)):l.push("(".concat(u.join(","),"):").concat(c.branchLength))}}return"(".concat(l.join(","),");")},getNodeAtPoint:function(e,t,a){for(var n=e._.actualNodeSize/2+g(e,3),r=e.layout(),s=r.rootNode,o=s.preIndex;o<s.preIndex+s.totalNodes;o++){var l=r.preorderTraversal[o];if(!l.isHidden&&t>l.x-n&&t<l.x+n&&a>l.y-n&&a<l.y+n)return l}var i=d[e.state.type];return i.getNodeAtPoint?i.getNodeAtPoint(e,t,a,n):null},getNodeById:function(e,t){var a=e.getVirtualTree();if("string"==typeof t){var n=a.nodeById[t];return n||e.error("Cannot find node of ID=",t),n}var r=a.nodeById[t.id];return r&&r===t||e.error("Node not found",t),r},getNodeLabels:function(e,t){var a=[],n=!0,r=!1,s=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var i=o.value,c=e.getNodeById(i);c&&c.isLeaf&&a.push(e.getLabel(c))}}catch(e){r=!0,s=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}return a},getVirtualTree:function(e){var t=e.state,a=void 0===t?{}:t,n=e.cache("virtual");if(n.get("source")!==a.source){var r=performance.now(),s=x(a.source),o=s.nodeById,l=s.rootNode,i=s.leafNodes,c=s.postorderTraversal,u=s.preorderTraversal;e.nodes={nodeById:o,rootNode:l,leafNodes:i,postorderTraversal:c,preorderTraversal:u,source:a.source,originalSource:a.source.original||a.source};var m=performance.now();e.log("parsing virtual tree took ",m-r," milliseconds."),e._.cache={},n=e.cache("virtual")}if((n.get("rootId")||null)!==e.state.rootId){var d=e.nodes.nodeById[e.state.rootId]||e.nodes.preorderTraversal[0],p=[];d.distanceFromRoot=0;for(var h=d.preIndex+1;h<d.preIndex+d.totalNodes;h++){var f=e.nodes.preorderTraversal[h];f.distanceFromRoot=f.parent.distanceFromRoot+f.branchLength,f.isLeaf&&p.push(f)}e.nodes.leafNodes=p,e.nodes.rootNode=d}return n.set("source",a.source),n.set("rootId",e.state.rootId),e.nodes},highlightNode:function(e,t){var a="string"==typeof t?e.getNodeById(t):t,n=a&&!a.isHidden?a.id:null;e._.highlightedId!==n&&(e._.highlightedId=n,e.render())},init:function(e,t){e.state=e.getInitialState(t),e.pixelRatio=k(e.ctx)},layout:function(e){var t=e.state,a=e.getVirtualTree(),n=e.cache("layout");if(isNaN(a.maxLabelWidth)||n.get("styles")!==t.styles){var r="",s=!0,o=!1,l=void 0;try{for(var i,c=a.leafNodes[Symbol.iterator]();!(s=(i=c.next()).done);s=!0){var u=i.value,m=e.getLabel(u);m.length>r.length&&(r=m)}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}a.maxLabelWidth=e.measureTextWidth(r)}if(n.get("rotatedIds")!==t.rotatedIds){var p=new Set(t.rotatedIds);if(n.get("rotatedIds")){var h=!0,f=!1,g=void 0;try{for(var b,y=n.get("rotatedIds")[Symbol.iterator]();!(h=(b=y.next()).done);h=!0){var E=b.value,v=a.nodeById[E];p.has(v.id)||(T(0,a,v),v.isInverted=!1)}}catch(e){f=!0,g=e}finally{try{h||null==y.return||y.return()}finally{if(f)throw g}}}var C=!0,w=!1,S=void 0;try{for(var N,O=t.rotatedIds[Symbol.iterator]();!(C=(N=O.next()).done);C=!0){var x=N.value,k=a.nodeById[x];k.isInverted||(T(0,a,k),k.isInverted=!0)}}catch(e){w=!0,S=e}finally{try{C||null==O.return||O.return()}finally{if(w)throw S}}}if(n.get("collapsedIds")!==t.collapsedIds){for(var _=new Set(t.collapsedIds),I=0;I<a.postorderTraversal.length;I++){var L=a.preorderTraversal[I];L.isCollapsed=_.has(L.id),L.parent&&(L.parent.isCollapsed||L.parent.isHidden)?L.isHidden=!0:L.isHidden=!1}for(var j=0;j<a.postorderTraversal.length;j++){var A=a.postorderTraversal[j];if(A.isLeaf)A.visibleLeaves=1;else if(A.isCollapsed)A.visibleLeaves=1;else{A.visibleLeaves=0;var P=!0,R=!1,M=void 0;try{for(var D,F=A.children[Symbol.iterator]();!(P=(D=F.next()).done);P=!0){var z=D.value;A.visibleLeaves+=z.visibleLeaves}}catch(e){R=!0,M=e}finally{try{P||null==F.return||F.return()}finally{if(R)throw M}}}}}if(n.get("branchScale")!==t.branchScale||n.get("collapsedIds")!==t.collapsedIds||n.get("rootId")!==t.rootId||n.get("rotatedIds")!==t.rotatedIds||n.get("stepScale")!==t.stepScale||n.get("type")!==t.type){var G=performance.now();d[t.type].layoutNodes(e,a);var U=performance.now();e.log("layout nodes took ",U-G," milliseconds.")}return n.set("branchScale",t.branchScale),n.set("collapsedIds",t.collapsedIds),n.set("rootId",t.rootId),n.set("rotatedIds",t.rotatedIds),n.set("stepScale",t.stepScale),n.set("type",t.type),n.set("styles",t.styles),a},measureTextWidth:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.state.fontWeight,n=e.ctx.font;e.ctx.font="".concat(a," ").concat(e.state.fontSize,"px ").concat(e.state.fontFamily);var r=e.ctx.measureText(t);return e.ctx.font=n,Math.ceil(r.width+e.state.fontSize)},mergeState:function(e,t){e.state=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(Object(a),!0).forEach((function(t){j(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e.state,{},t)},postRender:function(e,t){for(var a=e.state,n=t.rootNode.preIndex;n<t.rootNode.preIndex+t.rootNode.totalNodes;n++){var r=t.preorderTraversal[n];-1===a.selectedIds.indexOf(r.id)&&r.id!==e._.highlightedId||e.drawHighlight(r),r.isCollapsed&&(n+=r.totalNodes-1)}e.ctx.restore(),e.ctx.canvas.title="",e.ctx.canvas.style&&(e.ctx.canvas.style.cursor=e._.highlightedId?"pointer":"")},preRender:function(e,t){e.ctx.save(),e.ctx.clearRect(0,0,e.ctx.canvas.width,e.ctx.canvas.height),e._.actualMaxLabelWidth=g(e,t.maxLabelWidth),e._.actualFontSize=g(e,e.state.fontSize),e._.actualNodeSize=g(e,e.state.nodeSize),e._.actualHaloRadius=g(e,Math.max(.75*e.state.nodeSize,e.state.haloRadius)),e._.actualHaloWidth=g(e,e.state.haloWidth),e._.renderShapes=e.state.showNodes,e._.renderLabels=e.state.showLabels||e.state.stepScale*e.state.scale>=e.state.labelThreshold,e.ctx.textBaseline="middle",e.ctx.font="".concat(e._.actualFontSize,"px ").concat(e.state.fontFamily),e.ctx.lineWidth=g(e,e.state.lineWidth),e.ctx.strokeWidth=e.ctx.lineWidth,e.ctx.translate(e.state.offsetX*e.pixelRatio,e.state.offsetY*e.pixelRatio),e.ctx.scale(e.state.scale*e.pixelRatio,e.state.scale*e.pixelRatio)},render:function(e){e.resizeCanvas();var t=e.layout(),a=performance.now();if(e.preRender(t),e.state.styleNodeLines){var n=!0,r=!1,s=void 0;try{for(var o,l=t.postorderTraversal[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var i=o.value;if(i.isLeaf){var c=e.state.styles?e.state.styles[i.id]:void 0;i.strokeStyle=(c?c.strokeStyle:void 0)||e.state.strokeStyle}else{i.strokeStyle=i.children[0].strokeStyle;var u=!0,m=!1,p=void 0;try{for(var h,f=i.children[Symbol.iterator]();!(u=(h=f.next()).done);u=!0)if(h.value.strokeStyle!==i.strokeStyle){i.strokeStyle=e.state.strokeStyle;break}}catch(e){m=!0,p=e}finally{try{u||null==f.return||f.return()}finally{if(m)throw p}}}}}catch(e){r=!0,s=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}}for(var g=t.rootNode.preIndex,b=t.rootNode.preIndex+t.rootNode.totalNodes,y=g;y<b;y++){var E=t.preorderTraversal[y];E!==t.rootNode&&(E.id===e._.highlightedId?e.ctx.strokeStyle=e.state.highlightedStyle:e.state.styleNodeLines?e.ctx.strokeStyle=E.strokeStyle:e.ctx.strokeStyle=e.state.strokeStyle,d[e.state.type].drawLine(e,t,E),E.isCollapsed&&(y+=E.totalNodes-1))}for(var v=g;v<b;v++){var C=t.preorderTraversal[v];e.drawNode(t,C),C.isCollapsed&&(v+=C.totalNodes-1)}e.postRender(t);var w=performance.now();e.log("render took ",w-a," milliseconds.")},rerootNode:function(e,t){var a=e.getNodeById(t),n=e.layout();if(a.parent){var r={branchLength:0,children:[]};!function e(t,a,n,r){var s={branchLength:r.branchLength,children:[],parent:n};n.children.push(s);var o=!0,l=!1,i=void 0;try{for(var c,u=r.parent.children[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var m=c.value;m!==r&&s.children.push(m)}}catch(e){l=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(l)throw i}}r.parent.parent&&r.parent!==a.rootNode&&e(t,a,s,r.parent)}(e,n,r,a),r.children.push(a);var s={type:"newick",original:e.state.source,data:A(r)};e.setSource(s)}},reset:function(e,t){e.setState(M(e))},resetCollapsedNodes:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.refit,n=void 0!==a&&a;return e.setState(e.chain(D,n?y:null))},resize:function(e,t,a){e.setState(F(e,t,a))},resizeCanvas:function(e){var t=e.state.size,a=t.width,n=t.height;e.ctx.canvas.style&&(e.ctx.canvas.style.width="".concat(a,"px"),e.ctx.canvas.style.height="".concat(n,"px"),e.ctx.canvas.width=a*e.pixelRatio,e.ctx.canvas.height=n*e.pixelRatio)},rotateNode:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=a.refit,r=void 0!==n&&n,s=e.getNodeById(t);s&&e.setState(z(e,s.id,r))},selectLeafNodes:function(e,t,a){t&&Array.isArray(t)&&e.setState(function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(a){var n=new Set(e.state.selectedIds),r=!0,s=!1,l=void 0;try{for(var i,c=t[Symbol.iterator]();!(r=(i=c.next()).done);r=!0){var u=i.value;n.add(u)}}catch(e){s=!0,l=e}finally{try{r||null==c.return||c.return()}finally{if(s)throw l}}return{selectedIds:Array.from(n)}}return{selectedIds:t.length?t:o}}(e,t,a))},selectNode:function(e,t,a){var n=t?e.getNodeById(t):null;if(n&&n.isLeaf)e.setState(function(e,t,a){return{selectedIds:m(e.state.selectedIds,t,a)}}(e,n.id,a));else if(n){var r=n&&!n.isHidden?e.getLeafIds(n):o;e.setState(function(e,t,a){if(a){var n=new Set(e.state.selectedIds),r=!0,s=!1,o=void 0;try{for(var l,i=t[Symbol.iterator]();!(r=(l=i.next()).done);r=!0){var c=l.value;n.add(c)}}catch(e){s=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(s)throw o}}return{selectedIds:Array.from(n)}}return{selectedIds:t}}(e,r,a))}else e.setState({selectedIds:o})},setBranchScale:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getCentrePoint(),n=d[e.state.type].branchScalingAxis;n&&t>0&&e.setState(U(e,t,a))},setFontSize:function(e,t){"number"==typeof t?e.setState({fontSize:t}):e.error("Invalid font size value, expected number, got ",B(t))},setNodeSize:function(e,t){"number"==typeof t?e.setState({nodeSize:t}):e.error("Invalid node size value, expected number, got ",$(t))},setRoot:function(e,t){var a=null;null!==t&&(a=e.getNodeById(t)),e.setState(function(e,t){return e.chain((function(){return{rootId:t}}),M)}(e,a?a.id:null))},setScale:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getCentrePoint();if(!(t<=0)){if(a){var n=t/e.state.scale,r=e.state.offsetX;e.state.offsetX=r+(a.x-((a.x-r)*n+r));var s=e.state.offsetY;e.state.offsetY=s+(a.y-((a.y-s)*n+s))}e.state.scale=t,e.render()}},setSource:function(e,t){e.setState(function(e,t){return e.chain((function(){return{source:t}}),H,D,V,M)}(e,t))},setState:function(e,t){t&&(e.mergeState(t),e.render())},setStepScale:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.getCentrePoint(),n=d[e.state.type].stepScalingAxis;n&&t>0&&e.setState(K(e,t,a))},setStyles:function(e,t){"object"===q(t)?e.setState({styles:t}):e.error("Invalid node styles, expected object, got ",q(t))},setTreeType:function(e,t){e.setState(function(e,t){return e.chain((function(){return{type:t}}),M)}(e,t))},toggleAlignLeafLabels:function(e){e.setState({alignLabels:!e.state.alignLabels})},toggleLeafLabels:function(e){e.setState({renderLeafLabels:!e.state.renderLeafLabels})},transform:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.getCentrePoint();0===t&&0===a&&0===n||e.setState(W(e,t,a,n,r))},trigger:function(e,t,a){var n=e["on".concat(t)];"function"==typeof n&&n.apply(e,a)}},Z=function(e){e.error=console.error,e.log=function(){};for(var t=0,a=Object.keys(Y);t<a.length;t++){var n=a[t];e[n]=Y[n].bind(null,e)}};function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{x:(t-e.state.offsetX)/e.state.scale,y:(a-e.state.offsetY)/e.state.scale}}function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function J(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ee=function(e,t,a,n){var r=e.startPoint,s=e.centrePoint,o=e.endPoint,l=n-2*t,i=(a-2*t)/(o.x-r.x),c=l/(o.y-r.y),u=Math.min(i,c);return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){J(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({offsetX:a/2-s.x*u,offsetY:n/2-s.y*u,scale:u},p(u))};function te(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ae(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ne=function(e,t,a){var n=e.state.size;if(n.width===t&&n.height===a)return{};var r=function(e){var t=e.getDrawingArea(),a=t.width,n=t.height,r=e.getBounds(),s=r.minX,o=r.maxX,l=r.minY,i=r.maxY,c=X(e,e.state.padding,e.state.padding),u=X(e,a-e.state.padding,n-e.state.padding),m=X(e,a/2,n/2);return{startPoint:{x:Math.max(c.x,s),y:Math.max(c.y,l)},endPoint:{x:Math.min(u.x,o),y:Math.min(u.y,i)},centrePoint:m}}(e);return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?te(Object(a),!0).forEach((function(t){ae(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):te(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},F(e,t,a),{},ee(r,e.state.padding,t,a))},re=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n={canvas:e,ctx:e.getContext("2d"),state:{},_:{cache:{}}};if(Z(n),a.length&&c(n,a),n.init(t),t.source){var r=n.ctx.canvas,s=r.width,o=r.height;n.setState(n.chain((function(){return n.state.size?ne(n,s,o):F(n,s,o)}),(function(){return{source:t.source}}),(function(){return n.state.rootId?{rootId:n.state.rootId}:H()}),(function(){return n.state.collapsedIds?{collapsedIds:n.state.collapsedIds}:D()}),(function(){return n.state.rotatedIds?{rotatedIds:n.state.rotatedIds}:V()}),(function(){return n.state.stepScale?{stepScale:n.state.stepScale}:R()}),(function(){return n.state.branchScale?{branchScale:n.state.branchScale}:P(n)}),(function(){var e=h(n),t=e.offsetX,a=e.offsetY,r=e.scale,s=e.minScale,o=e.maxScale;return{offsetX:n.state.offsetX||t,offsetY:n.state.offsetY||a,scale:n.state.scale||r,minScale:n.state.minScale||s,maxScale:n.state.maxScale||o}})))}return n},se={appendToArray:m,getPixelRatio:k,mapPoint:X,mapScalar:g,restoreViewport:ee,unmapPoint:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return{x:t*e.state.scale+e.state.offsetX,y:a*e.state.scale+e.state.offsetY}},unmapScalar:function(e,t){return t*e.state.scale}};a.d(t,"constants",(function(){return n})),a.d(t,"defaults",(function(){return l})),a.d(t,"createTree",(function(){return re})),a.d(t,"methods",(function(){return Y})),a.d(t,"types",(function(){return d})),a.d(t,"utils",(function(){return se})),t.default={constants:n,defaults:l,createTree:re,methods:Y,types:d,utils:se}}])},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l}));var n=a(2);const r=e=>e.upload,s=e=>r(e).usage,o=(e,t)=>r(e).settings[t],l=Object(n.createSelector)(e=>r(e).previous.uploads,e=>e&&!!e.length&&e.some(e=>e.total!==e.complete))},,function(e,t,a){"use strict";var n=a(14),r=a(6);function s(e){return Object(r.a)("GET",`/api/genome/${e}`)}a.d(t,"b",(function(){return o})),a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return c}));const o=Object(n.b)("SHOW_GENOME_REPORT");function l(e,t){return{type:o,payload:{name:t,genomeId:e,promise:s(e)}}}const i="CLOSE_GENOME_REPORT";function c(){return{type:i}}},function(e,t,a){"use strict";function n(e){if("#"===e[0])return function(e){const t=parseInt(e.slice(1),16);return{r:t>>16,g:t>>8&255,b:255&t}}(e);if(e.startsWith("rgba"))return function(e){const[t,a,n,r]=e.slice(5).slice(0,-1).split(",");return{r:parseInt(t,10),g:parseInt(a,10),b:parseInt(n,10),a:parseInt(r,10)}}(e);throw new Error("Colour format not supported")}function r(e,t){let a=e;return a+=t,a>255?a=255:a<0&&(a=0),a}function s(e,t){const a=Math.round(2.55*t),s=n(e);let{r:o,g:l,b:i}=s;o=r(o,a),l=r(l,a),i=r(i,a);const{a:c}=s;return void 0!==c?`rgba(${o}, ${l}, ${i}, ${c})`:`#${(i|l<<8|o<<16).toString(16)}`}function o(e,t){const{r:a,g:r,b:s}=n(e);return`rgba(${a}, ${r}, ${s}, ${t})`}a.d(t,"a",(function(){return i}));const l={primaryColour:"",primaryColourTint:"",primaryColourShade:"",primaryColourAlpha:"",primaryColourAlphaLight:"",primaryColourAlphaMedium:"",primaryColourAlphaDark:""};t.b=l;function i(e){for(const[t,a]of Object.entries(e))l[t]=a,"primaryColour"===t&&(l.primaryColourTint=s(a,10),l.primaryColourShade=s(a,-10),l.primaryColourAlpha=o(a,.14),l.primaryColourAlphaLight=o(a,.14),l.primaryColourAlphaMedium=o(a,.54),l.primaryColourAlphaDark=o(a,.87)),"primaryColourAlpha"===t&&(l.primaryColourAlphaLight=a),"primaryColourAlphaLight"===t&&(l.primaryColourAlpha=a);const t=document.querySelector("#libmr-theme")||document.createElement("style");t.id="libmr-theme",t.type="text/css",t.innerHTML=`\n  :root {\n    --libmr-primary-colour: ${l.primaryColour};\n    --libmr-primary-colour-tint: ${l.primaryColourTint};\n    --libmr-primary-colour-shade: ${l.primaryColourShade};\n    --libmr-primary-colour-alpha: ${l.primaryColourAlphaLight};\n    --libmr-primary-colour-alpha-light: ${l.primaryColourAlphaLight};\n    --libmr-primary-colour-alpha-medium: ${l.primaryColourAlphaMedium};\n    --libmr-primary-colour-alpha-dark: ${l.primaryColourAlphaDark};\n  }\n`,document.head.appendChild(t)}},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(20),r=a(16);const s=new Set([n.b,n.a]),o={[n.b]:"Population",[n.a]:"Collection"};r.c.COLOUR,r.b.COLOURS.PURPLE,r.b.COLOURS.PURPLE},function(e,t,a){"use strict";var n={};a.r(n),a.d(n,"name",(function(){return _t})),a.d(n,"buildColumns",(function(){return It}));var r={};a.r(r),a.d(r,"name",(function(){return Lt})),a.d(r,"buildColumns",(function(){return jt}));var s={};a.r(s),a.d(s,"name",(function(){return Pt})),a.d(s,"buildColumns",(function(){return Rt}));var o=a(36),l=a(510),i=a(297),c=a(167),u=a(240);var m=Object(o.c)({activity:function(e=null,{type:t,payload:a}){switch(t){case u.a.ATTEMPT:return c.a.LOADING;case u.a.FAILURE:return c.a.ERROR;case u.a.SUCCESS:return a.result.map(e=>({...e,formattedDate:new Date(e.date).toLocaleString()}));default:return e}}}),d=a(189);const p={token:null,pending:!1};const h={id:a(212).a[1]};var f=a(41),g=a(105),b=a(31),y=a(235),E=a(101);const v={allSchemeSts:[],edgeMatrix:null,index:{lambda:null,pi:null},indexOfSelectedInAll:null,nodeCoordinates:null,nodes:null,progress:null,scheme:null,selectedGenomeId:null,skipMessage:null,status:"INITIAL_STATUS",taskId:null,threshold:null,triedBuilding:!1,version:null};function C(e,t,a){for(let n=1;n<=E.c;n++){const r=Object(y.a)(n,e,t),s=r[a];if(r.filter(e=>e===s).length>E.b)return n-1}return E.c}var w=a(100);const S={isOpen:!0};var N=a(73),O=a(152);function x(e){return e.reduce((e,t)=>(e[t.id]={...t,createdAt:new Date(t.createdAt)},e),{})}const k={total:0,organismId:{},type:{},createdAt:{},publicationYear:{}};var _=Object(o.c)({entities:function(e={},{type:t,payload:a}){switch(t){case N.b.SUCCESS:{const{collections:e}=a.result;return x(e)}case N.a.SUCCESS:return x(a.result);case N.b.FAILURE:case N.a.FAILURE:return{};default:return e}},filter:function(e=S,{type:t}){switch(t){case w.a:return{...e,isOpen:!e.isOpen};default:return e}},status:function(e=O.a.LOADING,{type:t}){switch(t){case N.a.ATTEMPT:case N.b.ATTEMPT:return O.a.LOADING;case N.a.SUCCESS:case N.b.SUCCESS:return O.a.SUCCESS;case N.a.FAILURE:case N.b.FAILURE:return O.a.ERROR;default:return e}},summary:function(e=k,{type:t,payload:a}){switch(t){case N.b.ATTEMPT:return{...e,loading:!0};case N.b.SUCCESS:return{...e,loading:!1,...a.result.summary};default:return e}}}),I=a(14);a(63),a(6);const T=Object(I.b)("REQUEST_DOWNLOAD");var L=a(187);function j(e,t,a){const{format:n,stateKey:r}=t,s=e[n]||{};return{...e,[n]:{...s,[r]:a}}}var A=a(140);function P(e={},t){const{query:a}=t;return 1===Object.keys(a).length&&a.prefilter?{...a}:{...e,...Object.keys(a).reduce((t,n)=>{const r=a[n];return t[n]=r===e[n]?void 0:r,t},{})}}var R=a(18);const M={total:0,visible:0,loading:!1};var D=a(68),F=a(85);const z={isOpen:!0,listFilters:{}};var G=a(26),U=a(139),B=a(16);const $={dropdown:null,genomes:{},download:{status:null,summary:null},lastSelectedIndex:null},H=(e,{id:t,name:a,organismId:n,binned:r})=>(e[t]={id:t,name:a,organismId:n,binned:r},e),V=(e,{id:t})=>(delete e[t],e);var K=a(321);const q={entities:[],metric:"length",filter:null};const W={title:"",description:"",pmid:""};var Y=a(172),Z=a(79);const X={markers:[],filter:null,popup:{open:!1,genomes:[]}};var Q=a(40);const J={name:null,genome:null,status:null};var ee=a(170),te=a(171);var ae=Object(o.c)({filter:function(e=z,{type:t,payload:a}){switch(t){case D.a:return{...e,isOpen:!e.isOpen};case D.b:return{...e,listFilters:{...e.listFilters,[a.filterKey]:a.text}};case A.UPDATE_FILTER:case A.SET_FILTER:return a.stateKey===F.b?{...e,listFilters:{}}:e;default:return e}},entities:function(e={},{type:t,payload:a}){switch(t){case R.a.SUCCESS:{const{prefilter:t}=a.filter;return a.result.reduce((e,a)=>("bin"===t&&(a.binned=!0),e[a.id]=a,e),{...e})}case R.d.SUCCESS:{const{prefilter:e}=a.filter;return a.result.genomes.reduce((t,a)=>("bin"===e&&(a.binned=!0),t[a.id]=a,t),{})}case"SEND_METADATA_UPDATE::SUCCESS":{const{data:t}=a,{computedData:n}=a.result,r={};for(const{id:a,name:s}of t)a in e&&(r[a]={...e[a],name:s,country:n[a].country,date:n[a].date});return Object.keys(r).length?{...e,...r}:e}default:return e}},indices:function(e={},{type:t,payload:a}){switch(t){case R.d.SUCCESS:return a.result.genomes.reduce((e,t,a)=>(e[a]=t.id,e),{});case R.a.ATTEMPT:{const{skip:t=0,limit:n=0}=a.options,r={...e};for(let a=t;a<t+n;a++)r[a]=e[a]||!0;return r}case R.a.FAILURE:{const{skip:t=0,limit:n=0}=a.options,r={...e};for(let e=t;e<t+n;e++)r[e]=void 0;return r}case R.a.SUCCESS:{const{skip:t=0}=a.options;return a.result.reduce((e,a,n)=>(e[n+t]=a.id,e),{...e})}default:return e}},collectionMetadata:function(e=W,{type:t,payload:a}){switch(t){case U.a:return{...e,...a};default:return e}},stats:function(e=q,{type:t,payload:a}){switch(t){case R.c.SUCCESS:return{...e,entities:a.result,filter:a.filter};case K.a:return{...e,metric:a.metric};default:return e}},status:function(e=null,{type:t}){switch(t){case R.d.ATTEMPT:case R.b.ATTEMPT:case R.c.ATTEMPT:return te.a.LOADING;case R.d.FAILURE:case R.b.FAILURE:case R.c.FAILURE:return te.a.ERROR;case R.d.SUCCESS:case R.b.SUCCESS:case R.c.SUCCESS:return te.a.OK;default:return e}},selection:function(e=$,{type:t,payload:a}){switch(t){case G.a:return{...e,genomes:a.genomes.reduce(H,{...e.genomes}),lastSelectedIndex:"number"==typeof a.index?a.index:e.lastSelectedIndex};case G.c:return{...e,genomes:a.genomes.reduce(V,{...e.genomes})};case G.f:return{...e,genomes:a.genomes.reduce(H,{})};case G.d:return{...e,dropdown:a===e.dropdown?null:a};case R.a.SUCCESS:case R.a.ERROR:case U.b.SUCCESS:return{...e,dropdown:null};case G.b:return $;case G.e.ATTEMPT:return{...e,download:{...e.download,status:B.e.LOADING}};case G.e.FAILURE:return{...e,download:{...e.download,status:B.e.ERROR}};case G.e.SUCCESS:return{...e,download:{...e.download,status:B.e.SUCCESS,summary:a.result}};case R.d.ATTEMPT:return{...e,lastSelectedIndex:null};case"SEND_METADATA_UPDATE::SUCCESS":{const{data:t}=a,n={};for(const{id:a,name:r}of t)a in e.genomes&&e.genomes[a].name!==r&&(n[a]={...e.genomes[a],name:r});return Object.keys(n).length?{...e,genomes:{...e.genomes,...n}}:e}default:return e}},summary:function(e=M,{type:t,payload:a}){switch(t){case R.d.ATTEMPT:return{...e,loading:!0};case R.d.SUCCESS:return{loading:!1,...a.result.summary};default:return e}},waiting:function(e=!1,{type:t}){switch(t){case ee.a.ATTEMPT:return!0;case ee.a.SUCCESS:case ee.a.FAILURE:return!1;default:return e}},map:function(e=X,{type:t,payload:a}){switch(t){case R.b.ATTEMPT:case Y.a:return{...e,popup:X.popup};case R.b.SUCCESS:return{...e,markers:a.result,filter:a.filter};case Y.b.ATTEMPT:return{...e,popup:{open:!0,genomes:[]}};case Y.b.SUCCESS:return{...e,popup:{...e.popup,genomes:a.result}};case Z.MAP_LASSO_CHANGE:return a.path?e:{...e,popup:X.popup};default:return e}},report:function(e=J,{type:t,payload:a}){switch(t){case g.b.ATTEMPT:return{...J,name:a.name,status:"LOADING"};case g.b.SUCCESS:{const t=a.result;return{...e,genome:t,status:"READY"}}case g.b.FAILURE:return{genome:null,status:"ERROR"};case g.a:case R.a.ATTEMPT:case Q.a:return{...J};default:return e}}}),ne=a(181);const re={asideVisible:!0,userDrawerVisible:!1};function se({pathname:e}){return"/"===e?"home":e.split("/")[1]}var oe=a(64),le=a(132),ie=a(234);const ce={status:ie.a.LOADING,collections:[]};var ue=a(185);const me={supportedOrganisms:[],allSpecies:[]};const de={visible:!1,message:null,action:null};var pe=a(120);const he={all:"allGenomes",user:"userGenomes",bin:"binnedGenomes"};var fe=a(236),ge=a(161),be=a(9),ye=a(10);const Ee={id:null,genomeIds:new Set};var ve=a(83);function Ce(e,t){return e.reduce((e,a)=>(e[a.uuid]={...a,[`__${t}`]:!0},e),{})}var we=a(302);var Se=Object(o.c)({menuOpen:function(e=!1,{type:t,payload:a}){switch(t){case"SET_MENU_ACTIVE":return void 0!==a.active?a.active:e;default:return e}}}),Ne=a(52);const Oe=new Set,xe={[Ne.a.VISIBILITY]:{ids:Oe,active:!1},[Ne.a.TREE]:{ids:Oe,active:!1},[Ne.a.MAP]:{ids:Oe,active:!1}};var ke=a(69);const _e=new Set,Ie={ids:_e};var Te=a(111);const Le={entries:[],current:null};var je=function(e=Le,t={}){switch(t.type){case Te.b:return{...e,entries:[t.payload.image,...e.entries],current:0};case Te.c:return{...e,current:t.payload.index};case Te.a:return{...e,current:e.entries.length-1};default:return e}},Ae=a(144),Pe=a(91),Re=a(263);const Me={status:Pe.a.UNSAVED};var De=a(34),Fe=a(110),ze=a(133);const Ge={advanced:!1,exact:!1,category:null,cursor:0,currentIntersection:0,intersections:[],recent:new Set,sort:ze.b.FREQ_DESC,text:""};function Ue(e,t){const a=new Set;for(const n of[...t,...e.recent])if(a.add(n),3===a.size)break;return a}function Be(e,t){if(!t||e.advanced)return e;const a=t.value.label;return a.length?{...e,text:a,intersections:[[t]]}:{...e,text:Ge.text,intersections:Ge.intersections}}var $e=a(304);const He={isExpanded:!1};var Ve=a(44),Ke=a(27),qe=a(39);function We(e,t){return(e,a)=>{const n=a(),r=Object(Ke.j)(n),{activeColumn:s}=Object(Ke.h)(n)[r];e(Object(Ve.f)(r,s===t?qe.e:t))}}const Ye={name:be.c.metadata,activeColumn:qe.e,onHeaderClick:We};var Ze=a(88),Xe=a(74);const Qe={name:be.c.typing,activeColumn:qe.e,columns:[],onHeaderClick:We},Je={group:!0,system:!0,fixed:!0,columnKey:"leadingSystemGroup",getHeaderContent(){},columns:[qe.d,qe.c,qe.e]},et={group:!0,system:!0,columnKey:"trailingSystemGroup",getHeaderContent(){},columns:[qe.f]},tt={columnKey:"reference",group:!0,columns:["__reference"],getHeaderContent:()=>{}},at={group:!0,columnKey:"mlst",columns:["__mlst","__mlst_profile"],get label(){return`MLST - ${Xe.f.mlst}`}},nt={group:!0,columnKey:"mlst2",columns:["__mlst2","__mlst2_profile"],get label(){return`MLST - ${Xe.f.mlst2}`}},rt={group:!0,columnKey:"ng-Mast",columns:["__ng-mast","__por","__tbpb"]},st={group:!0,columnKey:"ng-star",columns:["__ngstar","__ngstar_profile"]},ot={group:!0,columnKey:"genotyphi",columns:["__genotyphi_type","__genotyphi_snps_called"]},lt={group:!0,columnKey:"inctyper",columns:["__inc_types"]},it={group:!0,columnKey:"kleborate",columns:["__K_locus","__O_locus","__Virulence_Score","__Aerobactin","__Colibactin","__Salmochelin","__Yersiniabactin","__rmpA","__rmpA2"]};function ct({columns:e,...t}){return{...t,noAction:!0,headerClasses:"wgsa-table-header--unstyled",columns:e.map(e=>Ze.a[e])}}function ut({isClusterView:e},t,a){return[e||t.noPopulation?null:tt,t.noMLST?null:at,a?nt:null,t.ngMast?st:null,t.ngMast?rt:null,t.genotyphi?ot:null,t.inctyper?lt:null,t.kleborate?it:null].filter(e=>e).map(ct)}const mt=[Ze.a.__core_matches,Ze.a["__%_core_families"],Ze.a["__%_non-core"]],dt={name:be.c.stats,activeColumn:qe.e,columns:[],onHeaderClick:We};var pt=a(0),ht=a.n(pt),ft=a(179),gt=a(55),bt=a(160);const yt={group:!0,system:!0,fixed:!0,columnKey:"system",getHeaderContent(){},columns:[qe.d,qe.c,{...qe.e,flexGrow:0,headerClasses:"wgsa-table-header--unstyled",onHeaderClick:()=>{}}]},Et={group:!0,system:!0,columnKey:"spacer",getHeaderContent(){},columns:[{...qe.f,cellClasses:"wgsa-table-cell--resistance"}]};function vt(e,t){return-1===e.indexOf(t)}function Ct(e,t,a){const{key:n,displayName:r,label:s,effect:o}=e;return{addState({genomes:e}){return e.length?(this.hidden=e.every(({analysis:e})=>!e.paarsnp||vt(e.paarsnp[t],n)),this.width=this.getWidth()+16,this):this},columnKey:n,displayName:r,label:s,cellClasses:"wgsa-table-cell--resistance",flexGrow:0,getWidth:()=>Object(bt.b)(s),getCellContents:(e,a)=>gt.f(a,t,n)?ht.a.createElement("i",{className:"material-icons wgsa-resistance-icon",style:{color:gt.e(o)}},"lens"):null,headerClasses:"wgsa-table-header--expanded",hidden:a.every(e=>vt(e[t],n)),valueGetter:a=>gt.b(e,t,a),onHeaderClick:ft.onHeaderClick}}const wt={activeColumns:new Set,columns:[]};function St({name:e,buildColumns:t}){return function(a=wt,{type:n,payload:r}){switch(n){case b.a.SUCCESS:{const{genomes:e,organism:n,status:s,isClusterView:o}=r.result;if(s!==be.a.READY||o)return a;const l=function(e){return e.reduce((e,{analysis:t})=>t.paarsnp?(e.push(t.paarsnp),e):e,[])}(e),i=t(n.resistance,l);return{...a,columns:i.length&&i[0].group?[yt,...i,Et]:[...yt.columns,...i,...Et.columns]}}case Ve.b:return{...a,activeColumns:r.table===e?r.columns:a.activeColumns};default:return a}}}function Nt({key:e,displayName:t}){if(t)return t;const{customLabels:a={}}=ye.b.current.amrOptions||{};return a[e]||e}const{onHeaderClick:Ot}=a(179),xt=navigator&&navigator.platform&&navigator.platform.toUpperCase().indexOf("MAC")>=0?"Cmd":"Ctrl";function kt(e){const t=e.key,a=e.fullName||t;return{columnKey:t,headerClasses:"wgsa-table-header--expanded",headerTitle:`${a?`${a} - `:""}${xt} + click to select multiple`,cellClasses:"wgsa-table-cell--resistance",cellPadding:16,flexGrow:0,label:Nt(e),addState(){return this.width=48,this},getCellContents(e,{analysis:t}){if(!t.paarsnp)return null;const{antibiotics:a}=t.paarsnp;if(gt.g(t.paarsnp,e.columnKey)){const{state:t}=a[e.columnKey];return ht.a.createElement("i",{className:`material-icons wgsa-resistance-icon wgsa-amr--${t.toLowerCase()}`},"lens")}return null},valueGetter:e=>gt.c(t,e),onHeaderClick:Ot}}const _t=be.c.antibiotics;function It({antibiotics:e}){const{hiddenColumns:t=new Set}=ye.b.current.amrOptions||{};return e.filter(({key:e})=>!t.has(e)).map(kt)}const{onHeaderClick:Tt}=a(179),Lt=be.c.snps;function jt({snp:e={},antibiotics:t},a){return t.reduce((t,n)=>{const{key:r,fullName:s}=n;return r in e&&t.push({group:!0,columnKey:`snp_${r}`,label:Nt(n),onHeaderClick:Tt,headerClasses:"wgsa-table-header--expanded",headerTitle:s,columns:Object.keys(e[r]).sort().reduce((t,n)=>t.concat({cellClasses:"wgsa-table-cell--resistance",columnKey:n,fixedWidth:Object(bt.b)(n)+16,flexGrow:0,getCellContents(){},getLabel:()=>`${n}_`,addState({genomes:t}){return t.length?(this.hidden=e[r][n].every(({snpName:e})=>t.every(({analysis:t})=>t.paarsnp&&-1===t.paarsnp.snp.indexOf(`${n}_${e}`))),this):this},headerClasses:"wgsa-table-header--unstyled wgsa-table-header--expanded"},e[r][n].map(({snpName:e,effect:t})=>{const r=`${n}_${e}`;return Ct({key:r,displayName:r,label:e,effect:t},"snp",a)})),[])}),t},[])}const{onHeaderClick:At}=a(179);const Pt=be.c.genes;function Rt({paar:e={},antibiotics:t},a){return function(e){const{paarOverrides:t=[]}=ye.b.current.amrOptions||{};for(const{gene:a,from:n,to:r}of t){if(!(n in e))continue;const t=e[n].find(e=>e.element===a);if(!t)continue;const s=new Set(e[n]);s.delete(t),e[n]=Array.from(s),e[r]=e[r].concat(t)}}(e),t.reduce((t,n)=>{const{key:r,fullName:s}=n;return r in e&&t.push({group:!0,columnKey:`paar_${r}`,label:Nt(n),headerClasses:"wgsa-table-header--expanded",headerTitle:s,onHeaderClick:At,columns:e[r].map(({element:e,effect:t})=>Ct({key:e,label:e,effect:t},"paar",a))}),t},[])}const Mt=be.c.kleborateAMR;function Dt(e,t){return e.analysis.kleborate&&e.analysis.kleborate.amr[t]&&e.analysis.kleborate.amr[t].match&&"-"!==e.analysis.kleborate.amr[t].match}const Ft=gt.e("RESISTANT"),zt=navigator&&navigator.platform&&navigator.platform.toUpperCase().indexOf("MAC")>=0?"Cmd":"Ctrl";function Gt(e){const t=[];for(const a of Object.values(e[0].analysis.kleborate.amr))t.push({columnKey:`kleborate_${a.key}`,addState({genomes:e}){return e.length?(this.width=this.getWidth()+this.cellPadding,this):this},headerClasses:"wgsa-table-header--expanded",headerTitle:`${a.name} - ${zt} + click to select multiple`,cellClasses:"wgsa-table-cell--resistance",cellPadding:16,label:a.name,getWidth:()=>Object(bt.b)(a.name),getCellContents:(e,t)=>Dt(t,a.key)?ht.a.createElement("i",{className:"material-icons wgsa-resistance-icon",style:{color:Ft},title:t.analysis.kleborate.amr[a.key]},"lens"):null,valueGetter:e=>Dt(e,a.key)?Ft:gt.h,onHeaderClick:ft.onHeaderClick});return t}const Ut={activeColumns:new Set,columns:[]};const Bt=St(n),$t=St(r),Ht=St(s),Vt=function(e=Ut,{type:t,payload:a}){switch(t){case b.a.SUCCESS:{const{genomes:t,status:n,isClusterView:r}=a.result;return n!==be.a.READY||r||!ye.b.uiOptions.kleborate?e:{...e,columns:[...yt.columns,...Gt(t),...Et.columns]}}case Ve.b:return{...e,activeColumns:a.table===Mt?a.columns:e.activeColumns};default:return e}};var Kt=Object(o.c)({entities:Object(o.c)({metadata:function(e=Ye,{type:t,payload:a}){switch(t){case Ve.c:return a.table!==be.c.metadata?e:{...e,activeColumn:a.column};default:return e}},typing:function(e=Qe,{type:t,payload:a}){switch(t){case b.a.SUCCESS:{const t=function({noPopulation:e,noMLST:t,ngMast:a,genotyphi:n}){return!(e&&t&&!a&&!n)}(ye.b.uiOptions);if(!t)return{...e,active:t};const n=function({genomes:e}){Object(Xe.e)();const t=new Set(["mlst","mlst2"]);for(const{analysis:a}of e){for(const e of t)e in a&&(Xe.f[e]=a[e].source,t.delete(e));if(a.mlst2)return!0}return!1}(a.result);return{...e,active:t,columns:[Je,...ut(a.result,ye.b.uiOptions,n),et]}}case Ve.c:return a.table!==be.c.typing?e:{...e,activeColumn:a.column};default:return e}},stats:function(e=dt,{type:t,payload:a}){switch(t){case b.a.SUCCESS:return{...e,columns:[qe.d,qe.c,qe.e,...a.result.isClusterView?[]:mt,Ze.a.__genome_length,Ze.a.__n50,Ze.a["__no._contigs"],Ze.a["__non-ATCG"],Ze.a["__%_GC_Content"],qe.f]};case Ve.c:return a.table!==be.c.stats?e:{...e,activeColumn:a.column};default:return e}},antibiotics:Bt,snps:$t,genes:Ht,kleborateAMR:Vt}),visible:function(e=null,{type:t,payload:a}){switch(t){case Ve.d:return a.name;case Ae.a:return be.c.metadata;case Ae.b:return e===be.c.metadata?null:e;default:return e}},activeAMR:function(e=be.c.antibiotics,{type:t,payload:a}){switch(t){case Ve.d:return qe.a.has(a.name)?a.name:e;default:return e}},activeData:function(e=null,{type:t,payload:a}){switch(t){case Ve.d:return qe.b.has(a.name)?a.name:e;default:return e}},multi:function(e=!1,{type:t}){switch(t){case Ve.a:return!e;default:return e}}}),qt=a(116);const Wt={bounds:null,nodeSize:14,speed:"1",unit:"day",viewport:null};var Yt=(e=Wt,t={})=>{switch(t.type){case qt.a:return{...e,bounds:t.payload};case qt.b:return{...e,nodeSize:t.payload};case qt.c:return{...e,speed:t.payload};case qt.d:return{...e,unit:t.payload,bounds:Wt.bounds};case qt.e:return{...e,viewport:t.payload};default:return e}},Zt=a(317);var Xt=Object(o.c)({libmicroreact:function(e,t={}){switch(t.type){case oe.c:return{...e,bounds:null};default:return Yt(e,t)}},visible:function(e=null,t={}){switch(t.type){case Zt.a:return!0;case Ve.d:return!1;default:return e}}});const Qt=function(e,t=e(void 0,{})){return function(a={snapshots:[],current:t},n={}){switch(n.type){case Te.b:return{...a,snapshots:[a.current,...a.snapshots]};case Te.c:return{...a,current:a.snapshots[n.payload.index]};case Te.a:return{...a,current:a.snapshots[a.snapshots.length-1]};default:return{...a,current:e(a.current,n)}}}}(a(301).a);var Jt=a(107),ea=a(20);var ta=Object(o.c)({entities:function(e={},t){const{type:a,payload:n}=t;switch(a){case b.a.SUCCESS:{const{organism:t={},subtrees:a,tree:r}=n.result,s={...e,...a.reduce((e,t)=>(e[t.name]={status:"PENDING",progress:0,lastStatus:0,...t},e),{})};return r&&(s[ea.a]={status:"PENDING",progress:0,lastStatus:0,...r,name:ea.a}),t.tree&&(s[ea.b]={name:ea.b,status:"READY",leafIds:t.references.map(e=>e.uuid),newick:t.tree}),s}case ve.b.SUCCESS:return{...e,[n.stateKey]:{...e[n.stateKey],position:n.result.position}};case b.c:if("tree"===n.task){const t=e[ea.a];if(n.status&&n.timestamp>=t.lastStatus)return{...e,[ea.a]:{...t,status:n.status,progress:0,lastStatus:n.timestamp}};if(n.progress&&n.progress>t.progress)return{...e,[ea.a]:{...t,status:"IN PROGRESS",progress:Math.floor(n.progress)}}}if("subtree"===n.task){if(!(n.name in e))return e;const t=e[n.name];if(n.status&&n.timestamp>=t.lastStatus)return{...e,[n.name]:{...t,status:n.status,lastStatus:n.timestamp,size:n.size,populationSize:n.populationSize}};if(n.progress&&n.progress>t.progress)return{...e,[n.name]:{...t,progress:Math.floor(n.progress)}}}return e;case ve.a.SUCCESS:return{...e,[n.stateKey]:{...e[n.stateKey],name:n.stateKey,status:n.result.status,newick:n.result.newick}};default:return e}},lastSubtree:function(e=null,{type:t,payload:a}){switch(t){case ve.c:return Jt.b.has(a.name)?e:a.name;default:return e}},loading:function(e=!1,{type:t}){switch(t){case ve.a.ATTEMPT:return!0;case ve.a.FAILURE:case ve.a.SUCCESS:return!1;default:return e}},libmicroreact:function(e={},t){if(t.stateKey){const a=e[t.stateKey];return{...e,[t.stateKey]:Qt(a,t)}}return e},titles:function(e={},{type:t,payload:a}){switch(t){case b.a.SUCCESS:{const{organism:t}=a.result;if(!t||!t.references)return e;const n={};for(const e of t.references)n[e.uuid]=e.name;return n}default:return e}},visible:function(e=null,{type:t,payload:a}){switch(t){case b.a.SUCCESS:{const{tree:t}=a.result;return t?"READY"===t.status?ea.a:e:ea.b}case ve.c:return a.name;default:return e}}}),aa=a(149);const na={lassoActive:!1,lassoPath:null};const ra=Object(o.c)({entities:Object(o.c)({genomes:function(e={},{type:t,payload:a}){switch(t){case b.a.SUCCESS:{const{genomes:t=[],organism:n={}}=a.result,{references:r=[]}=n;return{...e,...Ce(t,"isCollection"),...Ce(r,"isReference")}}case ve.a.SUCCESS:{const{genomes:t}=a.result;return t?{...e,...Ce(t,"isPublic")}:e}default:return e}},collection:function(e=Ee,{type:t,payload:a}){switch(t){case ee.a.SUCCESS:{const{result:t,organismId:n,metadata:r}=a;return ye.b.current=n,{...e,token:t.token,organismId:n,metadata:r}}case b.a.FAILURE:return{...e,status:be.a.NOT_FOUND};case b.a.SUCCESS:{const{genomes:t=[],...n}=a.result;return ye.b.current=n.organismId,{...e,genomeIds:new Set(Object(ge.b)(t).map(e=>e.uuid)),access:n.access,createdAt:n.createdAt,description:n.description,size:n.size,organismId:n.organismId,owner:n.owner,pmid:n.pmid,progress:n.progress,status:be.a.READY,title:n.title,token:n.token,uuid:n.uuid,isClusterView:n.isClusterView||!1,genomeId:a.genomeId}}case fe.a.ATTEMPT:return{...e,access_status:"LOADING",access:a.access};case fe.a.SUCCESS:return{...e,access_status:"OK"};case fe.a.FAILURE:return{...e,access_status:"ERROR"};default:return e}}}),aboutCollectionOpen:function(e=!1,{type:t,payload:a}){switch(t){case we.a:return a.isOpen;default:return e}},clusterView:function(e=na,{type:t,payload:a}){switch(t){case aa.b:return{...e,lassoActive:!e.lassoActive,lassoPath:na.lassoPath};case aa.a:return{...e,lassoPath:a,lassoActive:null!==a};case oe.c:return{...e,lassoPath:na.lassoPath,lassoActive:na.lassoActive};default:return e}},downloads:Se,filter:function(e=xe,{type:t,payload:a={}}){const{ids:n}=a||{};switch(t){case b.a.SUCCESS:return{...e,[Ne.a.VISIBILITY]:{ids:Oe,active:!1},[Ne.a.TREE]:{ids:Oe,active:!1},[Ne.a.MAP]:{ids:Oe,active:!1}};case oe.a:return{...e,[a.key]:{...e[a.key],ids:n,active:!0}};case oe.b:{const t=e[a.key];return{...e,[a.key]:{...t,ids:new Set([...t.ids,...n]),active:!0}}}case oe.d:{const t=e[a.key],r=Array.from(t.ids).filter(e=>!n.has(e));return r.length?{...e,[a.key]:{...t,ids:new Set(r),active:!0}}:{...e,[a.key]:{...t,ids:Oe,active:!1}}}case oe.e:return{...e,[a.key]:{...e[a.key],ids:Oe,active:!1}};case oe.c:return{...e,[Ne.a.VISIBILITY]:{...e[Ne.a.VISIBILITY],ids:Oe,active:!1},[Ne.a.TREE]:{ids:Oe,active:!1},[Ne.a.MAP]:{ids:Oe,active:!1}};default:return e}},highlight:function(e=Ie,{type:t,payload:a={}}){const{ids:n}=a||{};switch(t){case ke.c:return{...e,ids:a.append?new Set([...e.ids,...n]):new Set(n)};case ke.b:{const t=Array.from(e.ids).filter(e=>!n.has(e));return t.length?{...e,ids:new Set(t)}:{...e,ids:_e}}case ke.a:return{...e,ids:_e};default:return e}},history:function(e={},t){if(t.stateKey){const a=e[t.stateKey];return{...e,[t.stateKey]:je(a,t)}}return e},metadata:function(e={},{type:t,payload:a}){switch(t){case Ae.a:{const t={...e};for(const e of a)e.name in t||(t[e.name]=e);return t}case Ae.b:return{};default:return e}},offline:function(e=Me,{type:t,payload:a}){switch(t){case Re.a:return{status:a.status};default:return e}},search:function(e=Ge,{type:t,payload:a}){switch(t){case De.j:return{...e,advanced:!e.advanced,text:""};case De.i:return{...Be(e,a),exact:!e.exact};case De.h:return{...e,text:a,cursor:0};case De.a:{const{intersections:t,currentIntersection:n}=e,{category:r}=a,s=t[n]||[];let o=n;return r&&Object(Fe.c)(r,s)&&(o=t.length),{...e,category:a.category,currentIntersection:o,text:"",cursor:0}}case De.f:{if(!e.advanced)return Be(e,a);const{currentIntersection:t}=e,n=Array.from(e.intersections),r=n[t]||[];return r.some(e=>e.key===a.key)?e:(n[t]=r.concat(a),{...e,category:null,cursor:0,intersections:n,recent:Ue(e,[a]),text:""})}case De.g:{const{term:t,intersection:n}=a,r=Array.from(e.intersections),s=Array.from(r[n]);1===s.length?r.splice(n,1):(s.splice(s.indexOf(t),1),r[n]=s);const o=e.currentIntersection in r?e.currentIntersection:Math.max(0,r.length-1);return{...e,cursor:0,currentIntersection:o,intersections:r,recent:Ue(e,[t]),text:""}}case De.c:{const{intersections:t,currentIntersection:n}=e,r=n+a.delta;return r<0||r>t.length?e:{...e,currentIntersection:r}}case De.b:return{...e,cursor:Math.max(0,e.cursor+a.delta)};case De.e:return{...e,sort:a};case De.d:return a===e.currentIntersection?e:{...e,currentIntersection:a};case oe.c:return{...Ge,recent:e.recent,exact:e.exact,advanced:e.advanced};default:return e}},summary:function(e=He,{type:t,payload:a}){switch(t){case $e.a:return{...e,isExpanded:a};default:return e}},table:Kt,timeline:Xt,tree:ta}),sa=ra(void 0,{});var oa=a(38),la=a(80),ia=a(89),ca=a(147);const ua={entities:{},lastMessageReceived:null,position:null,selectedOrganism:null};var ma=a(148);const da={loaded:!1,status:{},tick:void 0,errors:{}};var pa=a(322);const ha={showing:!1};var fa=a(59);const ga={processing:new Set,pending:[]};function ba(e,{id:t,filename:a},n){if(!(t in e))return e;const r=e[t];return{...e,[t]:{...r,[a]:{...r[a],...n}}}}var ya=a(53),Ea=Object(o.c)({entities:function(e={},{type:t,payload:a}){switch(t){case oa.a.SUCCESS:{const e={};for(const t of a.genomes){const a={};for(const e of t.files)a[e.name]={error:null,handle:e,name:e.name,progress:0};e[t.id]=a}return e}case"UPLOAD_READS_PROGRESS":return ba(e,a,{stage:a.stage,progress:a.progress});case fa.b:{if(!(a.id in e))return e;const[t]=Object.keys(e[a.id]);return ba(e,{...a,filename:t},{progress:a.progress})}case fa.d.FAILURE:case fa.c.FAILURE:{if(!(a.id in e))return e;const[t]=Object.keys(e[a.id]);return ba(e,{...a,filename:t},{error:a.error})}default:return e}},errors:function(e={},{type:t,payload:a}){switch(t){case fa.c.FAILURE:return{...e,[a.id]:a.error};default:return e}},queue:function(e=ga,{type:t,payload:a}){switch(t){case oa.a.SUCCESS:{const e=[];for(const t of a.genomes)e.push(t.id);return{...ga,pending:e}}case fa.c.ATTEMPT:return{...e,pending:e.pending.slice(1),processing:new Set([...e.processing,a.id])};case fa.c.SUCCESS:case fa.c.FAILURE:{const t=new Set(e.processing);return t.delete(a.id),{...e,processing:t}}default:return e}},status:function(e={},{type:t,payload:a}){switch(t){case oa.a.SUCCESS:{const e={};for(const t of a.genomes)e[t.id]=ya.a.PENDING;return e}case la.a.SUCCESS:{const t={...e};for(const e of a.result.genomes)e.id in t||(t[e.id]=e.files?ya.a.PENDING:ya.a.SUCCESS);return t}case fa.c.ATTEMPT:return{...e,[a.id]:ya.a.QUEUED};case fa.a.ATTEMPT:return{...e,[a.id]:ya.a.COMPRESSING};case fa.d.ATTEMPT:return{...e,[a.id]:ya.a.UPLOADING};case fa.d.FAILURE:case fa.c.FAILURE:return{...e,[a.id]:ya.a.ERROR};case fa.d.SUCCESS:case fa.c.SUCCESS:return{...e,[a.id]:ya.a.SUCCESS};default:return e}}});const va={filenameToGenomeId:{},pendingFiles:[],fileIds:{}};const Ca={uploadedAt:null,view:null};const wa=Object(o.c)({_:function(e=Ca,{type:t,payload:a}){switch(t){case oa.a.SUCCESS:return{...e,view:ia.b.PROGRESS,uploadedAt:a.uploadedAt||e.uploadedAt};case la.a.SUCCESS:{if(e.uploadedAt===a.uploadedAt)return e;const{result:t}=a;let n=!1;for(const e of t.genomes)if(e.files){n=!0;break}return{...e,uploadedAt:a.uploadedAt,view:n?ia.b.RECOVERY:ia.b.PROGRESS}}default:return e}},analysis:function(e=ua,{type:t,payload:a}){switch(t){case ca.a:{const{genomeId:t,results:n}=a,{entities:r}=e,s={...r[t]||{}};for(const{task:e,version:t,result:a,error:r}of n)s[e]=!r&&t,a&&(s[e]=a);return{...e,entities:{...r,[t]:s},lastMessageReceived:new Date,position:0}}case ca.c:return{...e,selectedOrganism:a.organismId};case ca.b.SUCCESS:return{...e,position:a.result.position};case la.a.SUCCESS:{const t={},{genomes:n,position:r}=a.result;for(const{analysis:e,...a}of n){const n={};if(a.pending)for(const e of a.pending)n[e]=null;if(a.errored)for(const e of a.errored)n[e]=!1;t[a.id]={...e,...n}}return{...e,position:r,entities:t}}case oa.a.SUCCESS:{const t={};for(const e of a.genomes)t[e.id]={};return{...e,entities:t}}default:return e}},assembly:function(e=da,{type:t,payload:a}){switch(t){case ma.b:return{...e,loaded:!0,status:a};case ma.c:return{...e,tick:a};case ma.a:return{...e,errors:{...e.errors,[a.id]:a.error}};case la.a.SUCCESS:{const t={};for(const e of a.result.genomes)e.assembler&&e.assembler.error&&(t[e.id]=e.assembler.error);return{...e,errors:t}}case oa.a.SUCCESS:return{...e,loaded:!0};default:return e}},errors:function(e=ha,{type:t,payload:a}){switch(t){case pa.a:return{...e,showing:!e.showing};default:return e}},files:Ea,genomes:function(e={},{type:t,payload:a}){switch(t){case oa.a.SUCCESS:{const t={...e};for(const e of a.genomes)t[e.id]={id:e.id,name:e.name,type:e.type};return t}case la.a.SUCCESS:{const t={};for(const n of a.result.genomes)t[n.id]={id:n.id,name:n.name,type:n.type,...e[n.id]};return t}default:return e}},recovery:function(e=va,{type:t,payload:a}){switch(t){case la.a.ATTEMPT:return va;case la.a.SUCCESS:{const t={},n=[],{genomes:r}=a.result;for(const e of r)if(e.files){n.push(e.files.sort());for(const a of e.files)t[a]=e.id}return{...e,pendingFiles:n,filenameToGenomeId:t}}case oa.a.SUCCESS:{const t={};for(const e of a.genomes)e.recovery&&(t[e.id]=e.recovery);return{...e,fileIds:t}}default:return e}}}),Sa=wa(void 0,{});var Na=a(168);const Oa={loading:!1,error:!1,uploads:[]};var xa=Object(o.c)({progress:function(e=Sa,t){return t.type===la.b?Sa:wa(e,t)},previous:function(e=Oa,{type:t,payload:a}){switch(t){case Na.a.ATTEMPT:return{...e,loading:!0};case Na.a.FAILURE:return{...e,loading:!1,error:!0};case Na.a.SUCCESS:return{...e,loading:!1,uploads:a.result};default:return e}},errorMessage:function(e=null,t){switch(t.type){case"UPLOAD_ERROR_MESSAGE":return t.payload;default:return e}},usage:function(e=null,t){switch(t.type){case oa.b.SUCCESS:return t.payload.result;default:return e}},settings:function(e={compression:!1,individual:!1},{type:t,payload:a}){switch(t){case oa.c:return{...e,[a.setting]:a.value};default:return e}}}),ka=Object(o.c)({account:m,auth:function(e=p,{payload:t,type:a}){switch(a){case d.a.ATTEMPT:return{...e,pending:!0};case d.a.SUCCESS:return{...e,token:t.result.token,pending:!1};case d.a.FAILURE:return{pending:!1};default:return e}},branding:function(e=h,t){switch(t.type){case"CHANGE_BRANDING":return{id:t.payload};default:return e}},clustering:function(e=v,{type:t,payload:a}){switch(t){case f.c.ATTEMPT:return{...e,status:"BUILDING_CLUSTERS",progress:0,triedBuilding:!0,taskId:null};case f.c.FAILURE:return a.genomeId!==e.selectedGenomeId||"BUILDING_CLUSTERS"!==e.status?e:{...e,status:"FAILED_BUILDING_CLUSTERS"};case f.c.SUCCESS:return a.genomeId!==e.selectedGenomeId||"BUILDING_CLUSTERS"!==e.status?e:{...e,taskId:a.result.taskId};case f.e:return"BUILDING_CLUSTERS"===e.status?"READY"===a.status?{...e,progress:100,status:"BUILT_CLUSTERS"}:"IN PROGRESS"===a.status?{...e,progress:e.progress<a.progress?a.progress:e.progress}:{...e,status:"FAILED_BUILDING_CLUSTERS"}:e;case f.a.ATTEMPT:return{...e,status:"FETCHING_CLUSTERS"};case f.a.FAILURE:return a.genomeId!==e.selectedGenomeId||"FETCHING_CLUSTERS"!==e.status?e:{...e,status:"FAILED_FETCHING_CLUSTERS"};case f.a.SUCCESS:{if(a.genomeId!==e.selectedGenomeId||"FETCHING_CLUSTERS"!==e.status)return e;const{result:t={}}=a,{nodes:n,sts:r,genomeIdx:s,scheme:o,version:l}=t,{pi:i,lambda:c}=t.clusterIndex;return{...e,status:"FETCHED_CLUSTERS",nodes:n,index:{pi:i,lambda:c},allSchemeSts:r,indexOfSelectedInAll:s,scheme:o,version:l,threshold:e.threshold||C(i,c,s)}}case f.b.ATTEMPT:return{...e,status:"FETCHING_EDGES"};case f.b.FAILURE:return"FETCHING_EDGES"!==e.status||e.selectedGenomeId!==a.genomeId||e.threshold!==a.threshold?e:{...e,status:"FAILED_FETCHING_EDGES"};case f.b.SUCCESS:return"FETCHING_EDGES"!==e.status||e.selectedGenomeId!==a.genomeId||e.threshold!==a.threshold?e:{...e,edgeMatrix:a.result.edges,status:"FETCHED_EDGES"};case f.d.ATTEMPT:return{...e,nodeCoordinates:null,status:"RUNNING_LAYOUT"};case f.d.SUCCESS:return a.result.skip?e:{...e,status:"COMPLETED_LAYOUT",nodeCoordinates:a.result.coordinates};case b.a.ATTEMPT:case f.g:{const t="number"==typeof a?a:Number(a.threshold),n="number"==typeof a?e.selectedGenomeId:a.genomeId;return t===e.threshold?e:{...e,threshold:t,status:e.nodes?"FETCHED_CLUSTERS":"INITIAL_STATUS",edgeMatrix:null,nodeCoordinates:null,selectedGenomeId:n}}case f.h:return{...e,status:"COMPLETED_LAYOUT",nodeCoordinates:a};case g.b.ATTEMPT:return{...v,selectedGenomeId:a.genomeId};case f.f:return a===e.selectedGenomeId?e:{...v,selectedGenomeId:a};default:return e}},collections:_,downloads:function(e={},{type:t,payload:a}){switch(t){case T.ATTEMPT:return j(e,a,{status:L.a.LOADING});case T.FAILURE:return j(e,a,{status:L.a.ERROR});case T.SUCCESS:return j(e,a,{status:L.a.SUCCESS,result:a.result});default:return e}},filters:function(e={},{type:t,payload:a}){switch(t){case A.UPDATE_FILTER:return{...e,[a.stateKey]:P(e[a.stateKey],a)};case A.SET_FILTER:return{...e,[a.stateKey]:{...a.query}};case A.CLEAR_FILTER:{const{prefilter:t}=e[a.stateKey];return{...e,[a.stateKey]:{prefilter:t}}}default:return e}},header:function(e=re,{type:t,payload:a}){switch(t){case ne.a:return{...e,userDrawerVisible:!1,asideVisible:a.isOpen};case ne.b:return{...e,asideVisible:!1,userDrawerVisible:a.isOpen};default:return e}},genomes:ae,location:function(e={},{type:t,payload:a}){switch(t){case"LOCATION_CHANGE":{const{location:e}=a;return{slug:se(a.location),...e}}default:return e}},maps:function(e={},{type:t,payload:a}){switch(t){case Z.MAP_STORE_BOUNDS:return{...e,[a.stateKey]:{...e[a.stateKey],bounds:a.bounds}};case Z.MAP_LASSO_CHANGE:return{...e,[a.stateKey]:{...e[a.stateKey],lassoPath:a.path}};case Z.MAP_VIEW_BY_COUNTRY:return{...e,[a.stateKey]:{...e[a.stateKey],viewByCountry:a.active}};case Z.MAP_MARKER_SIZE_CHANGED:return{...e,[a.stateKey]:{...e[a.stateKey],markerSize:a.size}};case"SET_GENOME_SELECTION":return a.genomes.length?e:Object.keys(e).reduce((t,a)=>{const n=e[a];return t[a]=0===a.indexOf("GENOME")?{...n,lassoPath:null}:n,t},{});case oe.c:return{...e,COLLECTION:{}};default:return e}},offline:function(e=ce,{type:t,payload:a}){switch(t){case le.a.ATTEMPT:return{...e,status:ie.a.LOADING};case le.a.SUCCESS:case le.b.SUCCESS:return{status:ie.a.SUCCESS,collections:a.result.map(e=>({...e,createdAt:new Date(e.createdAt)}))};default:return e}},organisms:function(e=me,{type:t,payload:a}){switch(t){case ue.a.ATTEMPT:return{...e,loading:!0};case ue.a.SUCCESS:return{loading:!1,...a.result};default:return e}},toast:function(e=de,{type:t,payload:a}){switch(t){case"TOAST_SHOW":return{visible:!0,...a};case"TOAST_HIDE":return de;default:return e}},summary:function(e={loaded:!1},{type:t,payload:a}){switch(t){case pe.a.ATTEMPT:return{loaded:!1};case pe.a.SUCCESS:return{...e,loaded:!0,...a.result};case R.d.SUCCESS:{const{filter:t={},result:n}=a,r=he[t.prefilter||"all"];return{...e,[r]:n.summary.total}}case le.b.SUCCESS:return{...e,offlineCollections:e.offlineCollections>0?e.offlineCollections-1:0};default:return e}},upload:xa,viewer:function(e,t){return t.type===b.b?sa:ra(e,t)}});const _a=[i.b,l.a],Ia=Object(o.d)(Object(o.a)(..._a),window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__():e=>e)(o.e)(ka);t.a=Ia},,function(e,t,a){"use strict";a.d(t,"i",(function(){return o})),a.d(t,"f",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"g",(function(){return m})),a.d(t,"e",(function(){return p})),a.d(t,"j",(function(){return h})),a.d(t,"a",(function(){return f})),a.d(t,"c",(function(){return g}));var n=a(57),r=a(9),s=a(55);function o(e,t,a){const r=[],s=new Set;for(const l of e){if(l.group){const e=o(l.columns,t,a);for(const t of e)s.has(t.key)||(r.push(t),s.add(t.key));continue}const{columnKey:e}=l;if("__name"===e)continue;if(!l.valueGetter||l.hidden)continue;if(s.has(e))continue;const i=l.displayName||Object(n.a)(l);a&&!a.test(i)||(r.push({label:i,tableName:t,key:e,numeric:l.numeric}),s.add(e))}return r}function l(e,t){return t&&!t.test("NAME")?null:{tableName:e,label:"NAME",key:"__name"}}function i(e,t){for(const a of e){if(a.columnKey===t)return a;if(a.group){const e=i(a.columns,t);if(e)return e}}return null}function c(e,t){return{key:`${e.key}_${t.key}`,category:e,value:t}}function u(e,t){return t===r.c.antibiotics?Object(s.d)(e):t===r.c.snps||t===r.c.genes||t===r.c.kleborateAMR?e===s.h?"ABSENT":"PRESENT":String(e)}function m(e,t=!1){try{const a=e.replace("?","\\?");return t?new RegExp(`^${a}$`,"i"):new RegExp(a,"i")}catch(e){return null}}const d={"=":(e,t)=>e===t,">":(e,t)=>t>e,">=":(e,t)=>t>=e,"<":(e,t)=>t<e,"<=":(e,t)=>t<=e};function p(e){const t=e.replace(" ","");let a;if("<"===t[0]||">"===t[0]?(a=t[0],"="===t[1]&&(a+="=")):"="===t[0]&&(a="="),!a)return null;const n=t.slice(a.length);if(isNaN(n))return null;if(!n.length)return{test:()=>!0};const r=d[a].bind(null,Number(n));return{test:e=>r(Number(e))}}const h={FREQ_DESC:(e,t)=>t.ids.length-e.ids.length,FREQ_ASC:(e,t)=>e.ids.length-t.ids.length,VALUE_DESC:(e,t)=>e.label>t.label?-1:e.label<t.label?1:0,VALUE_ASC:(e,t)=>e.label>t.label?1:e.label<t.label?-1:0};function f(e,t,a,r,s){const o=t.activeColumn,l={tableName:e,label:o.displayName||Object(n.a)(o),key:o.columnKey,numeric:o.numeric},i=[];let u;o.numeric&&(u=p(r)),u||(u=m(r,s));for(const e of a){const t=o.valueGetter(e);u&&u.test(t)&&i.push(e.uuid)}return c(l,{key:s?r:"contains",label:r,ids:i})}function g(e,t){return t.some(t=>!t.value.isExpression&&t.category.key===e.key)}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"a",(function(){return l}));const n="LIBMR HISTORY SNAPSHOT";function r(e){return{type:n,payload:{image:e}}}const s="LIBMR HISTORY TRAVEL";function o(e){return{type:s,payload:{index:e}}}const l="LIBMR HISTORY REVERT"},,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"f",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"g",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"h",(function(){return i})),a.d(t,"d",(function(){return c})),a.d(t,"i",(function(){return u})),a.d(t,"e",(function(){return m})),a.d(t,"j",(function(){return d}));const n="LIBMR TIMELINE BOUNDS",r=e=>({type:n,payload:e||null}),s="LIBMR TIMELINE NODE SIZE",o=e=>({type:s,payload:e}),l="LIBMR TIMELINE SPEED",i=e=>({type:l,payload:e}),c="LIBMR TIMELINE UNIT",u=e=>({type:c,payload:e}),m="LIBMR TIMELINE VIEWPORT",d=e=>({type:m,payload:e})},,,,function(e,t,a){"use strict";var n=a(14),r=a(6);var s=a(71);a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));const o=Object(n.b)("FETCH_SUMMARY");function l(){return{type:o,payload:{promise:Promise.all([Object(r.a)("GET","/api/summary"),Object(s.b)()]).then(([e,t])=>({...e,offlineCollections:t.length}))}}}},function(e,t,a){"use strict";var n=a(2),r=a(43),s=a.n(r),o=a(99),l=a(58);const i=["#834B96","#B668A6","#756E94","#97B5BE","#92A3B8","#E8E0EE","#BFABCF","#CFC1DB","#9070AC","#A389BB","#8968A7","#9D81B6"];function c(e,t){let a=!1,n=e;"#"===n[0]&&(n=n.slice(1),a=!0);const r=parseInt(n,16);let s=(r>>16)+t;s>255?s=255:s<0&&(s=0);let o=(r>>8&255)+t;o>255?o=255:o<0&&(o=0);let l=(255&r)+t;return l>255?l=255:l<0&&(l=0),(a?"#":"")+(l|o<<8|s<<16).toString(16)}const u=i.map(e=>c(e,-20)),m=i.map(e=>c(e,20));function d(e){return m[u.indexOf(e)]}var p=a(10),h=a(16);a.d(t,"d",(function(){return g})),a.d(t,"c",(function(){return b})),a.d(t,"a",(function(){return y})),a.d(t,"e",(function(){return C})),a.d(t,"f",(function(){return w})),a.d(t,"b",(function(){return O}));const f=({upload:e})=>e.progress.analysis,g=e=>f(e).selectedOrganism,b=e=>f(e).position,y=Object(n.createSelector)(f,e=>Object.keys(e.entities).map(t=>e.entities[t]));function E(e){const t={},a={};for(const n of e)for(const e of Object.keys(n)){if(e in t||(t[e]={total:0,errors:0}),null!==n[e]&&t[e].total++,!1===n[e]&&t[e].errors++,"mlst"===e&&n.mlst){const{st:e}=n.mlst;a[e]=(a[e]||0)+1}n[e]&&n[e].source&&(t[e].source=n[e].source)}return t.mlst&&(t.mlst.sequenceTypes=Object.keys(a).map(e=>({label:`ST ${e}`,total:a[e]})),t.mlst.errors&&t.mlst.sequenceTypes.push({label:"Error",total:t.mlst.errors,colour:h.c.DANGER_COLOUR})),t}const v=Object(n.createSelector)(l.f,y,(e,t)=>{const a={};let n=0,r=0;for(const e of t)if("speciator"in e&&null!==e.speciator)if(!1===e.speciator)r++;else{const{organismId:t}=e.speciator;a[t]=(a[t]||[]).concat(e)}else n++;const s=function(){const e=new Map;let t=0;return a=>{if(!e.has(a)){const n=u[t++%u.length];e.set(a,n)}return e.get(a)}}(),o=[];for(const e of Object.keys(a)){const t=a[e],n=Object(p.c)(e,t[0].speciator.organismName),r=s(n);o.push({key:e,label:n,colour:r,total:t.length,analyses:E(t)})}return!n||e&&!o.length||o.push({key:"pending",label:"Pending",total:n,colour:"#ccc"}),r&&o.push({key:"error",label:"Error",total:r,colour:h.c.DANGER_COLOUR}),o}),C=Object(n.createSelector)(v,e=>e.map(e=>{if(e.analyses){const t=Object.keys(e.analyses).map(t=>({key:t,label:h.d[t],...e.analyses[t]}));return{...e,analyses:s()(t,e=>`${e.label.toUpperCase()}-${e.key}`)}}return e})),w=Object(n.createSelector)(C,e=>!!e.length&&"pending"!==e[0].key);function S(e){const t=e.match(/^(.)\S* (..).*$/);if(t){const[,e,a]=t;return`${e}. ${a}.`}return e}const N=Object(n.createSelector)(v,e=>{const t={label:"Organism",data:[],backgroundColor:[],labels:[],organismIds:[],shortLabels:[],total:0},a={label:"Sequence Type",data:[],backgroundColor:[],labels:[],parents:[],total:0,tooltips:[]};let n=0;for(const{label:r,colour:s,total:o,key:l,analyses:i={}}of e){t.data.push(o),t.backgroundColor.push(s),t.labels.push(r),t.shortLabels.push(S(r)),t.organismIds.push(l),t.total+=o;let e=o;const{mlst:c={}}=i,{sequenceTypes:u=[]}=c;for(const t of u)a.data.push(t.total),a.backgroundColor.push(t.colour||d(s)),a.labels.push(t.label),a.parents.push(n),a.tooltips.push(`${t.total} / ${o}, ${(t.total/o*100).toFixed(1)}%`),e-=t.total;e>0&&(a.data.push(e),a.backgroundColor.push("#fefefe"),a.labels.push("Unknown ST"),a.parents.push(n)),n++}return{organisms:t,sts:a}}),O=Object(n.createSelector)(o.b,N,(e,{organisms:t,sts:a})=>{const n=[];return e&&n.unshift(e),t.data.length&&n.unshift(t),a.data.length&&n.unshift(a),n})},function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return c}));var n=a(15);const r="selected-genomes";function s(e){return e>function(){const{pagination:e={max:2500}}=n.a;return e.max}()}function o(){return localforage.getItem(r).then(e=>Object.values(e||{}))}function l(e=[]){const t={};for(const{id:a,name:n,organismId:r,binned:s}of e)t[a]={id:a,name:n,organismId:r,binned:s};return localforage.setItem(r,t)}function i(e){return localforage.getItem(r).then(t=>{for(const{id:a,name:n,organismId:r,binned:s}of e)t[a]={id:a,name:n,organismId:r,binned:s};return localforage.setItem(r,t)})}function c(e){return localforage.getItem(r).then(t=>{for(const{id:a}of e)delete t[a];return localforage.setItem(r,t)})}},function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return c}));var n=a(2),r=a(21),s=a(51);const o=Object(n.createSelector)(r.f,e=>e.reduce((e,t)=>(e[t.organismId]=e[t.organismId]||[],e[t.organismId].push(t),e),{})),l=Object(n.createSelector)(s.h,o,(e,t)=>!e&&1===Object.keys(t).length),i=Object(n.createSelector)(o,e=>{const t=Object.keys(e)[0];return{organismId:t,numGenomes:e[t].length}}),c=e=>e.genomes.collectionMetadata},,,function(e,t,a){"use strict";a.r(t),a.d(t,"isSupported",(function(){return o})),a.d(t,"taxIdMap",(function(){return c})),a.d(t,"getOrganismName",(function(){return m}));var n=a(274);a.d(t,"FormattedName",(function(){return n.default}));const r=a(380),s=new Set(r.map(e=>e.id)),o=({organismId:e})=>s.has(e),l=r.reduce((e,{id:t,nickname:n})=>(e[n]={id:t,nickname:n,...a(628)(`./${n}`).default},e),{}),i=Object.keys(l).map(e=>l[e]),c=new Map(i.map(e=>[e.id,e]));let u={};function m(e,t){return c.has(e)?c.get(e).name:t}t.default={get list(){return i},get current(){return u},set current(e){u=c.get(e)||{}},get:e=>l[e],get id(){return u.id},get formattedName(){return u.formattedName},get nickname(){return u.nickname},get uiOptions(){return u.uiOptions||{}},get maxGenomeSize(){return u.maxGenomeSize||Math.pow(10,10)},get gcRange(){return u.gcRange||{}}}},,,function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(42),o=a(16),l=a(187);const i={color:o.c.DANGER_COLOUR};t.a=({status:e,color:t,label:a,isArchive:n})=>r.a.createElement("div",{className:"wgsa-download-icon"},e===l.a.LOADING?r.a.createElement(s.a,null):r.a.createElement("div",null,r.a.createElement("i",{className:"wgsa-button-icon material-icons",style:e===l.a.ERROR?i:{color:t}},n?"archive":"insert_drive_file"),a?r.a.createElement("span",{className:"wgsa-download-label"},a):null))},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return i}));var n=a(14),r=a(71);const s=Object(n.b)("OFFLINE_LOAD_COLLECTIONS");function o(){return{type:s,payload:{promise:Object(r.b)()}}}const l=Object(n.b)("OFFLINE_REMOVE_COLLECTION");function i(e){return{type:l,payload:{promise:Object(r.e)(e).then(r.b)}}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));const n={FREQ_DESC:"FREQ_DESC",FREQ_ASC:"FREQ_ASC",VALUE_DESC:"VALUE_DESC",VALUE_ASC:"VALUE_ASC"},r={BASIC:0,ADVANCED:1}},,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"c",(function(){return m}));var n=a(21),r=a(123),s=a(14),o=a(63),l=a(320);const i=Object(s.b)("CREATE_COLLECTION");function c(){return(e,t)=>{const a=t(),{organismId:s}=Object(r.c)(a),c=Object(n.f)(a),u=Object(r.b)(a);return e(function(e,t,a){return{type:i,payload:{organismId:e,metadata:a,promise:Object(l.a)(t,e,a)}}}(s,c,u)).catch(()=>e(Object(o.c)({message:"Your collection could not be created at this time, please try again later."})))}}const u="CHANGE_COLLECTION_METADATA";function m(e,t){return{type:u,payload:{[e]:t}}}},function(e,t,a){"use strict";a.r(t),a.d(t,"UPDATE_FILTER",(function(){return r})),a.d(t,"SET_FILTER",(function(){return s})),a.d(t,"CLEAR_FILTER",(function(){return o})),a.d(t,"updateFilter",(function(){return l})),a.d(t,"setFilter",(function(){return i})),a.d(t,"clearFilter",(function(){return c})),a.d(t,"update",(function(){return u})),a.d(t,"clear",(function(){return m}));var n=a(40);const r="UPDATE_FILTER",s="SET_FILTER",o="CLEAR_FILTER";function l(e,t){return{type:r,payload:{stateKey:e,query:t}}}function i(e,t){return{type:s,payload:{stateKey:e,query:t}}}function c(e){return{type:o,payload:{stateKey:e}}}function u(e,t){return a=>{a(l(e,t)),delete t.prefilter,Object(n.f)(t)}}function m(e){return t=>{t(c(e)),Object(n.c)()}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return o}));var n=a(0),r=a.n(n);const s=new Set(["Salmonella enterica","Salmonella bongori"]);function o(e){return s.has(e)?"serovar":"serotype"}function l({speciesName:e,subspecies:t,serotype:a}){const n=o(e);return e&&t&&a?`${e} subspecies ${t} ${n} ${a}`:e&&a?`${e} ${n} ${a}`:e}t.a=e=>r.a.createElement("span",{title:l(e)},function({speciesName:e,subspecies:t,serotype:a,abbreviated:n}){const s=o(e);return"Salmonella enterica"===e&&a?r.a.createElement(r.a.Fragment,null,r.a.createElement("em",null,"Salmonella")," ",a):e&&t&&a?r.a.createElement(r.a.Fragment,null,r.a.createElement("em",null,e)," ",n?"subsp.":"subspecies"," ",r.a.createElement("em",null,t)," ",n?"ser.":s," ",a):e&&a?r.a.createElement(r.a.Fragment,null,r.a.createElement("em",null,e)," ",n?"ser.":s," ",r.a.createElement("strong",null,a)):r.a.createElement("em",null,e)}(e))},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return o}));var n=a(2);const r=({genomes:e})=>e.summary,s=e=>r(e).visible,o=e=>r(e).total;Object(n.createSelector)(s,o,(e,t)=>e===t)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return o}));const n="VIEWER_ADD_PRIVATE_METADATA";function r(e){return{type:n,payload:e}}const s="VIEWER_CLEAR_PRIVATE_METADATA";function o(){return{type:s}}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return c})),a.d(t,"f",(function(){return u}));var n=a(14),r=a(319);const s="UPLOAD_ANALYSIS_RECEIVED";function o(e){return{type:s,payload:e}}const l=Object(n.b)("UPLOAD_FETCH_POSITION");function i(e){return{type:l,payload:{uploadedAt:e,promise:r.a(e)}}}const c="UPLOAD_ORGANISM_SELECTED";function u(e){return{type:c,payload:{organismId:e}}}},function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"f",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"e",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return i}));const n="ASSEMBLY_PROGRESS_TICK";function r(){return{type:n,payload:Date.now()}}const s="ASSEMBLY_PIPELINE_STATUS";function o(e){return{type:s,payload:e}}const l="ASSEMBLY_PIPELINE_ERROR";function i(e){return{type:l,payload:e}}},function(e,t,a){"use strict";var n=a(6),r=a(161);function s(e,t){return console.log(`[Pathogenwatch] Fetching cluster for genome ${e}`),Object(n.a)("GET",`/api/clustering/${e}?threshold=${t}`).then(e=>({...e,genomes:Object(r.a)(e.genomes)}))}var o=a(31);function l(e,t){return{type:o.a,payload:{isClusterView:!0,genomeId:e,threshold:t,promise:s(e,t).then(e=>({...e,isClusterView:!0}))}}}a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return i})),a.d(t,"e",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"d",(function(){return m}));const i="CLUSTER_TOGGLE_LASSO_ACTIVE";function c(){return{type:i,payload:{}}}const u="CLUSTER_SET_LASSO_PATH";function m(e=[]){return{type:u,payload:e}}},function(e,t,a){"use strict";var n=a(75),r=a(267),s=a(0),o=a.n(s),l=a(3),i=a(40),c=a(329),u=a(165),m=a(326),d=a(65),p=a(100);var h=Object(l.a)((function(e){return{active:d.c(e,{stateKey:r.a}),searchText:Object(n.e)(e),filterSummary:Object(n.c)(e),prefilter:Object(n.d)(e)}}),(function(e){return{clearFilter:()=>e(p.c()),updateFilterValue:(t,a)=>e(p.f({[t]:a})),applyFilter:()=>e(p.b()),updateFilter:(t,a)=>e(p.e({[t]:a}))}}))(({active:e,searchText:t,filterSummary:a,updateFilterValue:n,applyFilter:r,updateFilter:s,clearFilter:l,prefilter:d})=>o.a.createElement(c.a,{active:e,clear:l,prefilter:d,summary:a,textValue:t,textOnChange:e=>n("searchText",e),textOnChangeEffect:r,updateFilter:s},o.a.createElement(u.a,{filterKey:"organismId",heading:"Organism",icon:"bug_report",summary:a.organism}),o.a.createElement(u.a,{className:"capitalised",filterKey:"access",heading:"Access",icon:"person"}),o.a.createElement(m.a,{summary:a.date}),o.a.createElement(u.a,{filterKey:"publicationYear",heading:"Publication Year",icon:"chrome_reader_mode"}),o.a.createElement(i.b,{update:s})));a.d(t,"b",(function(){return r.a})),a.d(t,"a",(function(){return h}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={LOADING:0,SUCCESS:1,ERROR:2}},,,function(e,t,a){"use strict";a.r(t),a.d(t,"getFilter",(function(){return r})),a.d(t,"isActive",(function(){return s}));var n=a(2);function r(e,{stateKey:t}){return e.filters[t]||{}}const s=Object(n.createSelector)(r,e=>Object.keys(e).some(t=>"prefilter"!==t&&e[t]))},,function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));const n=a(626);function r(e){if(e&&e.toLowerCase()in n){const[t]=n[e.toLowerCase()];return t||e}return e}function s(e){if(e){const[t,a,r]=n[e.toLowerCase()];if(t)return[a,r]}return e}},function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(213),o=a.n(s);const l={Paragraph:e=>r.a.createElement("span",null,e.children)};t.a=({className:e,tag:t,children:a})=>r.a.createElement(o.a,{className:e,containerTagName:t,source:a,renderers:l})},,function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return c}));var n=a(57);const r=document.createElement("canvas").getContext("2d"),s="bold",o="normal";function l(e,t,a){return r.font=((e=o,t=13)=>`${e} ${t}px "Roboto", "Helvetica", "Arial", sans-serif`)(t,a),r.measureText(e.slice(0,100)).width}const i=e=>l(e,s,11);function c(e,{genomes:t}){if(e.fixedWidth)return e;const{cellPadding:a=16}=e,r=i(Object(n.a)(e))+a;let c="",u=!1;const{valueGetter:m,getTextToMeasure:d=m}=e;for(const a of t){let t=d(a);null!=t&&(t=String(t),t.length>c.length&&(c=t,u="__name"===e.columnKey&&(a.__isCollection||a.__isReference)))}return e.width=c.length?Math.max(e.getMinWidth?e.getMinWidth():e.minWidth||0,r,l(c,u?s:o)+a):r,e}},function(e,t,a){"use strict";function n(e){return e.sort((e,t)=>e.name<t.name?-1:e.name>t.name?1:0)}function r(e=[]){return e.map(e=>{const t={...e.analysis};if(t.paarsnp&&Array.isArray(t.paarsnp.antibiotics)){const{antibiotics:e=[]}=t.paarsnp;t.paarsnp={...t.paarsnp,antibiotics:e.reduce((e,t)=>(e[t.name]=t,e),{})}}const a=e.uuid||e.id||e._id;return{...e,uuid:a,analysis:t,position:e.position||{latitude:e.latitude,longitude:e.longitude}}})}a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}))},,,function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(486),o=a(17),l=a.n(o),i=a(3),c=a(266),u=a(327),m=a(42),d=a(24),p=a(132),h=a(71);const f=r.a.createClass({displayName:"RemoveOfflineCollection",getInitialState:()=>({confirming:!1}),warn(){this.setState({confirming:!0})},cancel(){this.setState({confirming:!1})},render(){const{onConfirm:e,disabled:t}=this.props;return r.a.createElement(d.a,null,this.state.confirming?r.a.createElement("div",{key:"confirm",className:"wgsa-confirm-action"},r.a.createElement("p",null,"This cannot be undone."),r.a.createElement("button",{className:"mdl-button wgsa-button--text",onClick:this.cancel},"Cancel"),r.a.createElement("button",{className:"mdl-button wgsa-button--text mdl-button--primary",onClick:e},"Confirm")):r.a.createElement("button",{key:"action",className:"mdl-button wgsa-button--text",onClick:this.warn,disabled:t,title:t?"Remove this collection when you are online again 🙂":"Requires confirmation"},"Remove"))}});var g=Object(i.a)(null,(function(e,{token:t}){return{onConfirm:()=>e(Object(p.d)(t)),disabled:Object(h.c)()}}))(f);const b=e=>e.offline;function y(e){return b(e).status}function E(e){return b(e).collections}var v=a(234),C=a(50);const w=()=>r.a.createElement("div",{className:"wgsa-page wgsa-compact-page"},r.a.createElement("h1",null,"Offline Mode"),r.a.createElement("p",null,"Offline mode allows you to save specific collections for use even when you lose network connectivity."),r.a.createElement("h2",null,"How to Save Collections"),r.a.createElement("p",null,r.a.createElement("img",{src:"/images/save-for-offline.png"})),r.a.createElement("p",null,"When viewing a collection, click on the ",r.a.createElement("i",{className:"material-icons"},"info")," icon in header bar, revealing the ",r.a.createElement("strong",null,"Save for Offline Use")," button. Click this button, allow the page to refresh and your collection should be available offline, hurrah!"),r.a.createElement("p",null,"Saved collections are listed on this page when you need them.")),S=()=>r.a.createElement("div",{className:"wgsa-page wgsa-compact-page"},r.a.createElement("h1",null,"Oh no!"),r.a.createElement("p",null,"Unfortunately your browser does not support Offline Mode."),r.a.createElement("p",null,"We're super sorry. 😞")),N=()=>Object(h.d)()?r.a.createElement(w,null):r.a.createElement(S,null),O=e=>r.a.createElement(u.a,l()({},e,{footerLink:r.a.createElement(g,{token:e.item.token})})),x=({collections:e})=>r.a.createElement("div",{className:"wgsa-page"},r.a.createElement("h1",null,"Saved Collections"),Object(h.c)()?null:r.a.createElement("p",null,"These collections will be available when you are offline."),r.a.createElement(c.a,{items:e,template:O,keyProp:"token"})),k=r.a.createClass({displayName:"Offline",componentDidMount(){this.props.loadCollections()},renderContent(){const{status:e,collections:t}=this.props;return e===v.a.LOADING?r.a.createElement("div",{className:"wgsa-page"},r.a.createElement(m.a,null),";"):t.length?r.a.createElement(x,{collections:t}):r.a.createElement(N,null)},render(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null,"Offline"),this.renderContent())}});var _=Object(i.a)((function(e){return{status:y(e),collections:E(e)}}),(function(e){return{loadCollections:()=>e(Object(p.c)())}}))(k);a.d(t,"b",(function(){return h.c}));t.a=r.a.createElement(s.a,{path:"/offline",component:_})},function(e,t,a){"use strict";a(953);var n=a(277);a.d(t,"a",(function(){return n.a}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={LOADING:0,LOADED:1,ERROR:2}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));var n=a(14),r=a(183);const s=Object(n.b)("FETCH_UPLOADS");function o(){return{type:s,payload:{promise:Object(r.b)()}}}},,function(e,t,a){"use strict";a(1084);var n=a(139),r=a(0),s=a.n(r),o=a(3),l=a(90),i=a(123),c=a(26),u=a(10),m=a(228);const d=s.a.createClass({displayName:"CreateCollectionForm",componentDidMount(){componentHandler.upgradeElements(Array.from(this.formElements)),this.firstInput.focus()},addToFormElements(e){this.firstInput||(this.firstInput=e.querySelector("input")),this.formElements.has(e)||this.formElements.add(e)},formElements:new Set,firstInput:null,render(){const{metadata:{title:e,description:t,pmid:a},canCreateCollection:n}=this.props,{organismId:r,numGenomes:o}=this.props.collectionSummary;return r?s.a.createElement("form",{className:"wgsa-create-collection-form",onSubmit:this.props.onSubmit},s.a.createElement("span",{className:"wgsa-card-metadata-inliner wgsa-collection-summary"},s.a.createElement(l.a,{title:"Size",icon:"wgsa_genome"},s.a.createElement("span",null,o," Genome",1===o?"":"s")),s.a.createElement(l.a,{title:"Organism",icon:"bug_report"},u.d.get(r).formattedName)),s.a.createElement("div",{ref:this.addToFormElements,className:"mdl-textfield mdl-js-textfield mdl-textfield--floating-label"},s.a.createElement("input",{className:"mdl-textfield__input",type:"text",id:"collection-title",value:e,onChange:this.props.onFormChange,disabled:!n}),s.a.createElement("label",{className:"mdl-textfield__label",htmlFor:"collection-title"},"Title")),s.a.createElement("div",{ref:this.addToFormElements,className:"mdl-textfield mdl-js-textfield mdl-textfield--floating-label"},s.a.createElement("textarea",{className:"mdl-textfield__input",type:"text",rows:"3",id:"collection-description",value:t,onChange:this.props.onFormChange,disabled:!n}),s.a.createElement("label",{className:"mdl-textfield__label",htmlFor:"collection-description"},"Description")),s.a.createElement("div",{ref:this.addToFormElements,className:"mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdl-textfield--small"},s.a.createElement("input",{className:"mdl-textfield__input",type:"text",id:"collection-pmid",value:a,onChange:this.props.onFormChange,disabled:!n,pattern:"[0-9]*"}),s.a.createElement("label",{className:"mdl-textfield__label",htmlFor:"collection-pmid"},"PMID")),s.a.createElement("footer",null,s.a.createElement("button",{className:"mdl-button mdl-js-button mdl-button--raised mdl-button--colored",disabled:!n},"Create Now"))):null}});var p=Object(o.a)((function(e){return{canCreateCollection:i.a(e),collectionSummary:i.c(e),metadata:i.b(e)}}),(function(e){return{onSubmit:t=>{t.preventDefault(),e(Object(n.d)()).then(({token:t})=>{t?(e(Object(c.g)()),m.b.push(`/collection/${t}`)):console.error("Failed to create collection")})},onFormChange:({target:t})=>e(Object(n.c)(t.id.split("collection-")[1],t.value))}}))(d),h=a(24),f=a(320);const g={LOADING:"LOADING",NOT_READY:"NOT_READY",VERIFIED:"VERIFIED",ERROR:"ERROR",FAILED_TO_VERIFY:"FAILED_TO_VERIFY"},b=["Hang on in there","Stay strong","You can do this"];var y=s.a.createClass({displayName:"Verifier",getInitialState:()=>({status:g.LOADING,failed:!1}),componentDidMount(){this.verify(1e3),this.interval=setInterval(()=>this.verify(2e3),1e4)},componentDidUpdate(e,t){const{VERIFIED:a,ERROR:n}=g,{status:r}=this.state;t.status!==a&&r===a&&clearInterval(this.interval),r===n&&clearInterval(this.interval)},componentWillUnmount(){this.interval&&clearInterval(this.interval)},verify(e=2e3){this.setState({status:g.LOADING}),Promise.all([f.b(this.props.genomes,this.props.organismId).then(()=>({status:g.VERIFIED})).catch(e=>400===e.status?e.responseJSON||{}:{status:g.FAILED_TO_VERIFY}),new Promise(t=>setTimeout(t,e))]).then(([e])=>this.setState(e))},renderStatus(){return this.state.status===g.NOT_READY?s.a.createElement("div",null,s.a.createElement("p",null,"Core analysis incomplete, ",this.state.pending," result",1===this.state.pending?"":"s"," to go."),s.a.createElement("p",null,b[Math.floor(Math.random()*b.length)],". 😓")):this.state.status===g.ERROR?s.a.createElement("div",null,s.a.createElement("p",null,"Core analysis could not be completed for this selection."),s.a.createElement("p",null,"Please resubmit your genomes and try again.")):this.state.status===g.FAILED_TO_VERIFY?s.a.createElement("p",null,"Something went wrong 😞"):s.a.createElement("p",{className:"wgsa-blink"},"Verifying core analysis...")},render(){const{status:e}=this.state;return e===g.VERIFIED?this.props.children:s.a.createElement(h.a,{className:"wgsa-collection-verify",out:!1},s.a.cloneElement(this.renderStatus(),{key:this.state.status}))}}),E=a(95);const v=({deployedOrganisms:e})=>s.a.createElement("div",{className:"wgsa-create-collection-message"},s.a.createElement("p",null,"To create a collection, please select genomes identified as one of the following organisms:"),s.a.createElement("ul",{className:"wgsa-supported-organism-list"},Array.from(e).map(e=>s.a.createElement("li",{key:e},s.a.createElement(u.a,{fullName:!0,organismId:e}))))),C=({organismId:e,deficit:t})=>s.a.createElement("div",{className:"wgsa-create-collection-message"},s.a.createElement("p",null,"Population search is not currently supported for ",s.a.createElement("strong",null,s.a.createElement(u.a,{organismId:e})),"."),s.a.createElement("p",null,"At least 3 genomes are required to produce a tree for collections without population search."),s.a.createElement("p",null,"Please select ",s.a.createElement("strong",null,t," more genome",1===t?"":"s"),".")),w=({summary:e,onClick:t})=>s.a.createElement("div",{className:"wgsa-create-collection-message"},s.a.createElement("p",null,"To create a collection, please select ",s.a.createElement("strong",null,"one organism")," below:"),s.a.createElement("p",null,Object.keys(e).map(a=>s.a.createElement("button",{key:a,className:"mdl-chip mdl-chip--contact wgsa-inline-chip",onClick:()=>t(e[a])},s.a.createElement("span",{className:"mdl-chip__contact"},e[a].length),s.a.createElement("span",{className:"mdl-chip__text"},s.a.createElement(u.a,{organismId:a}))))));var S=Object(o.a)((function(e){return{selectedGenomeSummary:Object(i.d)(e),deployedOrganisms:Object(E.a)(e)}}),(function(e){return{onClick:t=>e(Object(c.l)(t))}}))(({selectedGenomeSummary:e,deployedOrganisms:t,onClick:a})=>{const n=Object.keys(e);if(0===n.length)return s.a.createElement(v,{deployedOrganisms:t});if(1===n.length){const t=n[0],a=e[t],r=a.length,{uiOptions:o={}}=u.d.get(t);return o.noPopulation&&r<3?s.a.createElement(C,{organismId:t,deficit:3-r}):s.a.createElement(y,{organismId:t,genomes:a},s.a.createElement(p,null))}return s.a.createElement(w,{summary:e,onClick:a})});a.d(t,"a",(function(){return n.b})),a.d(t,"b",(function(){return S}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={LOADING:0,ERROR:1,OK:2}},function(e,t,a){"use strict";var n=a(14),r=a(188),s=a(79),o=a(78),l=a(6);function i(e,t){const a=Object(o.stringify)(t);return Object(l.a)("POST",`/api/genome/at-locations?${a}`,{coordinates:e})}var c=a(28);a.d(t,"b",(function(){return u})),a.d(t,"e",(function(){return m})),a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"d",(function(){return h}));const u=Object(n.b)("SHOW_MARKER_POPUP");function m(e=[]){return(t,a)=>{const n=a(),r=Object(c.a)(n);t({type:u,payload:{promise:i(e,r)}})}}const d="CLOSE_MARKER_POPUP";function p(){return{type:d}}function h(e,t){return(a,n)=>{a(Object(s.changeLassoPath)(e,t));const o=n();t&&a(m(Object(r.e)(o,{stateKey:e})))}}},,,,,,,function(e,t,a){"use strict";a.r(t),a.d(t,"onHeaderClick",(function(){return s}));var n=a(44),r=a(27);function s(e,t){return(a,s)=>{const o=s(),l=Object(r.a)(o),{activeColumns:i}=Object(r.b)(o),c=t.group?t.columns.filter(e=>e.valueGetter&&!e.hidden):[t],u=t.group&&c.some(e=>!i.has(e));if(e.metaKey||e.ctrlKey){for(const e of c)t.group&&u?i.add(e):i[i.has(e)?"delete":"add"](e);a(Object(n.e)(l,new Set(i)))}else!function(e,t){return t.size&&t.size===e.length&&Array.from(t).every(t=>-1!==e.indexOf(t))}(c,i)?a(Object(n.e)(l,new Set(c))):a(Object(n.e)(l,new Set))}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s}));const n="HEADER_TOGGLE_ASIDE";const r="HEADER_TOGGLE_USER_DRAWER";function s(e){return{type:r,payload:{isOpen:e}}}},,function(e,t,a){"use strict";a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return i}));var n=a(6),r=a(15);function s(e,t){return Object(n.a)("PUT",`/api/genome?uploadedAt=${t}`,e.map(e=>({id:e.id,type:e.type,files:e.files.map(e=>e.name),metadata:{name:e.name,...e.metadata}})))}function o(e){return Object(n.a)("GET",`/api/upload/${e}`)}function l(){return Object(n.a)("GET","/api/upload")}function i(e){return fetch(`${r.a.assemblerAddress}/api/account`,{headers:{Authorization:`Bearer ${e}`}}).then(e=>{if(200===e.status)return e.json();throw new Error(e.statusText)})}},,function(e,t,a){"use strict";var n=a(14),r=a(6);a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));const s=Object(n.b)("FETCH_SPECIES_SUMMARY");function o(){return{type:s,payload:{promise:Object(r.a)("GET","/api/organism/summary")}}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return l})),a.d(t,"a",(function(){return i}));var n=a(6);function r(e){return Object(n.a)("GET","/api/genome",e)}function s(e){return Object(n.a)("GET","/api/genome/map",e)}function o(e){return Object(n.a)("GET","/api/genome/stats",e)}function l(e){return Object(n.a)("GET","/api/genome/summary",e)}function i(e,t){return Object(n.a)("POST","/api/genome/bin",{status:t,ids:e})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={NOT_GENERATED:0,LOADING:1,ERROR:2,SUCCESS:3}},function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return u})),a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return p}));var n=a(43),r=a.n(n),s=a(2),o=a(51),l=a(97),i=a(316);const c=e=>Object(o.b)(e).map.markers,u=e=>Object(o.b)(e).map.filter,m=e=>Object(o.b)(e).map.popup,d=Object(s.createSelector)(m,e=>{const t=[];for(const{genomes:a,organismId:n,speciesName:r,subspecies:s,serotype:o}of e.genomes)for(const{id:e,name:l}of a)t.push({id:e,name:l,organismId:n,speciesName:r,subspecies:s,serotype:o});return r()(t,"name")}),p=Object(s.createSelector)(c,l.b,(e,t)=>t?e.reduce((e,{position:a})=>{const[n,r]=a;return n&&r&&Object(i.contains)(t,{lat:n,lng:r})?(e.push(a),e):e},[]):[])},function(e,t,a){"use strict";var n=a(14),r=a(6);a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));const s=Object(n.b)("GET_AUTH_TOKEN");function o(){return{type:s,payload:{promise:Object(r.a)("GET","/auth/token")}}}},,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(82);t.a=r.a.createClass({displayName:"ST.react",componentDidMount(){const{id:e}=this.props;Object(s.b)(e)&&window&&window.Clipboard&&(this.clipboard=new window.Clipboard(this.el,{text:()=>e}))},render(){const{id:e}=this.props;if(Object(s.b)(e)){const t=e.substr(0,4);return r.a.createElement("span",{ref:e=>{this.el=e},className:"wgsa-mlst-st is-novel",title:`Novel ST: ${e}\n(Click to copy)`,onClick:e=>e.stopPropagation()},t)}return r.a.createElement("span",{className:"wgsa-mlst-st"},e)}})},function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(285);t.a=({alleles:e=[]})=>r.a.createElement("span",{className:"wgsa-mlst-profile"},e.map(({gene:e,hits:t})=>r.a.createElement("span",{key:e,className:"wgsa-mlst-profile-section"},t.length?t.map(e=>r.a.createElement(s.a,{key:e,id:e,showNovelHash:!0})):r.a.createElement("span",{title:"Not found"},"?"))))},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));const n=["WGSA","Pathogenwatch","PathogenDotWatch"],r={WGSA:"WGSA",Pathogenwatch:"Pathogenwatch",PathogenDotWatch:"Pathogenwatch"}},,function(e,t,a){"use strict";var n=a(0),r=a.n(n);t.a=({className:e,pmid:t,children:a="PubMed"})=>t?r.a.createElement("a",{className:e,href:`http://www.ncbi.nlm.nih.gov/pubmed/${t}`,target:"_blank",rel:"noopener",title:`PMID ${t}`},a):null},function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(158);t.a=({className:e,level:t="1",children:a})=>r.a.createElement(s.a,{className:e,tag:`h${t}`},a)},,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));const n=({upload:e})=>e.progress.recovery,r=e=>n(e).pendingFiles,s=e=>n(e).filenameToGenomeId,o=e=>n(e).fileIds},function(e,t,a){"use strict";a.d(t,"c",(function(){return p})),a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return f}));var n=a(512),r=a.n(n),s=a(511),o=a.n(s),l=a(265),i=a(15);const{origin:c=window.location.origin,clientId:u}=i.a;function m(e,t,a,n){return fetch(`${i.a.assemblerAddress}${t}`,{method:e,mode:"cors",headers:{...a,"Content-Type":"application/json"},body:JSON.stringify(n)})}function d(e,t,a,n){return{type:"UPLOAD_READS_PROGRESS",payload:{stage:e,id:t,filename:a,progress:n}}}function p(e,{token:t,uploadedAt:a},n){const s=o()();s.onmessage=({data:t})=>{t.progress&&n(d("IDENTIFY",e.id,t.file,t.progress))};const p={Authorization:`Bearer ${t}`},h=new r.a({target:`${i.a.assemblerAddress}/chunks`,simultaneousUploads:5,generateUniqueIdentifier:e=>s.hash(e),headers:p});return h.on("chunkingProgress",(t,a)=>{n(d("PREPARE",e.id,t.fileName,100*a))}),h.on("chunkingComplete",t=>{n(d("PREPARE",e.id,t.fileName,100))}),h.on("fileProgress",t=>{n(d("UPLOAD",e.id,t.fileName,100*t.progress()))}),new Promise((t,n)=>{let r=!1;h.on("error",(e,t)=>{n({message:e,file:t})}),h.on("complete",()=>{const s=[Object(l.c)(e.id)];r||s.push(m("PATCH","/api/pipelines",p,{session:a,genomeId:e.id,status:"READS_UPLOADED"}).then(e=>{200!==e.status&&n({message:e.statusText})})),Promise.all(s).then(t).catch(n)}),h.on("filesAdded",t=>{if(e.recovery){for(const{fileId:a}of e.recovery){let e=null;for(const n of t){if(n.uniqueIdentifier===a){e=null;break}e=n.fileName}if(e)return void n({message:`${e} does not match the original file, please try again.`})}h.upload()}else m("POST","/api/pipelines",p,{session:a,genomeId:e.id,callback:`${c}/api/genome/${e.id}/assembly?clientId=${u}`,progress:{channel:`${u}-assembly`,topic:a},files:t.map(e=>({filename:e.fileName,fileId:e.uniqueIdentifier,totalChunks:e.chunks.length}))}).then(e=>{304===e.status?(r=!0,h.fire("complete")):201!==e.status?n({message:e.statusText}):h.upload()}).catch(e=>n({message:e.message}))}),h.addFiles(e.files.map(e=>e.handle))})}function h(e,t){return new Promise((a,n)=>m("GET",`/api/sessions/${e}`,{Authorization:`Bearer ${t}`}).then(e=>{200===e.status?a(e.json()):404===e.status?n({type:"NOT_FOUND"}):n({message:e.statusText})}))}function f(e,t){return new Promise((a,n)=>m("GET",`/api/sessions/${e}/progress`,{Authorization:`Bearer ${t}`}).then(e=>{200===e.status?a(e.json()):n({message:e.statusText})}))}},function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(893),o=a(486),l=a(474),i=a.n(l),c=(a(925),a(927),a(929),a(3)),u=a(4),m=a.n(u),d=a(63),p=(a(933),a(477)),h=a.n(p),f=(a(945),a(947),a(17)),g=a.n(f),b=a(24),y=r.a.createClass({displayName:"Overlay.react",propTypes:{visible:r.a.PropTypes.bool.isRequired,hide:r.a.PropTypes.func,children:r.a.PropTypes.node},componentDidMount(){window.addEventListener("keydown",this.closeMenuOnEsc)},componentWillUnmount(){window.removeEventListener("keydown",this.closeMenuOnEsc)},closeMenuOnEsc(e){this.props.visible&&27===e.keyCode&&this.props.hide()},render(){const{visible:e,children:t,hide:a,className:n,...s}=this.props;return r.a.createElement(b.a,{out:!0},e&&r.a.createElement("div",g()({onClick:a,className:m()(n,"wgsa-overlay",{"wgsa-overlay--no-content":!t})},s),t))}}),E=r.a.createClass({displayName:"Component.react",propTypes:{actions:r.a.PropTypes.array,children:r.a.PropTypes.node,onClose:r.a.PropTypes.func,title:r.a.PropTypes.node},getDefaultProps:()=>({actions:[]}),render(){return r.a.createElement("div",{className:m()("wgsa-modal-container",this.props.containerClassName)},r.a.createElement(y,{visible:this.props.isOpen,hide:this.props.onClose},r.a.createElement("aside",{className:m()("wgsa-modal",this.props.className)},r.a.createElement("header",{onClick:e=>e.stopPropagation()},this.props.title,r.a.createElement("div",{className:"wgsa-modal-actions"},this.props.actions,r.a.createElement("button",{className:"mdl-button mdl-button--icon",title:"Close",onClick:this.props.onClose},r.a.createElement("i",{className:"material-icons"},"close")))),r.a.cloneElement(this.props.children,{onClick:e=>e.stopPropagation()}))))}}),v=a(286),C=a(85),w=a(155),S=a(18),N=a(120),O=a(26),x=a(186);function k(e,t,a=!0){return(n,s)=>{const o=Object(w.getFilter)(s(),{stateKey:C.b}),l=()=>n(k(e,!t,!1));return Object(x.a)(e.map(e=>e.id),t).then(({binned:s})=>0===s?Promise.resolve():(n(Object(O.i)(e)),Promise.all([n(Object(S.e)()),n(Object(S.h)(o)),n(Object(N.b)())]).then(()=>a&&n(Object(d.c)(function(e,t,a){return{action:{label:"Undo",onClick:a},message:r.a.createElement("span",null,r.a.createElement("strong",null,e," genome",1===e?"":"s")," ",t?"restored from":"moved to"," bin.")}}(s,!t,l)))))).catch(()=>n(Object(d.c)({message:"Something went wrong, please try again later."})))}}var _=Object(c.a)(null,(function(e,{genome:t}){return{moveToBin:()=>e(k([t],!0)),restoreFromBin:()=>e(k([t],!1))}}))(({genome:e={},...t})=>"me"!==e.owner?null:r.a.createElement(v.a,g()({item:e},t))),I=a(129),T=a(16),j=a(6);function A(e){for(const t in T.a)if(-1!==e.indexOf(t))return e;return`${e}.fasta`}var P=({id:e,name:t})=>r.a.createElement("a",{href:Object(j.c)(`/download/genome/${e}/fasta`),download:A(t),target:"_blank",rel:"noopener",title:"Download genome",className:"wgsa-download-button mdl-button mdl-button--icon"},r.a.createElement(I.a,{color:T.b.COLOURS.PURPLE,label:".fa"})),R=a(42),M=({complete:e,placeholder:t,children:a,wait:n=280})=>{const[s,o]=r.a.useState(e);return r.a.useEffect(()=>{setTimeout(()=>o(!0),n)},[]),r.a.createElement(b.a,null,e&&s?r.a.cloneElement(a,{key:"loaded"}):r.a.cloneElement(t,{key:"loading"}))},D=a(141),F=a(214),z=a(49),G=a(157),U=a(212);var B=Object(c.a)((function(e){return{brandingId:e.branding.id}}))(({brandingId:e})=>U.b[e]);const $={WGSA:"/images/WGSA.FINAL.svg",Pathogenwatch:"/images/pathogenwatch-saira-semicondensed.svg",PathogenDotWatch:"/images/pathogen-dot-watch-saira-caps.svg"};var H=Object(c.a)((function(e){return{brandingId:e.branding.id}}))(({className:e,brandingId:t})=>r.a.createElement("img",{className:e,src:$[t]}));const V={WGSA:"/images/WGSA.Icon.FINAL.svg",Pathogenwatch:"/images/pathogenwatch-icon.svg",PathogenDotWatch:"/images/pathogenwatch-icon.svg"};var K=Object(c.a)((function(e){return{brandingId:e.branding.id}}))(({className:e,brandingId:t})=>r.a.createElement("img",{className:e,src:V[t]})),q=a(50);const W=({analysis:e})=>{const{speciator:t,serotype:a={}}=e;return t?"28901"===t.speciesId?r.a.createElement(D.a,{abbreviated:!0,speciesName:t.speciesName,subspecies:a.subspecies,serotype:a.value}):r.a.createElement(D.a,{speciesName:t.speciesName}):r.a.createElement("em",null,"Species prediction pending")};var Y=({genome:e})=>{const{analysis:t={},country:a,pmid:n}=e,s=Object(z.c)(e);return r.a.createElement("div",{className:"wgsa-genome-report-summary"},r.a.createElement("header",null,r.a.createElement("h1",{title:e.name,className:"h2"},e.name),r.a.createElement(H,null)),r.a.createElement("p",{className:"h6 pw-genome-report-summary-subtitle"},r.a.createElement(W,{analysis:t})),(s||a||n)&&r.a.createElement("dl",null,a&&r.a.createElement("div",{className:"pw-genome-report-metadata inline"},r.a.createElement("dt",null,"Country"),r.a.createElement("dd",null,Object(G.b)(a))),s&&r.a.createElement("div",{className:"pw-genome-report-metadata inline"},r.a.createElement("dt",null,"Date"),r.a.createElement("dd",null,s)),n&&r.a.createElement("div",{className:"pw-genome-report-metadata inline"},r.a.createElement("dt",null,"PMID"),r.a.createElement("dd",null,r.a.createElement(F.a,{pmid:n},n)))))};const Z=({label:e,children:t,inline:a,className:n})=>{return""!==(s=t)&&null!=s?r.a.createElement("div",{className:m()("pw-genome-report-metadata",n,{inline:a})},r.a.createElement("dt",null,e),r.a.createElement("dd",null,function(e){return r.a.isValidElement(e)?e:Array.isArray(e)?r.a.createElement("em",null,"Array"):"object"==typeof e?r.a.createElement("em",null,"Object"):e}(t))):null;var s},X=r.a.createClass({displayName:"VersionSwitcher",getInitialState(){const{genome:e,taskName:t}=this.props,{analysis:a}=e;return{version:a[t].__v}},getVersions(){const{genome:e,taskName:t}=this.props,{tasks:a=[]}=e,n=[];for(const{task:e,version:s}of a)e===t&&n.push(r.a.createElement("button",{key:s,className:m()("wgsa-analysis-version",{"is-active":s===this.state.version}),onClick:()=>this.setState({version:s})},s));return n},render(){const{genome:e,taskName:t}=this.props,a=this.props.component,n=this.getVersions(e,t);return r.a.createElement(r.a.Fragment,null,n.length>0&&r.a.createElement("aside",{className:"wgsa-genome-detail-version"},"Version: ",n),r.a.createElement(a,{result:e.analysis[t],genome:e}))}});var Q=({genome:e})=>{const{userDefined:t={}}=e;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Metadata"),r.a.createElement("dl",{className:"grid"},Object.keys(t).map(e=>r.a.createElement(Z,{key:e,label:e},t[e]))))},J=a(375),ee=(a(971),a(15));const{key:te,cluster:ae}=ee.a.pusher||{};let ne=null;function re(e,t,a){return null===ne&&(console.log("[Pusher] Connecting"),ne=new Pusher(te,{cluster:ae,encrypted:!0})),console.log("[Pusher] Subscribing to",e,t),ne.subscribe(e).bind(t,a)}function se(e){console.log("[Pusher] Unsubscribing from",e),null!==ne&&(ne.unsubscribe(e),0===ne.allChannels().length&&(console.log("[Pusher] Disconnecting"),ne.disconnect(),ne=null))}var oe=r.a.createClass({displayName:"Notify.react",componentWillMount(){this.subscribe()},componentDidUpdate(){this.isSubscribed||this.subscribe()},componentWillUnmount(){const{room:e=ee.a.clientId}=this.props;e&&this.isSubscribed&&se(e)},isSubscribed:!1,subscribe(){const{room:e=ee.a.clientId,topic:t,onMessage:a}=this.props;e&&(re(e,t,a),this.isSubscribed=!0)},render(){return this.props.children}}),le=r.a.createClass({displayName:"Poller.react",componentDidMount(){this.interval=setInterval(this.props.fn,1e3*this.props.interval),this.props.fn()},componentWillUnmount(){clearInterval(this.interval)},render(){return this.props.children||null}});a(973);class ie extends r.a.Component{constructor(e){super(e),this.state={}}render(){const e=this.props.radius-this.props.strokeWidth/2,t=`0 0 ${2*this.props.radius} ${2*this.props.radius}`,a=e*Math.PI*2,n=a-a*this.props.percentage/100;return r.a.createElement("svg",{className:`CircularProgress ${this.props.percentage>=100?"CircularProgress-success":""}`.trim(),width:2*this.props.radius,height:2*this.props.radius,viewBox:t},r.a.createElement("circle",{className:"CircularProgress-Bg",cx:this.props.radius,cy:this.props.radius,r:e,strokeWidth:`${this.props.strokeWidth}px`}),r.a.createElement("circle",{className:"CircularProgress-Fg",cx:this.props.radius,cy:this.props.radius,r:e,stroke:this.props.colour||"#673c90",strokeWidth:`${this.props.strokeWidth}px`,style:{strokeDasharray:a,strokeDashoffset:n}}),r.a.createElement("text",{className:"CircularProgress-Text",x:this.props.radius,y:this.props.radius,dy:".4em",textAnchor:"middle"},`${this.props.percentage.toFixed(this.props.decimalPlaces)}%`))}}ie.propTypes={decimalPlaces:r.a.PropTypes.number,percentage:r.a.PropTypes.number,radius:r.a.PropTypes.number,strokeWidth:r.a.PropTypes.number},ie.defaultProps={decimalPlaces:0,percentage:50,radius:50,strokeWidth:1};var ce=a(2),ue=a(235),me=a(101);const de={0:"#673c90",1:"#b199c7","-1":"#9eb8c0"},pe={0:"#9a6fc3",1:"#e3dbeb"};pe[-1]="#dae4e7";const he=e=>e.clustering||{},fe=e=>he(e).index||{},ge=e=>he(e).selectedGenomeId,be=e=>he(e).status,ye=e=>he(e).threshold,Ee=e=>he(e).triedBuilding,ve=e=>he(e).edgeMatrix,Ce=e=>he(e).progress,we=e=>he(e).allSchemeSts,Se=e=>he(e).indexOfSelectedInAll,Ne=e=>he(e).taskId,Oe=e=>he(e).scheme,xe=e=>he(e).version,ke=e=>he(e).nodes,_e=Object(ce.createSelector)(ve,e=>(e||[]).filter(e=>1===e).length),Ie=(Object(ce.createSelector)(_e,e=>e>0),Object(ce.createSelector)(ye,fe,(e,{pi:t,lambda:a})=>{if(0!==(t||[]).length)return Object(ue.a)(e,t,a)})),Te=Object(ce.createSelector)(Se,we,Ie,(e,t,a)=>{if(a)return t.filter((t,n)=>a[n]===a[e])}),Le=Object(ce.createSelector)(Te,ke,(e=[],t)=>e.map(e=>t[e])),je=Object(ce.createSelector)(Te,e=>(e||[]).length),Ae=Object(ce.createSelector)(Se,Ie,we,Te,(e,t,a,n)=>{if(!t)return;const r=a[e];return n.indexOf(r)}),Pe=Object(ce.createSelector)(Se,Ie,Le,(e,t,a)=>{if(!t)return;const n=[];for(let e=0;e<a.length;e++){const{ids:t}=a[e];n.push(t)}return n}),Re=Object(ce.createSelector)(Le,e=>{if(e)return e.map(e=>0===e.ids.length?"Unnamed":1===e.ids.length?e.label:2===e.ids.length?`${e.label} and one other`:`${e.label} and ${e.ids.length-1} others`)}),Me=Object(ce.createSelector)(ve,Ae,(function(e,t){if(!e)return;const a=[];let n=0;for(let t=0;n<e.length;t++){const r={neighbours:[],explored:!1,degrees:3};a.push(r);for(let s=0;s<t;s++){const t=a[s];e[n]&&(r.neighbours.push(t),t.neighbours.push(r)),n++}}let r=[a[t]];for(let e=0;e<3;e++){let t=[];for(const a of r)a.explored||(t=[...t,...a.neighbours],a.degrees=e,a.explored=!0);r=t}return a.map(e=>e.degrees)})),De=Object(ce.createSelector)(Me,e=>e?e.map(e=>de[e]||de[-1]):void 0),Fe=Object(ce.createSelector)(Pe,e=>e?function(e){const t=Math.max(...e),a=Math.min(...e),n=t-a;return 0===n?e.map(()=>.5):e.map(e=>.5+(e-a)/n)}(e.map(e=>e.length**.3)):void 0),ze=Object(ce.createSelector)(Me,(function(e){if(!e)return;const t=[];for(let a=1;a<e.length;a++)for(let n=0;n<a;n++){const r=Math.min(e[a],e[n]);t.push(r)}return t})),Ge=Object(ce.createSelector)(ze,e=>e?e.map(e=>pe[e]||pe[-1]):void 0),Ue=[...Array(me.d+1)].map((e,t)=>t),Be=()=>Ue,$e=Object(ce.createSelector)(we,ke,(e,t)=>t?e.map(e=>t[e].ids.length):void 0),He=Object(ce.createSelector)(Se,Be,fe,$e,(e,t,{pi:a,lambda:n},r)=>{if(a)return t.map(t=>{const s=Object(ue.a)(t,a,n),o=s[e];let l=0;for(let e=0;e<r.length;e++)s[e]===o&&(l+=r[e]);return l})}),Ve=Object(ce.createSelector)(Se,Be,fe,(e,t,{pi:a,lambda:n})=>{if(a)return t.map(t=>{const r=Object(ue.a)(t,a,n),s=r[e];let o=0;for(const e of r)e===s&&o++;return o})}),Ke=Object(ce.createSelector)(Be,ye,He,(e=[],t,a=[])=>{if(t in e)return a[e.indexOf(t)]}),qe="#ccc",We="#b199c7",Ye="#673c90",Ze=Object(ce.createSelector)(Ve,ye,(e,t)=>{if(!e)return;const a=[],n=[];for(let r=0;r<e.length;r++){e[r]>me.b?(a.push(qe),n.push(qe)):(a.push(r===t?Ye:We),n.push(Ye))}return{status:a,hover:n}});const Xe=Object(ce.createSelector)(be,Te,ke,Ae,Re,Fe,De,Me,e=>he(e).nodeCoordinates||[],ve,Ge,ze,(function(e,t,a,n,r,s,o,l,i,c,u,m){const d=[],p=[];if(!t)return{nodes:d,edges:p};const h=t.length;if(0===h)return{nodes:[],edges:[]};if(1===h){const e=t[0];return{nodes:[{label:r[0],_label:r[0],color:de[0],genomeIds:a[e].ids,id:e,size:1,style:{colour:de[0],shape:"circle"},zIndex:0,x:0,y:0}],edges:[]}}if(!c)return{nodes:d,edges:p};let f=0;for(let g=0;g<h;g++){const b="COMPLETED_LAYOUT"===e&&g===n,y=t[g];d.push({label:b?r[g]:void 0,color:b?o[g]:void 0,hoverLabel:b?void 0:r[g],id:y,genomeIds:a[y].ids,size:s[g],style:{colour:o[g],shape:"circle"},zIndex:l[g],x:y in i?i[y].x:Math.cos(2*g*Math.PI/h),y:y in i?i[y].y:Math.sin(2*g*Math.PI/h)});for(let e=0;e<g;e++)c[f]&&p.push({id:`e${f}`,source:t[e],target:t[g],style:{colour:u[f]},zIndex:m[f]}),f++}return d.sort((e,t)=>t.zIndex-e.zIndex),p.sort((e,t)=>t.zIndex-e.zIndex),{nodes:d,edges:p}}));var Qe=a(41);class Je extends r.a.Component{constructor(){super(),this.getQueuePosition=()=>{this.props.taskId&&Object(j.a)("GET",`/api/genome/${this.props.genomeId}/clusters/position`,{taskId:this.props.taskId}).then(({position:e})=>this.setState({position:e})).catch(e=>{console.error(e),this.props.updateProgress({status:"FAILED"})})},this.renderQueuePosition=()=>{const{position:e}=this.state;return null===e?"Awaiting Queue Position":0===e?"Awaiting Progress":`Queue Position: ${e}`},this.state={position:null}}render(){const{taskId:e}=this.props;return r.a.createElement(oe,{room:e,topic:"clustering",onMessage:this.props.updateProgress},r.a.createElement("div",{className:"pw-cluster-content pw-cluster-progress"},this.props.progress>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(ie,{percentage:this.props.progress,radius:"64",strokeWidth:"12",decimalPlaces:1}),r.a.createElement("p",{className:"wgsa-blink"},r.a.createElement("strong",null,"Running"))):r.a.createElement(r.a.Fragment,null,e&&r.a.createElement(le,{interval:10,fn:()=>this.getQueuePosition()}),r.a.createElement("strong",null,"Job Queued"),r.a.createElement("p",{className:"wgsa-blink"},this.renderQueuePosition()))))}}var et=Object(c.a)((function(e){return{genomeId:ge(e),progress:Ce(e),taskId:Ne(e)}}),(function(e){return{updateProgress:t=>e(Object(Qe.p)(t))}}))(Je);var tt=Object(c.a)((function(e){return{genomeId:ge(e)}}),null,(function({genomeId:e},{dispatch:t},a){return{...a,onClick:()=>t(Object(Qe.i)(e))}}))(({onClick:e,children:t,primary:a})=>r.a.createElement("button",{className:m()("mdl-button mdl-button--raised",{"mdl-button--colored":a}),onClick:e},t));const at=()=>r.a.createElement("div",{className:"pw-cluster-content"},r.a.createElement("p",null,"Clusters have not been calculated for this genome."),r.a.createElement(tt,{primary:!0},"Run Clustering")),nt=()=>r.a.createElement("div",{className:"pw-cluster-content"},r.a.createElement("p",null,"Something went wrong 😞"),r.a.createElement(tt,null,"Try Again")),rt=r.a.createClass({displayName:"Clustering",componentDidMount(){this.update()},componentDidUpdate(e){this.update(e)},update(e={}){const{props:t}=this;"INITIAL_STATUS"===t.status&&"INITIAL_STATUS"!==e.status?t.fetch(this.props.selectedGenomeId):"BUILT_CLUSTERS"===t.status&&"BUILT_CLUSTERS"!==e.status?t.fetch(this.props.selectedGenomeId):"FETCHED_CLUSTERS"===t.status&&"FETCHED_CLUSTERS"!==e.status&&(t.numberOfNodesInCluster>1?t.fetchEdgeMatrix(t):t.skipLayout(this.props.graph.nodes))},render(){const{status:e}=this.props;switch(e){case"INITIAL_STATUS":return r.a.createElement(at,null);case"FETCHING_CLUSTERS":return r.a.createElement("div",{className:"pw-cluster-content"},r.a.createElement("p",{className:"wgsa-blink"},"Checking Status"));case"BUILDING_CLUSTERS":case"BUILT_CLUSTERS":return r.a.createElement(et,null);case"FETCHED_CLUSTERS":case"FETCHING_EDGES":case"FETCHED_EDGES":case"RUNNING_LAYOUT":case"COMPLETED_LAYOUT":case"SKIP_NETWORK":return this.props.children;case"FAILED_FETCHING_CLUSTERS":return this.props.triedBuilding?r.a.createElement(nt,null):r.a.createElement(at,null);case"FAILED_BUILDING_CLUSTERS":case"FAILED_FETCHING_EDGES":default:return r.a.createElement(nt,null)}}});var st=Object(c.a)((function(e){return{clusterSts:Te(e),graph:Xe(e),numberOfNodesInCluster:je(e),selectedGenomeId:ge(e),status:be(e),threshold:ye(e),triedBuilding:Ee(e),scheme:Oe(e),version:xe(e)}}),(function(e){return{build:t=>e(Qe.i(t)),fetch:t=>e(Qe.j(t)),fetchEdgeMatrix:({selectedGenomeId:t,scheme:a,version:n,threshold:r,clusterSts:s})=>e(Qe.k(t,a,n,r,s)),skipLayout:t=>e(Qe.m(t))}}))(rt),ot=(a(975),a(1)),lt=a.n(ot),it=(a(977),a(981),a(488)),ct=a.n(it),ut=a(230);const mt={down:"top",up:"bottom"};function dt({top:e=0,height:t=0},a,n){return{maxHeight:"up"===n?`${e-40}px`:`calc(100vh - ${e+t+40}px)`,transformOrigin:`${mt[n]} ${a}`}}class pt extends r.a.Component{constructor(e){super(e),this.handleOutClick=e=>{const{current:t}=this.buttonRef;t&&t.contains(e.target)||this.props.toggle()},this.handleKeyUp=e=>{27===e.keyCode&&this.props.toggle()},this.buttonRef=r.a.createRef()}render(){const{align:e="left",button:t,caret:a=!1,children:n,className:s,direction:o="down",header:l,open:i=!1,style:c,toggle:u,toggleOnClick:d=!0}=this.props,p=this.el?this.el.getBoundingClientRect():{},{height:h=0}=p;return r.a.createElement("div",{className:m()("libmr-Menu",{open:i,caret:a},s),onKeyUp:i?e=>this.handleKeyUp(e):null,ref:e=>{this.el=e},style:c,tabIndex:"-1"},r.a.cloneElement(t,{ref:this.buttonRef,onClick:u,open:i}),r.a.createElement(ct.a,{className:"libmr-RelativePortal",component:"div",right:"right"===e?0:void 0,bottom:"up"===o?h:void 0,onOutClick:i?e=>this.handleOutClick(e):null},r.a.createElement(ut.a,{visible:i,removeOnLeave:!0,motionName:"libmr"},t=>r.a.createElement("div",{className:m()("libmr-Menu-element",e,o,{caret:a},s,t.className),style:dt(p,e,o),tabIndex:"-1"},l,r.a.createElement("div",{className:"libmr-Menu-content",onClick:d?u:null},n)))))}}pt.propTypes={active:lt.a.bool,align:lt.a.oneOf(["left","right"]),button:lt.a.node,caret:lt.a.bool,children:lt.a.node,className:lt.a.string,direction:lt.a.oneOf(["up","down"]),header:lt.a.node,open:lt.a.bool,style:lt.a.object,toggle:lt.a.func,toggleOnClick:lt.a.bool};var ht=pt;const ft=e=>t=>{const[a,n]=r.a.useState(!1);return r.a.createElement(e,{...t,open:a,toggle:()=>n(!a)})};a(984);const gt=r.a.forwardRef(({children:e,className:t,onClick:a,title:n},s)=>r.a.createElement("button",{className:m()("mdc-icon-button",t),onClick:a,ref:s,title:n},e));gt.propTypes={children:lt.a.node,className:lt.a.string,onClick:lt.a.func,title:lt.a.string};var bt=gt;a(987);const yt=r.a.forwardRef(({active:e,children:t,className:a,clear:n,direction:s="down",label:o=t,onClick:l,open:i,title:c},u)=>r.a.createElement("span",{ref:u,role:"button",className:m()("libmr-MenuButton",{active:e,open:i},a),onClick:l,title:c},"string"==typeof o?r.a.createElement("span",null,o):o,e&&n?r.a.createElement("button",{className:"libmr-MenuButton-clear",onClick:n},r.a.createElement("i",{className:"material-icons",onClick:n},"cancel")):r.a.createElement("i",{className:"material-icons"},"arrow_drop_",s)));yt.propTypes={active:lt.a.bool,children:lt.a.node,className:lt.a.string,clear:lt.a.func,direction:lt.a.oneOf(["down","up"]),label:lt.a.node,onClick:lt.a.func,open:lt.a.bool,title:lt.a.string};var Et=yt;a(989);const vt=e=>r.a.createElement(ut.a,{visible:e.in,removeOnLeave:!0,motionName:"libmr-Fade"},t=>r.a.cloneElement(e.children,{className:m()(e.children.props.className,t.className)}));vt.propTypes={children:lt.a.element,in:lt.a.bool};var Ct=vt;class wt extends r.a.Component{constructor(...e){var t;return t=super(...e),this.state={isActive:!1},t}componentDidUpdate(e,t){this.state.isActive!==t.isActive&&(this.state.isActive?this.searchInput.focus():this.props.value&&this.props.onChange())}render(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(bt,{onClick:()=>this.setState({isActive:!this.state.isActive})},r.a.createElement("i",{className:"material-icons"},"search")),r.a.createElement(Ct,{in:this.state.isActive},r.a.createElement("input",{className:"libmr-search-input",type:"text",placeholder:"Search",value:this.props.value,onChange:e=>this.props.onChange(e.target.value),ref:e=>{this.searchInput=e}})))}}wt.displayName="Search",wt.propTypes={value:lt.a.string,onChange:lt.a.func};class St extends r.a.Component{constructor(...e){var t;return t=super(...e),this.handleClear=e=>{this.props.open||e.stopPropagation(),this.props.clear()},t}render(){const{active:e,className:t,header:a=!0,open:n,search:s,size:o="standard",summary:l,title:i,toggle:c,toggleOnClick:u=!1}=this.props,d="active"in this.props?e:!!l;return r.a.createElement(ht,g()({},this.props,{active:d,className:m()("libmr-ControlsMenu",t,o,{active:d}),header:a&&r.a.createElement("header",null,r.a.createElement("h3",null,i),s&&r.a.createElement(wt,s),r.a.createElement(bt,{onClick:c},r.a.createElement("i",{className:"material-icons"},"close"))),button:r.a.createElement(Et,{title:i,open:n,active:d,label:l||i,clear:d?e=>this.handleClear(e):null}),toggleOnClick:u}))}}St.propTypes={...ht.propTypes,clear:lt.a.func,header:lt.a.bool,search:lt.a.shape({value:lt.a.string,onChange:lt.a.func}),size:lt.a.oneOf(["standard","narrow"]),summary:lt.a.node,title:lt.a.string};var Nt=ft(St),Ot=(a(991),a(180)),xt=a.n(Ot),kt=a(489),_t=a.n(kt);const It=({id:e,...t})=>r.a.createElement(xt.a,{className:m()("libmr-ToggleSwitch",t.className,{"is-checked":t.isChecked}),id:e},r.a.createElement("label",null,t.label),r.a.createElement(_t.a,{checked:t.isChecked,onChange:()=>t.onChange(!t.isChecked)}));It.propTypes={className:lt.a.string,id:lt.a.string,isChecked:lt.a.bool,label:lt.a.node,onChange:lt.a.func};var Tt=It;a(995);const Lt=({id:e,...t})=>r.a.createElement("div",{className:m()("libmr-Slider",t.className),style:{"--min":t.min,"--max":t.max,"--val":t.value,...t.style}},r.a.createElement("label",{htmlFor:e},t.label,": ",t.displayValue||t.value,t.unit),r.a.createElement("input",{id:e,type:"range",min:t.min,max:t.max,value:t.value,onChange:e=>t.onChange(parseInt(e.target.value,10))}),r.a.createElement("span",{className:"libmr-Slider-focus-ring"}));Lt.propTypes={className:lt.a.string,displayValue:lt.a.number,id:lt.a.string.isRequired,label:lt.a.node.isRequired,max:lt.a.number.isRequired,min:lt.a.number.isRequired,onChange:lt.a.func.isRequired,unit:lt.a.string,style:lt.a.object,value:lt.a.number.isRequired};var jt=Lt;class At extends r.a.Component{constructor(...e){var t;return t=super(...e),this.state={isOpen:!1},t}render(){const{props:e}=this;return r.a.createElement(Nt,{className:"mr-menu mr-tree-styles-menu",open:this.state.isOpen,title:"Nodes & Labels",toggle:()=>this.setState({isOpen:!this.state.isOpen})},r.a.createElement(jt,{label:"Node Size",onChange:e.onNodeSizeChange,min:e.minNodeSize,max:e.maxNodeSize,value:e.nodeSize}),r.a.createElement(jt,{label:"Label Size",onChange:e.onLabelSizeChange,min:e.minLabelSize,max:e.maxLabelSize,value:e.labelSize}),r.a.createElement("hr",null),r.a.createElement(Tt,{className:"mr-toggle-switch",label:"Show Nodes",isChecked:e.showNodes,onChange:t=>e.onShowNodesChange(t)}),r.a.createElement(Tt,{className:"mr-toggle-switch",label:"Show Labels",isChecked:e.showLabels,onChange:t=>e.onShowLabelsChange(t)}))}}At.displayName="NetworkControlsMenu",At.propTypes={labelSize:lt.a.number.isRequired,maxLabelSize:lt.a.number.isRequired,maxNodeSize:lt.a.number.isRequired,minLabelSize:lt.a.number.isRequired,minNodeSize:lt.a.number.isRequired,nodeSize:lt.a.number.isRequired,onLabelSizeChange:lt.a.func.isRequired,onNodeSizeChange:lt.a.func.isRequired,onShowLabelsChange:lt.a.func,onShowNodesChange:lt.a.func,showLabels:lt.a.bool,showNodes:lt.a.bool};var Pt=a(490),Rt=a.n(Pt);a(997),a(999);const Mt=({className:e,active:t,...a})=>r.a.createElement(bt,g()({},a,{className:m()("libmr-ControlsButton",{active:t},e)}));Mt.propTypes={...bt.props,active:lt.a.bool};var Dt=Mt;a(1001);const Ft=({children:e,className:t,onZoomIn:a,onZoomOut:n})=>r.a.createElement("div",{className:m()("libmr-ZoomControls",t),draggable:"false"},r.a.createElement("div",{className:"libmr-ZoomControls-button",title:"Zoom in",onClick:a},r.a.createElement("i",{className:"libmr-ZoomControls-icon material-icons"},"zoom_in")),r.a.createElement("div",{className:"libmr-ZoomControls-divider"}),e?r.a.createElement(r.a.Fragment,null,e,r.a.createElement("div",{className:"libmr-ZoomControls-divider"})):null,r.a.createElement("div",{className:"libmr-ZoomControls-button",title:"Zoom out",onClick:n},r.a.createElement("i",{className:"libmr-ZoomControls-icon material-icons"},"zoom_out")));Ft.propTypes={className:lt.a.string,children:lt.a.node,onZoomIn:lt.a.func.isRequired,onZoomOut:lt.a.func.isRequired};var zt=Ft;const Gt=e=>r.a.createElement("div",{className:m()("libmr-Panel",e.className),style:e.style},e.children,r.a.createElement(Dt,{className:"libmr-Panel-controls-toggler",active:e.controlsVisible,title:e.controlsVisible?"Hide controls":"Show controls",onClick:()=>e.onControlsVisibleChange(!e.controlsVisible)},r.a.createElement("i",{className:"material-icons"},"tune")),r.a.createElement(Ct,{in:e.controlsVisible},r.a.createElement("div",{className:"libmr-Panel-primary-controls"},e.primaryControls)),r.a.createElement(Ct,{in:e.controlsVisible},r.a.createElement("div",{className:"libmr-Panel-secondary-controls"},e.secondaryControls)),!0===e.zoomControls&&r.a.createElement(Ct,{in:e.controlsVisible},r.a.createElement(zt,{onZoomIn:()=>e.onZoomChange(1),onZoomOut:()=>e.onZoomChange(-1)})),r.a.isValidElement(e.zoomControls)&&r.a.createElement(Ct,{in:e.controlsVisible},e.zoomControls));Gt.propTypes={className:lt.a.string,controlsVisible:lt.a.bool,style:lt.a.object,children:lt.a.node,primaryControls:lt.a.node,secondaryControls:lt.a.node,zoomControls:lt.a.oneOfType([lt.a.bool,lt.a.node]),onZoomChange:lt.a.func,onControlsVisibleChange:lt.a.func},Gt.defaultProps={zoomControls:!0};var Ut=Gt,Bt=e=>{const[t,a]=r.a.useState(!1);return r.a.createElement(Ut,g()({},e,{controlsVisible:t,onControlsVisibleChange:a}))};const $t=e=>r.a.createElement(Dt,{active:e.active,title:e.title||(e.active?"Disable lasso filter":"Activate lasso filter"),onClick:e.onClick},r.a.createElement("svg",{width:"22",height:"22",viewBox:"0 0 22 22",fill:"none",xmlns:"http://www.w3.org/2000/svg"},r.a.createElement("g",{opacity:"0.375"},r.a.createElement("path",{d:"M3.67997 3.667L3.80397 2.67472L2.32031 2.48932L2.71554 3.93133L3.67997 3.667ZM7.69982 18.3337L6.73539 18.598L6.9941 19.5419L7.94335 19.3036L7.69982 18.3337ZM18.3202 15.667L18.5637 16.6369L19.1078 16.5003L19.2748 15.9647L18.3202 15.667ZM14.474 4.00805L3.80397 2.67472L3.55598 4.65928L14.226 5.99262L14.474 4.00805ZM2.71554 3.93133L6.73539 18.598L8.66425 18.0693L4.6444 3.40267L2.71554 3.93133ZM7.94335 19.3036L18.5637 16.6369L18.0767 14.6971L7.45629 17.3638L7.94335 19.3036ZM19.2748 15.9647L21.9547 7.37215L20.0454 6.77667L17.3656 15.3693L19.2748 15.9647Z",fill:"black"})),r.a.createElement("path",{d:"M3.6799 6.33333C5.15997 6.33333 6.3598 5.13943 6.3598 3.66667C6.3598 2.19391 5.15997 1 3.6799 1C2.19983 1 1 2.19391 1 3.66667C1 5.13943 2.19983 6.33333 3.6799 6.33333Z",fill:"black"}),r.a.createElement("path",{d:"M14.3499 7.66634C15.83 7.66634 17.0298 6.47244 17.0298 4.99968C17.0298 3.52692 15.83 2.33301 14.3499 2.33301C12.8698 2.33301 11.67 3.52692 11.67 4.99968C11.67 6.47244 12.8698 7.66634 14.3499 7.66634Z",fill:"black"}),r.a.createElement("path",{d:"M7.69992 21.0003C9.17999 21.0003 10.3798 19.8064 10.3798 18.3337C10.3798 16.8609 9.17999 15.667 7.69992 15.667C6.21985 15.667 5.02002 16.8609 5.02002 18.3337C5.02002 19.8064 6.21985 21.0003 7.69992 21.0003Z",fill:"black"}),r.a.createElement("path",{d:"M18.3199 18.3333C19.8 18.3333 20.9998 17.1394 20.9998 15.6667C20.9998 14.1939 19.8 13 18.3199 13C16.8398 13 15.64 14.1939 15.64 15.6667C15.64 17.1394 16.8398 18.3333 18.3199 18.3333Z",fill:"black"})));$t.propTypes=Dt.propTypes;var Ht=$t,Vt=a(106),Kt=function(e,t){const a=e.x,n=e.y;let r=!1;for(let e=0,s=t.length-1;e<t.length;s=e++){const o=t[e].x,l=t[e].y,i=t[s].x,c=t[s].y;l>n!=c>n&&a<(i-o)*(n-l)/(c-l)+o&&(r=!r)}return r};function qt(e,t,a){const n=Object.assign({clearBeforeDraw:!1,dotsStyle:"#383838",isActive:!1,lineWidth:2,path:null,pointFillStyle:"#ffffff",pointSize:14,pointStrokeStyle:"#000000",strokeStyle:Vt.b.primaryColour,draw:()=>{const e=t.getContext("2d");n.clearBeforeDraw&&e.clearRect(0,0,t.width,t.height);const a=n.internalPath||n.path;if(n.isActive&&Array.isArray(a)&&a.length>0){const t=1;e.strokeStyle=n.strokeStyle,e.lineWidth=n.lineWidth*t,e.beginPath();const r=n.translateToCanvas(a);!function(e,t){e.moveTo(t[0].x,t[0].y);for(let a=1;a<t.length;a++)e.lineTo(t[a].x,t[a].y);e.stroke()}(e,r),e.lineWidth=1*t,e.fillStyle=n.pointFillStyle,e.strokeStyle=n.pointStrokeStyle,function(e,t,a,n){for(let r=0;r<t.length-(n?1:0);r++)e.fillRect(t[r].x-a,t[r].y-a,2*a,2*a),e.strokeRect(t[r].x-a+e.lineWidth,t[r].y-a+e.lineWidth,2*a-e.lineWidth,2*a-e.lineWidth)}(e,r,t*n.pointSize/2,!!n.path),e.closePath()}},destroy:()=>{e.removeEventListener("mousedown",o),e.removeEventListener("mouseup",l)},isPointInside:(e,t)=>Kt(e,t||n.path),onPathChange:e=>{n.setPath(e),n.draw()},onRedrawRequested:()=>{n.draw(),n.updateCanvas()},setActive:e=>{n.isActive=e,n.updateCanvas()},setPath:e=>{n.path=e,n.internalPath=null,n.updateCanvas()},translateToCanvas:e=>e,translateFromCanvas:(e,t)=>({x:e,y:t}),updateCanvas:()=>{n.isActive?Array.isArray(n.path)?(e.style.cursor=null,e.title="Click outside the path to clear"):(e.style.cursor="crosshair",e.title="Click to draw points"):(e.style.cursor=null,e.title="",n.internalPath&&(n.internalPath=null))}},a);let r=null,s=null;const o=e=>{r=e.offsetX,s=e.offsetY},l=e=>{Math.abs(r-e.offsetX)<5&&Math.abs(s-e.offsetY)<5&&(e=>{if(!n.isActive)return;const t=n.translateFromCanvas(e.offsetX,e.offsetY);if(Array.isArray(n.path))Kt(t,n.path)||n.onPathChange(null);else{if(n.internalPath||(n.internalPath=[]),n.internalPath.length>0){const t=n.pointSize,a=n.translateFromCanvas(e.offsetX-t,e.offsetY-t),r=n.translateFromCanvas(e.offsetX+t,e.offsetY+t);if(r.x>=n.internalPath[0].x&&a.x<=n.internalPath[0].x&&r.y>=n.internalPath[0].y&&a.y<=n.internalPath[0].y){const e=n.internalPath;return e.push(e[0]),n.internalPath=null,void n.onPathChange(e)}}n.internalPath.push(t),n.onRedrawRequested&&n.onRedrawRequested()}})(e),r=null,s=null};return e.addEventListener("mousedown",o,!1),e.addEventListener("mouseup",l,!1),n.updateCanvas(),n}var Wt=function(e,t){const a=e.renderers[0],n=a.domElements.mouse;a.initDOM("canvas","lasso");const r=a.domElements.lasso;n.parentElement.insertBefore(r,n);const s=a.width,o=a.height;a.width=0,a.height=0,a.resize(s,o);const l=qt(n,r,{clearBeforeDraw:!0,isActive:t.isActive,path:t.path,onPathChange:t.onPathChange,translateToCanvas:t=>function(e,t){const a=Math.cos(e.camera.angle)/e.camera.ratio,n=Math.sin(e.camera.angle)/e.camera.ratio,r=(e.renderers[0].width||0)/2-e.camera.x*a-e.camera.y*n,s=(e.renderers[0].height||0)/2-e.camera.y*a+e.camera.x*n,o=sigma.utils.getBoundaries(e.graph,"",!0);let l=o.minX,i=o.minY,c=o.maxX,u=o.maxY;const m=e.renderers[0].width,d=e.renderers[0].height;let p="outside"===e.settings("scalingMode")?Math.max(m/Math.max(c-l,1),d/Math.max(u-i,1)):Math.min(m/Math.max(c-l,1),d/Math.max(u-i,1));const h=(e.settings("rescaleIgnoreSize")?0:(e.settings("maxNodeSize")||o.sizeMax)/p)+(e.settings("sideMargin")||0);return c+=h,l-=h,u+=h,i-=h,p="outside"===e.settings("scalingMode")?Math.max(m/Math.max(c-l,1),d/Math.max(u-i,1)):Math.min(m/Math.max(c-l,1),d/Math.max(u-i,1)),t.map(e=>{const t=(e.x-(c+l)/2)*p,o=(e.y-(u+i)/2)*p;return{x:t*a+o*n+r,y:o*a+t*n+s}})}(e,t),translateFromCanvas:(t,a)=>function(e,t,a){const n=Math.cos(e.camera.angle)/e.camera.ratio,r=Math.sin(e.camera.angle)/e.camera.ratio,s=(t-((e.renderers[0].width||0)/2-e.camera.x*n-e.camera.y*r))/n,o=(a-((e.renderers[0].height||0)/2-e.camera.y*n+e.camera.x*r))/n,l=sigma.utils.getBoundaries(e.graph,"",!0);let i=l.minX,c=l.minY,u=l.maxX,m=l.maxY;const d=e.renderers[0].width,p=e.renderers[0].height;let h="outside"===e.settings("scalingMode")?Math.max(d/Math.max(u-i,1),p/Math.max(m-c,1)):Math.min(d/Math.max(u-i,1),p/Math.max(m-c,1));const f=(e.settings("rescaleIgnoreSize")?0:(e.settings("maxNodeSize")||l.sizeMax)/h)+(e.settings("sideMargin")||0);return u+=f,i-=f,m+=f,c-=f,h="outside"===e.settings("scalingMode")?Math.max(d/Math.max(u-i,1),p/Math.max(m-c,1)):Math.min(d/Math.max(u-i,1),p/Math.max(m-c,1)),{x:s/h+(u+i)/2,y:o/h+(m+c)/2}}(e,t,a),onRedrawRequested:()=>{l.draw(),l.updateCanvas()}});return e.renderers[0].bind("render",l.draw),l},Yt=a(491),Zt=a.n(Yt);const Xt=["scene","mouse","lasso"];const Qt=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|[\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|[\ud83c[\ude32-\ude3a]|[\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/,Jt={ad:"🇦🇩",ae:"🇦🇪",af:"🇦🇫",ag:"🇦🇬",ai:"🇦🇮",al:"🇦🇱",am:"🇦🇲",ao:"🇦🇴",aq:"🇦🇶",ar:"🇦🇷",as:"🇦🇸",at:"🇦🇹",au:"🇦🇺",aw:"🇦🇼",ax:"🇦🇽",az:"🇦🇿",ba:"🇧🇦",bb:"🇧🇧",bd:"🇧🇩",be:"🇧🇪",bf:"🇧🇫",bg:"🇧🇬",bh:"🇧🇭",bi:"🇧🇮",bj:"🇧🇯",bl:"🇧🇱",bm:"🇧🇲",bn:"🇧🇳",bo:"🇧🇴",bq:"🇧🇶",br:"🇧🇷",bs:"🇧🇸",bt:"🇧🇹",bv:"🇧🇻",bw:"🇧🇼",by:"🇧🇾",bz:"🇧🇿",ca:"🇨🇦",cc:"🇨🇨",cd:"🇨🇩",cf:"🇨🇫",cg:"🇨🇬",ch:"🇨🇭",ci:"🇨🇮",ck:"🇨🇰",cl:"🇨🇱",cm:"🇨🇲",cn:"🇨🇳",co:"🇨🇴",cr:"🇨🇷",cu:"🇨🇺",cv:"🇨🇻",cw:"🇨🇼",cx:"🇨🇽",cy:"🇨🇾",cz:"🇨🇿",de:"🇩🇪",dj:"🇩🇯",dk:"🇩🇰",dm:"🇩🇲",do:"🇩🇴",dz:"🇩🇿",ec:"🇪🇨",ee:"🇪🇪",eg:"🇪🇬",eh:"🇪🇭",er:"🇪🇷",es:"🇪🇸",et:"🇪🇹",eu:"🇪🇺",fi:"🇫🇮",fj:"🇫🇯",fk:"🇫🇰",fm:"🇫🇲",fo:"🇫🇴",fr:"🇫🇷",ga:"🇬🇦",gb:"🇬🇧",gd:"🇬🇩",ge:"🇬🇪",gf:"🇬🇫",gg:"🇬🇬",gh:"🇬🇭",gi:"🇬🇮",gl:"🇬🇱",gm:"🇬🇲",gn:"🇬🇳",gp:"🇬🇵",gq:"🇬🇶",gr:"🇬🇷",gs:"🇬🇸",gt:"🇬🇹",gu:"🇬🇺",gw:"🇬🇼",gy:"🇬🇾",hk:"🇭🇰",hm:"🇭🇲",hn:"🇭🇳",hr:"🇭🇷",ht:"🇭🇹",hu:"🇭🇺",id:"🇮🇩",ie:"🇮🇪",il:"🇮🇱",im:"🇮🇲",in:"🇮🇳",io:"🇮🇴",iq:"🇮🇶",ir:"🇮🇷",is:"🇮🇸",it:"🇮🇹",je:"🇯🇪",jm:"🇯🇲",jo:"🇯🇴",jp:"🇯🇵",ke:"🇰🇪",kg:"🇰🇬",kh:"🇰🇭",ki:"🇰🇮",km:"🇰🇲",kn:"🇰🇳",kp:"🇰🇵",kr:"🇰🇷",kw:"🇰🇼",ky:"🇰🇾",kz:"🇰🇿",la:"🇱🇦",lb:"🇱🇧",lc:"🇱🇨",li:"🇱🇮",lk:"🇱🇰",lr:"🇱🇷",ls:"🇱🇸",lt:"🇱🇹",lu:"🇱🇺",lv:"🇱🇻",ly:"🇱🇾",ma:"🇲🇦",mc:"🇲🇨",md:"🇲🇩",me:"🇲🇪",mf:"🇲🇫",mg:"🇲🇬",mh:"🇲🇭",mk:"🇲🇰",ml:"🇲🇱",mm:"🇲🇲",mn:"🇲🇳",mo:"🇲🇴",mp:"🇲🇵",mq:"🇲🇶",mr:"🇲🇷",ms:"🇲🇸",mt:"🇲🇹",mu:"🇲🇺",mv:"🇲🇻",mw:"🇲🇼",mx:"🇲🇽",my:"🇲🇾",mz:"🇲🇿",na:"🇳🇦",nc:"🇳🇨",ne:"🇳🇪",nf:"🇳🇫",ng:"🇳🇬",ni:"🇳🇮",nl:"🇳🇱",no:"🇳🇴",np:"🇳🇵",nr:"🇳🇷",nu:"🇳🇺",nz:"🇳🇿",om:"🇴🇲",pa:"🇵🇦",pe:"🇵🇪",pf:"🇵🇫",pg:"🇵🇬",ph:"🇵🇭",pk:"🇵🇰",pl:"🇵🇱",pm:"🇵🇲",pn:"🇵🇳",pr:"🇵🇷",ps:"🇵🇸",pt:"🇵🇹",pw:"🇵🇼",py:"🇵🇾",qa:"🇶🇦",re:"🇷🇪",ro:"🇷🇴",rs:"🇷🇸",ru:"🇷🇺",rw:"🇷🇼",sa:"🇸🇦",sb:"🇸🇧",sc:"🇸🇨",sd:"🇸🇩",se:"🇸🇪",sg:"🇸🇬",sh:"🇸🇭",si:"🇸🇮",sj:"🇸🇯",sk:"🇸🇰",sl:"🇸🇱",sm:"🇸🇲",sn:"🇸🇳",so:"🇸🇴",sr:"🇸🇷",ss:"🇸🇸",st:"🇸🇹",sv:"🇸🇻",sx:"🇸🇽",sy:"🇸🇾",sz:"🇸🇿",tc:"🇹🇨",td:"🇹🇩",tf:"🇹🇫",tg:"🇹🇬",th:"🇹🇭",tj:"🇹🇯",tk:"🇹🇰",tl:"🇹🇱",tm:"🇹🇲",tn:"🇹🇳",to:"🇹🇴",tr:"🇹🇷",tt:"🇹🇹",tv:"🇹🇻",tw:"🇹🇼",tz:"🇹🇿",ua:"🇺🇦",ug:"🇺🇬",um:"🇺🇲",us:"🇺🇸",uy:"🇺🇾",uz:"🇺🇿",va:"🇻🇦",vc:"🇻🇨",ve:"🇻🇪",vg:"🇻🇬",vi:"🇻🇮",vn:"🇻🇳",vu:"🇻🇺",wf:"🇼🇫",ws:"🇼🇸",ye:"🇾🇪",yt:"🇾🇹",za:"🇿🇦",zm:"🇿🇲",zw:"🇿🇼"};var ea=a(33),ta=function(e,t,a,n,r){e.strokeStyle=r;const s=e.lineWidth;e.lineWidth=ea.a.HALO_WIDTH,e.beginPath(),e.arc(t,a,n+ea.a.NODE_RADIUS+Math.floor(n/ea.a.NODE_RADIUS/2),0,2*Math.PI,!1),e.closePath(),e.stroke(),e.lineWidth=s};const aa={Degrees0:0,Degrees90:.5*Math.PI,Degrees180:Math.PI,Degrees270:1.5*Math.PI,Degrees360:2*Math.PI},na=document.createElement("canvas");na.width=14,na.height=14;const ra=na.getContext("2d");ra.lineWidth=1,ra.strokeStyle=ea.a.COLOUR_DARK;const sa=document.createElement("canvas");sa.width=4,sa.height=4;sa.getContext("2d");const oa=document.createElement("canvas").getContext("2d");function la(e,t,a,n,r=5){const s=n,o=.5*s,l=Math.PI/r;let i=Math.PI/2*3;e.moveTo(t,a-s);for(let n=0;n<r;n++)e.lineTo(t+Math.cos(i)*s,a+Math.sin(i)*s),i+=l,e.lineTo(t+Math.cos(i)*o,a+Math.sin(i)*o),i+=l;e.lineTo(t,a-s)}function ia(e,t,a,n,r){e.moveTo(t+n*Math.cos(0),a+n*Math.sin(0));for(let s=1;s<=r;s+=1)e.lineTo(t+n*Math.cos(2*s*Math.PI/r),a+n*Math.sin(2*s*Math.PI/r))}oa.font='14px "Roboto", "Helvetica", "Arial", sans-serif';var ca=function(e,t,a,n,r="circle",s="#bababa",o,l=ea.a.NODE_BORDER_WIDTH,i=ea.a.NODE_BORDER_STYLE){if(!(n<=0||"none"===r)){if(e.fillStyle=s,r in Jt){const s=e.font;e.font=`${2*n}px Segoe UI Emoji`,e.textAlign="center",e.textBaseline="top",e.fillText(Jt[r],t,a-n/2),e.font=s}else Qt.test(r)?(e.font=`${2*n}px Segoe UI Emoji`,e.textAlign="center",e.textBaseline="top",e.fillText(r,t,a-n/2)):(e.beginPath(),"dot"===r?e.arc(t,a,2*e.lineWidth,aa.Degrees0,aa.Degrees360):"circle"===r?e.arc(t,a,n,aa.Degrees0,aa.Degrees360):"square"===r?e.rect(t-n,a-n,2*n,2*n):"triangle"===r?(e.moveTo(t,a-n),e.lineTo(t+n,a+n),e.lineTo(t-n,a+n),e.lineTo(t,a-n)):"star"===r?la(e,t,a,n,5):"hexastar"===r?la(e,t,a,n,6):"heptastar"===r?la(e,t,a,n,7):"octastar"===r?la(e,t,a,n,8):"pentagon"===r?ia(e,t,a,n,5):"hexagon"===r?ia(e,t,a,n,6):"heptagon"===r?ia(e,t,a,n,7):"octagon"===r?ia(e,t,a,n,8):console.error("Invalid shape",r),e.fill(),l>0&&(e.strokeStyle=i,e.lineWidth=l,e.stroke()),e.closePath());o&&ta(e,t,a,n,o)}};sigma.canvas.nodes.def=function(e,t,a){const n=a("_camera");if(n&&!1!==e.isActive){const r=Math.pow(n.ratio,a("nodesPowRatio")),s=e[a("rendererSizeKey")]*r;s&&ca(t,e[a("rendererXKey")],e[a("rendererYKey")],s,e.style.shape,e.style.colour,e.isHighlighted?Vt.b.primaryColour:null)}},sigma.canvas.edges.def=function(e,t,a,n,r){if(r("_camera")&&!1!==t.isActive&&!1!==a.isActive){switch(n.strokeStyle=e.style.colour||r("defaultEdgeColor"),n.lineWidth=e.style.width||1,e.style.line){case"dashed":n.setLineDash([4,8]);break;case"dotted":n.setLineDash([1,2]);break;case"solid":default:n.setLineDash([])}n.beginPath(),n.moveTo(t[r("rendererXKey")],t[r("rendererYKey")]),n.lineTo(a[r("rendererXKey")],a[r("rendererYKey")]),n.stroke(),n.setLineDash([]);const s=t[r("rendererSizeKey")];e.style.label&&s>=r("labelThreshold")&&(n.fillStyle=n.strokeStyle,n.textAlign="center",n.textBaseline="middle",n.fillText(e.style.label,Math.round((t[r("rendererXKey")]+a[r("rendererXKey")])/2),Math.round((t[r("rendererYKey")]+a[r("rendererYKey")])/2)),n.textAlign="start",n.textBaseline="alphabetic")}};class ua extends r.a.Component{componentDidMount(){this.sigmaInst=new sigma({graph:this.props.graph,renderer:{container:this.el,type:"canvas"},settings:{defaultEdgeColor:this.props.edgeColour,defaultLabelSize:this.props.labelSize,defaultNodeColour:this.props.labelSize,drawLabels:this.props.showLabels,drawNodes:this.props.showNodes,font:this.props.fontFamily,maxNodeSize:this.props.nodeSize/2,minNodeSize:this.props.minNodeSize,nodeColor:this.props.nodeColour,sideMargin:1,...this.props.settings}});const e=this.sigmaInst.renderers[0].camera.quadtree.area;this.sigmaInst.renderers[0].camera.quadtree.area=(...t)=>e.apply(this.sigmaInst.renderers[0].camera.quadtree,t).sort((e,t)=>e.isHighlighted&&!t.isHighlighted?1:!e.isHighlighted&&t.isHighlighted?-1:0),this.props.draggableNodes&&sigma.plugins.dragNodes(this.sigmaInst,this.sigmaInst.renderers[0]),this.sigmaInst.initalZoomRatio=this.sigmaInst.settings("zoomingRatio"),this.props.onViewportChange&&this.sigmaInst.camera.bind("coordinatesUpdated",Rt()(()=>this.props.onViewportChange(this.saveViewport()),200)),this.props.onNodeSelect&&(this.sigmaInst.bind("clickNodes",e=>this.handleNodeClick(e)),this.sigmaInst.bind("clickStage",e=>this.handleStageClick(e))),this.sigmaInst.bind("overNode",e=>{const{data:t}=e;t.node.hoverLabel&&!1!==t.node.isActive&&(t.node.label=t.node.hoverLabel,this.sigmaInst.refresh()),this.props.onNodeHover&&this.props.onNodeHover(e)}),this.sigmaInst.bind("outNode",e=>{const{data:t}=e;t.node.hoverLabel&&t.node.label&&(t.node.label=void 0,this.sigmaInst.refresh()),this.props.onNodeLeave&&this.props.onNodeLeave(e)}),this.props.hasLasso&&(this.canvasLasso=Wt(this.sigmaInst,{isActive:this.props.lassoActive,path:this.props.lassoPath,onPathChange:e=>this.props.onLassoPathChange(e)}),this.sigmaInst.canvasLasso=this.canvasLasso);const t=this.sigmaInst.renderers[0];this.sigmaInst.settings("rendererXKey",`${t.options.prefix}x`),this.sigmaInst.settings("rendererYKey",`${t.options.prefix}y`),this.sigmaInst.settings("rendererSizeKey",`${t.options.prefix}size`),this.sigmaInst.settings("_camera",this.sigmaInst.camera),this.props.viewport&&this.restoreViewport(this.props.viewport),this.props.recomputeLayout?this.startLayout():this.sigmaInst.refresh();const{addExportCallback:a}=this.props;a&&(a("network-png",()=>function(e){const t=e.renderers[0],a=document.createElement("canvas");a.setAttribute("width",`${t.width}px`),a.setAttribute("height",`${t.height}px`);const n=a.getContext("2d");for(const e of Xt)e in t.domElements&&n.drawImage(t.domElements[e],0,0);return a.toDataURL()}(this.sigmaInst)),a("network-svg",()=>function(e){const t=e.renderers[0],a={},n=new Zt.a(t.width,t.height);n.clearRect=()=>{};for(const e of Object.keys(t.contexts))a[e]=t.contexts[e],t.contexts[e]=n;e.refresh();for(const e of Object.keys(a))t.contexts[e]=a[e];return n.getSerializedSvg(!1)}(this.sigmaInst)))}componentDidUpdate(e){e.showLabels!==this.props.showLabels&&this.sigmaInst.settings("drawLabels",this.props.showLabels),e.showNodes!==this.props.showNodes&&this.sigmaInst.settings("drawNodes",this.props.showNodes),e.nodeSize!==this.props.nodeSize&&this.sigmaInst.settings("maxNodeSize",this.props.nodeSize/2),this.props.graph!==e.graph&&(this.sigmaInst.graph.clear(),this.sigmaInst.graph.read(this.props.graph)),e.lassoActive!==this.props.lassoActive&&this.canvasLasso.setActive(this.props.lassoActive),e.lassoPath!==this.props.lassoPath&&this.canvasLasso.setPath(this.props.lassoPath),this.sigmaInst.refresh()}componentWillUnmount(){this.timeoutID&&clearTimeout(this.timeoutID),this.canvasLasso&&this.canvasLasso.destroy(),this.sigmaInst&&this.sigmaInst.kill();const{removeExportCallback:e}=this.props;e&&(e("network-png"),e("network-svg"))}getNodeNeighbours(e){const t=new Set;for(const a of e)t.add(a),this.props.graph.edges.forEach(e=>{e.source===a&&t.add(e.target),e.target===a&&t.add(e.source)});return Array.from(t)}getNodeComponent(e){const t=e,a=new Set;for(;t.length;){const e=t.pop();a.add(e),this.props.graph.edges.forEach(n=>{n.source!==e||a.has(n.target)||t.push(n.target),n.target!==e||a.has(n.source)||t.push(n.source)})}return Array.from(a)}startLayout(){this.sigmaInst&&!this.sigmaInst.isForceAtlas2Running()&&(this.props.onLayoutStart&&this.props.onLayoutStart(),this.sigmaInst.renderers[0].settings("drawEdges",!1),this.sigmaInst.startForceAtlas2({worker:!0,barnesHutOptimize:!1,...this.props.layoutSettings}),this.timeoutID=setTimeout(()=>this.stopLayout(),this.props.layoutDuration))}stopLayout(){if(!this.sigmaInst||!this.sigmaInst.isForceAtlas2Running())return;this.sigmaInst.renderers[0].settings("drawEdges",!0),this.sigmaInst.stopForceAtlas2();const e=this.sigmaInst.graph.nodes(),t={};for(const a of e)t[a.id]={x:a.x,y:a.y};this.props.onLayoutChange&&this.props.onLayoutChange(t)}handleNodeClick(e){const t=e.data.captor.metaKey||e.data.captor.ctrlKey,a=e.data.captor.altKey||e.data.captor.shiftKey,n=e.data.node.map(e=>e.id);if(a&&t){const e=this.getNodeComponent(n);this.props.onNodeSelect(e)}else if(a){const e=this.getNodeNeighbours(n);this.props.onNodeSelect(e,t)}else this.props.onNodeSelect(n,t)}handleStageClick(e){const{isDragging:t,metaKey:a,ctrlKey:n}=e.data.captor;t||(a||n)||this.props.onNodeSelect()}handleZoomChange(e){const t=this.sigmaInst.settings("zoomingRatio")**-e,a={duration:this.sigmaInst.settings("mouseZoomDuration")};sigma.utils.zoomTo(this.sigmaInst.camera,0,0,t,a)}handleZoomReset(){const e={duration:this.sigmaInst.settings("mouseZoomDuration")};sigma.utils.zoomTo(this.sigmaInst.camera,0,0,1/this.sigmaInst.camera.ratio,e)}saveViewport(){return{x:this.sigmaInst.camera.x,y:this.sigmaInst.camera.y,ratio:this.sigmaInst.camera.ratio}}restoreViewport(e){this.sigmaInst.camera.x=e.x,this.sigmaInst.camera.y=e.y,this.sigmaInst.camera.ratio=e.ratio}renderSecondaryControls(){return r.a.createElement(r.a.Fragment,null,this.props.hasLasso&&r.a.createElement(Ht,{active:this.props.lassoActive,onClick:()=>this.props.onLassoActiveChange(!this.props.lassoActive)}),r.a.createElement(Dt,{title:"Shuffle nodes",onClick:()=>this.startLayout()},r.a.createElement("i",{className:"material-icons"},"shuffle")),r.a.createElement(Dt,{title:"Reset zoom",onClick:()=>this.handleZoomReset()},r.a.createElement("i",{className:"material-icons"},"zoom_out_map")),this.props.secondaryControls)}render(){const{width:e,height:t}=this.props;return r.a.createElement(Bt,{primaryControls:this.props.primaryControls,onZoomChange:e=>this.handleZoomChange(e),secondaryControls:this.renderSecondaryControls(),style:{width:e,height:t,...this.props.style}},r.a.createElement("div",{className:m()("libmr-Network",this.props.className),ref:e=>{this.el=e},style:{width:e,height:t,...this.props.style}},this.props.children))}}ua.propTypes={addExportCallback:lt.a.func,children:lt.a.node,className:lt.a.string,draggableNodes:lt.a.bool,edgeColour:lt.a.string,fontFamily:lt.a.string,graph:lt.a.shape({edges:lt.a.array,nodes:lt.a.array}),hasLasso:lt.a.bool,height:lt.a.number,labelColour:lt.a.string,labelSize:lt.a.number,lassoActive:lt.a.bool,lassoPath:lt.a.array,layoutDuration:lt.a.number,layoutSettings:lt.a.object,minNodeSize:lt.a.number,nodeColour:lt.a.string,nodeRenderer:lt.a.func,nodeSize:lt.a.number,onLassoActiveChange:lt.a.func,onLassoPathChange:lt.a.func,onLayoutChange:lt.a.func,onLayoutStart:lt.a.func,onNodeHover:lt.a.func,onNodeLeave:lt.a.func,onNodeSelect:lt.a.func,onViewportChange:lt.a.func,primaryControls:lt.a.node,recomputeLayout:lt.a.bool,removeExportCallback:lt.a.func,secondaryControls:lt.a.node,settings:lt.a.object,showLabels:lt.a.bool,showNodes:lt.a.bool,style:lt.a.object,viewport:lt.a.object,width:lt.a.number},ua.defaultProps={draggableNodes:!1,edgeColour:"#ccc",fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',hasLasso:!1,labelColour:"#222",labelSize:14,layoutDuration:1e3,maxLabelSize:160,minNodeSize:1,nodeColour:"#ccc",nodeSize:16,secondaryControls:[],showLabels:!0,showNodes:!0};var ma=ua;const da=(e,t)=>`Cluster of ${e} at threshold of ${t}`;var pa=Object(c.a)((function(e){return{numberOfGenomesInCluster:Ke(e),threshold:ye(e)}}))(({numberOfGenomesInCluster:e,threshold:t})=>da(e,t));const ha=window.URL||window.webkitURL;let fa={};function ga(e,t){fa[e]=t}function ba(e){fa[e]=void 0}function ya(e,t,a=!0){if("function"==typeof fa[e])return Promise.resolve(t).then(fa[e]).then(n=>{if(a){const[,a]=e.split("-");!function(e,t,a){let n=e;"svg"===a?n=ha.createObjectURL(new Blob([e],{type:"image/svg+xml"})):"nwk"===a&&(n=ha.createObjectURL(new Blob([e],{type:"text/plain"})));const r=document.createElement("a");void 0!==r.download?(r.download=`${t}.${a}`,r.href=n,document.body.appendChild(r),r.click(),document.body.removeChild(r)):document.location.href="png"===a?n.replace("data:image/png","image/octet-stream"):n}(n,t,a)}return n});throw new Error(`Invalid export type: ${e}`)}const Ea=()=>r.a.createElement("div",{className:"pw-cluster-status"},r.a.createElement("p",{className:"wgsa-blink"},"Fetching cluster...")),va=()=>r.a.createElement("div",{className:"pw-cluster-status"},r.a.createElement("p",null,"Couldn't fetch the cluster, try another threshold")),Ca=r.a.createClass({displayName:"ClusterNetwork",getInitialState:()=>({controlsVisible:!1}),render(){switch(this.props.status){case"INITIAL_STATUS":case"BUILDING_CLUSTERS":case"BUILT_CLUSTERS":case"FETCHING_CLUSTERS":case"FETCHING_EDGES":case"FETCHED_CLUSTERS":return r.a.createElement(Ea,null);case"FETCHED_EDGES":case"RUNNING_LAYOUT":case"COMPLETED_LAYOUT":break;case"FAILED_BUILDING_CLUSTERS":case"FAILED_FETCHING_CLUSTERS":case"FAILED_FETCHING_EDGES":default:return r.a.createElement(va,null)}const e={opacity:"RUNNING_LAYOUT"===this.props.status?.5:1},{edgesCount:t}=this.props,{controlsVisible:a}=this.state;return r.a.createElement("div",{className:"pw-cluster-network"},!1!==this.props.coverMessage&&r.a.createElement("p",{className:"pw-network-cover-message"},"RUNNING_LAYOUT"===this.props.status?r.a.createElement("span",{className:"wgsa-blink"},"Rendering cluster..."):r.a.createElement(pa,null)),r.a.createElement(ma,{addExportCallback:ga,controlsVisible:a,graph:this.props.graph,hasLasso:this.props.hasLasso,lassoActive:this.props.lassoActive,lassoPath:this.props.lassoPath,layoutDuration:Math.min(Math.max(1e3,t/5),1e4),layoutSettings:me.a,onControlsVisibleChange:()=>this.setState({controlsVisible:!a}),onLassoActiveChange:this.props.onLassoActiveChange,onLassoPathChange:this.props.onLassoPathChange,onLayoutChange:this.props.stopLayout,onLayoutStart:this.props.startLayout,onNodeSelect:this.props.onNodeSelect,primaryControls:this.props.primaryControls,recomputeLayout:"FETCHED_EDGES"===this.props.status,removeExportCallback:ba,settings:me.e,style:e}))}});var wa=Object(c.a)((function(e,t){return{edgesCount:_e(e),graph:t.graph||Xe(e),status:be(e)}}),(function(e){return{startLayout:()=>e(Qe.n()),stopLayout:t=>e(Qe.o(t))}}))(Ca),Sa=a(72),Na=a.n(Sa);const Oa={cursor:"pointer"};class xa extends n.Component{constructor(...e){var t;return t=super(...e),this.state={hovering:!1},t}componentDidMount(){const{labels:e=[],values:t=[],backgroundColor:a="#b199c7",hoverBackgroundColor:n="#673c90",toolTipFunc:r=null}=this.props,s=null===r?void 0:{callbacks:{label:r,title:()=>""}},o=this.canvas.getContext("2d");this.chart=new Na.a(o,{type:"bar",data:{labels:e,datasets:[{backgroundColor:a,hoverBackgroundColor:n,borderWidth:0,data:t}]},options:{legend:{display:!1},scales:{xAxes:[{barPercentage:1,categoryPercentage:.9,ticks:{maxTicksLimit:10}}],yAxes:[{ticks:{beginAtZero:!0,display:!1}}]},tooltips:s}})}componentDidUpdate(){const{labels:e=[],values:t=[],backgroundColor:a,hoverBackgroundColor:n}=this.props,r=this.chart.data.datasets[0];r.data=t,r.backgroundColor=a,r.hoverBackgroundColor=n,this.chart.data.labels=e,this.chart.update()}onClick(e){const t=this.chart.getElementsAtEvent(e);let a,n;try{const e=t[0],{_index:r}=e;a=this.chart.data.labels[r],n=this.chart.data.datasets[0].data[r]}catch(e){return null}return this.props.onClick({label:a,value:n})}render(){return r.a.createElement("canvas",{style:Oa,onClick:e=>this.onClick(e),ref:e=>{this.canvas=e},width:this.props.width,height:this.props.height})}}var ka=xa;const _a=e=>da(e.yLabel,e.xLabel),Ia=["FAILED_BUILDING_CLUSTERS","FAILED_FETCHING_CLUSTERS","FAILED_FETCHING_EDGES","COMPLETED_LAYOUT"];class Ta extends n.Component{onClick({label:e}){if(-1===Ia.indexOf(this.props.status))return;this.props.numberOfNodesAtThreshold[this.props.chartThresholds.indexOf(e)]>me.b?this.props.showToast("This cluster is too large to display, please select a lower threshold."):this.props.setThreshold(e)}render(){return r.a.createElement(ka,{width:584,height:100,labels:this.props.chartThresholds,values:this.props.chartValues,onClick:e=>this.onClick(e),toolTipFunc:_a,backgroundColor:this.props.chartColours.status,hoverBackgroundColor:this.props.chartColours.hover})}}var La=Object(c.a)((function(e){return{chartColours:Ze(e),chartThresholds:Be(),chartValues:He(e),numberOfNodesAtThreshold:Ve(e),status:be(e)}}))(Ta);var ja=Object(c.a)((function(e){return{selectedGenomeId:ge(e),threshold:ye(e),status:be(e)}}),(function(e){return{setThreshold:t=>e(Qe.l(t))}}))(({result:e,selectedGenomeId:t,setThreshold:a,status:n,threshold:s})=>r.a.createElement("div",{className:m()({"pw-genome-report-noprint":"COMPLETED_LAYOUT"!==n})},r.a.createElement("header",{className:"pw-genome-report-section-header"},r.a.createElement("h2",null,"Core genome clustering"),r.a.createElement("p",null,r.a.createElement("a",{href:e.scheme,target:"_blank",rel:"noopener"},e.scheme))),r.a.createElement(st,null,r.a.createElement("div",{className:"pw-cluster-view"},r.a.createElement(wa,null),r.a.createElement("p",{className:"pw-cluster-chart-intro"},"Pick a threshold by clicking on the chart below"),r.a.createElement(La,{setThreshold:a}),r.a.createElement("div",{className:"pw-cluster-buttons"},r.a.createElement(tt,{genomeId:t},"Recluster"),r.a.createElement(J.a,{to:`/clustering/${t}?threshold=${s}`,className:"mdl-button mdl-button--raised mdl-button--colored pw-cluster-buttons-view"},"View cluster")))))),Aa=({result:{fp:e,summary:t}})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Core stats"),r.a.createElement("dl",{className:"grid"},r.a.createElement("div",null,r.a.createElement("dt",null,"Core matches"),r.a.createElement("dd",null,t.kernelSize)),r.a.createElement("div",null,r.a.createElement("dt",null,"Core families"),r.a.createElement("dd",null,t.percentKernelMatched,"%")),r.a.createElement("div",null,r.a.createElement("dt",null,"Non-core"),r.a.createElement("dd",null,(100-t.percentAssemblyMatched).toFixed(1),"%")),r.a.createElement("div",null,r.a.createElement("dt",null,"Complete alleles"),r.a.createElement("dd",null,t.completeAlleles)),r.a.createElement("div",null,r.a.createElement("dt",null,"Families matched"),r.a.createElement("dd",null,t.familiesMatched)),r.a.createElement("div",null,r.a.createElement("dt",null,r.a.createElement(B,null)," reference"),r.a.createElement("dd",null,e.reference)))),Pa=({matches:e,amrMatches:t=[],library:a,setBackground:n=!1,displayAmr:s=!1})=>{const o="gram_negative"===a?"Inc Match":"Group",l=e.reduce((e,t)=>(e.push(t[o].replace(/_\d+$/,"")),e),[]);return l.sort(),e.sort((e,t)=>e["Contig Start"]-t["Contig Start"]),r.a.createElement(r.a.Fragment,null,r.a.createElement("tbody",{className:"pw-inctyper-contig"},e.map((a,n)=>0===n?r.a.createElement("tr",null,r.a.createElement("td",{rowSpan:e.length},l.join("/")),s&&r.a.createElement("td",{rowSpan:e.length},0===t.length?"-":t.join(", ")),r.a.createElement("td",null,a["Inc Match"]),r.a.createElement("td",null,a["Percent Identity"]),r.a.createElement("td",null,a["Match Coverage"])):r.a.createElement("tr",null,r.a.createElement("td",null,a["Inc Match"]),r.a.createElement("td",null,a["Percent Identity"]),r.a.createElement("td",null,a["Match Coverage"])))))};function Ra(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"pw-genome-report-section-header"},r.a.createElement("h2",null,"Plasmid Inc types"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://cge.cbs.dtu.dk/services/PlasmidFinder/",target:"_blank",rel:"noopener"},"Database sourced from https://cge.cbs.dtu.dk/services/PlasmidFinder/"))),r.a.createElement("p",null,e))}var Ma=({analysis:e})=>{const{inctyper:t,paarsnp:a={matches:[],library:""}}=e;if(!t.hasOwnProperty("Inc Matches"))return Ra("Inctyper was not run for this assembly.");if(0===t["Inc Matches"].length)return Ra("No matches reported.");const n=t["Inc Matches"].reduce((e,t)=>{const a=e;return a.hasOwnProperty(t.Contig)||(a[t.Contig]=[]),a[t.Contig].push(t),a},{}),s=Object.keys(n).sort(),o={};for(const e of a.matches)e.query&&(a.hasOwnProperty("paar")&&a.paar.includes(e.id)||a.hasOwnProperty("snp")&&a.snp.includes(e.id))&&(e.query.id in o||(o[e.query.id]=[]),o[e.query.id].push(e.id));return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"pw-genome-report-section-header"},r.a.createElement("h2",null,"Plasmid Inc types"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://cge.cbs.dtu.dk/services/PlasmidFinder/",target:"_blank",rel:"noopener"},"Database sourced from https://cge.cbs.dtu.dk/services/PlasmidFinder/"))),r.a.createElement("table",{className:"bordered wide",cellSpacing:"0"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Contig Inc type"),""!==a.library&&r.a.createElement("th",null,"Contig AMR genes"),r.a.createElement("th",null,"Match ID"),r.a.createElement("th",null,"% Identity"),r.a.createElement("th",null,"% Coverage"))),Object.keys(n).length?s.map((e,s)=>r.a.createElement(Pa,{amrMatches:o[e],library:t.Library,matches:n[e],setBackground:s%2==0,displayAmr:""!==a.library})):r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{colSpan:"5",className:"muted"},"No matches")))))};const Da='14px "Roboto", "Helvetica", "Arial", sans-serif';var Fa;(Fa=Na.a).pluginService.register({beforeDatasetsDraw(e){const t=e.scales["y-axis-0"],a=e.scales["x-axis-0"],n=e.chart.ctx;if(e.options.horizontalLine)for(let r=0;r<e.options.horizontalLine.length;r++){n.save();const s=e.options.horizontalLine[r],o=s.y?t.getPixelForValue(s.y):0;o&&(n.beginPath(),n.moveTo(a.getPixelForValue(a.min),o),n.lineTo(a.getPixelForValue(a.max),o),n.lineWidth=s.lineWidth||2,n.strokeStyle=s.style||"rgba(0,0,0,.54)",s.dash&&n.setLineDash([8,8]),n.stroke()),s.text&&(n.fillStyle=s.textStyle||s.style||"rgba(0,0,0,.54)",n.textBaseline="top",n.textAlign="right",n.font=s.font||Da,n.fillText(s.text,a.getPixelForValue(a.max),o+4)),n.restore()}}}),Fa.pluginService.register({beforeDatasetsDraw(e){const t=e.scales["x-axis-0"],a=e.scales["y-axis-0"],n=e.chart.ctx;if(e.options.verticalLine)for(let r=0;r<e.options.verticalLine.length;r++){n.save();const s=e.options.verticalLine[r],o=s.x?t.getPixelForValue(s.x):0;o&&(n.beginPath(),n.moveTo(o,a.getPixelForValue(a.min)),n.lineTo(o,a.getPixelForValue(a.max)),n.lineWidth=s.lineWidth||2,n.strokeStyle=s.style||"rgba(0,0,0,.54)",s.dash&&n.setLineDash([8,8]),n.stroke()),s.text&&(n.fillStyle=s.textStyle||s.style||"rgba(0,0,0,.54)",n.font=s.font||Da,n.textBaseline="top",n.fillText(s.text,o+8,a.getPixelForValue(a.max))),n.restore()}}});var za=r.a.createClass({displayName:"N50Chart.react",componentDidMount(){const{metrics:e}=this.props,{contigSums:t,N50Contig:a}=e,n={label:"N50",backgroundColor:"#a386bd",fill:!1,pointBorderColor:"#a386bd",data:[{x:0,y:0}].concat(t.map((e,t)=>({x:t+1,y:e})))};this.chart=new Na.a(this.canvas,{type:"line",data:{datasets:[n]},options:{animation:!1,responsive:!1,legend:{display:!1},tooltips:{displayColors:!1,callbacks:{title:(e,{datasets:t})=>"Sum: ".concat(e.map(({index:e,datasetIndex:a})=>t[a].data[e].y).join(", ")),label:({index:e,datasetIndex:t},{datasets:a})=>`Size: ${a[t].data[e].y-(e>0?a[t].data[e-1].y:0)}`}},scales:{xAxes:[{type:"linear",position:"bottom",ticks:{display:!1,max:t.length+1},scaleLabel:{display:!1},beginAtZero:!0,gridLines:{display:!1}}],yAxes:[{gridLines:{display:!1}}]},horizontalLine:[{y:e.length/2,style:"#3c7383",text:e.length/2,dash:!0}],verticalLine:[{x:a,style:"#ccc",dash:!0,text:`Contig ${a}`,textStyle:"rgba(0, 0, 0, 0.54)"}]}})},render(){return r.a.createElement("canvas",{ref:e=>{this.canvas=e},width:"584",height:"320"})}}),Ga=({result:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Assembly stats"),r.a.createElement("dl",{className:"grid"},r.a.createElement("div",null,r.a.createElement("dt",null,"Genome length"),r.a.createElement("dd",null,e.length)),r.a.createElement("div",null,r.a.createElement("dt",null,"No. contigs"),r.a.createElement("dd",null,e.contigs)),r.a.createElement("div",null,r.a.createElement("dt",null,"Smallest contig"),r.a.createElement("dd",null,e.smallestContig)),r.a.createElement("div",null,r.a.createElement("dt",null,"Largest contig"),r.a.createElement("dd",null,e.largestContig)),r.a.createElement("div",null,r.a.createElement("dt",null,"Average contig length"),r.a.createElement("dd",null,e.averageContig)),r.a.createElement("div",null,r.a.createElement("dt",null,"N50"),r.a.createElement("dd",null,e.N50)),r.a.createElement("div",null,r.a.createElement("dt",null,"Non-ATCG"),r.a.createElement("dd",null,e.nonATCG)),r.a.createElement("div",null,r.a.createElement("dt",null,"GC content"),r.a.createElement("dd",null,e.gcContent,"%"))),r.a.createElement("figure",null,r.a.createElement("figcaption",null,"N50 chart"),r.a.createElement(za,{metrics:e}))),Ua=a(10);const Ba={PUBLIC:"https://gitlab.com/cgps/pathogenwatch/amr-libraries/blob",TESTING:"https://gitlab.com/cgps/pathogenwatch/amr-test-libraries/blob"},$a=new Set(["1280","1313","485","90370"]);var Ha=({result:e,genome:t})=>{const{organismId:a}=t.analysis.speciator,{antibiotics:n,library:s={label:a,source:$a.has(a)?"PUBLIC":"TESTING",version:"0.0.1"}}=e;let o=new Set;if(Ua.d.has(a)){const{amrOptions:e={}}=Ua.d.get(a);e&&e.hiddenColumns&&(o=e.hiddenColumns)}const l=o.size?n.filter(({name:e})=>!o.has(e)):n,i=`${Ba[s.source]}/${s.version}/${s.label}.toml`;return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"pw-genome-report-section-header"},r.a.createElement("a",{href:i,target:"_blank",rel:"noopener",className:"pw-genome-report-secondary-link"},r.a.createElement("strong",null,"PAARSNP AMR")," - Library ",s.label," version ",s.version,"PUBLIC"!==s.source?` (${s.source})`:"")),r.a.createElement("table",{cellSpacing:"0",className:"wgsa-genome-report-amr wide bordered"},r.a.createElement("caption",null,"Resistance profile"),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Agent"),r.a.createElement("th",null,"Predicted phenotype"),r.a.createElement("th",null,"Variants/genes"))),r.a.createElement("tbody",null,l.map(({name:e,fullName:t,state:a,mechanisms:n})=>r.a.createElement("tr",{key:e,className:m()({"pw-genome-report-amr-present":"NOT_FOUND"!==a,"pw-genome-report-amr-resistant":"RESISTANT"===a})},r.a.createElement("td",null,t),r.a.createElement("td",{className:"wgsa-genome-report-amr-state"},a.replace(/_/g," ").toLowerCase()),r.a.createElement("td",{className:"pw-genome-report-amr-mechanisms"},n.join(", ")))))))},Va=({result:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"pw-genome-report-section-header"},r.a.createElement("a",{href:"https://github.com/katholt/Kleborate#resistance-gene-detection",target:"_blank",rel:"noopener",className:"pw-genome-report-secondary-link"},r.a.createElement("strong",null,"Kleborate")," - https://github.com/katholt/Kleborate#resistance-gene-detection")),r.a.createElement("table",{cellSpacing:"0",className:"wgsa-genome-report-amr wide bordered"},r.a.createElement("caption",null,"Resistance profile"),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Agent"),r.a.createElement("th",null,"Predicted phenotype"),r.a.createElement("th",null,"Genes/variants"))),r.a.createElement("tbody",null,e.csv.filter(e=>"amr"===e.set).map(t=>r.a.createElement("tr",{key:e.amr[t.field].name,className:m()({"pw-genome-report-amr-present":"-"!==e.amr[t.field].match,"pw-genome-report-amr-resistant":"-"!==e.amr[t.field].match})},r.a.createElement("td",null,e.amr[t.field].name),r.a.createElement("td",{className:"wgsa-genome-report-amr-state"},"-"===e.amr[t.field].match?"Not Found":"Resistant"),r.a.createElement("td",{className:"pw-genome-report-amr-mechanisms"},e.amr[t.field].match.replace(/;/gi,", ").replace(/\^/gi,"").replace(/\*\?/gi," (homolog, fragment)").replace(/\*/gi," (homolog)").replace(/\?/gi," (fragment)")))))));const Ka={amx:{name:"Amoxicillin",type:"Beta-lactams"},cro:{name:"Ceftriaxone",type:"Extended-Spectrum Beta-lactams"},ctx:{name:"Cefotaxime",type:"Broad-spectrum cephalosporins"},cxm:{name:"Cefuroxime",type:"Beta-lactams"},mem:{name:"Meropenem",type:"Carbapenems"},pen:{name:"Penicillin",type:"Beta-lactams"}};var qa=({result:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"pw-genome-report-section-header"},r.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/pubmed/27302760",target:"_blank",rel:"noopener",className:"pw-genome-report-secondary-link"},r.a.createElement("strong",null,"PBP Analysis")," - Li et al, 2016")),r.a.createElement("table",{cellSpacing:"0",className:"wgsa-genome-report-amr wide bordered"},r.a.createElement("caption",null,"Predicted resistance profile"),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Agent"),r.a.createElement("th",null,"Predicted MIC"),r.a.createElement("th",null,"Inferred phenotype (non/meningitis)"))),r.a.createElement("tbody",null,Object.keys(Ka).map(t=>r.a.createElement("tr",{key:Ka[t].name,className:m()({"pw-genome-report-amr-present":!0,"pw-genome-report-amr-resistant":"R"===e[t]||"R"===e[`${t}Meningitis`]||"R"===e[`${t}NonMeningitis`]})},r.a.createElement("td",null,Ka[t].name),r.a.createElement("td",{className:"wgsa-genome-report-amr-state"},e[`${t}Mic`]),r.a.createElement("td",{className:"wgsa-genome-report-amr-state"},(e.hasOwnProperty(t)?e[t]:`${e[`${t}NonMeningitis`]} / ${e[`${t}Meningitis`]}`).replace(/R/g,"Resistant").replace(/I/g,"Intermediate").replace(/S/g,"Sensitive"))))))),Wa=({genome:e})=>{const{paarsnp:t,kleborate:a,spn_pbp_amr:n}=e.analysis;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Antimicrobial resistance (AMR)"),!!t&&!a&&r.a.createElement(Ha,{result:t,genome:e}),!!a&&r.a.createElement(Va,{result:a}),!!n&&r.a.createElement(qa,{result:n}))},Ya=({result:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Organism prediction"),r.a.createElement("dl",{className:"grid"},r.a.createElement(Z,{label:"Taxonomy ID"},r.a.createElement("a",{href:`https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Tree&id=${e.organismId}`,target:"_blank",rel:"noopener",title:"View in NCBI taxonomy browser"},e.organismId)),r.a.createElement(Z,{label:"Organism name"},e.organismName),r.a.createElement(Z,{label:"RefSeq reference"},r.a.createElement("a",{href:`http://www.ncbi.nlm.nih.gov/assembly/${e.referenceId}/`,target:"_blank",rel:"noopener"},e.referenceId)),r.a.createElement(Z,{label:"Mash distance"},e.mashDistance),r.a.createElement(Z,{label:"p-value"},e.pValue),r.a.createElement(Z,{label:"Matching hashes"},e.matchingHashes))),Za=({to:e,children:t})=>r.a.createElement("div",{className:"pw-genome-report-external-link"},r.a.createElement("a",{href:e,target:"_blank",rel:"noopener"},t),r.a.createElement("i",{className:"material-icons"},"launch")),Xa=a(86),Qa=({result:e,speciator:t,filterKey:a="mlst",heading:n="MLST – Multilocus sequence typing"})=>{const s=e.alleles.map(e=>{const t=e.gene.split("_");return{gene:t[1]||t[0],hits:e.hits}});return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"pw-genome-report-section-header"},r.a.createElement("h2",null,n),r.a.createElement("p",null,r.a.createElement("a",{href:e.url,target:"_blank",rel:"noopener"},e.url))),r.a.createElement("div",{className:"pw-genome-report-column one third"},r.a.createElement("dl",null,r.a.createElement(Z,{label:"Sequence type"},r.a.createElement(Xa.b,{id:e.st}))),r.a.createElement(Za,{to:`/genomes/all?genusId=${t.genusId}&speciesId=${t.speciesId}&${a}=${e.st}`},"View all ST ",r.a.createElement(Xa.b,{id:e.st,textOnly:!0}))),r.a.createElement("div",{className:"pw-genome-report-column two thirds"},r.a.createElement("table",{className:"pw-mlst-profile",cellSpacing:"0"},r.a.createElement("caption",null,"Profile"),r.a.createElement("thead",null,r.a.createElement("tr",null,s.map(({gene:e})=>r.a.createElement("th",{key:e},e)))),r.a.createElement("tbody",null,r.a.createElement("tr",null,s.map(({gene:e,hits:t})=>r.a.createElement("td",{key:e},t.length?t.map(e=>r.a.createElement(Xa.a,{key:e,id:e})):r.a.createElement("span",{title:"Not found"},"?"))))))))},Ja=({result:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"pw-genome-report-section-header"},r.a.createElement("h2",null,"Genotyphi"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://github.com/katholt/genotyphi",target:"_blank",rel:"noopener"},"https://github.com/katholt/genotyphi"))),r.a.createElement("dl",{className:"flex"},r.a.createElement("div",null,r.a.createElement("dt",null,"Genotype"),r.a.createElement("dd",null,e.genotype)),r.a.createElement("div",null,r.a.createElement("dt",null,"SNPs called"),r.a.createElement("dd",null,e.foundLoci))),r.a.createElement(Za,{to:`/genomes/all?organismId=90370&genotype=${e.genotype}`},"View all genotype ",e.genotype)),en=({result:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"pw-genome-report-section-header"},r.a.createElement("h2",null,"NG-MAST – Multi-antigen sequence typing"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://github.com/MDU-PHL/ngmaster",target:"_blank",rel:"noopener"},"https://github.com/MDU-PHL/ngmaster"))),r.a.createElement("div",null,r.a.createElement("dl",{className:"flex"},r.a.createElement("div",null,r.a.createElement("dt",null,"NG-MAST"),r.a.createElement("dd",null,e.ngmast)),r.a.createElement("div",null,r.a.createElement("dt",null,"POR"),r.a.createElement("dd",null,e.por)),r.a.createElement("div",null,r.a.createElement("dt",null,"TBPB"),r.a.createElement("dd",null,e.tbpb))),r.a.createElement(Za,{to:`/genomes/all?genusId=482&speciesId=485&ngmast=${e.ngmast}`},"View all ST ",e.ngmast)));const tn={SISTR:{link:r.a.createElement("a",{href:"http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0147101",target:"_blank",rel:"noopener"},r.a.createElement("em",null,"Salmonella In Silico")," Typing Resource (SISTR)"),title:"serovar"},SeroBA:{link:r.a.createElement("a",{href:"https://mgen.microbiologyresearch.org/content/journal/mgen/10.1099/mgen.0.000186",target:"_blank",rel:"noopener"},"SeroBA"),docs:"https://cgps.gitbook.io/pathogenwatch/technical-descriptions/typing-methods/seroba"}};var an=({genome:e})=>{const{speciator:t,serotype:a}=e.analysis,{link:n=r.a.createElement("span",null,"(unspecified source)"),title:s="serotype",docs:o}=tn[a.source]||{};return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"pw-genome-report-section-header"},r.a.createElement("h2",null,"Serotype"),r.a.createElement("p",null,n)),r.a.createElement("dl",{className:"flex"},a.subspecies&&r.a.createElement("div",{className:"pw-genome-report-metadata"},r.a.createElement("dt",null,"Subspecies"),r.a.createElement("dd",null,r.a.createElement("em",null,a.subspecies))),r.a.createElement("div",{className:"pw-genome-report-metadata"},r.a.createElement("dt",{className:"pw-capitalise"},s),r.a.createElement("dd",null,a.value,a.warn&&o&&r.a.createElement("a",{href:o,target:"_blank",rel:"noopener",className:"pw-genome-report-secondary-link"},"Guidance on this result")))),r.a.createElement(Za,{to:`/genomes/all?genusId=${t.genusId}&speciesId=${t.speciesId}&serotype=${a.value}`},"View all ",s," ",a.value))};var nn=({genome:e})=>{const{poppunk:t,speciator:a}=e.analysis;return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"pw-genome-report-section-header"},r.a.createElement("h2",null,"Strain"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://www.pneumogen.net/gps/"},"The Global Pneumococcal Sequencing Project"))),r.a.createElement("dl",{className:"pw-genome-report-unsized"},r.a.createElement("div",{className:"pw-genome-report-metadata"},r.a.createElement("dt",null,"GPSC"),r.a.createElement("dd",null,t.strain,"novel"===t.strain&&"me"===e.owner&&r.a.createElement("a",{href:"mailto:gps@pneumogen.net?subject=Novel strain assignment&body=(Please attach your assembly to this email)",target:"_blank",rel:"noopener",className:"pw-genome-report-secondary-link"},"Submit for assignment")))),r.a.createElement(Za,{to:`/genomes/all?genusId=${a.genusId}&speciesId=${a.speciesId}&strain=${t.strain}`},"View all GPSC ",t.strain))},rn=({genome:e})=>{const{kleborate:t}=e.analysis,a=t.species!==e.analysis.speciator.speciesName;return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"pw-genome-report-section-header"},r.a.createElement("h2",null,"Kleborate"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://github.com/katholt/Kleborate",target:"_blank",rel:"noopener"},"https://github.com/katholt/Kleborate"))),r.a.createElement("dl",{className:"grid"},r.a.createElement("div",{className:"pw-genome-report-metadata"},r.a.createElement("dt",null,"K locus"),r.a.createElement("dd",null,t.typing.K_locus),r.a.createElement(Za,{to:`/genomes/all?genusId=570&klocus=${t.typing.K_locus}`},"View all ",t.typing.K_locus)),r.a.createElement("div",{className:"pw-genome-report-metadata"},r.a.createElement("dt",null,"Confidence"),r.a.createElement("dd",null,t.typing.K_locus_confidence)),r.a.createElement("div",{className:"pw-genome-report-metadata"},r.a.createElement("dt",null,r.a.createElement("em",null,"wzi")),r.a.createElement("dd",null,t.typing.wzi))),r.a.createElement("dl",{className:"grid"},r.a.createElement("div",{className:"pw-genome-report-metadata"},r.a.createElement("dt",null,"O locus"),r.a.createElement("dd",null,t.typing.O_locus)),r.a.createElement("div",{className:"pw-genome-report-metadata"},r.a.createElement("dt",null,"Confidence"),r.a.createElement("dd",null,t.typing.O_locus_confidence))),a&&r.a.createElement("dl",{className:"pw-genome-report-unsized"},r.a.createElement("div",{className:"pw-genome-report-metadata"},r.a.createElement("dt",{className:"danger"},"Species"),r.a.createElement("dd",null,t.species))))},sn=({genome:e})=>{const{spn_pbp_amr:t}=e.analysis;return r.a.createElement(r.a.Fragment,null,r.a.createElement("header",{className:"pw-genome-report-section-header"},r.a.createElement("h2",null,"PBP types"),r.a.createElement("p",null,r.a.createElement("a",{href:"https://github.com/BenJamesMetcalf/Spn_Scripts_Reference",target:"_blank",rel:"noopener"},"https://github.com/BenJamesMetcalf/Spn_Scripts_Reference"))),r.a.createElement("dl",{className:"flex"},["pbp1a","pbp2b","pbp2x"].map(e=>{return r.a.createElement("div",{className:"pw-genome-report-metadata"},r.a.createElement("dt",null,e.substring(0,3).toUpperCase()+e.substring(3)),r.a.createElement("dd",null,(a=t[e],isNaN(a)?a.charAt(0).toUpperCase()+a.substring(1).toLowerCase():a)));var a})))};var on=({genome:e})=>{const{speciator:t,mlst:a,mlst2:n,ngstar:s}=e.analysis;return r.a.createElement(r.a.Fragment,null,(a||s)&&r.a.createElement("div",{id:"mlst"},a&&r.a.createElement(Qa,{result:a,speciator:t}),n&&r.a.createElement(Qa,{heading:"Alternative MLST",result:n,speciator:t,filterKey:"mlst2"}),s&&r.a.createElement(Qa,{heading:"NG-STAR – Sequence typing for antimicrobial resistance",result:s,speciator:t,filterKey:"ngstar",label:"type"})),function(e){const{genotyphi:t,ngmast:a,serotype:n,poppunk:s,kleborate:o,spn_pbp_amr:l}=e.analysis;return r.a.createElement(r.a.Fragment,null,!!s&&r.a.createElement("div",{className:"pw-genome-report-column one half"},r.a.createElement(nn,{genome:e})),!!n&&r.a.createElement("div",{className:"pw-genome-report-column one half"},r.a.createElement(an,{genome:e})),!!t&&r.a.createElement("div",{className:"pw-genome-report-column one half"},r.a.createElement(Ja,{result:t})),!!a&&r.a.createElement("div",null,r.a.createElement(en,{result:a})),!!o&&r.a.createElement("div",null,r.a.createElement(rn,{genome:e})),!!l&&r.a.createElement("div",null,r.a.createElement(sn,{genome:e})))}(e))};const ln={0:"no virulence loci",1:"yersiniabactin only",2:"yersiniabactin and colibactin, or colibactin only",3:"aerobactin and/or salmochelin only (without yersiniabactin or colibactin)",4:"aerobactin and/or salmochelin with yersiniabactin (without colibactin)",5:"yersiniabactin, colibactin and aerobactin and/or salmochelin"},cn=["Yersiniabactin","YbST","Colibactin","CbST","Aerobactin","AbST","Salmochelin","SmST"],un=({className:e,children:t})=>r.a.createElement("td",{className:e},t.replace("0","-"));var mn=({result:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"pw-genome-report-section-header"},r.a.createElement("a",{href:"https://github.com/katholt/Kleborate#virulence-loci",target:"_blank",rel:"noopener",className:"pw-genome-report-secondary-link"},r.a.createElement("strong",null,"Kleborate virulence")," - https://github.com/katholt/Kleborate#virulence-loci")),r.a.createElement("div",{className:"pw-genome-report-column two thirds"},r.a.createElement("dl",{className:"pw-genome-report-unsized"},r.a.createElement("div",null,r.a.createElement("dt",null,"Virulence score"),r.a.createElement("dd",null,e.virulence_score," – ",ln[e.virulence_score])))),r.a.createElement("div",{className:"pw-genome-report-column one third"},r.a.createElement("dl",{className:"pw-genome-report-unsized"},r.a.createElement("div",null,r.a.createElement("dt",null,"Hypermucoidy (",r.a.createElement("em",null,"rmpA")," / ",r.a.createElement("em",null,"rmpA2"),")"),r.a.createElement("dd",null,e.virulence.rmpA," / ",e.virulence.rmpA2)))),"0"!==e.virulence_score&&r.a.createElement("table",{className:"wide bordered",cellSpacing:"0"},r.a.createElement("thead",null,r.a.createElement("tr",null,cn.map(e=>r.a.createElement("th",null,e)))),r.a.createElement("tbody",null,r.a.createElement("tr",null,cn.map(t=>r.a.createElement(un,null,e.virulence[t])))))),dn=({genome:e})=>{const{kleborate:t}=e.analysis;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,"Virulence"),!!t&&r.a.createElement(mn,{result:t}))};const pn=r.a.createClass({displayName:"Content",getInitialState:()=>({active:"Overview"}),setActive(e){this.setState({active:e})},scrollTo(e){e in this.sections&&this.sections[e].scrollIntoView({behavior:"smooth",block:"start"})},sections:{},render(){const{genome:e}=this.props,{fileId:t,pending:a=[],userDefined:n=null,upload:s={type:"assembly"}}=e,o=[{key:"Top",component:r.a.createElement(Y,{genome:e})}];return n&&Object.keys(n).length>0&&o.push({key:"Metadata",component:r.a.createElement(Q,{genome:e})}),o.push(...(e=>{const{analysis:t={}}=e,{cgmlst:a,core:n,inctyper:s,kleborate:o,metrics:l,paarsnp:i,speciator:c}=t,u=[];return function(e){return e.mlst||e.mlst2||e.genotyphi||e.ngmast||e.serotype||e.poppunk||e.kleborate||e.ngstar}(t)&&u.push({key:"Typing",component:r.a.createElement(on,{genome:e})}),(i||o)&&u.push({key:"AMR",component:r.a.createElement(Wa,{genome:e})}),s&&Object.keys(s).includes("Inc Matches")&&u.push({key:"Inc Typing",component:r.a.createElement(Ma,{analysis:t})}),o&&u.push({key:"Virulence",component:r.a.createElement(dn,{genome:e})}),a&&u.push({key:"Clustering",component:r.a.createElement(ja,{result:a})}),n&&u.push({key:"Core",component:r.a.createElement(X,{taskName:"core",component:Aa,genome:e})}),l&&u.push({key:"Assembly",component:r.a.createElement(X,{taskName:"metrics",component:Ga,genome:e})}),c&&u.push({key:"Organism",component:r.a.createElement(X,{taskName:"speciator",component:Ya,genome:e})}),u})(e)),a.length&&o.push({key:`+${a.length} Pending`,component:r.a.createElement("ul",null,a.map(e=>r.a.createElement("li",null,e)))}),r.a.createElement("div",null,r.a.createElement("style",null,'@media print {\n\n  * {\n    overflow: visible !important;\n  }\n\n  /* hide everything that isn\'t the report */\n  .mdl-layout > :not(.wgsa-genome-report),\n  .wgsa-genome-report .wgsa-modal > header,\n  .wgsa-genome-report .wgsa-modal nav\n   {\n    display: none;\n  }\n\n  /* put everything in view */\n  .mdl-layout__container,\n  .wgsa-modal-container.wgsa-genome-report,\n  .wgsa-genome-report .wgsa-overlay,\n  .wgsa-genome-report .wgsa-modal {\n    position: static;\n  }\n  html,\n  body,\n  .mdl-layout__container,\n  .mdl-layout {\n    height: auto;\n  }\n  .mdl-layout,\n  .wgsa-genome-report,\n  .wgsa-modal,\n  .wgsa-overlay {\n    display: block !important;\n  }\n\n  /* make the report the full width of the page */\n  .wgsa-genome-report .wgsa-modal {\n    width: auto;\n    max-width: none;\n  }\n\n  .wgsa-genome-report-content {\n    margin: 0;\n    padding: 0;\n  }\n\n  @page {\n    margin-top: 1cm;\n    margin-bottom: 1cm;\n  }\n\n  .wgsa-genome-report-content {\n    margin-top: 0;\n    padding-bottom: 16px;\n  }\n\n  .wgsa-genome-report-summary header {\n    padding-top: 0;\n  }\n\n  /* page breaks */\n  figure {\n    break-inside: avoid;\n  }\n\n  /* https://stackoverflow.com/a/53742871 */\n  .wgsa-genome-report-content h2 {\n    break-inside: avoid;\n  }\n  .wgsa-genome-report-content h2::after {\n    content: "";\n    display: block;\n    height: 100px;\n    margin-bottom: -100px;\n  }\n\n  /* hide unnecessary elements */\n  .pw-genome-report-external-link,\n  a::after,\n  .wgsa-genome-report dd .pw-genome-report-secondary-link,\n  .pw-genome-report-noprint {\n    display: none;\n  }\n\n  /* show content links as text */\n  .wgsa-genome-report-content dd a {\n    text-decoration: none;\n    font-weight: inherit;\n  }\n\n  /* Clustering overrides */\n  .pw-cluster-view button,\n  .pw-cluster-view a,\n  .pw-cluster-buttons,\n  .libmr-ZoomControls,\n  .pw-cluster-chart-intro,\n  .chartjs-size-monitor {\n    display: none !important;\n  }\n  .wgsa-genome-report .pw-cluster-view {\n    height: auto;\n    margin: 0;\n  }\n  .pw-cluster-view > canvas {\n    margin: 0 auto;\n  }\n  .wgsa-genome-report-content #clustering {\n    break-inside: avoid;\n  }\n  .pw-network-cover-message {\n    position: static;\n    margin: 0;\n    padding: 0;\n  }\n  .pw-cluster-network {\n    margin-bottom: 16px;\n  }\n\n}'),r.a.createElement("nav",{onClick:e=>e.stopPropagation()},r.a.createElement(h.a,{items:o.map(e=>e.key.toLowerCase()),currentClassName:"active",rootEl:".wgsa-genome-report .wgsa-overlay"},o.map(({key:e})=>r.a.createElement("li",{key:e},r.a.createElement("a",{href:`#${e.toLowerCase()}`,onClick:t=>{t.preventDefault(),this.scrollTo(e)}},e)))),r.a.createElement(_,{key:"remove",genome:e,onRemove:close})),r.a.createElement("div",{className:"wgsa-genome-report-content",onClick:e=>e.stopPropagation()},o.map(({key:e,component:t})=>r.a.createElement("section",{key:e,ref:t=>{this.sections[e]=t},id:`${e.toLowerCase()}`},t)),!t&&r.a.createElement("div",{className:"pw-expand pw-flex-center"},r.a.createElement("span",{className:"wgsa-file-icon"},r.a.createElement("i",{className:"material-icons"},"assembly"===s.type?"insert_drive_file":"file_copy")),r.a.createElement("p",{className:"h6"},"Awaiting assembly"))))}}),hn=new Set(["LOADING","READY"]);var fn=({name:e,genome:t,status:a,close:n})=>{const s=hn.has(a),o=t?t.name:e;return r.a.createElement(E,{title:r.a.createElement("span",{className:"wgsa-genome-report-title"},r.a.createElement("div",{className:"pw-genome-report-print-button",onClick:e=>e.stopPropagation()},r.a.createElement("button",{className:"mdl-button mdl-button--icon",title:"Print report",onClick:()=>(e=>{const t=document.title;document.title=`Pathogenwatch genome report ${e}`,window.print(),document.title=t})(o)},r.a.createElement("i",{className:"material-icons"},"print"))),"Genome report: ",o," ",t&&t.fileId&&r.a.createElement(P,{key:"download",id:t.id,name:t.name})),isOpen:s,onClose:n,animationKey:"genome-report",containerClassName:"wgsa-genome-report"},r.a.createElement(M,{placeholder:r.a.createElement("div",{className:"wgsa-genome-report-loader",onClick:e=>e.stopPropagation()},r.a.createElement(R.a,null)),complete:"READY"===a},r.a.createElement(pn,{genome:t})))},gn=a(105);var bn=Object(c.a)((function({genomes:e}){return e.report}),(function(e){return{close:()=>e(Object(gn.c)(null))}}))(fn),yn=a(122);const En=r.a.createClass({displayName:"Component",componentDidMount(){Object(yn.b)().then(this.props.setSelection)},render:()=>null});var vn=Object(c.a)(null,(function(e){return{setSelection:t=>e(Object(O.l)(t))}}))(En),Cn=a(888),wn=(a(1003),a(181));const Sn=r.a.createClass({displayName:"MenuButton",propTypes:{openMenu:r.a.PropTypes.func},openLoginMenu(e){e.stopPropagation(),e.preventDefault(),this.props.openMenu()},render(){return r.a.createElement("div",{className:"wgsa-main-menu-button"},r.a.createElement("button",{className:"mdl-button mdl-button--icon",title:"Main Menu",onClick:e=>this.openLoginMenu(e)},r.a.createElement("i",{className:"material-icons"},"menu")))}});var Nn=Object(c.a)(null,(function(e){return{openMenu:()=>e(Object(wn.c)(!0))}}))(Sn),On=a(40),xn=a(164);const kn=()=>r.a.createElement("span",{className:"wgsa-header-content"},r.a.createElement("span",{className:"mdl-navigation__link"},"Offline Mode"));var _n=({offline:e=Object(xn.b)()})=>e?r.a.createElement(kn,null):r.a.createElement("nav",{className:"wgsa-header-content mdl-navigation"},r.a.createElement(On.d,{to:"/genomes"},"Genomes"),r.a.createElement(On.d,{to:"/collections"},"Collections"),r.a.createElement(On.d,{to:"/upload"},"Upload"),r.a.createElement(On.d,{to:"https://cgps.gitbook.io/pathogenwatch/",external:!0,className:"sm-hide"},"Documentation"),r.a.createElement("a",{className:"mdl-button mdl-button--icon",href:"https://twitter.com/pathogenwatch",rel:"noopener",target:"_blank",title:"Follow @Pathogenwatch"},r.a.createElement("i",{className:"cgps-twitter-icon"})),r.a.createElement("a",{className:"mdl-button mdl-button--icon",href:"mailto:cgps@sanger.ac.uk",rel:"noopener",target:"_blank",title:"Contact us"},r.a.createElement("i",{className:"material-icons"},"email")));const In=({header:e})=>e,Tn=()=>r.a.createElement(J.a,{to:"/offline",className:"wgsa-main-menu-button",title:"View Saved Collections"},r.a.createElement("i",{className:"material-icons"},"signal_wifi_off"));var Ln=Object(c.a)((function(e){return{...In(e),offline:Object(xn.b)()}}))(({asideEnabled:e,className:t,offline:a,children:n=r.a.createElement(_n,{asideEnabled:e})})=>r.a.createElement("header",{className:m()("mdl-layout__header mdl-layout__header--scroll wgsa-header",{"wgsa-header--inverse":a},t)},r.a.createElement("div",{className:"mdl-layout__header-row"},a?r.a.createElement(Tn,null):r.a.createElement(Nn,null),r.a.createElement(J.a,{to:"/",className:"mdl-layout-title"},r.a.createElement(H,{className:"wgsa-header-logo"})),n))),jn=r.a.createElement(o.a,{component:Ln}),An=(a(1005),a(13)),Pn=a(23),Rn=a(78),Mn=a.n(Rn);const Dn=e=>e.viewer.clusterView,Fn=Object(ce.createSelector)(Dn,e=>e.lassoPath),zn=Object(ce.createSelector)(Dn,e=>e.lassoActive);function Gn(e,t){let a=!1;for(let n=0,r=e.length-1;n<e.length;r=n++)e[n].y>t.y!=e[r].y>t.y&&t.x<(e[r].x-e[n].x)*(t.y-e[n].y)/(e[r].y-e[n].y)+e[n].x&&(a=!a);return a}const Un=Object(ce.createSelector)(Fn,Xe,(e,t)=>{if(e){const a=[];for(const n of t.nodes)n.x&&n.y&&Gn(e,n)&&a.push(...n.genomeIds);return a}}),Bn=Object(ce.createSelector)(Be,Ve,He,(e,t,a)=>{const n={};if(!t)return{items:n};let r=null,s=0;for(let o=0;o<t.length&&!(t[o]>me.b);o++)r!==a[o]&&(r=a[o],n[e[o]]=""),s=e[o];return{max:s||e[a.indexOf(r)],items:n}}),$n=Object(ce.createSelector)(e=>e.location,e=>Object(Rn.parse)(e.search).threshold);var Hn=a(37),Vn=a(87),Kn=a.n(Vn),qn=a(43),Wn=a.n(qn),Yn=a(27),Zn=a(55);const Xn=Object(ce.createSelector)(Yn.g,Yn.a,(e,t)=>Object(Zn.a)(e.entities[t],e.multi)),Qn=Object(ce.createSelector)(Yn.d,e=>e.activeColumn.valueGetter);function Jn(e){return e.reference?"triangle":e.public?"square":"circle"}const er=Object(ce.createSelector)(Pn.a,Qn,Xn,(e,t,a)=>{const n={};for(const r of e){const e=t(r);n[r.id]={colour:a(r),label:"string"==typeof e&&e.length?e:" ",shape:Jn(r)}}return n});var tr=a(57);const ar=e=>Kn()(e).format("YYYY-MM-DD");function nr(e){const t=[],a={};for(const n of e){const e=n.date;a[e]=(a[e]||0)+1,t.push({x:e,y:a[e],id:n.id})}return t}function rr(e,t){const a={};for(const n of e){const e=Kn()(n.date),r=[e.year()];"quarter"===t?r.push(e.quarter()):"week"===t?r.push(e.week()):"month"===t?r.push(e.month()+1):"day"===t&&(r.push(e.month()+1),r.push(e.date()));const s=r.join("-");if(a[s])a[s].y++;else{const n=Kn()({year:e.year()});"quarter"===t?n.set("quarter",e.quarter()):"week"===t?n.set("week",e.week()):"month"===t?n.set("month",e.month()):"day"===t&&(n.set("month",e.month()),n.set("date",e.date())),a[s]={x:n.toDate(),y:1,label:ar(n)}}}return Object.values(a)}const sr=e=>({min:0,max:e.length-1}),or=({min:e,max:t},a)=>a.length?{min:Kn()(a[Math.ceil(e)].x),max:Kn()(a[Math.floor(t)].x)}:{},lr=e=>Object(An.f)(e).timeline.libmicroreact,ir=Object(ce.createSelector)(Yn.d,er,(e,t)=>({id:a})=>`${Object(tr.a)(e.activeColumn)}: ${t[a].label}`),cr=Object(ce.createSelector)(Pn.a,e=>{const t=[];for(const a of e)a.year&&t.push({date:new Date(`${a.year}-${a.month||1}-${a.day||1}`),id:a.id});return Wn()(t,"date")}),ur=e=>cr(e).length>0,mr=Object(ce.createSelector)(cr,e=>lr(e).unit,rr),dr=Object(ce.createSelector)(e=>lr(e).bounds,mr,(e,t)=>e||sr(t)),pr=Object(ce.createSelector)(dr,mr,or),hr=Object(ce.createSelector)(e=>lr(e).bounds,cr,pr,(e,t,{min:a,max:n})=>{if(null===e)return null;const r=[];for(const{date:e,id:s}of t)a.isSameOrBefore(e)&&n.isSameOrAfter(e)&&r.push(s);return r});var fr=a(52);const gr=e=>e.viewer,br=e=>gr(e).search.intersections,yr=Object(ce.createSelector)(br,e=>e.reduce((e,t)=>{let a=t[0].value.ids;for(const{value:e}of t.slice(1))a=a.filter(t=>-1!==e.ids.indexOf(t));return e.concat(a)},[])),Er=Object(ce.createSelector)(e=>gr(e).filter,Un,Hn.c,hr,(e,t=[],a=[],n=[])=>{const r=[];return e[fr.a.MAP].active&&r.push(e[fr.a.MAP].ids),t.length&&r.push(new Set(t)),a&&a.length&&r.push(new Set(a)),n&&n.length&&r.push(new Set(n)),e[fr.a.VISIBILITY].active&&r.push(e[fr.a.VISIBILITY].ids),r}),vr=Object(ce.createSelector)(Pn.c,Hn.f,(e,t)=>t.length?t:e),Cr=Object(ce.createSelector)(Pn.c,e=>e.length),wr=Object(ce.createSelector)(Er,br,yr,(e,t,a)=>{const n=[...e];t.length&&n.push(new Set(a));const r=new Set(n[0]);for(const e of n.slice(1))for(const t of r)e.has(t)||r.delete(t);return new Set(r)}),Sr=Object(ce.createSelector)(br,wr,(e,t)=>!!e.length||!!t.size),Nr=Object(ce.createSelector)(vr,Cr,wr,Sr,(e,t,a,n)=>({unfilteredIds:e,total:t,ids:a,active:n,count:n?a.size:e.length})),Or=Object(ce.createSelector)(Nr,e=>Array.from(e.active?e.ids:e.unfilteredIds));var xr=a(9),kr=a(133),_r=a(110);const Ir=e=>Object(An.f)(e).search,Tr=e=>Ir(e).category,Lr=e=>Ir(e).text,jr=e=>Ir(e).sort,Ar=e=>Ir(e).advanced,Pr=Object(ce.createSelector)(Tr,Lr,e=>Ir(e).exact,(e,t,a)=>{if(!t.length)return null;let n;return e&&e.numeric&&(n=Object(_r.e)(t)),n||(n=Object(_r.g)(t,a)),n}),Rr=Object(ce.createSelector)(Ir,e=>Array.from(e.recent)),Mr=Object(ce.createSelector)(Ir,e=>e.intersections),Dr=Object(ce.createSelector)(Ir,e=>e.intersections[e.currentIntersection]),Fr=Object(ce.createSelector)(Yn.h,Pr,Yn.j,(e,t,a)=>Object.keys(e).reduce((n,r)=>{const s=e[r],o=Object(_r.i)(s.columns,r,t);if(s===e.metadata){const e=Object(_r.f)(a,t);e&&o.unshift(e)}return o.length&&n.push({heading:xr.b[r],items:o}),n},[]));function zr(e,t,a){const n=a.length?[{key:`contains_${t}`,label:t,ids:a,isExpression:!0}]:[],r=e.numeric?"Enter expression: =, <, >, <=, >=":"Enter text";return{heading:e.numeric?"Expression":"Contains",placeholder:r,items:n}}const Gr=Object(ce.createSelector)(Pn.b,Pn.a,Dr,Er,(e,t,a,n)=>{const r=[...n];if(a)for(const e of a)r.push(new Set(e.value.ids));if(!r.length)return t;const s=new Set(r[0]);for(const e of r.slice(1))for(const t of s)e.has(t)||s.delete(t);return Array.from(s).map(t=>e[t])}),Ur=Object(ce.createSelector)(Tr,Yn.h,Lr,Pr,Gr,jr,Dr,(e,t,a,n,r,s,o=[])=>{const l=t[e.tableName],i=Object(_r.d)(l.columns,e.key),c=new Map,u=[];for(const t of r){const a=i.valueGetter(t);if(null==a)continue;if(o.some(n=>n.category.key===e.key&&n.value.key===a||!n.value.ids.includes(t.uuid)))continue;const r=Object(_r.h)(a,e.tableName),s=n&&n.test(r);if(s&&u.push(t.uuid),n?s:r){const e=c.get(a)||{key:a,label:r,ids:[]};e.ids.push(t.uuid),c.set(a,e)}}return[zr(e,a,u),{heading:"Matches",items:Array.from(c.values()).sort(_r.j[s]),placeholder:"No results",sort:!0}]}),Br=e=>Tr(e)?Ur(e):Fr(e),$r=Object(ce.createSelector)(Br,e=>Ir(e).cursor,(e,t)=>{if(0===e.length)return null;let a=t;for(const{items:t}of e){if(!(a>=t.length))return t[a];a-=t.length}const{items:n}=e[e.length-1];return n[n.length-1]||null}),Hr=Object(ce.createSelector)(Ir,Yn.d,({advanced:e,category:t},a)=>e?`FILTER ${t?t.label:"COLUMNS"}`:`FILTER ${Object(tr.a)(a.activeColumn)}`);var Vr=a(34);var Kr=Object(c.a)((function(e){return{active:jr(e)}}),(function(e){return{onChange:t=>e(Object(Vr.s)(t.target.value))}}))(({active:e,onChange:t})=>r.a.createElement("aside",null,r.a.createElement("label",null,"Sort by",r.a.createElement("select",{value:e,onChange:t},r.a.createElement("option",{value:kr.b.FREQ_DESC},"Frequency: High to Low"),r.a.createElement("option",{value:kr.b.FREQ_ASC},"Frequency: Low to High"),r.a.createElement("option",{value:kr.b.VALUE_ASC},"Value: Ascending"),r.a.createElement("option",{value:kr.b.VALUE_DESC},"Value: Descending")))));var qr=Object(c.a)((function(e,{index:t}){return{active:Ir(e).currentIntersection===t}}),(function(e,{index:t}){return{onClick:()=>e(Object(Vr.q)(t))}}))(({operator:e,active:t,onClick:a})=>r.a.createElement("button",{className:m()("mdl-chip",{"mdl-chip--active":t}),onClick:a},r.a.createElement("span",{className:"mdl-chip__text"},e)));function Wr(e){return(t,a)=>{const n=Ir(a());if(n.recent.has(e))t(Object(Vr.k)(e));else if(n.category){const a=Object(_r.b)(n.category,e);t(Object(Vr.k)(a))}else t(Object(Vr.r)(e))}}function Yr(e,t,a){const n=Object(Yn.e)(e),r=Object(Yn.d)(e),s=Object(Pn.a)(e);return Object(_r.a)(n,r,s,t,a)}const Zr=r.a.createClass({displayName:"AdvancedMode",propTypes:{open:r.a.PropTypes.bool},renderCurrentFilter(){const{current:e,removeTerm:t}=this.props;return e.length?r.a.createElement("section",null,r.a.createElement("h2",{className:"wgsa-search-dropdown__heading"},"Current Filter"),e.map((a,n)=>r.a.createElement("ul",{key:n},a.map((e,s)=>r.a.createElement("li",{key:e.key},r.a.createElement("span",{className:"mdl-chip mdl-chip--deletable mdl-chip--contact mdl-chip--alt"},r.a.createElement("span",{className:"mdl-chip__contact"},e.value.ids.length),r.a.createElement("span",{className:"mdl-chip__text"},r.a.createElement("small",null,e.category.label,": "),r.a.createElement("strong",null,e.value.label)),r.a.createElement("button",{className:"mdl-chip__action",onClick:()=>t(e,n),title:"Remove"},r.a.createElement("i",{className:"material-icons"},"cancel"))),s<a.length-1&&r.a.createElement("span",{className:"wgsa-search-operator"},"AND"))),r.a.createElement("li",null,r.a.createElement(qr,{operator:"AND",index:n})),n<e.length-1&&r.a.createElement("li",{className:"wgsa-search-operator"},r.a.createElement("span",null,"OR")),n===e.length-1&&r.a.createElement("li",{className:"wgsa-search-operator"},r.a.createElement(qr,{operator:"OR",index:e.length})))),r.a.createElement("hr",null)):null},renderRecentTerms(){const{recent:e,selectItem:t}=this.props;return e.length?r.a.createElement("section",null,r.a.createElement("h2",{className:"wgsa-search-dropdown__heading"},"Recently Used"),r.a.createElement("ul",null,e.map(e=>r.a.createElement("li",{key:e.key},r.a.createElement("button",{className:"mdl-chip mdl-chip--contact",onClick:()=>t(e)},r.a.createElement("span",{className:"mdl-chip__text"},r.a.createElement("span",{className:"mdl-chip__contact mdl-chip__contact--muted"},e.value.ids.length),r.a.createElement("small",null,e.category.label,": "),r.a.createElement("strong",null,e.value.label)))))),r.a.createElement("hr",null)):null},getColumnHeading:(e,t)=>e?r.a.createElement("h2",{className:"wgsa-search-dropdown__heading"},"Choose Value"):t.length?r.a.createElement("h2",{className:"wgsa-search-dropdown__heading"},"Choose Column"):r.a.createElement("span",null,"(No matching column)"),render(){const{sections:e,activeItem:t,category:a}=this.props,{selectItem:n,removeCategory:s}=this.props;return r.a.createElement("div",{className:"wgsa-advanced-search"},this.renderCurrentFilter(),this.renderRecentTerms(),r.a.createElement("section",null,this.getColumnHeading(a,e),!!a&&r.a.createElement("span",{className:"mdl-chip mdl-chip--deletable"},r.a.createElement("span",{className:"mdl-chip__text"},a.label),r.a.createElement("button",{className:"mdl-chip__action",onClick:()=>s()},r.a.createElement("i",{className:"material-icons"},"cancel")))),r.a.createElement("div",{className:"wgsa-search-dropdown__values"},e.map(({heading:e,items:a,placeholder:s,sort:o})=>r.a.createElement("section",{key:e},o&&r.a.createElement(Kr,null),r.a.createElement("h3",{className:"wgsa-search-dropdown__heading"},e),s&&!a.length&&r.a.createElement("p",null,"(",s,")"),r.a.createElement("ul",null,a.map(e=>r.a.createElement("li",{key:e.key},r.a.createElement("button",{className:m()("mdl-chip",{"mdl-chip--active":e===t,"mdl-chip--contact":e.ids}),onClick:()=>n(e)},e.ids&&r.a.createElement("span",{className:"mdl-chip__contact"},e.ids.length),r.a.createElement("span",{className:"mdl-chip__text"},e.label)))))))))}});var Xr=Object(c.a)((function(e){return{category:Tr(e),current:Mr(e),recent:Rr(e),sections:Br(e),activeItem:$r(e)}}),(function(e){return{selectItem:t=>e(Wr(t)),removeTerm:(t,a)=>e(Object(Vr.p)(t,a)),removeCategory:()=>e(Object(Vr.r)(null))}}))(Zr);const Qr=r.a.createClass({displayName:"SearchDropdown",propTypes:{isOpen:r.a.PropTypes.bool,close:r.a.PropTypes.func},render(){const{isOpen:e,close:t}=this.props;return r.a.createElement(b.a,{className:"wgsa-search-dropdown-container"},e?r.a.createElement("div",{className:"wgsa-search-dropdown"},r.a.createElement("button",{onClick:t,className:"mdl-button mdl-button--icon"},r.a.createElement("i",{className:"material-icons"},"close")),r.a.createElement(Xr,null)):null)}});var Jr=Object(c.a)((function(e){return{isOpen:Ar(e)}}),(function(e){return{close:()=>e(Object(Vr.u)())}}))(Qr),es=a(64);var ts=Object(c.a)((function(e){const t=Nr(e);return{totalAmount:t.total,filteredAmount:t.count,active:t.active}}),(function(e){return{clear:()=>e(Object(es.g)())}}))(({active:e,filteredAmount:t,totalAmount:a,clear:n,children:s})=>r.a.createElement("span",{className:"wgsa-filter-status",onClick:e=>e.stopPropagation()},r.a.createElement("span",null,t," of ",a),s,r.a.createElement("button",{className:"mdl-button mdl-button--icon",onClick:n,title:"Clear filter",disabled:!e},r.a.createElement("i",{className:"material-icons"},"backspace"))));const as=r.a.createClass({displayName:"Search",propTypes:{filteredAmount:r.a.PropTypes.number,totalAmount:r.a.PropTypes.number,filterColumnName:r.a.PropTypes.string,handleChange:r.a.PropTypes.func},componentDidUpdate(e){const{search:t}=this.props;e.search.category===t.category&&e.search.intersections===t.intersections&&e.search.currentIntersection===t.currentIntersection&&e.search.advanced===t.advanced||this.refs.input.focus()},handleChange(e){this.props.handleChange(e.target.value)},handleClick(){this.refs.input.focus()},handleKeyboard(e){const{text:t,category:a}=this.props.search;switch(e.keyCode){case 37:this.props.moveCursor(-1);break;case 39:this.props.moveCursor(1);break;case 38:this.props.moveIntersection(-1);break;case 40:this.props.moveIntersection(1);break;case 8:a&&0===t.length&&this.props.removeCategory();break;case 13:this.props.selectItemAtCursor();break;case 27:e.stopPropagation(),this.props.toggleMode()}},render(){const{toggleMode:e,toggleExactMatch:t,search:a}=this.props,{text:n,advanced:s,exact:o}=a;return r.a.createElement("div",{className:"wgsa-search-box-container"},r.a.createElement("div",{className:m()("wgsa-search-box",{"wgsa-search-box--active":s}),onClick:this.handleClick},r.a.createElement("i",{className:"wgsa-search-box__icon material-icons"},"search"),r.a.createElement("button",{className:m()("mdl-button mdl-button--icon",{active:s}),onClick:e,title:"Toggle advanced search"},r.a.createElement("i",{className:"material-icons"},"add_box")),r.a.createElement("button",{className:m()("mdl-button mdl-button--icon",{active:o}),onClick:t,title:"Toggle exact match"},r.a.createElement("i",{className:"material-icons"},"explicit")),r.a.createElement("input",{ref:"input",className:"wgsa-search-box__input",placeholder:this.props.placeholder,onChange:this.handleChange,onKeyDown:this.handleKeyboard,value:n}),r.a.createElement(ts,null)),r.a.createElement(Jr,null))}});var ns=Object(c.a)((function(e){return{search:Ir(e),placeholder:Hr(e)}}),(function(e){return{handleChange:t=>e(function(e){return(t,a)=>{const n=a(),r=Ir(n),{advanced:s,exact:o}=r;if(s)t(Object(Vr.m)(e));else{const a=Yr(n,e,o);t(Object(Vr.k)(a))}}}(t)),openDropdown:t=>e(Object(Vr.l)(t)),removeCategory:()=>e(Object(Vr.r)(null)),selectItemAtCursor:()=>e((e,t)=>{const a=$r(t());a&&e(Wr(a))}),moveCursor:t=>e(Object(Vr.n)(t)),moveIntersection:t=>e(Object(Vr.o)(t)),toggleMode:()=>e(Object(Vr.u)()),toggleExactMatch:()=>e((e,t)=>{const a=t(),n=Ir(a),{text:r,exact:s}=n,o=!!r.length&&Yr(a,r,!s);e(Object(Vr.t)(o))})}}))(as),rs=(a(1007),a(159)),ss=(a(1009),r.a.createClass({displayName:"DropArea",propTypes:{onFiles:r.a.PropTypes.func.isRequired},getInitialState:()=>({indicatorVisible:!1}),handleDrop(e){e.stopPropagation(),e.preventDefault(),this.setState({indicatorVisible:!1}),e.dataTransfer&&e.dataTransfer.files.length>0&&this.props.onFiles(e.dataTransfer.files)},showDropIndicator(e){e.stopPropagation(),e.preventDefault(),this.setState({indicatorVisible:!0})},hideDropIndicator(e){e.stopPropagation(),e.preventDefault(),this.setState({indicatorVisible:!1})},handleClick(){this.refs.fileInput.click()},handleFileInputChange(e){const{files:t}=e.target;t&&t.length>0&&(this.props.onFiles(t),e.target.value=null)},render(){return r.a.createElement("form",{className:m()("pw-drop-area-form",this.props.className,{"is-indicating":this.state.indicatorVisible}),onDragOver:this.showDropIndicator,onDragLeave:this.hideDropIndicator,onDrop:this.handleDrop,onClick:this.handleClick},r.a.createElement(b.a,null,this.state.indicatorVisible?r.a.createElement("p",{key:"drop"},r.a.createElement("strong",null,"Drop to upload")):r.a.cloneElement(this.props.children,{key:"instructions"})),r.a.createElement("input",{type:"file",multiple:"multiple",accept:".csv",ref:"fileInput",onChange:this.handleFileInputChange}))}}));const os=window.URL||window.webkitURL;function ls(e){const t=new Blob([e],{type:"text/csv;charset=utf-8"});return os.createObjectURL(t)}var is=r.a.createClass({displayName:"DownloadButton",getInitialState:()=>({link:null}),componentWillReceiveProps(e){this.props.genomeIds!==e.genomeIds&&this.setState({link:null})},componentDidUpdate(e,t){!t.link&&this.state.link&&this.link.click()},onClick(){this.props.generateFile().then(e=>{this.setState({link:ls(e)})})},render(){const{filename:e,title:t,children:a,className:n}=this.props;return this.state.link?r.a.createElement("a",{ref:e=>{this.link=e},href:this.state.link,target:"_blank",rel:"noopener",download:e,title:t,className:n},a):r.a.createElement("button",{onClick:this.onClick,title:t,className:n},a)}}),cs=a(303),us=a.n(cs),ms=a(472),ds=a.n(ms);const ps=/(\.csv)$/i;function hs(e){const t={};for(const[a,n]of Object.entries(e))a.length&&"string"==typeof n&&(t[a.toLowerCase().trim()]=n.trim().replace(/^=*/,""));return t}function fs(e){const t=us.a.parse(e,{header:!0,dynamicTyping:!1,skipEmptyLines:!0});return t.errors.length>0&&(console.error("[Pathogenwatch] Errors during CSV to JSON conversion:"),console.dir(t.errors)),t.data=t.data.map(hs),t}function gs(e,t=e.filename){const{displayname:a,id:n,name:r,...s}=e,o=a||r||n||t,{year:l,month:i,day:c,latitude:u,longitude:m,pmid:d,...p}=s,h={};for(const[e,t]of Object.entries(p))t.length&&"filename"!==e&&(h[e]=t);const f={name:o,userDefined:h};return l&&(f.year=parseInt(l,10)),i&&(f.month=parseInt(i,10)),c&&(f.day=parseInt(c,10)),u&&(f.latitude=parseFloat(u)),m&&(f.longitude=parseFloat(m)),d&&(f.pmid=d),ds()(f),f}var bs={parseCsvToJson:fs,isValid:function({date:e}){const t=(new Date).getFullYear();if(!e)return!0;const{day:a,month:n,year:r}=e;return!(a&&(a<1||a>31||!n||!r))&&(!(n&&(n<1||n>12||!r))&&(!r||!(r<1900||r>t)))}},ys=a(144),Es=a(298);const vs=Object(ce.createSelector)(e=>e.viewer.highlight,e=>e.ids),Cs=Object(ce.createSelector)(vs,Array.from),ws=Object(ce.createSelector)(vs,e=>e.size>0);var Ss=function(e,{trimQuotes:t=!0}={}){const a=function(e){const t=[],a=[e];for(;a.length;){const e=a.pop();Array.isArray(e.children)&&a.push(...e.children),t.push(e)}return t.reverse()}(e),n=function(e){const t=[],a=[e];for(;a.length;){const e=a.shift();t.push(e),Array.isArray(e.children)&&a.unshift(...e.children)}return t}(e);if(a.every(e=>0===(e.branchLength||e.branch_length||0))){e.branchLength=0;for(let e=0;e<n.length;e++){const t=n[e];if(t.children)for(const e of t.children)e.branchLength=t.branchLength+1}}for(let e=0;e<a.length;e++){const n=a[e];if(n.postIndex=e,n.isLeaf=!Array.isArray(n.children),n.branchLength=Math.abs(n.branchLength||n.branch_length||0),delete n.branch_length,n.isLeaf&&"string"==typeof n.name&&(n.id=t?n.name.trim().replace(/^['"]|['"]$/g,""):n.name,delete n.name),n.totalNodes=1,n.totalLeaves=1,n.totalLeafLength=n.branchLength,!n.isLeaf){n.totalNodes=1,n.totalLeaves=0;let e=0;for(const t of n.children)n.totalNodes+=t.totalNodes,n.totalLeaves+=t.totalLeaves,t.totalLeafLength>e&&(e=t.totalLeafLength),t.parent=n;n.totalLeafLength=n.branchLength+e,n.longestLeaf=e}}const r={},s=[];for(let e=0;e<n.length;e++){const t=n[e];t.preIndex=e,t.id||(t.id=e.toString()),r[t.id]=t,t.distanceFromRoot=(t.parent?t.parent.distanceFromRoot:0)+t.branchLength,t.isLeaf&&s.push(t),t.visibleLeaves=t.totalLeaves}return{nodeById:r,rootNode:e,leafNodes:s,postorderTraversal:a,preorderTraversal:n}};const Ns=a(705);var Os=function(e){let t=e;"string"==typeof e&&(t={type:"newick",data:e});const{type:a,data:n,...r}=t;let s=null;if("newick"===a||void 0===a)s=Ns.parse_newick(n);else{if("biojs"!==a)throw new Error(`Source type is not supported: ${a}`);s=n}return Ss(s,r)};function xs(e,t,a){const n=[];for(const r of a.children){const a=e.splice(t,r.totalNodes);n.push(a)}for(const a of n)e.splice(t,0,...a)}var ks=function(e,t,a){const{preorderTraversal:n,postorderTraversal:r}=t;xs(n,n.indexOf(a)+1,a);for(let e=0;e<n.length;e++)n[e].preIndex=e;xs(r,r.indexOf(a)-a.totalNodes+1,a);for(let e=0;e<r.length;e++)r[e].postIndex=e;a.children.reverse()},_s=a(62),Is=a(20);const Ts=Object(ce.createSelector)(er,e=>Or?Or(e):[],Pn.b,(e,t,a)=>{const n={};for(const r of Object.keys(e)){const s=t.includes(r);n[r]={fillStyle:e[r].colour,fontStyle:a[r].__isCollection||a[r].reference?"bold":null,label:e[r].label,labelFillStyle:a[r].__isCollection?T.b.COLOURS.PURPLE:null,shape:s?e[r].shape:"none",strokeStyle:e[r].colour}}return n}),Ls=({status:e,size:t,populationSize:a,progress:n},r)=>{if("PENDING"===e)return`${r}: Pending`;if("IN PROGRESS"===e)return`${r}: ${n}%`;if("ERROR"===e)return`${r}: Error, awaiting retry`;if("FAILED"===e)return`${r}: Failed`;if("READY"===e){const e=t-a;return a>0?`${r} (${e}) [${a}]`:e>0?`${r} (${e})`:r}},js=Object(ce.createSelector)(_s.d,_s.c,e=>Object(_s.d)(e)[Is.b].leafIds,Hn.b,(e,t,a,n)=>{const r={};for(const s of a){const a=n[s];t.includes(s)?r[s]={fillStyle:T.b.COLOURS.PURPLE_LIGHT,fontStyle:"bold",label:Ls(e[s],a),labelFillStyle:T.b.COLOURS.PURPLE}:r[s]={fillStyle:T.b.COLOURS.GREY,label:a}}return r});var As=a(107);const Ps=Object(ce.createSelector)(Hn.e,Cs,Pn.b,(e,t,a)=>{if(e===Is.b){const e=new Set;for(const n of t)a[n].analysis&&e.add(a[n].analysis.core.fp.reference);return Array.from(e)}return t}),Rs=Object(ce.createSelector)(Hn.e,Hn.b,e=>Object(An.a)(e).uuid,(e,t,a)=>{const n=e in As.a?As.a[e].toLowerCase():t[e];return`pathogenwatch-${Ua.b.nickname}-${a}${n?`-${n}`:""}-tree`}),Ms=Object(ce.createSelector)(Rs,e=>({image:`${e}.png`,leafLabels:`${e}-labels.txt`,newick:`${e}.nwk`})),Ds={digits:0,fontSize:13,position:{left:8,bottom:16}},Fs={shape:"triangle"},zs=Object(ce.createSelector)(_s.e,Hn.g,e=>Object(Hn.e)(e)===Is.b?js(e):Ts(e),Ps,({name:e,newick:t},{phylocanvas:a},n,r)=>({...a,leafNodeStyle:e===Is.b?Fs:a.leafNodeStyle,renderLeafLabels:e===Is.b||a.renderLeafLabels,scalebar:Ds,selectedIds:r,source:a.source||t,styles:n})),Gs=(e,t=[])=>{if(!e)return[];for(const a of t){const t=e.nodeById[a];ks(0,e,t)}const a=[];for(const t of e.preorderTraversal)t.isLeaf&&a.push(t.id);return a},Us=e=>{const t=Object(Hn.a)(e);return Is.a in t?t[Is.a].phylocanvas:{}},Bs=Object(ce.createSelector)(e=>Us(e).source,e=>(Object(_s.d)(e)[Is.a]||{}).newick,(e,t)=>e||t?Os(e||t):null),$s=Object(ce.createSelector)(Bs,e=>Us(e).rotatedIds,(e,t)=>Gs(e,t)),Hs=Object(ce.createSelector)(e=>Object(Hn.g)(e).phylocanvas.source,e=>e?Os(e):null),Vs=Object(ce.createSelector)(Hn.e,$s,Hs,e=>Object(Hn.g)(e).phylocanvas.rotatedIds,(e,t,a,n)=>As.b.has(e)?t.length?t:null:Gs(a,n)),Ks=Object(ce.createSelector)(vs,Or,(e,t)=>Array.from(e.size?e:t)),qs=Object(ce.createSelector)(Pn.b,Ks,e=>{if(!Object(An.g)(e))return Vs(e)},(e,t,a)=>{if(!a||!a.length)return t.map(t=>e[t]);const n=[];for(const r of a)t.includes(r)&&n.push(e[r]);return n}),Ws=Object(ce.createSelector)(qs,e=>e.filter(e=>"me"===e.owner));var Ys=Object(c.a)((function(e){return{numberOfRows:Object(Es.b)(e),genomes:Ws(e)}}),(function(e){return{addMetadata:t=>e(Object(ys.c)(t)),clearMetadata:()=>e(Object(ys.d)())}}),(function({numberOfRows:e,genomes:t},a){return{numberOfRows:e,...a,generateCSV:()=>Promise.resolve("name\n".concat(t.map(e=>e.name).join("\n")))}}))((function({addMetadata:e,numberOfRows:t,clearMetadata:a,generateCSV:n}){const[s,o]=r.a.useState(!1),[l,i]=r.a.useState(null);return r.a.createElement(ht,{align:"right",button:r.a.createElement(bt,{title:"Private metadata"},r.a.createElement("i",{className:"material-icons"},"note_add")),caret:!0,className:"pw-viewer-add-metadata-menu",open:s,toggle:()=>{s||i(null),o(!s)},toggleOnClick:!1},r.a.createElement("header",null,r.a.createElement("h3",null,"Private Metadata"),r.a.createElement(b.a,{out:!0},s&&t>0&&r.a.createElement("button",{key:"clear",className:"wgsa-link-button secondary",onClick:a},r.a.createElement("i",{className:"material-icons wgsa-button-icon"},"remove_circle_outline"),"Clear ",t," added rows"))),r.a.createElement("p",null,"Drag and drop a file in ",r.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Comma-separated_values",target:"_blank",rel:"noopener"},"CSV format")," to add private metadata to this view. These data stay on your computer and are ",r.a.createElement("strong",null,"not saved anywhere else"),", so please retain your files."),r.a.createElement("p",null,"The ",r.a.createElement("strong",null,"name")," column is used to match rows to genome records.",r.a.createElement("br",null),r.a.createElement(is,{className:"wgsa-link-button",filename:"genomes.csv",generateFile:n},"Download names of your uploaded genomes in this view")),r.a.createElement("p",null,"We recommend you include the following columns:",r.a.createElement("br",null),r.a.createElement("strong",null,"latitude"),", ",r.a.createElement("strong",null,"longitude"),", ",r.a.createElement("strong",null,"year"),", ",r.a.createElement("strong",null,"month"),", ",r.a.createElement("strong",null,"day")),r.a.createElement("p",null,"When providing a date, month and day are optional. Coordinates should be provided in decimal degrees. Extra columns will be included in the metadata table."),r.a.createElement(ss,{className:"pw-viewer-add-metadata-form",onFiles:function(t){const a=Array.from(t)[0];ps.test(a.name)?Object(rs.readAsText)(a).then(fs).then(({data:t,errors:a})=>{if(a.length>0){const[e]=a;i(e)}else e(t.map(e=>{const t=gs(e);return{...t,position:{latitude:t.latitude,longitude:t.longitude}}})),o(!1)}):i({message:"File extension must end with .csv"})}},l?r.a.createElement("p",{key:"error"},!isNaN(l.row)&&r.a.createElement(r.a.Fragment,null,"There is a problem on row ",l.row+1,":",r.a.createElement("br",null)),r.a.createElement("strong",null,l.message)):r.a.createElement("p",{key:"instruction"},"Drag and drop or click to add")))})),Zs=(a(1011),a(213)),Xs=a.n(Zs),Qs=a(259),Js=a.n(Qs),eo=a(90),to=(a(1013),a(236));const ao=e=>Object(An.a)(e).access,no=e=>Object(An.a)(e).access_status;var ro=Object(c.a)((function(e,{level:t}){return{active:ao(e)===t}}),(function(e,{level:t}){return{onClick:()=>e(Object(to.b)(t))}}))(({onClick:e,icon:t,active:a,title:n,description:s})=>r.a.createElement("button",{className:m()({active:a}),title:`Set collection to "${n}"`,onClick:e,disabled:a},r.a.createElement("i",{className:"material-icons"},t),r.a.createElement("div",null,r.a.createElement("strong",null,n),r.a.createElement("br",null),s)));var so=Object(c.a)((function(e){return{status:no(e)}}))(({status:e})=>{if(!e||"LOADING"===e)return null;let t;return"ERROR"===e&&(t=r.a.createElement("p",null,r.a.createElement("i",{className:"material-icons"},"error_outline")," Failed, please try again")),"OK"===e&&(t=r.a.createElement("p",null,r.a.createElement("i",{className:"material-icons"},"check_circle")," Saved")),r.a.createElement(b.a,{className:"wgsa-collection-access-status"},t)}),oo=()=>r.a.createElement("section",{className:"wgsa-collection-access"},r.a.createElement("h4",null,"Access level"),r.a.createElement(so,null),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(ro,{level:"private",icon:"lock",title:"Private",description:"available to you only."})),r.a.createElement("li",null,r.a.createElement(ro,{level:"shared",icon:"link",title:"Shared",description:"available to anyone with the link, no sign-in required."})))),lo=a(215),io=(a(1015),a(1017),a(493)),co=a.n(io);const uo=({className:e,id:t,onChange:a,checked:n,children:s,label:o=s})=>r.a.createElement(xt.a,{id:t,className:m()("libmr-Checkbox",e)},r.a.createElement(co.a,{onChange:a,checked:n}),r.a.createElement("label",null,o));uo.propTypes={checked:lt.a.bool,children:lt.a.node,className:lt.a.string,id:lt.a.string,label:lt.a.node,onChange:lt.a.func};var mo=uo,po=a(91),ho=a(71);const fo=({status:e})=>{switch(e){case po.a.SAVING:return"saving data...";case po.a.ERRORED:return"sorry, something went wrong.";default:return"page will refresh once saved."}};var go=({status:e,checkStatus:t,onSave:a})=>{const n=Object(ho.d)();r.a.useEffect(()=>{n&&t()},[]);const[s,o]=r.a.useState(e===po.a.SAVED);if(r.a.useEffect(()=>{s||e!==po.a.SAVED||o(!0)},[e]),!n)return r.a.createElement("div",{className:"wgsa-save-for-offline unsupported"},r.a.createElement("h4",null,"Offline mode"),r.a.createElement("p",null,"Unsupported by your browser."));return r.a.createElement("div",{className:"wgsa-save-for-offline supported"},r.a.createElement("h4",null,"Offline mode"),r.a.createElement(mo,{id:"save-for-offline",key:"checkbox",checked:s,onChange:()=>{s||(o(!0),a())}},e===po.a.SAVED?r.a.createElement("span",null,r.a.createElement("strong",null,"Saved for offline use"),r.a.createElement("br",null),r.a.createElement("a",{href:"/offline",target:"_blank",rel:"noopener"},"manage offline collections")):r.a.createElement("span",null,r.a.createElement("strong",null,"Save for offline use"),r.a.createElement("br",null),r.a.createElement(fo,{status:e}))))};const bo=e=>Object(An.f)(e).offline.status;var yo=a(263);var Eo=Object(c.a)((function(e){return{status:bo(e)}}),(function(e){return{checkStatus:()=>e(Object(yo.b)()),onSave:()=>e(Object(yo.c)())}}))(go),vo=a(302);var Co=Object(c.a)((function(e){const{aboutCollectionOpen:t}=Object(An.f)(e);return{isOpen:t,metadata:Object(An.b)(e),organism:Ua.b.current.formattedName}}),null,(function(e,{dispatch:t}){return{...e,onButtonClick:()=>t(Object(vo.b)(!e.isOpen))}}))(({organism:e,metadata:t,isOpen:a,onButtonClick:n})=>r.a.createElement(ht,{align:"right",button:r.a.createElement(bt,{title:"About collection"},r.a.createElement("i",{className:"material-icons"},"info")),caret:!0,className:"wgsa-about-collection-dropdown",open:a,toggle:n,toggleOnClick:!1},r.a.createElement(lo.a,{className:"wgsa-about-collection-dropdown__title",level:"3"},t.title||"About Collection"),r.a.createElement("p",{className:"wgsa-card-metadata-inliner"},r.a.createElement(eo.a,{title:"Organism",icon:"bug_report"},e),r.a.createElement(eo.a,{tooltip:t.dateCreated.toLocaleDateString(),icon:"access_time"},Js()(t.dateCreated,new Date)," ago")),t.description?r.a.createElement(Xs.a,{source:t.description}):r.a.createElement("p",null,"(no description)"),t.pmid&&r.a.createElement("p",{className:"pw-append-icon"},r.a.createElement(F.a,{pmid:t.pmid},"View Publication"),r.a.createElement("i",{className:"material-icons"},"launch")),"me"===t.owner&&r.a.createElement("hr",null),"me"===t.owner&&r.a.createElement(oo,{access:t.access}),r.a.createElement("hr",null),r.a.createElement(Eo,null)));a(1020),a(1022);const wo=e=>r.a.createElement(ht,g()({},e,{className:m()("libmr-DropdownMenu",e.className)}));wo.propTypes={...ht.propTypes};var So=ft(wo);Object(ce.createSelector)(Pn.b,Ks,(e,t)=>t.reduce((t,a)=>{const{reference:n,__isCollection:r}=e[a];return n?(t.reference++,t):r?(t.collection++,t):(t.public++,t)},{reference:0,collection:0,public:0}));const No=Object(ce.createSelector)(An.a,e=>Object(j.c)(`/download/collection/${e.uuid}`));var Oo=a(70);const xo=({link:e,filename:t,title:a,genomeIds:n,children:s})=>r.a.createElement("form",{action:`${e}?filename=${t}`,method:"POST"},r.a.createElement("button",{type:"submit",download:t,title:a},s),n&&r.a.createElement("input",{type:"hidden",name:"ids",value:n})),ko=({collection:e,genomeIds:t,prefix:a})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(xo,{link:`${a}/speciator`,filename:Object(Oo.a)(e,"species-prediction.csv"),genomeIds:t},"Species prediction"),Ua.b.uiOptions.kleborate&&r.a.createElement(xo,{link:`${a}/kleborate`,filename:Object(Oo.a)(e,"kleborate.csv"),genomeIds:t},"Kleborate"));ko.propTypes={collection:r.a.PropTypes.object,genomeIds:r.a.PropTypes.array,prefix:r.a.PropTypes.string};var _o=Object(c.a)((function(e){return{collection:Object(An.a)(e),genomeIds:Ks(e),prefix:No(e)}}))(ko);var Io=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:()=>ya("network-png","pathogenwatch-clustering")},"Network (.png)"),r.a.createElement("button",{onClick:()=>ya("network-svg","pathogenwatch-clustering")},"Network (.svg)")),To=a(88),Lo=a(82);const jo={columnKey:"__name",valueGetter:({name:e})=>e},Ao={columnKey:"__latitude",valueGetter:({position:e})=>e&&e.latitude?e.latitude:""},Po={columnKey:"__longitude",valueGetter:({position:e})=>e&&e.longitude?e.longitude:""},Ro={columnKey:"__mlst",valueGetter:({analysis:e})=>e.mlst?e.mlst.st:""},Mo={columnKey:"__mlst_profile",valueGetter({analysis:e}){if(!e.mlst)return null;const{code:t,alleles:a}=e.mlst;return t||Object(Lo.a)(a)}},Do={[jo.columnKey]:jo,[Ao.columnKey]:Ao,[Po.columnKey]:Po,...To.a,[Ro.columnKey]:Ro,[Mo.columnKey]:Mo},Fo={metadata:tr.c,typing:tr.c,stats:tr.c,antibiotics:(e,{analysis:{paarsnp:t}})=>Object(Zn.g)(t,e)?1:0,snps:(e,t)=>Object(Zn.f)(t,"snp",e)?1:0,genes:(e,t)=>Object(Zn.f)(t,"paar",e)?1:0};function zo(e,t,a){const n=function(e,t){return e.map(({key:e})=>{if(e in Do)return Do[e].valueGetter;const a=Fo[t];return t=>a(e,t)})}(t,e);return us.a.unparse({fields:t.map(e=>e.label),data:a.map(e=>n.map(t=>t(e)))})}function Go(e,t){return t.group?t.columns.reduce(Go,e):t.columnKey in e||t.hidden||!t.valueGetter?e:(e[t.columnKey]=t,e)}function Uo(e,t=[]){return function({genomes:a,genomeIds:n,tables:r}){let s=r[e].columns.reduce(Go,{});s=Object.keys(s).map(e=>({key:e,label:s[e].displayName||Object(tr.a)(s[e])})).concat(t);const o=n.map(e=>a[e]);return Promise.resolve(zo(e,s,o))}}const Bo=Uo(xr.c.metadata,[{key:"__latitude",label:"LATITUDE"},{key:"__longitude",label:"LONGITUDE"}]),$o=Uo(xr.c.typing),Ho=Uo(xr.c.stats),Vo=Uo(xr.c.antibiotics),Ko=Uo(xr.c.snps),qo=Uo(xr.c.genes),Wo=e=>{const{collection:t,genomes:a,genomeIds:n,tables:s}=e;return r.a.createElement(r.a.Fragment,null,e.hasMetadataTable&&r.a.createElement(is,{filename:Object(Oo.a)(t,"metadata.csv"),genomeIds:n,generateFile:()=>Bo({genomes:a,genomeIds:n,tables:s})},"Metadata table"),e.hasTypingTable&&r.a.createElement(is,{filename:Object(Oo.a)(t,"typing.csv"),genomeIds:n,generateFile:()=>$o({genomes:a,genomeIds:n,tables:s})},"Typing table"),r.a.createElement(is,{filename:Object(Oo.a)(t,"stats.csv"),genomeIds:n,generateFile:()=>Ho({genomes:a,genomeIds:n,tables:s})},"Stats table"),e.hasAMRTables&&r.a.createElement(r.a.Fragment,null,r.a.createElement("hr",null),r.a.createElement(is,{filename:Object(Oo.a)(t,"amr-profile.csv"),genomeIds:n,generateFile:()=>Vo({genomes:a,genomeIds:n,tables:s})},"AMR profile"),r.a.createElement(is,{filename:Object(Oo.a)(t,"amr-snps.csv"),genomeIds:n,generateFile:()=>Ko({genomes:a,genomeIds:n,tables:s})},"AMR SNPs"),r.a.createElement(is,{filename:Object(Oo.a)(t,"amr-genes.csv"),genomeIds:n,generateFile:()=>qo({genomes:a,genomeIds:n,tables:s})},"AMR genes")))};Wo.propTypes={collection:r.a.PropTypes.object,genomes:r.a.PropTypes.object,genomeIds:r.a.PropTypes.array,hasMetadataTable:r.a.PropTypes.bool,hasTypingTable:r.a.PropTypes.bool,tables:r.a.PropTypes.object};var Yo=Object(c.a)((function(e){return{collection:Object(An.a)(e),genomes:Object(Pn.b)(e),genomeIds:Ks(e),hasMetadataTable:Object(Pn.f)(e),hasTypingTable:Object(Yn.k)(e),hasAMRTables:Object(Pn.d)(e),tables:Object(Yn.h)(e)}}))(Wo);const Zo=({collection:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:()=>ya("timeline-png",Object(Oo.a)(e,"timeline"))},"Timeline (.png)"));Zo.propTypes={collection:r.a.PropTypes.object,genomeIds:r.a.PropTypes.array,prefix:r.a.PropTypes.string,tree:r.a.PropTypes.string};var Xo=Object(c.a)((function(e){return{collection:Object(An.a)(e)}}))(Zo);const Qo=({link:e,filename:t,title:a,genomeIds:n,tree:s,children:o})=>r.a.createElement("form",{action:`${e}?filename=${t}`,method:"POST"},r.a.createElement("button",{type:"submit",download:t,title:a,disabled:s===Is.b},o),n&&r.a.createElement("input",{type:"hidden",name:"ids",value:n}),!As.b.has(s)&&r.a.createElement("input",{type:"hidden",name:"subtree",value:s})),Jo=({link:e,filename:t,title:a,children:n})=>r.a.createElement("a",{href:`${e}?filename=${t}`,target:"_blank",rel:"noopener",download:t,title:a},n),el=({collection:e,genomeIds:t,path:a,filename:n,tree:s})=>s?r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:()=>ya("tree-nwk",n)},"Tree (.nwk)"),r.a.createElement("button",{onClick:()=>ya("tree-png",n)},"Tree (.png)"),r.a.createElement("button",{onClick:()=>ya("tree-svg",n)},"Tree (.svg)"),r.a.createElement("hr",null),r.a.createElement(Qo,{link:`${a}/core-allele-distribution`,filename:Object(Oo.a)(e,"core-allele-distribution.csv"),genomeIds:t,tree:s},"Core allele distribution"),r.a.createElement(Qo,{link:`${a}/score-matrix`,filename:Object(Oo.a)(e,"score-matrix.csv"),genomeIds:t,tree:s},"Score matrix"),r.a.createElement(Qo,{link:`${a}/difference-matrix`,filename:Object(Oo.a)(e,"difference-matrix.csv"),genomeIds:t,tree:s},"Difference matrix"),r.a.createElement(Jo,{link:`${a}/variance-summary`,filename:Object(Oo.a)(e,"variance-summary.csv")},"Variance summary")):null;el.propTypes={collection:r.a.PropTypes.object,genomeIds:r.a.PropTypes.array,prefix:r.a.PropTypes.string,tree:r.a.PropTypes.string};var tl=Object(c.a)((function(e){return{collection:Object(An.a)(e),filename:Rs(e),genomeIds:Ks(e),path:No(e),tree:Object(Hn.e)(e)}}))(el);const al=({viewHasTrees:e,viewHasNetwork:t,viewHasTimeline:a})=>{const[n,s]=r.a.useState(!1);return r.a.createElement(So,{align:"right",button:r.a.createElement(bt,{title:"Downloads"},r.a.createElement("i",{className:"material-icons",style:{marginTop:"1px"}},"file_download")),className:"pw-downloads-menu",open:n,toggle:()=>{s(!n)},toggleOnClick:!1},r.a.createElement(_o,null),r.a.createElement("hr",null),r.a.createElement(Yo,null),(e||t)&&r.a.createElement("hr",null),e&&r.a.createElement(r.a.Fragment,null,a&&r.a.createElement(Xo,null),r.a.createElement(tl,null)),t&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Io,null),a&&r.a.createElement(Xo,null)))};al.propTypes={viewHasTrees:r.a.PropTypes.bool,viewHasNetwork:r.a.PropTypes.bool,viewHasTimeline:r.a.PropTypes.bool};var nl=Object(c.a)((function(e){return{viewHasTrees:Object(_s.f)(e),viewHasNetwork:Object(An.g)(e),viewHasTimeline:ur(e)}}))(al);var rl=Object(c.a)((function(e){return{clusterView:Object(An.g)(e)}}))(({clusterView:e})=>r.a.createElement("span",{className:"mdl-layout-spacer mdl-layout-spacer--flex"},r.a.createElement(ns,null),r.a.createElement("nav",{className:"wgsa-header-collection-options mdl-navigation",onClick:e=>e.stopPropagation()},r.a.createElement(nl,null),r.a.createElement(Ys,null),!e&&r.a.createElement(Co,null)),r.a.createElement("style",null,".libmr-RelativePortal > div {\n          z-index: 3;\n        }")));function sl(e){return e===xr.a.READY?"mdl-layout__header--primary mdl-shadow--3dp":null}var ol=Object(c.a)(e=>({status:Object(An.a)(e).status}))(({status:e})=>r.a.createElement(Ln,{className:sl(e)},function(e){switch(e){case xr.a.READY:return r.a.createElement(rl,null);default:return r.a.createElement(_n,null)}}(e))),ll=(a(1025),a(1027),a(332)),il=(a(1029),a(209)),cl=a.n(il),ul=a(81);class ml extends r.a.Component{constructor(...e){var t;return t=super(...e),this.state={height:0,width:0},t}renderComponent(e,t){const{width:a,height:n}=this.state;return n&&a?r.a.createElement(e,{width:a,height:n,...t}):null}render(){const{children:e,component:t=e,minWidth:a,minHeight:n,...s}=this.props;return r.a.createElement(ul.a,g()({},s,{onResize:cl()(({width:e,height:t})=>this.setState({width:Math.max(a,e),height:Math.max(n,t)}),64)}),()=>this.renderComponent(t,s))}}ml.displayName="AutoSizer",ml.propTypes={children:lt.a.elementType,component:lt.a.elementType,minHeight:lt.a.number,minWidth:lt.a.number},ml.defaultProps={minHeight:160,minWidth:240};a(1031);const dl=({entries:e,current:t,onTravel:a})=>r.a.createElement("ul",{className:"libmr-History"},e.map((e,n)=>r.a.createElement("li",{key:n,tabIndex:"0",onClick:()=>a(n),className:n===t?"is-selected":null},r.a.createElement("img",{src:e}))));dl.propTypes={current:lt.a.number,entries:lt.a.arrayOf(lt.a.string).isRequired,onTravel:lt.a.func.isRequired};var pl=dl,hl=(a(1033),a(79)),fl=a(97),gl=(a(1035),a(22)),bl=a.n(gl),yl=a(258),El=a(444),vl=a(421),Cl=a(445),wl=a(446),Sl=a(19),Nl=a.n(Sl),Ol=a(333),xl=a.n(Ol),kl=a(496),_l=a.n(kl),Il=a(377),Tl=a.n(Il),Ll=a(378),jl=a.n(Ll),Al=a(497),Pl=a.n(Al),Rl=a(379),Ml=a.n(Rl),Dl=a(203);function Fl(e){return!Pl()(e)&&!e}function zl(e){return!Fl(e)}function Gl(e){return Fl(e.lng)||Fl(e.lat)}class Ul extends Dl.a{constructor(e,t){super(e,t),this.map=void 0!==e.map?e.map:t.map,this.markers={}}createLeafletElement(){return null}componentWillReceiveProps(){}componentDidMount(){this.leafletElement=Nl.a.findDOMNode(this.container),this.map.getPanes().overlayPane.appendChild(this.leafletElement),this.props.fitBoundsOnLoad&&this.fitBounds(),this.attachEvents(),this.updatePosition()}componentWillUnmount(){const e=this.map.getPanes();"overlayPane"in e&&e.overlayPane.removeChild(this.leafletElement)}fitBounds(){const e=this.props.markers,t=Ml()(xl()(e,this.props.longitudeExtractor),zl),a=Ml()(xl()(e,this.props.latitudeExtractor),zl),n={lng:jl()(t),lat:jl()(a)},r={lng:Tl()(t),lat:Tl()(a)};Gl(n)||Gl(r)||this.map.fitBounds(bl.a.latLngBounds(bl.a.latLng(r),bl.a.latLng(n)))}markersOrPositionExtractorsChanged(e){return this.props.markers!==e.markers||this.props.longitudeExtractor!==e.longitudeExtractor||this.props.latitudeExtractor!==e.latitudeExtractor}componentDidUpdate(e){this.map.invalidateSize(),this.props.fitBoundsOnUpdate&&this.markersOrPositionExtractorsChanged(e)&&this.fitBounds(),this.updatePosition()}attachEvents(){this.map.on("zoomend",this.updatePosition.bind(this)),this.map.on("viewreset",this.updatePosition.bind(this))}getLocationForMarker(e){return{lat:this.props.latitudeExtractor(e),lng:this.props.longitudeExtractor(e)}}updatePosition(){_l()(this.props.markers,(e,t)=>{const a=this.getLocationForMarker(e);if(Gl(a))return;const n=this.markers[this.getMarkerRefName(t)];if(!n||!n.ref)throw new Error("Missing reference: Please add a reference to your Marker element, by adding 'ref={(c) => this.ref = c}' to your marker's root tag");const r=Nl.a.findDOMNode(n.ref);if(!r)return;const s=this.map.latLngToLayerPoint(bl.a.latLng(a));bl.a.DomUtil.setPosition(r,s)})}render(){return r.a.createElement("div",{ref:e=>{this.container=e},className:"leaflet-objects-pane leaflet-marker-pane leaflet-zoom-hide react-leaflet-marker-layer"},this.renderMarkers())}renderMarkers(){const e={position:"absolute"},t=this.props.markerComponent;return xl()(this.props.markers,(a,n)=>Gl(this.getLocationForMarker(a))?null:r.a.createElement(t,g()({},this.props.propsForMarkers,{key:n,style:e,map:this.map,ref:e=>{this.markers[this.getMarkerRefName(n)]=e},marker:a})))}getMarkerRefName(e){return`marker-${e}`}}Ul.prototype.createLeafletElement=()=>{},Ul.propTypes={markers:lt.a.array,longitudeExtractor:lt.a.func.isRequired,latitudeExtractor:lt.a.func.isRequired,markerComponent:lt.a.func.isRequired,propsForMarkers:lt.a.object,fitBoundsOnLoad:lt.a.bool,fitBoundsOnUpdate:lt.a.bool};a(711);var Bl=bl.a.divIcon({className:"material-icons",html:"place",iconSize:[40,40],iconAnchor:[20,37],popupAnchor:[0,-32]});const $l={};class Hl extends Dl.a{componentWillMount(){super.componentWillMount()}componentDidMount(){super.componentDidMount(),this.addMarkers(this.props.markers)}shouldComponentUpdate(e){return e.markers!==this.props.markers}componentDidUpdate(){this.addMarkers(this.props.markers)}createLeafletElement(){return this.leafletElement=bl.a.markerClusterGroup(this.props.options),this.leafletElement}addMarkers(e){const t=this.leafletElement.getLayers();for(const e of t)e.options.layerId===$l&&this.leafletElement.removeLayer(e);if(!Array.isArray(e)||0===e.length)return;const a=[];for(const{id:t,latitude:n,longitude:r,name:s,icon:o=Bl}of e)n&&r&&a.push(bl.a.marker([n,r],{id:t,icon:o,title:s,layerId:$l}).on("click",this.props.onMarkerClick));this.leafletElement.addLayers(a)}render(){return null}}Hl.propTypes={map:r.a.PropTypes.object,markers:r.a.PropTypes.array,onMarkerClick:r.a.PropTypes.func,options:r.a.PropTypes.object},Hl.defaultProps={markers:[],options:{}};var Vl=Hl;a(815);const Kl={width:"30px",height:"30px",margin:"-2px 0 0 -4px",backgroundImage:"url('data:image/svg+xml;charset=utf-8;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDU2LjcgNTYuNyIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgNTYuNyA1Ni43IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnIGlkPSJQb2x5X3Rvb2xfZm91ciI+DQoJPHBvbHlsaW5lIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAxMDEwMSIgc3Ryb2tlLXdpZHRoPSIxLjQiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRzPSIzNC45LDE2LjIgMTMuNCwxMy41IDIxLjUsNDMuMiANCgkJNDIuOSwzNy44IDQ4LjMsMjAuNCAJIi8+DQoJPGVsbGlwc2UgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlPSIjMDEwMTAxIiBzdHJva2Utd2lkdGg9IjAuOCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBjeD0iMTMuNCIgY3k9IjEzLjUiIHJ4PSI1LjQiIHJ5PSI1LjQiLz4NCgk8ZWxsaXBzZSBmaWxsPSIjRkZGRkZGIiBzdHJva2U9IiMwMTAxMDEiIHN0cm9rZS13aWR0aD0iMC44IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGN4PSIzNC45IiBjeT0iMTYuMiIgcng9IjUuNCIgcnk9IjUuNCIvPg0KCTxlbGxpcHNlIGZpbGw9IiNGRkZGRkYiIHN0cm9rZT0iIzAxMDEwMSIgc3Ryb2tlLXdpZHRoPSIwLjgiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgY3g9IjIxLjUiIGN5PSI0My4yIiByeD0iNS40IiByeT0iNS40Ii8+DQoJPGVsbGlwc2UgZmlsbD0iI0ZGRkZGRiIgc3Ryb2tlPSIjMDEwMTAxIiBzdHJva2Utd2lkdGg9IjAuOCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBjeD0iNDIuOSIgY3k9IjM3LjgiIHJ4PSI1LjQiIHJ5PSI1LjQiLz4NCgk8cmVjdCBmaWxsPSJub25lIiB3aWR0aD0iNTYuNCIgaGVpZ2h0PSI1Ni43Ii8+DQo8L2c+DQo8L3N2Zz4=')",backgroundRepeat:"no-repeat"};var ql=r.a.createClass({displayName:"LeafletMapLasso",propTypes:{className:r.a.PropTypes.string,activeClassName:r.a.PropTypes.string,initialPath:r.a.PropTypes.array,onPathChange:r.a.PropTypes.func},contextTypes:{map:r.a.PropTypes.instanceOf(bl.a.Map)},getDefaultProps:()=>({activeClassName:"is-active"}),getInitialState(){return{isActive:null!==(this.props.initialPath||null)}},componentDidMount(){this.lasso=L.featureGroup.lassoSelect({finishedTooltip:"Click outside the region to cancel the filter.",polyline:{color:"#673c90"},initialPath:this.props.initialPath}).addTo(this.context.map),this.context.map.lasso=this.lasso,this.lasso.on("pathchange",()=>{const{onPathChange:e}=this.props;e&&e(this.lasso.getPath())})},componentWillReceiveProps(e){this.props.initialPath&&!e.initialPath&&this.setState({isActive:!1})},componentDidUpdate(e,t){const{initialPath:a}=this.props;null===a&&this.lasso.reset(),t.isActive!==this.state.isActive&&(this.state.isActive?this.lasso.enable():(this.lasso.disable(),this.lasso.reset()))},onLassoToggleButtonClick(e){e.stopPropagation(),this.setState({isActive:!this.state.isActive})},render(){const{className:e,activeClassName:t}=this.props,{isActive:a}=this.state;return r.a.createElement("button",{className:m()("leaflet-map-lasso-button",e,{[t]:a}),title:a?"Disable map region filter":"Activate map region filter",onClick:this.onLassoToggleButtonClick},r.a.createElement("i",{className:"material-icons mr-lasso-icon",style:Kl}))}});var Wl=r.a.createClass({displayName:"LeafletMap",propTypes:{height:r.a.PropTypes.number,width:r.a.PropTypes.number,className:r.a.PropTypes.string,markerIds:r.a.PropTypes.array,markers:r.a.PropTypes.arrayOf(r.a.PropTypes.object),markerComponent:r.a.PropTypes.func,markerSize:r.a.PropTypes.number,cluster:r.a.PropTypes.bool,clusterOptions:r.a.PropTypes.object,center:yl.a.latlng,zoom:r.a.PropTypes.number,highlightedColour:r.a.PropTypes.string,lassoPath:r.a.PropTypes.array,mapboxStyle:r.a.PropTypes.string,mapboxKey:r.a.PropTypes.string,buttonClassname:r.a.PropTypes.string,onBoundsChange:r.a.PropTypes.func,onLassoPathChange:r.a.PropTypes.func,refitOnMarkerChange:r.a.PropTypes.bool},getDefaultProps:()=>({cluster:!1,markers:[],markerIds:[],refitOnMarkerChange:!0}),componentDidMount(){this.refitMapBounds()},componentDidUpdate(e){0===e.markers.length&&this.props.markers.length?this.refitMapBounds():this.props.refitOnMarkerChange&&e.markerIds!==this.props.markerIds&&this.refitMapBounds()},componentWillUnmount(){const{onBoundsChange:e}=this.props;if(e&&this.map){e({center:this.map.getCenter(),zoom:this.map.getZoom()})}},onClusterMarkerClick({target:e,event:t}){this.props.onMarkerClick&&this.props.onMarkerClick(e.options,t)},onMarkerLayerClick({marker:e,event:t}){this.props.onMarkerClick&&this.props.onMarkerClick(e,t)},onClick(e){this.props.onClick&&this.props.onClick(e,this.map)},getBounds(){const{markers:e}=this.props;if(!e||0===e.length)return bl.a.latLngBounds([-85,-180],[85,180]);let t=-1e3,a=-1e3,n=1e3,r=1e3;for(const s of e){if(!(s.position||s.latitude&&s.longitude))continue;const e=s.latitude||s.position[0],o=s.longitude||s.position[1];e>t&&(t=e),e<n&&(n=e),o>a&&(a=o),o<r&&(r=o)}const s=bl.a.latLng([n,r]),o=bl.a.latLng([t,a]);return bl.a.latLngBounds(s,o)},refitMapBounds(e){e?this.leafletMap.leafletElement.panTo(e):this.leafletMap.leafletElement.fitBounds(this.getBounds())},renderMarkers(){const{markers:e,cluster:t,markerComponent:a,highlightedColour:n,markerProps:s={}}=this.props;return t?r.a.createElement(Vl,{markers:e||[],onMarkerClick:this.onClusterMarkerClick,options:this.props.clusterOptions}):a?r.a.createElement(Ul,{markers:e||[],latitudeExtractor:({position:e})=>e[0],longitudeExtractor:({position:e})=>e[1],markerComponent:a,propsForMarkers:{...s,onClick:this.onMarkerLayerClick,highlightedColour:n}}):e?e.map(({position:e,title:t,icon:a=Bl},n)=>r.a.createElement(El.a,{key:n,position:e,title:t,icon:a})):null},renderDefaultMarkers(){return this.props.markers?this.props.markers.map(({position:e},t)=>r.a.createElement(El.a,{key:e.join("-"),position:e})):null},render(){const{center:e,zoom:t,mapboxStyle:a,mapboxKey:n}=this.props;return r.a.createElement("div",{className:m()("cgps-leaflet-map",`cgps-leaflet-map--marker-size-${this.props.markerSize}`,this.props.className)},r.a.createElement(vl.a,{onClick:this.onClick,animate:!1,center:e,zoom:t,zoomControl:!1,boundsOptions:{animate:!1},onMoveend:({target:e})=>{this.map=e},ref:e=>{this.leafletMap=e},style:{width:"100%",height:"100%"}},r.a.createElement(Cl.a,{attribution:"\n  Map data &copy;\n  <a href='http://openstreetmap.org'>OpenStreetMap</a> contributors,\n  <a href='http://creativecommons.org/licenses/by-sa/2.0/'>CC-BY-SA</a>,\n  Imagery © <a href='http://mapbox.com'>Mapbox</a>\n",url:`https://api.mapbox.com/styles/v1/mapbox/${a}/tiles/{z}/{x}/{y}?access_token=${n}`}),this.renderMarkers(),r.a.createElement("div",{className:"cgps-leaflet-map-controls"},this.props.controls,r.a.createElement(ql,{className:this.props.buttonClassname,initialPath:this.props.lassoPath,onPathChange:this.props.onLassoPathChange})),r.a.createElement(wl.a,{position:"bottomright"})),this.props.children)}});const Yl="mdl-button mdl-button--icon wgsa-pane-button wgsa-pane-button--dark";var Zl=Object(c.a)((function(e,t){return{bounds:Object(fl.a)(e,t),lassoPath:t.lassoPath}}),(function(e,{stateKey:t,onLassoPathChange:a}){return{onBoundsChange:a=>e(hl.storeBounds(t,a)),onLassoPathChange:a||(a=>e(hl.changeLassoPath(t,a)))}}))(e=>r.a.createElement(Wl,{center:e.bounds.center,className:e.className,cluster:e.cluster,clusterOptions:e.clusterOptions,controls:e.controls,highlightedColour:T.b.COLOURS.PURPLE,buttonClassname:Yl,lassoPath:e.lassoPath,markers:e.markers,markerIds:e.markerIds,markerComponent:e.markerComponent,markerProps:e.markerProps,markerSize:e.markerSize,mapboxKey:ee.a.mapboxKey,mapboxStyle:"light-v9",onBoundsChange:e.onBoundsChange,onClick:e.onClick,onGroupMarkersChange:e.onGroupMarkersChange,onLassoPathChange:e.onLassoPathChange,onMarkerClick:e.onMarkerClick,zoom:e.bounds.zoom},e.children));var Xl=({colour:e="black"})=>r.a.createElement("svg",{viewBox:"0 0 100 100",style:{width:"200%",transform:"translate(-25%, -25%)"}},r.a.createElement("circle",{cx:"50",cy:"50",r:42,fill:"none",stroke:e,strokeWidth:8}));const{PropTypes:Ql}=r.a,Jl=2*Math.PI;class ei extends r.a.Component{render(){const{borderWidth:e=7.5,borderColour:t="#555",donutFill:a="#fff"}=this.props;return r.a.createElement("svg",{viewBox:"0 0 100 100",className:this.props.className},r.a.createElement("g",{transform:"rotate(-90 50 50)"},function({slices:e,onSliceClick:t}){const a=e.reduce((e,{value:t})=>e+t,0);let n=0,s=49,o=0;return e.map((e,l)=>{const{colour:i,value:c}=e;if(c===a)return r.a.createElement("circle",{r:49,cx:50,cy:50,fill:i,key:l,"data-count":c,onClick:a=>t&&t(e,a)});if(0===c)return null;const u=c/a,m=u<=.5?0:1;n+=u*Jl;const d=49*Math.cos(n),p=49*Math.sin(n),h=["M 50,50",`l ${s},${-o}`,"a49,49","0",`${m},0`,`${d-s},${-(p-o)}`,"z"].join(" ");return s=d,o=p,r.a.createElement("path",{d:h,fill:i,key:l,"data-count":c,onClick:a=>{t&&t(e,a)}})})}(this.props)),e>0&&r.a.createElement("circle",{cx:50,cy:50,r:50-e/2,fill:"none",strokeWidth:e,stroke:t}),this.props.donut&&r.a.createElement("circle",{cx:50,cy:50,r:(50-e)/2,fill:a,strokeWidth:e,stroke:t}),"}",r.a.createElement("text",{x:"50",y:"50"}))}}ei.propTypes={className:r.a.PropTypes.string,borderWidth:r.a.PropTypes.number,borderColour:r.a.PropTypes.string,donut:r.a.PropTypes.bool,slices:r.a.PropTypes.arrayOf(r.a.PropTypes.shape({colour:r.a.PropTypes.string.isRequired,value:r.a.PropTypes.number.isRequired})).isRequired,onSliceClick:r.a.PropTypes.func};var ti=r.a.createClass({displayName:"LeafletPieChartMarker",shouldComponentUpdate(e){const{marker:t}=this.props;if(t.id.length!==e.marker.id.length)return!0;for(const a of t.id)if(-1===e.marker.id.indexOf(a))return!0;if(t.highlighted!==e.marker.highlighted)return!0;if(t.slices.size!==e.marker.slices.size)return!0;const a=t.slices.entries(),n=e.marker.slices.entries();for(let e=0;e<t.slices.size;e++){const[e,t]=a.next().value,[r,s]=n.next().value;if(e!==r||t!==s)return!0}return!1},render(){const{marker:e,style:t,onClick:a,highlightedColour:n}=this.props,s=Array.from(e.slices.entries()).map(([e,t])=>({colour:e,value:t}));return r.a.createElement("div",{ref:e=>{this.ref=e},style:t,className:m()("leaflet-marker-icon",{highlighted:e.highlighted}),onClick:t=>{t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),a({event:t,marker:e})}},e.highlighted&&r.a.createElement(Xl,{colour:n}),r.a.createElement(ei,{slices:s,borderColour:this.props.borderColour,borderWidth:this.props.botderWidth}))}}),ai=r.a.createClass({displayName:"LeafletMarkerControls",propTypes:{className:r.a.PropTypes.string,activeClassName:r.a.PropTypes.string,markerSize:r.a.PropTypes.number,onMarkerSizeChange:r.a.PropTypes.func,onViewByCountryChange:r.a.PropTypes.func},getDefaultProps:()=>({activeClassName:"is-active"}),getInitialState:()=>({isActive:!1}),componentDidUpdate(){if(this.state.isActive){const{slider:e,countrySwitch:t}=this.refs;componentHandler.upgradeElements([e,t])}},render(){const{className:e,activeClassName:t,markerSize:a,onMarkerSizeChange:n,onViewByCountryChange:s}=this.props,{isActive:o}=this.state;return r.a.createElement("div",{onClick:e=>e.stopPropagation()},r.a.createElement("button",{key:"button",className:m()("leaflet-marker-controls-button",e,{[t]:o}),title:o?"Hide map controls":"Show map controls",onClick:()=>this.setState({isActive:!o})},r.a.createElement("i",{className:"material-icons"},"tune")),r.a.createElement("div",{className:m()("wgsa-pane-controls wgsa-pane-controls--top",{"wgsa-pane-controls--visible":o})},r.a.createElement("div",{className:"wgsa-pane-controls__row wgsa-pane-overlay"},r.a.createElement("div",{className:"wgsa-pane-slider"},r.a.createElement("label",null,"Marker Size",r.a.createElement("input",{ref:"slider",type:"range",onChange:e=>n(parseInt(e.target.value,10)),min:"1",max:"10",step:"1",value:a,className:"mdl-slider mdl-js-slider",tabIndex:"0"}))),r.a.createElement("label",{ref:"countrySwitch",className:"mdl-icon-toggle mdl-js-icon-toggle mdl-js-ripple-effect",htmlFor:"group-markers-switch",title:"View by Country"},r.a.createElement("input",{type:"checkbox",id:"group-markers-switch",className:"mdl-icon-toggle__input",onChange:e=>s(e.target.checked)}),r.a.createElement("i",{className:"mdl-icon-toggle__label material-icons"},"flag")))))}}),ni=a(316);const ri=Object(ce.createSelector)(Pn.a,fl.b,(e,t)=>e.reduce((e,{uuid:a,position:n={}})=>n.latitude&&n.longitude&&Object(ni.contains)(t,{lat:n.latitude,lng:n.longitude})?e.concat(a):e,[])),si=({position:e={}})=>{const{latitude:t,longitude:a}=e;return t&&a?[t,a]:null},oi=({country:e})=>e?Object(G.a)(e):null,li=Object(ce.createSelector)(fl.d,e=>e?oi:si),ii=Object(ce.createSelector)(li,Pn.b,Or,vs,er,(e,t,a=[],n,r)=>{if(!a||0===a.length)return[];const s=new Map;for(const o of a){const a=t[o],l=e(a);if(l){const e=r[a.id].colour,t=l.join("_"),i=s.get(t)||{position:l,id:[],slices:new Map,highlighted:!1};i.id.push(o),i.title=i.id.length,i.slices.set(e,(i.slices.get(e)||0)+1),i.highlighted=i.highlighted||n.has(o),s.set(t,i)}}return Array.from(s.values())}),ci=Or;function ui(e,t){return(a,n)=>{if(a(hl.changeLassoPath(e,t)),t){const t=ri(n(),{stateKey:e});a(Object(es.f)(t,fr.a.MAP))}else a(Object(es.h)(fr.a.MAP))}}var mi=a(69);var di=Object(c.a)((function(e){return{markerIds:ci(e,{stateKey:"COLLECTION"}),markerSize:Object(fl.c)(e,{stateKey:"COLLECTION"}),lassoPath:Object(fl.b)(e,{stateKey:"COLLECTION"}),markers:ii(e,{stateKey:"COLLECTION"}),hasHighlight:ws(e)}}),(function(e){return{dispatch:e,onLassoPathChange:t=>e(ui("COLLECTION",t)),onMarkerClick:({id:t,highlighted:a},n)=>{n.stopPropagation(),n.metaKey||n.ctrlKey?e(a?Object(mi.e)(t):Object(mi.f)(t,!0)):e(Object(mi.f)(t))},onMarkerSizeChange:t=>e(Object(hl.markerSizeChanged)("COLLECTION",t)),onViewByCountryChange:t=>e(Object(hl.viewByCountry)("COLLECTION",t))}}),(function(e,{dispatch:t,...a},n){return{...n,...e,...a,onClick:({originalEvent:a})=>{var n;(n=a.target).ownerSVGElement&&n.ownerSVGElement.parentNode&&n.ownerSVGElement.parentNode.classList.contains("leaflet-marker-icon")||(e.hasHighlight?t(Object(mi.d)()):e.lassoPath&&t(ui("COLLECTION",void 0)))}}}))(e=>r.a.createElement(Zl,{className:"wgsa-collection-viewer-map",stateKey:"COLLECTION",lassoPath:e.lassoPath,markers:e.markers,markerIds:e.markerIds,markerComponent:ti,markerSize:e.markerSize,onClick:e.onClick,onLassoPathChange:e.onLassoPathChange,onMarkerClick:e.onMarkerClick,controls:r.a.createElement(ai,{className:Yl,activeClassName:"wgsa-pane-button--active",markerSize:e.markerSize,onMarkerSizeChange:e.onMarkerSizeChange,onViewByCountryChange:e.onViewByCountryChange})},e.children)),pi=(a(1037),a(513));const hi={icon:lt.a.node,component:lt.a.elementType,title:lt.a.string},fi=({children:e,className:t,navStyle:a,panes:n,style:s})=>{const[o,l]=r.a.useState(null),[i,c]=r.a.useState(!1),u=null!==o;return r.a.createElement("div",{className:m()("libmr-SidePane",{active:u,open:i},t),style:s},r.a.createElement("div",{className:"libmr-SidePane-main"},e),r.a.createElement(pi.a,{transitionName:"libmr-SidePane",onEnd:()=>c(u)},u&&r.a.createElement("aside",{key:"aside",className:"libmr-SidePane-aside"},r.a.createElement(bt,{className:"libmr-SidePane-close",onClick:()=>l(null),title:"Close"},r.a.createElement("i",{className:"material-icons"},"close")),r.a.createElement("div",{className:"libmr-SidePane-contents"},n[o].title&&r.a.createElement("h3",{className:"libmr-SidePane-title"},n[o].title),r.a.createElement("div",{className:"libmr-SidePane-contents-overflow"},r.a.createElement(n[o].component))))),r.a.createElement("nav",{className:"libmr-SidePane-nav",style:a},n.map(({icon:e},t)=>r.a.createElement(Dt,{key:t,active:o===t,onClick:()=>l(o===t?null:t)},e))))};fi.propTypes={children:lt.a.node,className:lt.a.string,navStyle:lt.a.object,panes:lt.a.arrayOf(lt.a.shape(hi)),style:lt.a.object};var gi=fi,bi=(a(1039),({active:e,text:t,contact:a,contactStyle:n,className:s,onClick:o})=>r.a.createElement("button",{title:name,className:m()(s,"mdl-chip mdl-chip--contact",{"mdl-chip--active":e}),onClick:e=>o(e)},a&&r.a.createElement("span",{className:"mdl-chip__contact",style:n},a),r.a.createElement("span",{className:"mdl-chip__text"},t)));Object(ce.createSelector)(qs,er,(e,t)=>e.map(e=>({genome:e,colour:t[e.id].colour})));const yi=Object(ce.createSelector)(qs,er,(e,t)=>Array.from(e.reduce((e,a)=>{const n=t[a.id].colour,r=e.get(n)||[];return r.push(a),e.set(n,r)},new Map).entries())),Ei=e=>(e=>Object(An.f)(e).summary)(e).isExpanded;var vi=a(304);function Ci(e){return e.map(([e,t])=>({colour:e,value:t.length,genomes:t}))}var wi=Object(c.a)((function(e){return{summary:yi(e),isExpanded:Ei(e)}}),(function(e){return{onClick:t=>e(Object(vi.b)(t)),onSliceClick:t=>e(Object(es.f)(t))}}))(({summary:e,isExpanded:t,onClick:a,onSliceClick:n})=>r.a.createElement("div",{title:t?"":"Summary",className:m()("wgsa-collection-viewer-summary mdl-shadow--2dp",{"wgsa-collection-viewer-summary--expanded":t}),onClick:e=>{e.stopPropagation(),t||a(!0)}},t&&r.a.createElement("button",{className:"mdl-button mdl-button--icon",onClick:e=>{e.stopPropagation(),a(!1)},title:"Close summary"},r.a.createElement("i",{className:"material-icons"},"clear")),r.a.createElement(ei,{className:"wgsa-summary-chart",slices:Ci(e),borderWidth:1.5,onSliceClick:(e,a)=>{t&&(a.preventDefault(),a.stopPropagation(),n(e.genomes.map(e=>e.uuid)))}}),r.a.createElement("div",{className:"wgsa-summary-list"},e.map(([e,t],a)=>Object(Zn.d)(e)&&r.a.createElement(bi,{key:a,className:m()("wgsa-summary-list__chip",{"mdl-chip--inverse":e===Zn.h}),text:Object(Zn.d)(e),contact:t.length,contactStyle:{background:e},onClick:e=>{e.preventDefault(),e.stopPropagation(),n(t.map(e=>e.uuid))}}))))),Si=(a(1041),a(1043),a(1045),a(244));function Ni(e,t,...a){return(e+(t?` ${e}--selected `:" ")+a.join(" ")).trim()}function Oi(e,t){const{group:a,headerClasses:n}=e;return Ni("wgsa-table-header",t,n,a?"wgsa-table-header--group":null)}const xi=Ni.bind(null,"wgsa-table-cell"),ki=({valueGetter:e,display:t=e},a)=>t(a);function _i(e){return e.group?e.system||e.columns.some(e=>e.valueGetter&&!e.hidden):!e.hidden}var Ii=r.a.createClass({displayName:"FixedTable",propTypes:{height:r.a.PropTypes.number,width:r.a.PropTypes.number,tableProps:r.a.PropTypes.object,columns:r.a.PropTypes.array,data:r.a.PropTypes.array,calculatedColumnWidths:r.a.PropTypes.array,getDefaultHeaderContent:r.a.PropTypes.func,rowClickHandler:r.a.PropTypes.func,activeColumns:r.a.PropTypes.object},handleRowClick(e,t){e.stopPropagation(),this.props.rowClickHandler(this.props.data[t])},isSelected(e){if(e.system)return!1;const t=(e.group?e.columns:[e]).filter(e=>_i(e)&&e.valueGetter);return!!t.length&&t.every(e=>this.props.activeColumns.has(e))},renderHeader(e,t){const{getHeaderContent:a}=e,n=this.isSelected(e);return r.a.createElement(Si.Cell,g()({},t,{className:Oi(e,n)}),a?a(e):this.props.getDefaultHeaderContent(e))},renderCell(e,{rowIndex:t,width:a,height:n}){const{cellClasses:s,getCellContents:o=ki}=e,l=this.isSelected(e);return r.a.createElement(Si.Cell,g()({width:a,height:n},{className:xi(l,s)}),o(e,this.props.data[t]))},renderColumns(e){return e.filter(_i).map(e=>e.group?r.a.createElement(Si.ColumnGroup,{key:e.columnKey,fixed:e.fixed,header:t=>this.renderHeader(e,t)},this.renderColumns(e.columns)):r.a.createElement(Si.Column,g()({key:e.columnKey,header:t=>this.renderHeader(e,t),cell:t=>this.renderCell(e,t),width:e.fixedWidth||e.width||96,flexGrow:0},e)))},render(){const{data:e,columns:t,height:a,width:n,tableProps:s}=this.props;return r.a.createElement(Si.Table,g()({rowsCount:e.length,rowHeight:28,headerHeight:28+(t.length&&t[0].group?0:24),groupHeaderHeight:24,height:a,width:n,className:"wgsa-table",rowClassNameGetter:()=>"wgsa-table-row",onRowClick:this.handleRowClick},s),this.renderColumns(t))}}),Ti=a(160);const Li=Object(ce.createSelector)(e=>Object(Yn.i)(e).columns,qs,An.a,Yn.c,(e,t,a,n)=>e.map(e=>function e(t,a){if(t.isSelected=a.activeColumns.has(t),t.group){for(let n=0;n<t.columns.length;n++)t.columns[n]=e(t.columns[n],a);return t}return t.addState?t.addState(a):a.genomes.length?Object(Ti.a)(t,a):t}(e,{genomes:t,collection:a,activeColumns:n})));const ji=e=>e.preventDefault(),Ai=r.a.createClass({displayName:"Table",propTypes:{height:r.a.PropTypes.number,width:r.a.PropTypes.number,tableProps:r.a.PropTypes.object,data:r.a.PropTypes.array,columns:r.a.PropTypes.array,handleHeaderClick:r.a.PropTypes.func,dispatch:r.a.PropTypes.func,filter:r.a.PropTypes.object},componentDidMount(){componentHandler.upgradeDom()},shouldComponentUpdate(e){const{data:t,columns:a,filter:n,width:r,height:s}=this.props;return t!==e.data||a!==e.columns||n!==e.filter||r!==e.width||s!==e.height},componentDidUpdate(){componentHandler.upgradeDom()},render(){return r.a.createElement("section",{onClick:this.props.onClick,onWheel:ji,onTouchMove:ji},r.a.createElement(b.a,null,r.a.createElement(Ii,g()({key:this.props.tableName},this.props,{rowClickHandler:this.props.onRowClick,getDefaultHeaderContent:this.props.getDefaultHeaderContent}))),0===this.props.data.length&&r.a.createElement("p",{style:{width:this.props.width},className:"wgsa-text-overlay wgsa-hipster-style"},"No matching results."))}}),Pi=({column:e,onClick:t})=>r.a.createElement("button",{title:e.headerTitle,className:"wgsa-selectable-column-heading",onClick:a=>t(a,e)},Object(tr.a)(e));var Ri=Object(c.a)((function(e){const t=Object(Yn.i)(e),{activeColumn:a,activeColumns:n,...r}=t;return{...r,activeColumns:a?new Set([a]):n,collection:Object(An.a)(e),columns:Li(e),data:qs(e),fixedGroupWidth:Object(Yn.f)(e),tableName:Object(Yn.j)(e)}}),null,(function(e,{dispatch:t},a){const{data:n,columns:s,activeColumns:o,tableName:l}=e;return Object(tr.d)(s,a.width,e.fixedGroupWidth),{...a,activeColumns:o,data:n,tableName:l,columns:s,onRowClick:e=>{return t((a=e,(e,t)=>{const n=t(),r=vs(n);1===r.size&&r.has(a.uuid)?e(Object(mi.d)()):e(Object(mi.f)([a.uuid]))}));var a},getDefaultHeaderContent:a=>r.a.createElement(Pi,{column:a,onClick:(a,n)=>{if(a.stopPropagation(),n.noAction)return;const r=n.onHeaderClick||e.onHeaderClick;t(r(a,n))}})}}))(Ai);const Mi=Object(ce.createSelector)(ur,e=>Object(An.f)(e).timeline.visible,Yn.j,(e,t,a)=>!e||null!==t&&!0!==t?a:"timeline"),Di=Object(ce.createSelector)(Mi,Yn.l,(e,t)=>"timeline"!==e&&t);var Fi=a(44);var zi=Object(c.a)((function(e){return{visible:Di(e),active:Object(Yn.g)(e).multi}}),(function(e){return{toggle:()=>e(Object(Fi.h)())}}))(({visible:e,active:t,toggle:a})=>e?r.a.createElement(Dt,{active:t,className:"pw-multi-button",onClick:()=>a(),title:"Toggle multiple resistance"},"MDR"):null),Gi=a(317);const Ui={[xr.c.metadata]:"list",[xr.c.typing]:"list",[xr.c.stats]:"list",[xr.c.antibiotics]:"local_pharmacy",[xr.c.snps]:"local_pharmacy",[xr.c.genes]:"local_pharmacy",[xr.c.kleborateAMR]:"local_pharmacy",[xr.c.timeline]:"access_time"},Bi=Object(c.a)(e=>{const t=Object(Pn.e)(e);return{amr:Object(Pn.d)(e)&&!t,kleborate:t,metadata:Object(Pn.f)(e),timeline:ur(e),typing:Object(Yn.k)(e),visibleView:Mi(e)}},e=>({showTable:t=>e(Object(Fi.g)(t)),_showTimeline:t=>e(Object(Gi.b)(t))}))(({visibleView:e,showTable:t,_showTimeline:a,metadata:n,timeline:s,typing:o,kleborate:l,amr:i})=>r.a.createElement(So,{direction:"up",button:r.a.createElement(Et,{direction:"up"},r.a.createElement("i",{className:"material-icons"},Ui[e]),xr.b[e])},n&&r.a.createElement("button",{onClick:()=>t(xr.c.metadata)},"Metadata"),o&&r.a.createElement("button",{onClick:()=>t(xr.c.typing)},"Typing"),r.a.createElement("button",{onClick:()=>t(xr.c.stats)},"Stats"),(i||l)&&r.a.createElement("hr",null),i&&r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{onClick:()=>t(xr.c.antibiotics)},"Antibiotics"),r.a.createElement("button",{onClick:()=>t(xr.c.snps)},"SNPs"),r.a.createElement("button",{onClick:()=>t(xr.c.genes)},"Genes")),l&&r.a.createElement("button",{onClick:()=>t(xr.c.kleborateAMR)},"Kleborate AMR"),s&&r.a.createElement(r.a.Fragment,null,r.a.createElement("hr",null),r.a.createElement("button",{onClick:a},"Timeline")))),$i=()=>r.a.createElement("div",{className:"wgsa-table-switcher",onClick:e=>e.stopPropagation()},r.a.createElement(Bi,null),r.a.createElement(zi,null));$i.displayName="TableSwitcher";var Hi=$i;a(1047),a(846),a(847);Na.a.defaults.timeline=Na.a.defaults.scatter;const Vi={};Na.a.controllers.timeline=Na.a.controllers.scatter.extend({dataElementType:Na.a.elements.Point.extend({draw(){const e=this._view;if(e.skip)return;const t=this._chart.ctx,a=e.radius,n=this._chart.config.data.datasets[this._datasetIndex],r=n.data[this._index].id,s=n.styles[r]||Vi,o=n.highlightedIds.has(r);ca(t,e.x,e.y,a,s.shape,s.colour,o&&Vt.b.primaryColour)}})});const Ki={day:1,week:7,month:30,quarter:90,year:365};class qi extends r.a.Component{componentDidMount(){this.createChart(),this.props.addExportCallback&&this.props.addExportCallback("timeline-png",()=>this.domRef.toDataURL())}componentDidUpdate(e){const t=e.width!==this.props.width||e.height!==this.props.height,a=e.bounds!==this.props.bounds||e.chartData!==this.props.chartData||e.unit!==this.props.unit,n=e.highlightedIds!==this.props.highlightedIds||e.nodeSize!==this.props.nodeSize||e.styles!==this.props.styles;t&&this.resizeChart(),(a||n)&&this.updateChart(a),(t||a)&&this.resetChartRanges(),this.props.viewport!==e.viewport&&this.props.viewport&&this.restoreViewport(),this.chart.update()}componentWillUnmount(){this.props.removeExportCallback&&this.props.removeExportCallback("timeline-png"),this.destroyChart()}getYTicks(e=0){const t=2*this.props.nodeSize+2;return{min:e,max:(this.props.height-40)/t+e}}getPanZoomRanges(e){const t={pan:{},zoom:{}},a=2*this.props.nodeSize+2;t.pan.rangeMin={x:e.min.toDate(),y:0},t.pan.rangeMax={x:e.max.toDate(),y:this.props.maxStackSize+1};const n=(this.props.width-40)/a,r=(this.props.height-40)/a;return t.zoom.rangeMin={x:n*Ki[this.props.unit]*864e5,y:r},t.zoom.rangeMax={x:this.props.bounds.max.diff(this.props.bounds.min),y:this.props.maxStackSize},t}getChartBounds(){const e=Math.max(1,this.props.bounds.max.diff(this.props.bounds.min,"days")),t=Math.ceil((this.props.nodeSize+2)*e/(this.props.width-40));return{min:Kn()(this.props.bounds.min).subtract(t,"day"),max:Kn()(this.props.bounds.max).add(t,"day")}}createDatasets(){return{labels:[],datasets:[{label:"Dataset",pointRadius:this.props.nodeSize/2,pointHoverRadius:this.props.nodeSize/2+1,data:this.props.chartData,highlightedIds:this.props.highlightedIds,styles:this.props.styles}]}}createChart(){const e=this.domRef.getContext("2d");this.domRef.height=this.props.height,this.domRef.width=this.props.width;const t=this.getChartBounds(),a=this.getPanZoomRanges(t),{viewport:n}=this.props;this.chart=new Na.a(e,{type:"timeline",data:this.createDatasets(),options:{animation:!1,layout:{padding:{left:0,right:0,top:-24,bottom:0}},legend:{display:!1},maintainAspectRatio:!1,onClick:(e,[t])=>{const a=e.metaKey||e.ctrlKey;if(t){const e=t._chart.config.data.datasets[t._datasetIndex].data[t._index];this.props.setHighlightedIds([e.id],a)}else this.props.highlightedIds.size&&!a&&this.props.setHighlightedIds()},pan:{enabled:!0,mode:"xy",rangeMin:a.pan.rangeMin,rangeMax:a.pan.rangeMax,onPan:()=>this.saveViewport()},responsive:!1,responsiveAnimationDuration:0,scales:{xAxes:[{position:"bottom",time:{unit:this.props.unit,min:n?n.minx:t.min,max:n?n.maxx:t.max},ticks:{maxRotation:0,autoSkip:!0,autoSkipPadding:16},type:"time"}],yAxes:[{display:!1,ticks:n?{min:n.miny,max:n.maxy}:this.getYTicks()}]},title:{display:!0,text:""},tooltips:{displayColors:!1,callbacks:{title:(e,t)=>e.map(e=>t.datasets[e.datasetIndex].data[e.index].x.toLocaleDateString()).join(", "),label:(e,t)=>{const a=t.datasets[e.datasetIndex].data[e.index];return this.props.getTooltip(a)}}},zoom:{enabled:!0,drag:!1,mode:"xy",rangeMin:a.zoom.rangeMin,rangeMax:a.zoom.rangeMax,onZoom:()=>this.saveViewport()}}}),window.cgps_microreact_timelineChart=this.chart}updateChart(e){if(e){const e=this.getChartBounds();this.chart.scales["x-axis-1"].options.time.min=e.min,this.chart.scales["x-axis-1"].options.time.max=e.max,this.chart.scales["x-axis-1"].options.time.unit=this.props.unit;const t=2*this.props.nodeSize+2,a=(this.chart.chartArea.bottom-this.chart.chartArea.top)/t;this.chart.scales["y-axis-1"].options.ticks.min=0,this.chart.scales["y-axis-1"].options.ticks.max=a}this.chart.config.data=this.createDatasets(),this.chart.clear()}resizeChart(){const e=this.chart.scales["y-axis-1"].options.ticks.min||0;this.chart.resize(),Object.assign(this.chart.scales["y-axis-1"].options.ticks,this.getYTicks(e))}resetChartRanges(){const e=this.getChartBounds(),t=this.getPanZoomRanges(e);Object.assign(this.chart.config.options.pan,t.pan),Object.assign(this.chart.config.options.zoom,t.zoom)}destroyChart(){this.chart&&(this.chart.destroy(),this.chart=null)}saveViewport(){this.props.onViewportChange({minx:this.chart.scales["x-axis-1"].options.time.min.valueOf(),maxx:this.chart.scales["x-axis-1"].options.time.max.valueOf(),miny:this.chart.scales["y-axis-1"].options.ticks.min,maxy:this.chart.scales["y-axis-1"].options.ticks.max})}restoreViewport(){this.chart.scales["x-axis-1"].options.time.min=this.props.viewport.minx,this.chart.scales["x-axis-1"].options.time.max=this.props.viewport.maxx,this.chart.scales["y-axis-1"].options.ticks.min=this.props.viewport.miny,this.chart.scales["y-axis-1"].options.ticks.max=this.props.viewport.maxy}render(){const{width:e,height:t}=this.props;return r.a.createElement("div",{className:"libmr-Timeline-plot",style:{width:e,height:t}},r.a.createElement("canvas",{ref:e=>{this.domRef=e}}))}}qi.displayName="TimelineChart",qi.propTypes={addExportCallback:lt.a.func,bounds:lt.a.shape({min:lt.a.instanceOf(Kn.a).isRequired,max:lt.a.instanceOf(Kn.a).isRequired}),chartData:lt.a.arrayOf(lt.a.shape({x:lt.a.instanceOf(Date).isRequired,y:lt.a.number.isRequired,id:lt.a.string.isRequired})).isRequired,getTooltip:lt.a.func.isRequired,height:lt.a.number.isRequired,highlightedIds:lt.a.instanceOf(Set).isRequired,maxStackSize:lt.a.number.isRequired,nodeSize:lt.a.number.isRequired,onViewportChange:lt.a.func.isRequired,removeExportCallback:lt.a.func,setHighlightedIds:lt.a.func.isRequired,styles:lt.a.object.isRequired,unit:lt.a.string.isRequired,width:lt.a.number.isRequired,viewport:lt.a.shape({minx:lt.a.number.isRequired,maxx:lt.a.number.isRequired,miny:lt.a.number.isRequired,maxy:lt.a.number.isRequired})};a(1049),a(1051);var Wi=a(501);const Yi=e=>r.a.createElement(xt.a,{id:e.id,className:"libmr-RadioButton"},r.a.createElement(Wi.Radio,{onChange:e.onChange,checked:e.checked}),r.a.createElement("label",null,e.label));Yi.propTypes={checked:lt.a.bool,id:lt.a.string,label:lt.a.string,onChange:lt.a.func};var Zi=Yi;const Xi=e=>r.a.createElement("div",{className:m()("libmr-RadioSelect",e.className)},r.a.createElement("ul",null,e.items.map(t=>r.a.createElement("li",{key:t.value},r.a.createElement(Zi,{id:t.value,onChange:e.onChange?()=>e.onChange(t.value):null,label:t.label,checked:e.value===t.value||t.selected||!1}))),e.children));Xi.propTypes={children:lt.a.node,className:lt.a.string,items:lt.a.arrayOf(lt.a.shape({label:lt.a.string,value:lt.a.string,selected:lt.a.bool})),onChange:lt.a.func,value:lt.a.string};var Qi=Xi;const Ji={year:"Year",quarter:"Quarter",month:"Month",week:"Week",day:"Day"},ec={1:"1 second",3:"3 seconds",10:"10 seconds",20:"20 seconds",30:"30 seconds",60:"60 seconds"},tc=Object.keys(Ji).map(e=>({value:e,label:Ji[e]}));class ac extends r.a.Component{constructor(...e){var t;return t=super(...e),this.state={isPlaying:!1,isMovingWindow:!1},t}componentDidUpdate(e,t){t.isPlaying!==this.state.isPlaying&&(this.state.isPlaying?this.startTimelinePlay():this.stopTimelinePlay())}componentWillUnmount(){this.stopTimelinePlay()}moveBounds(e,t){const a=this.props.bounds.min+e,n=this.props.bounds.max+t;return a>=0&&n<=this.props.timelineMax&&this.props.onBoundsChange({min:a,max:n}),n>=this.props.timelineMax}togglePlayTimeline(e){this.setState({isPlaying:!this.state.isPlaying,isMovingWindow:e.metaKey||e.ctrlKey})}startTimelinePlay(){this.timerTick(!0)}stopTimelinePlay(){this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=null}timerTick(e=!1){const t=this.moveBounds(this.state.isMovingWindow?1:0,1),a=1e3*parseInt(this.props.speed,10);t?e?(this.props.onBoundsChange({min:0,max:1}),this.timeoutID=setTimeout(()=>this.timerTick(),a)):this.setState({isPlaying:!1}):this.timeoutID=setTimeout(()=>this.timerTick(),a)}render(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Dt,{title:"Reset zoom",onClick:()=>this.props.onBoundsChange({min:this.props.bounds.min,max:this.props.bounds.max})},r.a.createElement("i",{className:"material-icons"},"zoom_out_map")),r.a.createElement("div",{className:"libmr-Panel-control-group"},r.a.createElement(Dt,{title:"Skip to end",onClick:()=>this.props.onBoundsChange({min:this.props.timelineMax-(this.props.bounds.max-this.props.bounds.min),max:this.props.timelineMax})},r.a.createElement("i",{className:"material-icons"},"skip_next")),r.a.createElement(Dt,{title:"Fast-forward",onClick:()=>this.moveBounds(1,1)},r.a.createElement("i",{className:"material-icons"},"fast_forward")),r.a.createElement(Dt,{active:this.state.isPlaying,onClick:e=>this.togglePlayTimeline(e),title:this.state.isPlaying?"Pause":"Play timeline. Hold Ctrl/Cmd + click for moving window."},r.a.createElement("i",{className:"material-icons"},this.state.isPlaying?"pause":"play_arrow")),r.a.createElement(Dt,{title:"Rewind",onClick:()=>this.moveBounds(-1,-1)},r.a.createElement("i",{className:"material-icons"},"fast_rewind")),r.a.createElement(Dt,{title:"Back to start",onClick:()=>this.props.onBoundsChange({min:0,max:this.props.bounds.max-this.props.bounds.min})},r.a.createElement("i",{className:"material-icons"},"skip_previous"))),r.a.createElement("div",{className:"libmr-Panel-control-group"},r.a.createElement(Nt,{active:!1,align:"right",size:"narrow",summary:r.a.createElement("strong",null,ec[this.props.speed]),title:"Speed"},r.a.createElement(Qi,{items:Object.keys(ec).map(e=>({value:e,label:`1 ${this.props.unit}/${ec[e]}`})),onChange:this.props.onSpeedChange,value:this.props.speed})),r.a.createElement(Nt,{active:!1,align:"right",size:"narrow",summary:r.a.createElement("strong",null,Ji[this.props.unit]),title:"Group by"},r.a.createElement(Qi,{items:tc,onChange:this.props.onUnitChange,value:this.props.unit})),r.a.createElement(Nt,{align:"right",title:"Nodes"},r.a.createElement(jt,{label:"Node size",onChange:this.props.onNodeSizeChange,min:this.props.minNodeSize,max:this.props.maxNodeSize,unit:"px",value:this.props.nodeSize}))))}}ac.displayName="TimelineControls",ac.propTypes={bounds:lt.a.shape({min:lt.a.number.isRequired,max:lt.a.number.isRequired}).isRequired,maxNodeSize:lt.a.number,minNodeSize:lt.a.number,nodeSize:lt.a.number.isRequired,onBoundsChange:lt.a.func.isRequired,onNodeSizeChange:lt.a.func.isRequired,onSpeedChange:lt.a.func.isRequired,onUnitChange:lt.a.func.isRequired,speed:lt.a.string.isRequired,timelineMax:lt.a.number.isRequired,unit:lt.a.string.isRequired},ac.defaultProps={maxNodeSize:ea.a.MAX_NODE_SIZE,minNodeSize:ea.a.MIN_NODE_SIZE,nodeSize:ea.a.NODE_SIZE};a(1054);var nc=a(502);function rc(e){let t=0,a=Number.MAX_VALUE;for(const n of e)n.y>t&&(t=n.y),n.y<a&&(a=n.y);const n=.1*(t-a);return{min:a>n?a-n:0,max:t+n}}class sc extends r.a.Component{constructor(...e){var t;return t=super(...e),this.state={isDragging:!1,bounds:null},t}componentDidMount(){this.createChart(),this.debouncedChangeBounds=cl()(e=>{this.state.isDragging&&this.props.onBoundsChange(e)},ea.a.DELAY)}componentDidUpdate(e){e.width===this.props.width&&e.height===this.props.height||this.resizeChart(),e.chartData!==this.props.chartData&&this.updateChart()}componentWillUnmount(){this.chart.destroy()}createDatasets(){return{labels:this.props.chartData.map(e=>e.label),datasets:[{data:this.props.chartData,get backgroundColor(){return Vt.b.primaryColourAlphaMedium},lineTension:0,label:"Histogram"}]}}createChart(){this.domRef.height=this.props.height,this.domRef.width=this.props.width;const e=this.domRef.getContext("2d");this.chart=new Na.a(e,{type:"line",data:this.createDatasets(),options:{animation:!1,layout:{padding:{left:0,right:0,top:-40,bottom:0}},legend:{display:!1},maintainAspectRatio:!1,responsive:!1,scales:{xAxes:[{display:!1}],yAxes:[{display:!1,ticks:rc(this.props.chartData)}]},title:{display:!0,text:""},tooltips:{callbacks:{title:e=>`${e.map(e=>this.props.chartData[e.index].label).join(" ")}: ${e.length} point${1===e.length?"":"s"}`,label:()=>""},displayColors:!1,yAlign:"bottom"}}})}updateChart(){this.chart.config.data=this.createDatasets();const e=rc(this.props.chartData);this.chart.config.options.scales.yAxes[0].ticks.min=e.min,this.chart.config.options.scales.yAxes[0].ticks.max=e.max,this.chart.clear(),this.chart.update()}resizeChart(){this.chart.resize()}destroyChart(){this.chart.destroy(),this.chart=null}sliderPositionToBounds(e,t){const a=this.props.chartData.length-1;return{min:e*a/this.props.width,max:(e+t)*a/this.props.width}}render(){const e=this.state.bounds||this.props.bounds,t=this.props.width/Math.max(1,this.props.chartData.length-1),a=e.min*t,n=Math.max(1,e.max-e.min)*t,s=n<128,o=a>this.props.width-64+7,l=a+n<71;return r.a.createElement("div",{className:"libmr-AreaChart",style:{width:this.props.width,height:this.props.height}},r.a.createElement("canvas",{ref:e=>{this.domRef=e}}),r.a.createElement(nc.a,{bounds:"parent",minWidth:24,position:{x:a,y:0},size:{width:n,height:this.props.height},onDragStart:()=>this.setState({isDragging:!0}),onDrag:(e,t)=>{const a=this.sliderPositionToBounds(t.x>0?t.x:0,n);this.setState({bounds:a}),this.debouncedChangeBounds(a)},onDragStop:(e,t)=>{this.setState({isDragging:!1,bounds:null});const a=this.sliderPositionToBounds(t.x>0?t.x:0,n);this.props.onBoundsChange(a)},onResizeStart:()=>this.setState({isDragging:!0}),onResize:(e,t,a,n,r)=>{const s=this.sliderPositionToBounds(r.x>0?r.x:0,a.offsetWidth);this.setState({bounds:s}),this.debouncedChangeBounds(s)},onResizeStop:(e,t,a,n,r)=>{this.setState({isDragging:!1,bounds:null});const s=this.sliderPositionToBounds(r.x>0?r.x:0,a.offsetWidth);this.props.onBoundsChange(s)},className:m()("libmr-AreaChart-slider",{"has-labels":this.props.showLabels||this.state.isDragging,stacked:s,"stacked-left":o,"stacked-right":l}),enableResizing:{top:!1,right:!0,bottom:!1,left:!0,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},dragAxis:"x",resizeHandleClasses:{left:"libmr-AreaChart-resize-handler",right:"libmr-AreaChart-resize-handler"},resizeHandleStyles:{left:{top:-1,bottom:-1,height:"auto"},right:{top:-1,bottom:-1,height:"auto"}}},r.a.createElement("label",{className:"libmr-AreaChart-label-min"},this.props.formatLabel(this.props.chartData[Math.ceil(e.min)].x)),r.a.createElement("label",{className:"libmr-AreaChart-label-max"},this.props.formatLabel(this.props.chartData[Math.floor(e.max)].x))))}}sc.displayName="AreaChart",sc.propTypes={bounds:lt.a.shape({min:lt.a.number.isRequired,max:lt.a.number.isRequired}).isRequired,chartData:lt.a.arrayOf(lt.a.shape({x:lt.a.oneOfType([lt.a.instanceOf(Date),lt.a.number]).isRequired,y:lt.a.number.isRequired,label:lt.a.string.isRequired})).isRequired,formatLabel:lt.a.func,height:lt.a.number.isRequired,onBoundsChange:lt.a.func.isRequired,showLabels:lt.a.bool,width:lt.a.number.isRequired},sc.defaultProps={formatLabel:e=>e};const oc=({width:e,height:t,...a})=>{const[n,s]=r.a.useState(!1),o=r.a.useMemo(()=>function(e){if(e.length){let t=e[0].y;for(const{y:a}of e)t=a>t?a:t;return t}return 0}(a.chartData),[a.chartData]);return r.a.createElement(Ut,{className:"libmr-Timeline",controlsVisible:n,onControlsVisibleChange:s,secondaryControls:r.a.createElement(ac,{bounds:a.bounds,nodeSize:a.nodeSize,onBoundsChange:a.onBoundsChange,onNodeSizeChange:a.onNodeSizeChange,onSpeedChange:a.onSpeedChange,onUnitChange:a.onUnitChange,speed:a.speed,timelineMax:a.histogram.length-1,unit:a.unit}),style:{width:e,height:t},zoomControls:!1},r.a.createElement(qi,{addExportCallback:a.addExportCallback,bounds:a.momentBounds,chartData:a.chartData,getTooltip:a.getTooltip,height:t-56,highlightedIds:a.highlightedIds,maxStackSize:o,nodeSize:a.nodeSize,onViewportChange:a.onViewportChange,removeExportCallback:a.removeExportCallback,setHighlightedIds:a.setHighlightedIds,styles:a.styles,unit:a.unit,viewport:a.viewport,width:e-16}),r.a.createElement(sc,{bounds:a.bounds,chartData:a.histogram,formatLabel:ar,height:48,onBoundsChange:a.onBoundsChange,width:e-16,showLabels:n}),a.children)};oc.displayName="Timeline",oc.propTypes={addExportCallback:lt.a.func,bounds:lt.a.shape({min:lt.a.number.isRequired,max:lt.a.number.isRequired}),chartData:lt.a.arrayOf(lt.a.shape({x:lt.a.instanceOf(Date).isRequired,y:lt.a.number.isRequired,id:lt.a.string.isRequired})).isRequired,children:lt.a.node,getTooltip:lt.a.func,height:lt.a.number.isRequired,highlightedIds:lt.a.instanceOf(Set).isRequired,histogram:lt.a.arrayOf(lt.a.shape({x:lt.a.instanceOf(Date).isRequired,y:lt.a.number.isRequired,label:lt.a.string.isRequired})).isRequired,maxNodeSize:lt.a.number,minNodeSize:lt.a.number,momentBounds:lt.a.shape({min:lt.a.instanceOf(Kn.a).isRequired,max:lt.a.instanceOf(Kn.a).isRequired}).isRequired,nodeSize:lt.a.number.isRequired,onBoundsChange:lt.a.func.isRequired,onNodeSizeChange:lt.a.func.isRequired,onSpeedChange:lt.a.func.isRequired,onUnitChange:lt.a.func.isRequired,onViewportChange:lt.a.func.isRequired,removeExportCallback:lt.a.func,setHighlightedIds:lt.a.func.isRequired,speed:ac.propTypes.speed,styles:lt.a.object.isRequired,unit:ac.propTypes.unit,viewport:lt.a.shape({minx:lt.a.number.isRequired,maxx:lt.a.number.isRequired,miny:lt.a.number.isRequired,maxy:lt.a.number.isRequired}).isRequired,width:lt.a.number.isRequired},oc.defaultProps={getTooltip:e=>e.id};var lc=oc;const ic=e=>{const t=(e=>{const{points:t,unit:a}=e,n=r.a.useMemo(()=>nr(t),[t]),s=r.a.useMemo(()=>rr(t,a),[t,a]),o=r.a.useMemo(()=>e.bounds||sr(s),[e.bounds,s]),l=r.a.useMemo(()=>or(o,s),[o,s]);return{bounds:o,chartData:n,histogram:s,momentBounds:l}})(e);return r.a.createElement(lc,g()({},e,t))};ic.propTypes={points:lt.a.arrayOf(lt.a.shape({date:lt.a.instanceOf(Date).isRequired,id:lt.a.string.isRequired})).isRequired,styles:lt.a.object.isRequired};var cc=a(116);const uc=Object(ce.createSelector)(cr,Or,(e,t)=>{const a=[];for(const n of e)t.includes(n.id)&&a.push(n);return a}),mc=Object(ce.createSelector)(uc,nr);var dc=Object(c.a)((function(e){const t=lr(e);return{hasTimeline:ur(e),bounds:dr(e),chartData:mc(e),getTooltip:ir(e),highlightedIds:vs(e),histogram:mr(e),momentBounds:pr(e),nodeSize:t.nodeSize,speed:t.speed,styles:er(e),unit:t.unit,viewport:t.viewport}}),(function(e){return{onBoundsChange:t=>e(cc.f(t)),onNodeSizeChange:t=>e(cc.g(t)),onSpeedChange:t=>e(cc.h(t)),onUnitChange:t=>e(cc.i(t)),onViewportChange:t=>e(cc.j(t)),setHighlightedIds:(t,a)=>e(Object(mi.f)(t,a))}}))(e=>e.hasTimeline?r.a.createElement(lc,g()({addExportCallback:ga,removeExportCallback:ba},e)):null),pc=(a(1056),a(1058),a(1060),a(1062),a(102)),hc=a.n(pc),fc=a(504),gc=a.n(fc),bc=a(505),yc=a.n(bc),Ec=a(506),vc=a.n(Ec),Cc=a(507),wc=a.n(Cc),Sc=a(508),Nc=a.n(Sc);function Oc(){return(Oc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var xc=r.a.createElement("path",{d:"M3 15.813V6v9.813zM14 19v-6 6zM9 9V3v6zM9 3h8-8zM9 9h8-8zM3 6h5-5zM3 15.813h11H3zM14 13h6-6zM14 19h6-6z"}),kc=r.a.createElement("path",{d:"M3 15.813v1H2v-1h1zM3 6H2V5h1v1zm11 13v1h-1v-1h1zm0-6h-1v-1h1v1zM9 9v1H8V9h1zm0-6H8V2h1v1zM2 15.813V6h2v9.813H2zM13 19v-6h2v6h-2zM8 9V3h2v6H8zm1-7h8v2H9V2zm0 6h8v2H9V8zM3 5h5v2H3V5zm0 9.813h11v2H3v-2zM14 12h6v2h-6v-2zm0 6h6v2h-6v-2z",fill:"#FFF"});var _c=e=>r.a.createElement("svg",Oc({width:"1em",height:"1em",viewBox:"0 0 22 22"},e),xc,kc);function Ic(){return(Ic=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var Tc=r.a.createElement("path",{d:"M14.53 7.462l-.707-.707-.707.707.707.707.707-.707zm-8.485 2.829l.98.196.203-1.014-1.02-.169-.163.987zm-4.95-.707L.1 9.474l.994.11zm2.828 8.485l.707-.707-.015-.016-.017-.015-.675.738zm6.364-6.364l3.536 3.535 1.414-1.414-3.536-3.535-1.414 1.414zm4.95 3.535c1.008-1.007 1.556-2.064 1.765-3.107.207-1.036.065-1.989-.198-2.777a7.143 7.143 0 00-.963-1.867 7.13 7.13 0 00-.583-.712 2.323 2.323 0 00-.013-.014l-.005-.004-.001-.002-.001-.001-.708.706-.708.707-.001-.002h-.001l.001.001.017.018a5.142 5.142 0 01.375.465c.238.333.514.796.694 1.337.179.537.258 1.131.134 1.753-.123.614-.458 1.325-1.218 2.085l1.414 1.414zm-1.414-1.414c-.76.76-1.472 1.095-2.086 1.218-.621.125-1.215.046-1.752-.133a5.148 5.148 0 01-1.337-.694 5.157 5.157 0 01-.466-.375l-.017-.017-.002-.002v.001l.002.001-.706.708-.707.708.001.001.002.002.005.005.013.013.043.04a7.111 7.111 0 00.669.542c.44.315 1.083.702 1.867.964.789.263 1.742.405 2.778.198 1.043-.21 2.1-.758 3.107-1.766l-1.414-1.414zm1.414-5.657l3.535-3.535-1.414-1.414-3.535 3.535 1.414 1.414zm2.828-4.242a96.673 96.673 0 01-.626.78v-.001l-.002-.002v.001l.016.013.083.075c.076.07.19.182.33.336.279.307.652.778 1.007 1.41.706 1.254 1.352 3.162 1.028 5.749l1.985.248c.384-3.07-.384-5.404-1.27-6.978a9.814 9.814 0 00-1.268-1.772 7.484 7.484 0 00-.591-.585 3.164 3.164 0 00-.063-.052l-.002-.002h-.001l-.626.78zm0 0l.707-.708-.002-.002a2.277 2.277 0 00-.06-.057 11.74 11.74 0 00-.701-.606c-.47-.376-1.15-.864-1.986-1.318-1.658-.9-4.038-1.719-6.668-1.112l.45 1.949c1.967-.454 3.83.142 5.264.92a11.717 11.717 0 012.15 1.51 5.87 5.87 0 01.136.128l.005.004h-.001l.706-.708zm-9.9 9.9c-.897-.898-1.41-1.99-1.14-3.34l-1.961-.392c-.437 2.185.464 3.922 1.688 5.145l1.414-1.414zm-2.12-3.536l.163-.987h-.003l-.007-.002-.03-.004-.112-.019A142.258 142.258 0 004.29 9c-1.045-.159-2.31-.34-3.105-.412l-.18 1.991c.724.066 1.933.239 2.984.399a170.72 170.72 0 011.744.275l.11.018.029.005h.007l.001.001.165-.986zm-3.956-.597c.153-1.376.773-2.639 1.39-3.586a11.308 11.308 0 011.071-1.39 4.7 4.7 0 01.08-.083c0-.002.002-.002.002-.003l-.001.001-.708-.706-.707-.707-.002.002a2.275 2.275 0 00-.039.04 10.443 10.443 0 00-.409.457c-.258.306-.604.748-.962 1.297C1.096 6.1.302 7.667.101 9.473l1.988.221zM.1 9.474c-.325 2.92.448 5.244 1.304 6.834.427.794.876 1.406 1.222 1.825a8.644 8.644 0 00.6.655.842.842 0 01.018.016l.002.001v.001l.676-.737.676-.738v.001H4.6l.001.002-.002-.002-.017-.017a6.654 6.654 0 01-.414-.456 9.257 9.257 0 01-1.002-1.499c-.707-1.313-1.348-3.232-1.077-5.666L.1 9.474zm3.115 9.302c4.28 4.28 11.277 4.28 15.557 0l-1.415-1.414c-3.498 3.498-9.23 3.498-12.728 0l-1.414 1.414z"});var Lc=e=>r.a.createElement("svg",Ic({width:"1em",height:"1em",viewBox:"0 0 22 22"},e),Tc);function jc(){return(jc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var Ac=r.a.createElement("path",{d:"M11.536 1.267l1.5 5.417 1.928-.534-1.5-5.417-1.928.534zm2.955 6.02l6.5-3.666-.982-1.742-6.5 3.667.982 1.742zm-1.369-1.35l-3 5.5 1.756.959 3-5.5-1.756-.958zm-1.826 5.024l-10-3.099-.592 1.91 10 3.1.592-1.91zm-1.174 1.434l2.5 4.584 1.756-.958-2.5-4.583-1.756.957zm2.464 3.699l-2 4.5 1.828.812 2-4.5-1.828-.812zm.622 1.362l6 1.834.584-1.913-6-1.833-.584 1.912z"});var Pc=e=>r.a.createElement("svg",jc({width:"1em",height:"1em",viewBox:"0 0 22 22"},e),Ac);function Rc(){return(Rc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var Mc=r.a.createElement("path",{d:"M1 11l-.447.894v-1.788L1 11zm2.25-1.125l-.447-.894.447.894zm4.5-2.25l-.447-.894.447.894zM10 6.5l.447.894L10 6.5zm4.5-2.25l-.447-.894.447.894zm2.25-1.125l-.447-.894.447.894zm-15.303 6.98l18 9-.894 1.79-18-9 .894-1.79zm-.894 0l2.25-1.124.894 1.788-2.25 1.125-.894-1.788zm2.25-1.124l4.5-2.25.894 1.788-4.5 2.25-.894-1.788zm4.5-2.25l2.25-1.125.894 1.788-2.25 1.125-.894-1.788zm2.25-1.125l4.5-2.25.894 1.788-4.5 2.25-.894-1.788zm4.5-2.25l2.25-1.125.894 1.788-2.25 1.125-.894-1.788zm2.25-1.125l2.25-1.125.894 1.788-2.25 1.125-.894-1.788z"}),Dc=r.a.createElement("path",{d:"M5.553 13.106l6-3 .894 1.788-6 3-.894-1.788zm6-3l7-3.5.894 1.788-7 3.5-.894-1.788zm.894 0l7 3.5-.894 1.788-7-3.5.894-1.788z"});var Fc=e=>r.a.createElement("svg",Rc({width:"1em",height:"1em",viewBox:"0 0 22 22"},e),Mc,Dc);function zc(){return(zc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var Gc=r.a.createElement("path",{d:"M6.188 3H16 6.187zM3 14h6-6zM13 9h6-6zM19 9v8-8zM13 9v8-8zM16 3v5-5zM6.188 3v11V3zM9 14v6-6zM3 14v6-6z",fill:"#C4C4C4"}),Uc=r.a.createElement("path",{d:"M6.188 3h-1V2h1v1zM16 3V2h1v1h-1zM3 14H2v-1h1v1zm6 0v-1h1v1H9zm4-5h-1V8h1v1zm6 0V8h1v1h-1zM6.187 2H16v2H6.187V2zM3 13h6v2H3v-2zm10-5h6v2h-6V8zm7 1v8h-2V9h2zm-6 0v8h-2V9h2zm3-6v5h-2V3h2zM7.187 3v11h-2V3h2zM10 14v6H8v-6h2zm-6 0v6H2v-6h2z",fill:"#FFF"});const Bc={rc:_c,cr:Lc,rd:Pc,dg:Fc,hr:e=>r.a.createElement("svg",zc({width:"1em",height:"1em",viewBox:"0 0 22 22"},e),Gc,Uc)},$c={rc:"Rectangular",cr:"Circular",rd:"Radial",dg:"Diagonal",hr:"Hierarchical"},Hc=e=>{const t=e.treeType.toLowerCase(),a=t===e.selectedTreeType,n=Bc[t];return r.a.createElement(Dt,{active:a,title:$c[e.treeType],onClick:()=>e.handleClick(e.treeType.toLowerCase())},r.a.createElement(n,null))};Hc.displayName="TreeTypeButton",Hc.propTypes={treeType:lt.a.string.isRequired,selectedTreeType:lt.a.string.isRequired,handleClick:lt.a.func.isRequired};var Vc=Hc;const Kc={Degrees0:0,Degrees45:.25*Math.PI,Degrees90:.5*Math.PI,Degrees180:Math.PI,Degrees270:1.5*Math.PI,Degrees360:2*Math.PI},qc=[];var Wc={alignLabels:!1,branchScale:null,collapsedIds:qc,fillStyle:"#222",fontFamily:"serif",fontSize:16,fontWeight:"normal",haloRadius:12,haloStyle:"#3C7383",haloWidth:4,highlightedId:null,highlightedStyle:"#3C7383",internalNodeStyle:{shape:"none"},labelThreshold:8,leafNodeStyle:{shape:"circle"},lineWidth:1,nodeSize:14,nodesPowRatio:.5,padding:32,renderInternalLabels:!1,renderLabels:!0,renderLeafLabels:!0,rootId:null,rotatedIds:qc,selectableInternalNodes:!0,selectableLeafNodes:!0,selectedIds:qc,showLabels:!1,showNodes:!0,stepScale:8,strokeStyle:"#222",styleLeafLabels:!1,styleNodeLines:!1,styles:{},type:"rc",zoomFactor:3};const Yc=e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Ht,{active:e.lasso,onClick:()=>e.onLassoChange(!e.lasso)}),r.a.createElement("div",{className:"libmr-Panel-control-group"},r.a.createElement(Vc,{treeType:"hr",selectedTreeType:e.type,handleClick:e.onTypeChange}),r.a.createElement(Vc,{treeType:"dg",selectedTreeType:e.type,handleClick:e.onTypeChange}),r.a.createElement(Vc,{treeType:"rd",selectedTreeType:e.type,handleClick:e.onTypeChange}),r.a.createElement(Vc,{treeType:"cr",selectedTreeType:e.type,handleClick:e.onTypeChange}),r.a.createElement(Vc,{treeType:"rc",selectedTreeType:e.type,handleClick:e.onTypeChange})));Yc.displayName="TreeControls",Yc.propTypes={lasso:lt.a.bool.isRequired,type:lt.a.string.isRequired,onLassoChange:lt.a.func.isRequired,onTypeChange:lt.a.func.isRequired},Yc.defaultProps={type:Wc.type};var Zc=Yc;const Xc=e=>r.a.createElement(Nt,{className:"scrollable-content",title:"Nodes & labels"},r.a.createElement(jt,{id:"tree-nodeSize",label:"Node size",onChange:e.onNodeSizeChange,min:e.minNodeSize,max:e.maxNodeSize,value:e.nodeSize,unit:"px"}),r.a.createElement(jt,{id:"tree-fontSize",label:"Label size",onChange:e.onFontSizeChange,min:e.minFontSize,max:e.maxFontSize,value:e.fontSize,unit:"px"}),r.a.createElement("hr",null),r.a.createElement(Tt,{className:"mr-toggle-switch",label:"Show leaf nodes",id:"tree-styleLeafNodes",isChecked:e.styleLeafNodes,onChange:t=>e.onStyleLeafNodesChange(t)}),r.a.createElement(Tt,{className:"mr-toggle-switch",label:"Show leaf borders",id:"tree-renderLeafBorders",isChecked:e.renderLeafBorders,onChange:t=>e.onRenderLeafBordersChange(t)}),r.a.createElement("hr",null),r.a.createElement(Tt,{className:"mr-toggle-switch",label:"Show leaf labels",id:"tree-renderLeafLabels",isChecked:e.renderLeafLabels,onChange:t=>e.onRenderLeafLabelsChange(t)}),r.a.createElement(Tt,{className:"mr-toggle-switch",label:"Align leaf labels",id:"tree-alignLabels",isChecked:e.alignLabels,onChange:t=>e.onAlignLabelsChange(t)}),r.a.createElement(Tt,{className:"mr-toggle-switch",label:"Colour leaf labels",id:"tree-styleLeafLabels",isChecked:e.styleLeafLabels,onChange:t=>e.onStyleLeafLabelsChange(t)}),r.a.createElement("hr",null),r.a.createElement(Tt,{className:"mr-toggle-switch",label:"Show internal nodes",id:"tree-styleInternalNodes",isChecked:e.styleInternalNodes,onChange:t=>e.onStyleInternalNodesChange(t)}),r.a.createElement(Tt,{className:"mr-toggle-switch",label:"Show internal labels",id:"tree-renderInternalLabels",isChecked:e.renderInternalLabels,onChange:t=>e.onRenderInternalLabelsChange(t)}),r.a.createElement(Tt,{className:"mr-toggle-switch",label:"Colour internal edges",id:"tree-styleNodeLines",isChecked:e.styleNodeLines,onChange:t=>e.onStyleNodeLinesChange(t)}));Xc.propTypes={alignLabels:lt.a.bool,fontSize:lt.a.number.isRequired,maxFontSize:lt.a.number.isRequired,maxNodeSize:lt.a.number.isRequired,minFontSize:lt.a.number.isRequired,minNodeSize:lt.a.number.isRequired,nodeSize:lt.a.number.isRequired,onAlignLabelsChange:lt.a.func.isRequired,onFontSizeChange:lt.a.func.isRequired,onNodeSizeChange:lt.a.func.isRequired,onRenderInternalLabelsChange:lt.a.func.isRequired,onRenderLeafBordersChange:lt.a.func.isRequired,onRenderLeafLabelsChange:lt.a.func.isRequired,onStyleInternalNodesChange:lt.a.func.isRequired,onStyleLeafLabelsChange:lt.a.func.isRequired,onStyleLeafNodesChange:lt.a.func.isRequired,onStyleNodeLinesChange:lt.a.func.isRequired,renderInternalLabels:lt.a.bool,renderLeafBorders:lt.a.bool,renderLeafLabels:lt.a.bool,styleInternalNodes:lt.a.bool,styleLeafLabels:lt.a.bool,styleLeafNodes:lt.a.bool,styleNodeLines:lt.a.bool},Xc.defaultProps={fontSize:ea.a.FONT_SIZE,maxFontSize:ea.a.MAX_FONT_SIZE,maxNodeSize:ea.a.MAX_NODE_SIZE,minFontSize:ea.a.MIN_FONT_SIZE,minNodeSize:ea.a.MIN_NODE_SIZE,nodeSize:ea.a.NODE_SIZE};var Qc=Xc;const Jc={x:["fullscreen","swap_horiz","swap_vert"],y:["fullscreen","swap_vert","swap_horiz"]};class eu extends r.a.Component{constructor(...e){var t;return t=super(...e),this.state={mode:0},this.toggleMode=()=>{this.setState({mode:2===this.state.mode?0:this.state.mode+1})},t}render(){const e=[this.props.onZoomIn,this.props.onHorizZoomIn,this.props.onVertZoomIn],t=[this.props.onZoomOut,this.props.onHorizZoomOut,this.props.onVertZoomOut],{mainAxis:a="x"}=this.props;return r.a.createElement(zt,{className:this.props.className,onZoomIn:e[this.state.mode],onZoomOut:t[this.state.mode]},r.a.createElement("div",{className:"libmr-ZoomControls-button",title:"Toogle zoom mode",onClick:this.toggleMode},r.a.createElement("i",{className:"libmr-ZoomControls-icon material-icons"},Jc[a][this.state.mode])))}}eu.displayName="TreeZoomControls",eu.propTypes={className:lt.a.string,mainAxis:lt.a.string,onZoomIn:lt.a.func.isRequired,onZoomOut:lt.a.func.isRequired,onHorizZoomIn:lt.a.func.isRequired,onHorizZoomOut:lt.a.func.isRequired,onVertZoomIn:lt.a.func.isRequired,onVertZoomOut:lt.a.func.isRequired};var tu={rd:{alignableLabels:!1,branchScalingAxis:"xy",drawLine:function(e,t,a){e.ctx.beginPath(),e.ctx.moveTo(a.x,a.y),e.ctx.lineTo(a.parent.x,a.parent.y),e.ctx.stroke(),e.ctx.closePath()},getBranchScale:function(e){const t=function(e){return Math.min(e.ctx.canvas.width,e.ctx.canvas.height)}(e)/2,a=e.getVirtualTree(),n=a.rootNode.totalLeafLength-a.rootNode.branchLength;return n>0?t/n:n<0?t*n:0},getNodeAtPoint:function(e,t,a,n){const{rootNode:r,postorderTraversal:s}=e.layout();for(let e=r.postIndex-r.totalNodes+1;e<=r.postIndex;e++){const r=s[e];if(r.parent&&(r.x>r.parent.x?t<r.x&&t>r.parent.x:t<r.parent.x&&t>r.x))if(isNaN(r.slope)){if(r.y>r.parent.y?a<r.y&&a>r.parent.y:a<r.parent.y&&a>r.y)return r}else if(a>r.slope*t+r.intercept-n&&a<r.slope*t+r.intercept+n)return r}return null},layoutNodes:function(e,t){let a=0;const{rootNode:n}=t;for(let e=n.postIndex-n.totalNodes+1;e<=n.postIndex;e++){const r=t.postorderTraversal[e];if(r.isLeaf)r.angle=a*(Kc.Degrees360/n.visibleLeaves);else{let e=0;for(const t of r.children)e+=t.angle*t.totalLeaves;r.angle=e/r.totalLeaves}(r.isLeaf&&!r.isHidden||r.isCollapsed&&!r.isHidden)&&(a+=1)}for(let a=n.preIndex;a<n.preIndex+n.totalNodes;a++){const r=t.preorderTraversal[a],s=r.branchLength*e.state.branchScale;r.x=(r!==n?r.parent.x:0)+s*Math.cos(r.angle),r.y=(r!==n?r.parent.y:0)+s*Math.sin(r.angle),r!==n&&(r.slope=(r.parent.y-r.y)/(r.parent.x-r.x),r.intercept=r.y-r.slope*r.x)}}},rc:{alignableLabels:!0,branchScalingAxis:"x",drawLine:function(e,t,a){a!==t.rootNode&&(e.ctx.beginPath(),e.ctx.moveTo(a.x,a.y),e.ctx.lineTo(a.parent.x,a.y),e.ctx.lineTo(a.parent.x,a.parent.y),e.ctx.stroke(),e.ctx.closePath())},getBranchScale:function(e,t=e.state.stepScale){const a=e.getVirtualTree(),n=a.rootNode.totalLeaves*t,r=e.ctx.canvas.width/e.ctx.canvas.height*n,s=a.rootNode.totalLeafLength-a.rootNode.branchLength;return 0===s&&e.error(501),r/s},getNodeAtPoint:function(e,t,a,n){const{rootNode:r,postorderTraversal:s}=e.layout();for(let e=r.postIndex-r.totalNodes+1;e<=r.postIndex;e++){const r=s[e];if(r.parent&&(t<r.x+n&&t>r.parent.x-n&&a<r.y+n&&a>r.y-n||t<r.parent.x+n&&t>r.parent.x-n&&(a<r.parent.y?a>r.y-n:a<r.y+n)))return r}return null},mainAxis:"x",layoutNodes:function(e,t){let a=0;const{rootNode:n}=t;for(let r=n.postIndex-n.totalNodes+1;r<=n.postIndex;r++){const n=t.postorderTraversal[r];if(n.angle=Kc.Degrees0,n.x=n.distanceFromRoot*e.state.branchScale,n.isLeaf)n.y=a*e.state.stepScale;else if(n.isCollapsed)n.y=a*e.state.stepScale;else{const e=n.children[0].y,t=n.children[n.children.length-1].y;n.y=(t+e)/2}(n.isLeaf&&!n.isHidden||n.isCollapsed&&!n.isHidden)&&(a+=1)}},stepScalingAxis:"y"},cr:{alignableLabels:!0,branchScalingAxis:"xy",drawLine:function(e,t,a){const{rootNode:n}=t,r=a.parent.distanceFromRoot-n.distanceFromRoot;if(e.ctx.beginPath(),e.ctx.moveTo(a.x,a.y),e.ctx.lineTo(r*e.state.branchScale*Math.cos(a.angle),r*e.state.branchScale*Math.sin(a.angle)),e.ctx.stroke(),e.ctx.closePath(),a.children&&a.children.length&&!a.isCollapsed){const t=a.children[0].angle,r=a.children[a.children.length-1].angle,s=Math.abs(a.distanceFromRoot-n.distanceFromRoot);e.ctx.beginPath(),e.ctx.arc(0,0,s*e.state.branchScale,t,r,r<t),e.ctx.stroke(),e.ctx.closePath()}},getBranchScale:function(e){const t=function(e){return Math.min(e.ctx.canvas.width,e.ctx.canvas.height)}(e)/2,{rootNode:a}=e.getVirtualTree();return a.totalLeafLength>0?t/a.totalLeafLength:a.totalLeafLength<0?t*a.totalLeafLength:0},getNodeAtPoint:function(e,t,a,n){const{rootNode:r,postorderTraversal:s}=e.layout();for(let o=r.postIndex-r.totalNodes+1;o<=r.postIndex;o++){const l=s[o];if(!l.parent)continue;const i=l.parent.distanceFromRoot-r.distanceFromRoot,c=i*e.state.branchScale*Math.cos(l.angle);if(l.x>c?t<l.x&&t>c:t<c&&t>l.x)if(isNaN(l.slope)){const t=i*e.state.branchScale*Math.sin(l.angle);if(l.y>t?a<l.y&&a>t:a<t&&a>l.y)return l}else if(a>l.slope*t+l.intercept-n&&a<l.slope*t+l.intercept+n)return l}return null},layoutNodes:function(e,t){let a=0;const{rootNode:n}=t;for(let r=n.postIndex-n.totalNodes+1;r<=n.postIndex;r++){const n=t.postorderTraversal[r];if(n.isLeaf)n.angle=a*(Kc.Degrees360/t.rootNode.visibleLeaves);else{const e=n.children[0].angle,t=n.children[n.children.length-1].angle;n.angle=(t+e)/2}const s=(n.distanceFromRoot-t.rootNode.distanceFromRoot)*e.state.branchScale;n.x=s*Math.cos(n.angle),n.y=s*Math.sin(n.angle),(n.isLeaf&&!n.isHidden||n.isCollapsed&&!n.isHidden)&&(a+=1),n.parent&&(n.slope=Math.tan(n.angle),n.intercept=n.y-n.slope*n.x)}}},dg:{alignableLabels:!1,getBranchScale:function(e){const{rootNode:t}=e.getVirtualTree(),a=e.ctx.canvas.width-2*e.state.padding;return t.totalLeafLength>0?a/t.totalLeafLength:t.totalLeafLength<0?a*t.totalLeafLength:0},getNodeAtPoint:function(e,t,a,n){const{rootNode:r,postorderTraversal:s}=e.getVirtualTree();for(let e=r.postIndex-r.totalNodes+1;e<=r.postIndex;e++){const r=s[e];if(r&&r.parent&&t<r.x&&t>r.parent.x&&a>r.slope*t+r.intercept-n&&a<r.slope*t+r.intercept+n)return r}return null},drawLine:function(e,t,a){a!==t.rootNode&&(e.ctx.beginPath(),e.ctx.moveTo(a.x,a.y),e.ctx.lineTo(a.parent.x,a.parent.y),e.ctx.stroke(),e.ctx.closePath())},layoutNodes:function(e,t){let a=0;const{rootNode:n}=t;for(let r=n.postIndex-n.totalNodes+1;r<=n.postIndex;r++){const n=t.postorderTraversal[r];if(n.angle=Kc.Degrees0,n.x=(t.rootNode.visibleLeaves-n.visibleLeaves)*e.state.stepScale/2,n.isLeaf)n.y=a*e.state.stepScale;else if(n.isCollapsed)n.y=a*e.state.stepScale;else{const t=n.children[0].y,a=(n.visibleLeaves-n.children[0].visibleLeaves)*e.state.stepScale;n.y=t+a/2}n.isLeaf&&a++}for(let e=n.preIndex;e<n.preIndex+n.totalNodes;e++){const a=t.preorderTraversal[e];a.parent&&(a.slope=(a.parent.y-a.y)/(a.parent.x-a.x),a.intercept=a.y-a.slope*a.x)}},mainAxis:"x",stepScalingAxis:"y"},hr:{alignableLabels:!0,drawLine:function(e,t,a){a!==t.rootNode&&(e.ctx.beginPath(),e.ctx.moveTo(a.x,a.y),e.ctx.lineTo(a.x,a.parent.y),e.ctx.lineTo(a.parent.x,a.parent.y),e.ctx.stroke(),e.ctx.closePath())},branchScalingAxis:"y",getBranchScale:function(e,t=e.state.stepScale){const a=e.getVirtualTree(),n=a.rootNode.totalLeaves*t,r=e.ctx.canvas.height/e.ctx.canvas.width*n,s=a.rootNode.totalLeafLength-a.rootNode.branchLength;return 0===s&&e.error(501),r/s},getNodeAtPoint:function(e,t,a,n){const{rootNode:r,preorderTraversal:s}=e.layout();for(let e=r.preIndex;e<r.preIndex+r.totalNodes;e++){const r=s[e];if(r.parent&&(t<r.x+n&&t>r.x-n&&a<r.y+n&&a>r.parent.y-n||a<r.parent.y+n&&a>r.parent.y-n&&(t<r.parent.x?t>r.x-n:t<r.x+n)))return r}return null},mainAxis:"y",layoutNodes:function(e,t){let a=0;const{rootNode:n}=t;for(let r=n.postIndex-n.totalNodes+1;r<=n.postIndex;r++){const n=t.postorderTraversal[r];if(n.angle=Kc.Degrees90,n.y=n.distanceFromRoot*e.state.branchScale,n.isLeaf)n.x=-1*a*e.state.stepScale;else if(n.isCollapsed)n.x=a*e.state.stepScale;else{const e=n.children[0].x,t=n.children[n.children.length-1].x;n.x=(t+e)/2}(n.isLeaf&&!n.isHidden||n.isCollapsed&&!n.isHidden)&&(a+=1)}},stepScalingAxis:"x"}},au=function(e){const t=e.getBounds(!1),a=e.getDrawingArea(),n=t.maxX-t.minX,r=t.maxY-t.minY,s=Math.max(.333*a.width,a.right-a.left-e.state.nodeSize),o=Math.max(.333*a.height,a.bottom-a.top-e.state.nodeSize),l=s/n,i=o/r,c=Math.min(l,i),u=e.state.padding+Math.max(e.state.nodeSize,e.state.fontSize)/2;let m=-1*t.minX*c,d=-1*t.minY*c;l>i?(m+=u+(s-n*c)/2,d+=u):l<i?(m+=u,d+=u+(o-r*c)/2):(m+=u,d+=u),void 0===tu[e.state.type].mainAxis&&(m+=(a.width-s)/2-u,d+=(a.height-o)/2-u);const{minScale:p,maxScale:h}=function(e){return{minScale:e/2,maxScale:Math.max(e,16)}}(c);return{offsetX:m,offsetY:d,scale:c,minScale:p,maxScale:h}},nu=function(e){return{branchScale:tu[e.state.type].getBranchScale(e,Wc.stepScale)}},ru=function(e){return{stepScale:Wc.stepScale}},su=function(e){return e.chain(ru,nu,au)},ou=function(e,t){return e.chain(()=>({rootId:t}),su)},lu=function(e){return(t,a)=>{t.lasso=qt(t.ctx.canvas,t.ctx.canvas,{isActive:e.props.lasso,path:e.props.path,onPathChange:a=>{if(null===a&&e.props.highlightedIds.length)return;let n=null;if(a){n=[];const e=t.layout();for(const r of e.leafNodes)t.lasso.isPointInside(r,a)&&n.push(r.id)}e.props.onFilterChange(n,a)},onRedrawRequested:()=>t.render(),translateToCanvas:e=>e.map(e=>hc.a.utils.unmapPoint(t,e.x,e.y)),translateFromCanvas:(e,a)=>hc.a.utils.mapPoint(t,e,a)});const n=()=>{setTimeout(()=>e.props.onAddHistoryEntry(t.ctx.canvas.toDataURL()),0)};t.drawNodeShape=function({state:e,ctx:t},a,n,r,s=r/2){a.isLeaf?e.styleLeafNodes&&ca(t,0,0,s,n,t.fillStyle,null,e.renderLeafBorders?t.lineWidth:0):(a.isCollapsed&&e.styleLeafNodes||e.styleInternalNodes)&&a.piechartSlices&&function(e,t,a,n,r={},s=null,o=ea.a.NODE_BORDER_WIDTH,l=ea.a.NODE_BORDER_STYLE){let i=0;for(const s of Object.keys(r)){e.fillStyle=s,e.beginPath(),e.moveTo(t,a);const o=i+2*Math.PI*r[s];e.arc(t,a,n,i,o,!1),e.fill(),e.closePath(),i=o}o>0&&(e.beginPath(),e.arc(t,a,n,aa.Degrees0,aa.Degrees360),e.strokeStyle=l,e.strokeWidth=o,e.stroke(),e.closePath()),s&&ta(e,t,a,n,s)}(t,0,0,s,a.piechartSlices,null,e.renderLeafBorders?t.lineWidth:0)}.bind(null,t),a("collapseNode",(e,t)=>{e(...t),n()}),a("layout",(e,a)=>{const n=e(...a);if(t._.piechart=t._.piechart||{},(!0===t.state.styleInternalNodes||t.state.collapsedIds.length)&&t._.piechart.styles!==t.state.styles){const e={fillStyle:t.state.fillStyle,...t.state.leafNodeStyle};for(const a of n.postorderTraversal)if(a.isLeaf){const e=t.state.styles?t.state.styles[a.id]:void 0;a.strokeStyle=(e?e.strokeStyle:void 0)||t.state.strokeStyle}else{const n={};for(const r of a.children)if(r.isLeaf){const a=t.state.styles[r.id]||e;n[a.fillStyle]=(n[a.fillStyle]||0)+1}else for(const e of Object.keys(r.piechartSlices))n[e]=(n[e]||0)+r.piechartSlices[e];a.piechartSlices=n}for(const e of n.postorderTraversal)if(!e.isLeaf)for(const t of Object.keys(e.piechartSlices))e.piechartSlices[t]=e.piechartSlices[t]/e.totalLeaves;t._.piechart.styles=t.state.styles}return n}),a("mergeState",(a,[n])=>{a(),t.state={...t.state,...n,size:{width:e.props.width,height:e.props.height},highlightedStyle:Vt.b.primaryColour,haloStyle:Vt.b.primaryColour,metadata:{...t.state.metadata,...n.metadata},scalebar:{...t.state.scalebar,...n.metadata}}}),a("postRender",(e,a)=>{e(...a),t.lasso.isActive&&(t.ctx.save(),t.ctx.scale(t.pixelRatio,t.pixelRatio),t.lasso.draw(),t.ctx.restore(),t.lasso.updateCanvas())}),a("rerootNode",(e,t)=>{e(...t),n()}),t.selectNode=(a,n)=>{if(t._.selectedNodeId=null,a&&a.isLeaf)e.props.setHighlightedIds([a.id],n);else{if(e.props.path)return void(e.props.highlightedIds.length&&e.props.setHighlightedIds());a&&!a.isHidden?(t._.selectedNodeId=a.id,e.props.onFilterChange(t.getLeafIds(a))):n||(e.props.highlightedIds.length?e.props.setHighlightedIds():e.props.onFilterChange(null))}},t.setRoot=e=>{t._.selectedNodeId=null;let a=null;null!==e&&(a=t.getNodeById(e)),t.setState({...ou(t,a?a.id:null),ids:t.getLeafIds(e)}),n()},e.props.onPhylocanvasStateChange&&a("setState",(t,[a])=>{t(),e.props.onPhylocanvasStateChange(a)}),a("setTreeType",(e,t)=>{e(...t),n()}),t.isUninitialised=()=>null===t.state.branchScale,e.props.onRedrawOriginalTree&&a("setSource",(a,n)=>{n[0]===t.nodes.originalSource?e.props.onRedrawOriginalTree():a(...n)})}};lt.a.shape({index:lt.a.number.isRequired,field:lt.a.string.isRequired,label:lt.a.string.isRequired}),lt.a.shape({index:lt.a.number.isRequired,image:lt.a.string.isRequired});const iu=lt.a.shape({x:lt.a.number.isRequired,y:lt.a.number.isRequired}),cu=(lt.a.oneOfType([lt.a.arrayOf(lt.a.number.isRequired),lt.a.shape({lat:lt.a.number.isRequired,lng:lt.a.number.isRequired})]),()=>{});class uu extends r.a.Component{constructor(...e){var t;return t=super(...e),this.state={controlsVisible:!1},t}componentDidMount(){let e=this.props.phylocanvasState;e.viewPort&&!e.size&&(e={...e,...hc.a.utils.restoreViewport(e.viewPort,e.padding,this.props.width,this.props.height)}),this.tree=hc.a.createTree(this.canvasRef,e,[gc.a,vc.a,wc.a,Nc.a,lu(this),yc.a]),this.onInitialise();const{addExportCallback:t}=this.props;t&&(t("tree-png",()=>this.tree.exportPNG()),t("tree-svg",()=>this.tree.exportSerialisedSVG()),t("tree-nwk",()=>this.tree.getNewick()))}componentDidUpdate(e){e.width===this.props.width&&e.height===this.props.height||this.resizeTree(),e.lasso!==this.props.lasso&&this.tree.lasso.setActive(this.props.lasso),e.path!==this.props.path&&this.tree.lasso.setPath(this.props.path),e.filenames!==this.props.filenames&&(this.tree.contextMenu.filenames=this.props.filenames);let t=!1;if(e.phylocanvasState!==this.props.phylocanvasState&&(this.tree.mergeState(this.props.phylocanvasState),this.tree.isUninitialised())){const{source:e}=this.props.phylocanvasState;this.tree.setSource(e),t=!0}this.tree.render(),t&&this.onInitialise()}componentWillUnmount(){this.tree.lasso&&this.tree.lasso.destroy(),this.tree&&this.tree.destroy();const{removeExportCallback:e}=this.props;e&&(e("tree-png"),e("tree-svg"))}onInitialise(){this.props.onPhylocanvasInitialise&&setTimeout(()=>this.props.onPhylocanvasInitialise(this.tree.ctx.canvas.toDataURL()),0)}getMainAxis(){if(this.tree){const e=hc.a.types[this.tree.state.type];return e?e.mainAxis:void 0}}resizeTree(){this.tree.resize(this.props.width,this.props.height)}toggleStyleInternalNodes(e){this.tree.setState({styleInternalNodes:e,internalNodeStyle:{shape:e?"circle":"none"}})}render(){const{width:e,height:t,phylocanvasState:a}=this.props,{controlsVisible:n}=this.state;return r.a.createElement(Ut,{controlsVisible:n,onControlsVisibleChange:()=>this.setState({controlsVisible:!n}),primaryControls:r.a.createElement("div",{className:"libmr-ControlsMenu-group"},r.a.createElement(Qc,{alignLabels:a.alignLabels,fontSize:a.fontSize,maxFontSize:this.props.maxFontSize,maxNodeSize:this.props.maxNodeSize,minFontSize:this.props.minFontSize,minNodeSize:this.props.minNodeSize,nodeSize:a.nodeSize,onAlignLabelsChange:e=>this.tree.setState({alignLabels:e}),onFontSizeChange:e=>this.tree.setState({fontSize:e}),onNodeSizeChange:e=>this.tree.setState({nodeSize:e}),onRenderInternalLabelsChange:e=>this.tree.setState({renderInternalLabels:e}),onRenderLeafBordersChange:e=>this.tree.setState({renderLeafBorders:e}),onRenderLeafLabelsChange:e=>this.tree.setState({renderLeafLabels:e}),onStyleInternalNodesChange:e=>this.toggleStyleInternalNodes(e),onStyleLeafLabelsChange:e=>this.tree.setState({styleLeafLabels:e}),onStyleLeafNodesChange:e=>this.tree.setState({styleLeafNodes:e}),onStyleNodeLinesChange:e=>this.tree.setState({styleNodeLines:e}),renderInternalLabels:a.renderInternalLabels,renderLeafBorders:a.renderLeafBorders,renderLeafLabels:a.renderLeafLabels,styleInternalNodes:a.styleInternalNodes,styleLeafLabels:a.styleLeafLabels,styleLeafNodes:a.styleLeafNodes,styleNodeLines:a.styleNodeLines,theme:this.props.theme}),this.props.primaryControls),secondaryControls:r.a.createElement(Zc,{lasso:this.props.lasso,onLassoChange:this.props.onLassoChange,onTypeChange:e=>this.tree.setTreeType(e),type:a.type}),style:{width:e,height:t,...this.props.style},theme:this.props.theme,zoomControls:r.a.createElement(eu,{mainAxis:this.getMainAxis(),onZoomIn:()=>this.tree.transform(0,0,1),onZoomOut:()=>this.tree.transform(0,0,-1),onHorizZoomIn:()=>this.tree.changeBranchScale(1),onHorizZoomOut:()=>this.tree.changeBranchScale(-1),onVertZoomIn:()=>this.tree.changeStepScale(1),onVertZoomOut:()=>this.tree.changeStepScale(-1),theme:this.props.theme})},r.a.createElement("div",{className:"libmr-Tree",style:{width:e,height:t}},r.a.Children.map(this.props.children,e=>r.a.isValidElement(e)?r.a.cloneElement(e,{controlsVisible:n}):e),r.a.createElement("canvas",{ref:e=>{this.canvasRef=e},width:e,height:t})))}}uu.displayName="Tree",uu.propTypes={...Ut.panelProps,addExportCallback:lt.a.func,filenames:lt.a.object,height:lt.a.number.isRequired,highlightedIds:lt.a.array,lasso:lt.a.bool,newickString:lt.a.string,onAddHistoryEntry:lt.a.func,onFilterChange:lt.a.func,onLassoChange:lt.a.func,onPhylocanvasInitialise:lt.a.func,onPhylocanvasStateChange:lt.a.func,onRedrawOriginalTree:lt.a.func,path:lt.a.arrayOf(iu),phylocanvasState:lt.a.object,removeExportCallback:lt.a.func,setHighlightedIds:lt.a.func,width:lt.a.number.isRequired},uu.defaultProps={highlightedIds:[],lasso:!1,onAddHistoryEntry:cu,onControlsVisibleChange:cu,onFilterChange:cu,onLassoChange:cu,onPhylocanvasInitialise:cu,onPhylocanvasStateChange:cu,onZoomModeChange:cu,setHighlightedIds:cu};var mu=a(83),du=a(31),pu=a(318);function hu(e){return(t,a)=>{const n=Object(An.a)(a());return t(mu.d(e,Object(pu.b)(n.uuid,e)))}}const fu={message:"Subtree currently unavailable, please try again later."};function gu(e){return(t,a)=>{const n=a(),r=Object(_s.d)(n)[e];r&&"READY"===r.status&&(r.newick?t(mu.f(e)):t(hu(e)).then(()=>t(mu.f(e))).catch(()=>t(Object(d.c)(fu))))}}var bu=Object(c.a)((function(e){return{singleTree:Object(An.e)(e),visibleTree:Object(Hn.h)(e),subtrees:Object(_s.b)(e)}}),(function(e){return{displayTree:t=>e(gu(t))}}))(({singleTree:e,displayTree:t,subtrees:a,visibleTree:n})=>e===Is.a?null:r.a.createElement("header",{className:"wgsa-tree-header"},r.a.createElement(So,{button:r.a.createElement(Et,null,n)},!e&&r.a.createElement("button",{onClick:()=>t(Is.a)},"Collection"),(!e||e===Is.b)&&r.a.createElement("button",{onClick:()=>t(Is.b)},"Population"),r.a.createElement("hr",null),a.map(([e,a])=>r.a.createElement("button",{onClick:()=>t(e)},a))))),yu=a(111);const Eu=e=>({type:"LIBMR PHYLOCANVAS STATE",payload:e}),vu=e=>({type:"LIBMR TREE LASSO",payload:{lasso:e}}),Cu=(e,t)=>({type:"LIBMR TREE FILTER",payload:{ids:e,path:t}});const wu=({controlsVisible:e=!1,loading:t})=>r.a.createElement(b.a,{in:!0},!e&&r.a.createElement(bu,{key:"header"}),t?r.a.createElement("div",{className:"wgsa-loading-overlay",key:"loading"},r.a.createElement(R.a,null)):null);var Su=Object(c.a)((function(e){const{lasso:t,path:a}=Object(Hn.g)(e);return{lasso:t,path:a,filenames:Ms(e),highlightedIds:Ps(e),loading:Object(Hn.i)(e),phylocanvasState:zs(e)}}),(function(e,{stateKey:t}){return{onAddHistoryEntry:a=>e({stateKey:t,...Object(yu.d)(a)}),onFilterChange:(a,n)=>t!==Is.b&&e({stateKey:t,...Cu(a,n)}),onLassoChange:a=>e({stateKey:t,...vu(a)}),onPhylocanvasInitialise:a=>e({stateKey:t,...Object(yu.d)(a)}),onPhylocanvasStateChange:a=>e({stateKey:t,...Eu(a)}),setHighlightedIds:(a,n)=>e(((e,t,a)=>n=>{e===Is.b?1===t.length&&n(gu(t[0])):n(Object(mi.f)(t,a))})(t,a,n))}}))(e=>0===e.width||0===e.height?null:r.a.createElement(uu,g()({},e,{addExportCallback:ga,removeExportCallback:ba}),r.a.createElement(wu,{loading:e.loading})));const Nu=r.a.createClass({displayName:"Progress",renderQueuePosition(){const{position:e}=this.props;return 0===e?"Awaiting progress":e?`Queue position: ${e}`:"Awaiting position"},renderStatus(){const{status:e,progress:t}=this.props;return"PENDING"===e?r.a.createElement("div",{className:"wgsa-tree-progress mdl-shadow--2dp"},r.a.createElement("p",null,"Tree pending"),r.a.createElement("p",{className:"wgsa-muted wgsa-blink"},this.renderQueuePosition()),r.a.createElement(le,{interval:10,fn:this.props.fetchPosition})):"IN PROGRESS"===e?r.a.createElement("div",{className:"wgsa-tree-progress mdl-shadow--2dp"},r.a.createElement(ie,{radius:"40",strokeWidth:"8",percentage:t||0}),r.a.createElement("p",{className:"wgsa-blink"},"Tree in progress")):"ERROR"===e?r.a.createElement("div",{className:"wgsa-tree-progress mdl-shadow--2dp"},r.a.createElement("p",{className:"danger"},"Error building tree"),r.a.createElement("p",{className:"wgsa-blink"},"Awaiting retry")):"FAILED"===e?r.a.createElement("div",{className:"wgsa-tree-progress mdl-shadow--2dp"},r.a.createElement("p",null,"😞"),r.a.createElement("p",{className:"danger"},"Failed to build tree")):"READY"===e?r.a.createElement("div",{className:"wgsa-tree-progress mdl-shadow--2dp"},r.a.createElement("button",{className:"mdl-button mdl-button--raised mdl-button--colored",onClick:this.props.showTree},"View Tree")):null},render(){return r.a.createElement(b.a,{out:!0},r.a.cloneElement(this.renderStatus(),{key:this.props.status}))}});var Ou=Object(c.a)((function(e){const{status:t,progress:a,position:n}=Object(_s.d)(e)[Is.a];return{status:t,progress:a,position:n}}),(function(e,{date:t}){return{fetchPosition:()=>e(Object(mu.e)(Is.a,t)),showTree:()=>e(Object(mu.f)(Is.a))}}))(Nu),xu=a(334);const ku=Object(xu.a)(xu.b);var _u=Object(c.a)((function(e){return{genomeTotals:He(e),currentThreshold:$n(e),marks:Bn(e)}}))(({marks:e,currentThreshold:t,genomeTotals:a=[]})=>r.a.createElement(ul.a,null,({width:n})=>r.a.createElement("div",{className:"pw-cluster-threshold-slider wgsa-pane-overlay",style:{width:n}},r.a.createElement("h3",null,"Set Threshold"),r.a.createElement(ku,{min:0,max:e.max,step:1,marks:e.items,defaultValue:t,included:!1,onAfterChange:e=>Object(On.f)({threshold:e}),tipFormatter:e=>`${a[e]} genomes at threshold ${e}`})))),Iu=a(149);const Tu=Object(ce.createSelector)(Xe,vs,Nr,(e,t,a)=>{for(const n of e.nodes)if(n.isHighlighted=n.genomeIds.some(e=>t.has(e)),a.active){const e=n.genomeIds.some(e=>a.ids.has(e));n.isActive=e,n.label&&!e?(n.hiddenLabel=n.label,n.label=void 0):n.hiddenLabel&&e&&(n.label=n.hiddenLabel)}else n.isActive=!0,n.hiddenLabel&&(n.label=n.hiddenLabel);return{...e}}),Lu=r.a.createClass({displayName:"ClusterViewNetwork",componentDidUpdate(e){e.threshold!==this.props.threshold&&this.props.fetch(this.props.genomeId,this.props.threshold)},render(){const{props:e}=this;return"READY"!==e.collectionStatus?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(st,null,r.a.createElement(wa,{coverMessage:!1,graph:e.graph,hasLasso:!0,height:e.height,lassoActive:e.lassoActive,lassoPath:e.lassoPath,onLassoActiveChange:e.onLassoActiveChange,onLassoPathChange:t=>e.onLassoPathChange(t,e.hasHighlight),onNodeSelect:(t,a)=>e.onNodeSelect(e,t,a),width:e.width})),r.a.createElement("h2",{className:"pw-cluster-view-current-threshold wgsa-pane-overlay"},"Threshold of ",e.threshold),r.a.createElement(_u,null))}});var ju=Object(c.a)((function(e){const t=Object(An.a)(e);return{lassoActive:zn(e),lassoPath:Fn(e),graph:Tu(e),threshold:$n(e),genomeId:t.genomeId,collectionStatus:t.status,hasHighlight:ws(e)}}),(function(e){return{fetch:(t,a)=>e(Object(Iu.c)(t,a)),onLassoActiveChange:()=>e(Object(Iu.e)()),onLassoPathChange:(t,a)=>{e(null===t&&a?Object(mi.d)():Object(Iu.d)(t))},onNodeSelect:(t,a,n)=>{e(((e,t,a)=>(n,r)=>{if(e.lassoActive&&!e.lassoPath)return;let s;if(t&&t.length){s=[];const e=r(),a=ke(e);for(const e of t)s.push(...a[e].ids)}s?n(Object(mi.f)(s,a)):e.lassoPath||n(Object(mi.d)())})(t,a,n))}}}))(Lu);const Au=Object(c.a)((e,{stateKey:t})=>Object(An.d)(e)[t]||{entries:[]},(e,{stateKey:t})=>({onTravel:a=>e({...Object(yu.e)(a),stateKey:t})}))(pl),Pu=Object(c.a)(e=>({stateKey:Object(Hn.e)(e)}))(Su),Ru=Object(c.a)(e=>({visible:Mi(e)}))(({visible:e,...t})=>r.a.createElement("div",{style:{position:"relative"}},r.a.createElement(Hi,null),"timeline"===e?r.a.createElement(dc,t):r.a.createElement(Ri,t))),Mu=({isClusterView:e,treeStateKey:t,horizontalSize:a,createdAt:n})=>{const[s,o]=r.a.useState(null);return e?r.a.createElement(ll.a,{split:"vertical",defaultSize:"50%",className:"wgsa-no-overflow-pane",resizerClassName:"wgsa-resizer",onChange:o},r.a.createElement(ju,{width:s,height:a}),r.a.createElement(di,null,r.a.createElement(wi,null))):t?r.a.createElement(ll.a,{split:"vertical",defaultSize:"50%",className:"wgsa-no-overflow-pane",resizerClassName:"wgsa-resizer",onChange:o},r.a.createElement(ml,{component:Pu}),r.a.createElement(di,null,r.a.createElement(wi,null))):r.a.createElement(di,null,r.a.createElement(wi,null),r.a.createElement(Ou,{date:n}))};var Du=Object(c.a)((function(e){const t=Object(An.a)(e);return{createdAt:t.createdAt,isClusterView:t.isClusterView,treeStateKey:Object(Hn.e)(e)}}))(({isClusterView:e,treeStateKey:t,createdAt:a})=>{const[n,s]=r.a.useState(null),o=r.a.useMemo(()=>({height:n||"62.5%"}),[n]),l=r.a.useMemo(()=>e?[]:[{title:"History",icon:r.a.createElement("i",{className:"material-icons"},"history"),component:()=>r.a.createElement(Au,{stateKey:t})}],[e,t]);return r.a.createElement(gi,{panes:l,navStyle:o},r.a.createElement(ll.a,{split:"horizontal",defaultSize:"62.5%",resizerClassName:"wgsa-resizer",onChange:s},r.a.createElement(Mu,{createdAt:a,isClusterView:e,treeStateKey:t,horizontalSize:n}),r.a.createElement(ml,{component:Ru})))});const Fu=r.a.createClass({displayName:"StatusSwitcher",componentDidMount(){const{uuid:e,treesComplete:t}=this.props;t||!e||this.notificationChannel||(this.notificationChannel=re(e,"progress",this.props.updateProgress))},componentDidUpdate(e){const{treesComplete:t}=this.props;!e.treesComplete&&t&&this.notificationChannel&&se(this.props.uuid)},componentWillUnmount(){this.notificationChannel&&se(this.props.uuid)},render:()=>null});var zu=Object(c.a)((function(e){const t=Object(An.a)(e);return{treesComplete:Object(_s.a)(e),uuid:t.uuid}}),(function(e){return{updateProgress:t=>e(function(e={}){return t=>"tree"===e.task&&"READY"===e.status?t(hu(e.name)):t(Object(du.f)(e))}(t))}}))(Fu);var Gu=Object(c.a)((function(e){return{title:Object(An.c)(e)||"Explore Collection"}}))(({title:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(q.a,null,e),r.a.createElement(Du,null),r.a.createElement(zu,null)));a(1064);const Uu={background:T.b.COLOURS.GREY_LIGHT},Bu=Object(c.a)()(r.a.createClass({displayName:"Background",componentDidMount(){componentHandler.upgradeDom()},render(){const{logo:e=!0}=this.props;return r.a.createElement("div",{style:Uu,className:"wgsa-loading-container"},r.a.createElement("div",{className:"wgsa-loading-content"},e&&r.a.createElement(H,{className:"wgsa-loading-logo"}),this.props.children))}})),$u=r.a.createClass({displayName:"LoadSpinner",render:()=>r.a.createElement(Bu,{logo:!1},r.a.createElement(q.a,null,"Loading..."),r.a.createElement(R.a,null),r.a.createElement("h1",null,"Loading collection..."))});const Hu=r.a.createClass({displayName:"LoadError",render(){return r.a.createElement(Bu,null,r.a.createElement(q.a,null,"Error"),function({collection:e,location:t}){const{status:a}=e;if(a===xr.a.NOT_FOUND){const{organism:e}=t.state||{};return e?[r.a.createElement("h1",null,"Looking for an old collection?"),r.a.createElement("p",{className:"mdl-typography--title"},"It will be available at ",r.a.createElement("a",{href:`https://archive.wgsa.net/${e}${t.pathname}`},"archive.wgsa.net")," for a short time.",r.a.createElement("br",null),"Please ",r.a.createElement("a",{href:"mailto:cgps@sanger.ac.uk"},"contact us")," if you would like your data migrated to the new site.")]:[r.a.createElement("h1",null,"We're sorry, this collection cannot be found."),r.a.createElement("p",{className:"mdl-typography--title"},"Please ensure that the address is correct, and if so, please try again later.")]}return a===xr.a.ABORTED?[r.a.createElement("h1",null,"We're sorry, your upload was interrupted"),r.a.createElement("p",{className:"mdl-typography--title"},"Please upload your files again."),r.a.createElement(J.a,{to:`/${Ua.b.nickname}/upload`,className:"mdl-button mdl-button--raised"},"Go Back")]:[r.a.createElement("h1",null,"We're sorry, something went wrong."),r.a.createElement("button",{onClick:()=>history.go(-1),className:"mdl-button mdl-button--raised"},"Go Back")]}(this.props),r.a.createElement("p",null,"Please contact ",r.a.createElement("a",{href:"mailto:cgps@sanger.ac.uk"},"cgps@sanger.ac.uk")," if problems persist."))}});var Vu=r.a.createClass({displayName:"Explorer",propTypes:{fetch:r.a.PropTypes.func,reset:r.a.PropTypes.func,status:r.a.PropTypes.string,progress:r.a.PropTypes.object},componentDidMount(){this.props.fetch()},componentWillUnmount(){this.props.reset()},render(){const{collection:e}=this.props;return e.status===xr.a.READY?r.a.createElement(Gu,null):e.status&&e.status!==xr.a.READY?r.a.createElement(Hu,{collection:e,location:this.props.location}):r.a.createElement($u,null)}});var Ku=Object(c.a)((function(e){return{collection:Object(An.a)(e)}}),(function(e,{match:t}){return{fetch:()=>e(du.d(t.params.token)),reset:()=>e(du.e())}}))(Vu);const qu=r.a.createElement(o.a,{path:"/collection/:token",component:ol});var Wu=r.a.createElement(o.a,{path:"/collection/:token",component:Ku});a(1066),a(1068);const Yu=({style:e,children:t})=>r.a.createElement("div",{style:e,className:"wgsa-grid-item"},t);var Zu=r.a.createClass({displayName:"Grid.react",propTypes:{className:r.a.PropTypes.string,columnWidth:r.a.PropTypes.number,columnCount:r.a.PropTypes.oneOfType([r.a.PropTypes.number,r.a.PropTypes.array]),items:r.a.PropTypes.array,rowHeight:r.a.PropTypes.number,template:r.a.PropTypes.func},getColumnCount(e){return this.props.columnCount?this.parseColumnCount(e):Math.max(1,Math.floor(e/this.props.columnWidth))},getColumnWidth(e,t){const{columnWidth:a,rightMargin:n}=this.props;return(a||Math.floor(e/t))-(n?n/t:0)},getRowHeight(e){const{rowHeight:t,rowMinHeight:a=0,rowMaxHeight:n=Number.MAX_VALUE,cellArea:r,rowFooterHeight:s=0}=this.props;return Math.min(Math.max(a,(t||r/e)+s),n)},parseColumnCount(e){const{columnCount:t}=this.props;if(Array.isArray(t)){let a=1;for(const{minWidth:n=0,count:r}of t){if(n>e)return a;a=r}return a}return t},render(){const{template:e,items:t,headerHeight:a=0}=this.props;return r.a.createElement("div",{className:this.props.className},this.props.header,r.a.createElement(ul.a,null,({height:n,width:s})=>{const o=this.getColumnCount(s),l=this.getColumnWidth(s,o);return r.a.createElement(ul.b,{cellRenderer:({key:a,columnIndex:n,rowIndex:s,style:l})=>{const i=t[n+s*o];return i?r.a.createElement(Yu,{key:a,style:l},r.a.createElement(e,{item:i})):null},className:"wgsa-virtualised-grid",columnCount:o,columnWidth:l,rowCount:Math.ceil(t.length/o),rowHeight:this.getRowHeight(l),width:s,height:n-a})}))}}),Xu=a(150);a(1070);const Qu=r.a.memo(({visible:e,total:t,itemType:a})=>r.a.createElement("p",{className:"wgsa-filter-summary__count"},"Viewing ",r.a.createElement("span",null,e.toLocaleString())," of ",t.toLocaleString()," ",a,1!==t?"s":"")),Ju=({className:e,children:t})=>r.a.createElement("div",{className:m()("wgsa-filter-summary wgsa-content-margin",e)},t);var em=a(100),tm=a(75);var am=Object(c.a)((function(e){return{isOpen:Object(tm.g)(e)}}),(function(e){return{onClick:()=>e(Object(em.d)())}}))(({isOpen:e,onClick:t})=>r.a.createElement("div",{className:"wgsa-filter-header"},r.a.createElement("button",{className:"mdl-button mdl-button--icon",onClick:t},r.a.createElement("i",{className:"material-icons"},"tune"))));const nm=({collections:e})=>e.entities,rm=({collections:e})=>e.status,sm=Object(ce.createSelector)(nm,e=>Object.keys(e).map(t=>e[t])),om=e=>(({collections:e})=>e.summary)(e).total;var lm=Object(c.a)((function(e){return{visibleCollections:sm(e).length,totalCollections:om(e),activeSort:Object(tm.a)(e)}}),(function(e){return{onSortChange:t=>e(Object(em.e)({sort:t.target.value}))}}))(({visibleCollections:e,totalCollections:t,activeSort:a="createdAt-",onSortChange:n})=>0===t?r.a.createElement("header",null):r.a.createElement("header",null,r.a.createElement(am,null),r.a.createElement(Qu,{visible:e,total:t,itemType:"collection"}),r.a.createElement("label",{className:"wgsa-select-box"},"Sort by",r.a.createElement("select",{value:a,onChange:n},r.a.createElement("option",{value:"createdAt-"},"Created: Most Recent"),r.a.createElement("option",{value:"createdAt"},"Created: Least Recent"),r.a.createElement("option",{value:"size"},"Size: Low to High"),r.a.createElement("option",{value:"size-"},"Size: High to Low"),r.a.createElement("option",{value:"title"},"Title: Ascending"),r.a.createElement("option",{value:"title-"},"Title: Descending"),r.a.createElement("option",{value:"publicationYear"},"Published: Ascending"),r.a.createElement("option",{value:"publicationYear-"},"Published: Descending"))))),im=a(327),cm=(a(1072),a(113)),um=a.n(cm),mm=({children:e,visible:t})=>r.a.createElement(um.a,{transitionName:"wgsa-overlay",transitionEnterTimeout:280,transitionLeaveTimeout:280},t&&r.a.createElement("div",{className:"wgsa-content-overlay"},e)),dm=a(152);const pm=r.a.createClass({displayName:"Collections",componentWillMount(){this.props.filter()},componentDidUpdate(e){e.prefilter!==this.props.prefilter&&this.props.filter()},getEmptyMessage(){const{total:e,match:t,filterActive:a}=this.props,{prefilter:n}=t.params;if(a)return r.a.createElement("div",{className:"pw-filter-view-message"},r.a.createElement("p",null,"No matches, please refine your search."),r.a.createElement("button",{className:"mdl-button mdl-button--raised mdl-button--colored",onClick:this.props.clear},"Clear Filters"));if(0===e)switch(n){case"bin":return r.a.createElement("p",{className:"pw-filter-view-message"},"Nothing in the bin 👍");case"user":return r.a.createElement("div",{className:"pw-filter-view-message"},r.a.createElement("p",null,"You haven't created any collections."),r.a.createElement("p",null,r.a.createElement(J.a,{to:"/genomes",className:"mdl-button mdl-button--raised mdl-button--colored"},"Browse Genomes")));default:return r.a.createElement("p",{className:"pw-filter-view-message"},"Nothing to see here.")}return null},getContent(){const{status:e,collections:t}=this.props;return e===dm.a.ERROR?r.a.createElement("p",{className:"pw-filter-view-message"},"Something went wrong. 😞"):0===this.props.total&&e===dm.a.LOADING?null:0===t.length?this.getEmptyMessage():r.a.createElement(Zu,{className:"wgsa-filter-view",template:im.a,items:t,columnCount:[{minWidth:560,count:2},{minWidth:1020,count:3},{minWidth:1580,count:4}],rightMargin:16,cellArea:64e3,rowMinHeight:160,rowMaxHeight:232,rowFooterHeight:36})},render(){const{status:e}=this.props;return r.a.createElement("div",{className:m()("wgsa-collections wgsa-filter-container",{"has-filter":this.props.isFilterOpen})},r.a.createElement(q.a,null,"Collections"),r.a.createElement(Xu.a,null),r.a.createElement("div",{className:"wgsa-filter-content"},r.a.createElement(lm,null),this.getContent()),r.a.createElement(mm,{visible:e===dm.a.LOADING},r.a.createElement("p",{className:"pw-filter-view-loading"},"Loading... ⏳")))}});var hm=Object(c.a)((function(e,{match:t}){const{prefilter:a}=t.params;return{prefilter:a,collections:sm(e),total:om(e),status:rm(e),isFilterOpen:Object(tm.g)(e),filterActive:Object(tm.f)(e)}}),(function(e,{match:t,location:a}){const{prefilter:n}=t.params,r=Object(Rn.parse)(a.search);return{filter:()=>e(Object(em.e)({prefilter:n,...r},!1)),clear:()=>e(Object(em.c)())}}))(pm);const fm=r.a.createElement(o.a,{path:"/collections"},r.a.createElement(Ln,{asideEnabled:!0}));var gm=r.a.createElement(o.a,{path:"/collections/:prefilter(all|user|bin)",component:hm}),bm=(a(1074),a(28));var ym=Object(c.a)((e,{view:t})=>{const a=`/genomes/${Object(bm.d)(e)}`,n=t?`${a}/${t}`:a,{location:r}=e;return{link:`${n}${r.search}`,active:r.pathname===n}})(({active:e,link:t,title:a})=>r.a.createElement(J.a,{to:t,className:m()("wgsa-button-group__item",{active:e})},a)),Em=a(68);var vm=Object(c.a)((function(e){return{isOpen:Object(bm.g)(e)}}),(function(e){return{onClick:()=>e(Object(Em.f)())}}))(({isOpen:e,onClick:t})=>r.a.createElement("div",{className:"wgsa-filter-header"},r.a.createElement("button",{className:"mdl-button mdl-button--icon",onClick:t,title:e?"Hide filter":"Show filter"},r.a.createElement("i",{className:"material-icons"},"tune")))),Cm=(a(1076),a(1078),a(1080),({children:e,className:t,redirect:a=`${window.location.pathname}${window.location.search}`})=>r.a.createElement(J.a,{className:t,to:`/sign-in?redirect=${a}`},e)),wm=a(21),Sm=a(123);const{user:Nm}=ee.a;var Om=Object(c.a)((function(e){return{selectedGenomes:Object(wm.d)(e),selectedGenomeIds:Object(wm.c)(e),canCreateCollection:Object(Sm.a)(e)}}),(function(e){return{clearAll:()=>e(Object(O.g)()),removeGenome:t=>e(Object(O.i)([t])),showGenome:t=>e(Object(gn.d)(t.id,t.name)),sendToBin:t=>e(k(t,!0)),toggle:t=>e(Object(O.m)(t))}}))(({clearAll:e,removeGenome:t,selectedGenomes:a,sendToBin:n,showGenome:s,toggle:o,canCreateCollection:l})=>r.a.createElement("div",{className:"wgsa-genome-selection"},r.a.createElement("header",{className:"wgsa-dropdown-header"},"Selection",r.a.createElement("button",{className:"wgsa-button--text wgsa-clear-selection",onClick:e},"Clear All")),r.a.createElement(ul.d,{height:278,width:438,style:{overflowX:"hidden"},className:"wgsa-genome-selection-list",rowCount:a.length,rowHeight:32,rowRenderer:({key:e,index:n,style:o})=>{const l=a[n];return r.a.createElement("li",{key:e,className:"wgsa-list-item",style:{...o,width:440,top:o.top+8}},r.a.createElement("button",{className:"wgsa-link-button",title:"View report",onClick:()=>s(l)},l.name),r.a.createElement("button",{title:"Remove from selection",onClick:e=>{e.stopPropagation(),t(l)},className:"mdl-button mdl-button--icon"},r.a.createElement("i",{className:"material-icons"},"clear")))}}),r.a.createElement("footer",{className:"wgsa-dropdown-footer"},!!Nm&&r.a.createElement("div",null,r.a.createElement("button",{className:"mdl-button mdl-button--icon",onClick:()=>n(a),title:"Send to bin"},r.a.createElement("i",{className:"material-icons"},"delete_sweep")),r.a.createElement("button",{title:"Edit metadata",className:"mdl-button",onClick:()=>o("edit")},"Edit")),l?r.a.createElement("span",{key:"can-create-collection"},r.a.createElement("button",{className:"mdl-button",onClick:()=>o("download")},"Download Data"),Nm?r.a.createElement("button",{key:"create-collection",className:"mdl-button mdl-button--raised mdl-button--colored",onClick:()=>o("collection")},"Create Collection"):r.a.createElement(Cm,{key:"create-collection",className:"mdl-button mdl-button--raised mdl-button--colored"},"Sign in to Create Collection")):r.a.createElement("button",{key:"download-only",className:"mdl-button mdl-button--raised mdl-button--colored",onClick:()=>o("download")},"Download Data")))),xm=(a(1082),a(170));var km=({amount:e,limit:t})=>r.a.createElement("div",{className:"wgsa-selection-message"},r.a.createElement("h3",null,"We're Sorry!"),r.a.createElement("p",null,"You have selected ",r.a.createElement("strong",null,e," genomes"),", but the current limit for this feature is ",r.a.createElement("strong",null,t),". 😞"),r.a.createElement("p",null,"Please refine your selection to continue."));var _m=Object(c.a)((function(e){return{amount:Object(wm.i)(e)}}))(({type:e,amount:t,children:a})=>{const n=ee.a[e]||1e3;return t>n?r.a.createElement(km,{type:e,amount:t,limit:n}):a});var Im=Object(c.a)(null,(function(e){return{goBack:()=>e(Object(O.m)("selection"))}}))(({goBack:e})=>r.a.createElement("div",{className:"wgsa-genome-collection"},r.a.createElement("header",{className:"wgsa-dropdown-header"},"Create Collection"),r.a.createElement(_m,{type:"maxCollectionSize"},r.a.createElement(xm.b,null)),r.a.createElement("footer",{className:"wgsa-dropdown-footer"},r.a.createElement("button",{className:"mdl-button",onClick:e},"Go back"))));a(1086);var Tm=({link:e,ids:t,children:a,className:n})=>r.a.createElement("form",{action:e,method:"POST",target:"_blank"},r.a.createElement("button",{className:n},a),r.a.createElement("input",{type:"hidden",name:"ids",value:t}));const Lm=({speciesId:e,speciesName:t,total:a,tasks:n,ids:s})=>e?r.a.createElement("li",null,r.a.createElement(D.a,{speciesName:t}),r.a.createElement("ul",{className:"wgsa-genome-download-list"},r.a.createElement("li",null,r.a.createElement(Tm,{link:Object(j.c)("/download/genome/fasta"),ids:s},"FASTA files")),r.a.createElement("li",null,r.a.createElement(Tm,{link:Object(j.c)("/download/genome/metadata"),ids:s},"Metadata")),n.map(e=>r.a.createElement("li",{key:e.name},r.a.createElement(Tm,{link:e.link,ids:e.ids},e.label,e.sources.length>0&&r.a.createElement("small",null," (",e.sources.join(", "),")")),r.a.createElement("span",null,e.ids.length,"/",a))))):null,jm=r.a.createClass({displayName:"Content",componentDidMount(){this.props.fetch()},componentDidUpdate(e){const{selection:t,fetch:a}=this.props;e.selection!==t&&a()},showAllOrganisms:(e,t)=>0===e.length||1===e.length&&e[0].ids.length!==t.length||e.length>1,render(){const{status:e,summary:t,selection:a}=this.props;if(e===T.e.LOADING)return r.a.createElement(R.a,null);if(e===T.e.ERROR)return r.a.createElement("p",null,"Something went wrong. 😞");if(e===T.e.SUCCESS){const e=a.map(e=>e.id);return r.a.createElement("ul",null,this.showAllOrganisms(t,e)&&r.a.createElement("li",null,"All Organisms",r.a.createElement("ul",{className:"wgsa-genome-download-list"},r.a.createElement("li",null,r.a.createElement(Tm,{link:Object(j.c)("/download/genome/fasta"),ids:e},"FASTA files")),r.a.createElement("li",null,r.a.createElement(Tm,{link:Object(j.c)("/download/genome/metadata"),ids:e},"Metadata")),r.a.createElement("li",null,r.a.createElement(Tm,{link:Object(j.c)("/download/analysis/speciator"),ids:e},r.a.createElement("strong",null,"Species Prediction"))))),t.map(e=>r.a.createElement(Lm,g()({key:e.speciesId},e))))}return null}});var Am=Object(c.a)((function(e){return{status:Object(wm.g)(e).status,summary:Object(wm.a)(e),selection:Object(wm.d)(e)}}),(function(e){return{fetch:()=>e(Object(O.h)()),goBack:()=>e(Object(O.m)("selection"))}}))(({goBack:e,...t})=>r.a.createElement("div",{className:"wgsa-genome-downloads"},r.a.createElement("header",{className:"wgsa-dropdown-header"},"Download"),r.a.createElement("div",{className:"wgsa-genome-downloads__content"},r.a.createElement(_m,{type:"maxDownloadSize"},r.a.createElement(jm,t))),r.a.createElement("footer",{className:"wgsa-dropdown-footer"},r.a.createElement("button",{className:"mdl-button",onClick:e},"Go back")))),Pm=(a(1088),r.a.createClass({displayName:"Progress",propTypes:{error:lt.a.shape({row:lt.a.number,message:lt.a.string}),progress:lt.a.number,rows:lt.a.number},render(){if(this.props.error){const{row:e=null,message:t}=this.props.error;return r.a.createElement("div",{className:"pw-edit-metadata-progress error"},r.a.createElement("p",null,"Sorry! There was a problem",null!==e?` with row ${e}`:"",":"),r.a.createElement("p",null,t))}const{result:e}=this.props;return r.a.createElement("div",{className:"pw-edit-metadata-progress success"},r.a.createElement(b.a,null,e?r.a.createElement("p",{key:"complete"},r.a.createElement("i",{className:"material-icons"},"check_circle"),e.matched," genome",1===e.matched?" ":"s ","updated successfully"):r.a.createElement("p",{className:"wgsa-blink"},"Uploading...")))}})),Rm=a(14);function Mm(e){return Object(j.a)("POST","/api/genome",e)}const Dm=Object(Rm.b)("SEND_METADATA_UPDATE");class Fm extends r.a.Component{constructor(){super(),this.state={uploading:!1,rows:0,completed:0,error:null},this.handleFiles=this.handleFiles.bind(this)}componentDidUpdate(e,t){!t.result&&this.state.result&&setTimeout(this.props.goBack,1e3)}handleFiles(e){const t=Array.from(e)[0];ps.test(t.name)&&this.setState({uploading:!0},()=>Object(rs.readAsText)(t).then(e=>bs.parseCsvToJson(e)).then(({data:e,errors:t})=>{if(t.length>0){const[{row:e,message:a}]=t;this.setState({error:{row:e+1,message:a}})}else this.props.update(e.map((e,t)=>{if(!e.id)throw new Error("Every row must contain an ID, please download existing metadata before attempting to upload.");try{return{id:e.id,...gs(e)}}catch(e){throw e.message=`${e.message} (row ${t+1})`,e}})).then(e=>this.setState({result:e})).catch(()=>this.setState({error:{message:r.a.createElement(r.a.Fragment,null,"Failed to update, please make sure you are the owner of the genomes in the file.",r.a.createElement("br",null),"/genomes/user"!==window.location.pathname&&r.a.createElement(J.a,{to:"/genomes/user"},"View genomes owned by you"))}}))}).catch(e=>this.setState({error:{message:e.message}})))}render(){const{ids:e,goBack:t}=this.props,a=this.state.completed/this.state.rows*100;return r.a.createElement("div",{className:"wgsa-dropdown"},r.a.createElement("header",{className:"wgsa-dropdown-header"},"Edit Metadata"),r.a.createElement(_m,{type:"maxDownloadSize"},r.a.createElement(b.a,{className:"wgsa-dropdown-content pw-edit-metadata-section",out:!1},this.state.uploading?r.a.createElement(Pm,{key:"progress",result:this.state.result,error:this.state.error}):r.a.createElement("div",{className:"pw-edit-metadata-instructions pw-edit-metadata-section"},r.a.createElement("p",{className:"pw-edit-metadata-warning"},r.a.createElement("i",{className:"material-icons danger"},"warning"),"This will overwrite existing data"),r.a.createElement(Tm,{className:"pw-edit-metadata-link",link:Object(j.c)("/download/genome/metadata"),ids:e},"1. Download existing metadata for selected genomes"),r.a.createElement("p",null,"2. Make changes to the spreadsheet (e.g. in Excel)"),r.a.createElement(ss,{className:"pw-edit-metadata-section",onFiles:this.handleFiles},r.a.createElement("p",null,"3. Drag file here to upload ",r.a.createElement("br",null),"or click to select file"))))),r.a.createElement("footer",{className:"wgsa-dropdown-footer wgsa-dropdown-footer--right"},!this.state.uploading&&r.a.createElement("button",{className:m()("mdl-button",{"mdl-button--raised mdl-button--colored":100===a}),onClick:t},"Go back"),r.a.createElement(b.a,null,this.state.error&&r.a.createElement("button",{className:"mdl-button mdl-button--raised mdl-button--colored",onClick:()=>this.setState({uploading:!1,rows:0,completed:0,error:null})},"Try Again"))))}}var zm=Object(c.a)((function(e){return{ids:Object(wm.c)(e)}}),(function(e){return{goBack:()=>e(Object(O.m)("selection")),update:t=>e(function(e){return{type:Dm,payload:{data:e,promise:Mm(e)}}}(t))}}))(Fm);const Gm=r.a.createElement("div",{className:"wgsa-selection-message"},r.a.createElement("h3",null,"No genomes selected"),r.a.createElement("p",null,"In the ",r.a.createElement("strong",null,"List")," view, select genomes by clicking a row. Try selecting one genome and holding ",r.a.createElement("strong",null,"shift")," to select more."),r.a.createElement("p",null,"In the ",r.a.createElement("strong",null,"Map")," view, select genomes by using the lasso tool.")),Um=r.a.createClass({displayName:"Dropdown",getInitialState:()=>({slideDirection:null}),componentWillReceiveProps(e){return"selection"===this.props.view&&"edit"===e.view?this.setState({slideDirection:"right"}):"edit"===this.props.view&&"selection"===e.view?this.setState({slideDirection:"left"}):"selection"===e.view?this.setState({slideDirection:"right"}):this.setState({slideDirection:"left"})},render(){const{view:e,hasSelection:t}=this.props;return r.a.createElement(b.a,{out:!0},e?r.a.createElement("div",{className:"wgsa-genome-selection-dropdown mdl-shadow--2dp"},t?r.a.createElement(um.a,{transitionName:`slide-${this.state.slideDirection}`,transitionEnterTimeout:280,transitionLeaveTimeout:280},"selection"===e&&r.a.createElement(Om,null),"collection"===e&&r.a.createElement(Im,null),"download"===e&&r.a.createElement(Am,null),"edit"===e&&r.a.createElement(zm,null)):Gm):null)}});var Bm=Object(c.a)((function(e){return{hasSelection:Object(wm.i)(e)>0,view:Object(wm.h)(e)}}))(Um);const $m=r.a.createClass({displayName:"Summary",componentDidUpdate(e){this.animating||this.props.size!==e.size&&(this.sonarEl.classList.remove("wgsa-sonar-effect"),this.sonarEl.offsetWidth,this.sonarEl.classList.add("wgsa-sonar-effect"),this.animating=!0,setTimeout(()=>{this.animating=!1},1400))},onKeyUp(e){"Escape"===e.key&&this.props.toggle()},animating:!1,render(){const{size:e,toggle:t,view:a}=this.props;return r.a.createElement("div",{className:"wgsa-selection-summary",onKeyUp:this.onKeyUp},r.a.createElement("button",{className:"mdl-chip mdl-chip--contact mdl-chip--active wgsa-selection",onClick:()=>t(a||"selection"),title:0===e?"No genomes selected":void 0},r.a.createElement("span",{ref:e=>{this.sonarEl=e},className:"mdl-chip__contact",title:e>0?"View selection":void 0},(n=e)>9999?`${Math.round(n/1e3)}K`:n),r.a.createElement("span",{className:"mdl-chip__text"},"Selected Genomes")),r.a.createElement(Bm,null));var n}});var Hm=Object(c.a)((function(e){return{size:Object(wm.i)(e),view:Object(wm.h)(e)}}),(function(e){return{toggle:t=>e(Object(O.m)(t))}}))($m);var Vm=Object(c.a)((function(e){const t=Object(wm.d)(e);return{selectedGenomes:t,disabled:0===t.length}}),(function(e){return{restore:t=>e(k(t,!1))}}))(({selectedGenomes:e,disabled:t,restore:a})=>r.a.createElement("button",{disabled:t,className:"mdl-button mdl-button--primary",onClick:()=>a(e),title:t?"Select genomes to restore":"Restore selected genomes"},"Restore From Bin"));const Km=({genomes:e})=>e.summary,qm=e=>Km(e).visible,Wm=e=>Km(e).total;var Ym=Object(c.a)((function(e){return{visibleGenomes:qm(e),totalGenomes:Wm(e)}}))(({visibleGenomes:e,totalGenomes:t,prefilter:a})=>0===t?r.a.createElement("header",null):r.a.createElement("header",null,r.a.createElement(vm,null),r.a.createElement("div",{className:"wgsa-button-group"},r.a.createElement("i",{className:"material-icons",title:"View"},"visibility"),r.a.createElement(ym,{title:"List"}),r.a.createElement(ym,{view:"map",title:"Map"}),r.a.createElement(ym,{view:"stats",title:"Stats"})),r.a.createElement(Qu,{visible:e,total:t,itemType:"genome"}),"bin"===a?r.a.createElement(Vm,null):r.a.createElement(Hm,null))),Zm=a(171),Xm=r.a.createClass({displayName:"Genomes.react",propTypes:{hasGenomes:r.a.PropTypes.bool,uploads:r.a.PropTypes.object,isUploading:r.a.PropTypes.bool,prefilter:r.a.PropTypes.string,fetch:r.a.PropTypes.func},contextTypes:{router:r.a.PropTypes.object},componentWillMount(){this.props.fetch()},componentDidUpdate(e){const{prefilter:t,fetch:a}=this.props;e.prefilter===t||a()},renderEmptyMessage(){const{total:e,prefilter:t,filterActive:a}=this.props;if(a)return r.a.createElement("div",{className:"pw-filter-view-message"},r.a.createElement("p",null,"No matches, please refine your search."),r.a.createElement("button",{className:"mdl-button mdl-button--raised mdl-button--colored",onClick:this.props.clearFilter},"Clear Filters"));if(0===e)switch(t){case"bin":return r.a.createElement("p",{className:"pw-filter-view-message"},"Nothing in the bin 👍");case"user":return r.a.createElement("div",{className:"pw-filter-view-message"},r.a.createElement("p",null,"You haven't uploaded any genomes."),r.a.createElement("p",null,r.a.createElement(J.a,{to:"/upload",className:"mdl-button mdl-button--raised mdl-button--colored"},"Upload now")));default:return r.a.createElement("p",{className:"pw-filter-view-message"},"Nothing to see here.")}return null},renderContent(){const{items:e,total:t,status:a}=this.props;return a===Zm.a.ERROR?r.a.createElement("p",{className:"pw-filter-view-message"},"Something went wrong. 😞"):0===t&&a===Zm.a.LOADING?null:0===e.length?this.renderEmptyMessage():this.props.children},render(){return r.a.createElement("div",{className:m()("wgsa-genomes wgsa-filter-container",{"has-filter":this.props.isFilterOpen})},r.a.createElement(q.a,{title:"Genomes"}),r.a.createElement(C.a,null),r.a.createElement("div",{className:"wgsa-filter-content"},r.a.createElement(Ym,{prefilter:this.props.prefilter}),this.renderContent()),r.a.createElement(mm,{visible:this.props.status===Zm.a.LOADING},r.a.createElement("p",{className:"pw-filter-view-loading"},"Loading... ⏳")))}}),Qm=a(51),Jm=a(142);var ed=Object(c.a)((function(e,{match:t}){const{prefilter:a}=t.params;return{prefilter:a,hasGenomes:Object(Qm.g)(e)>0,items:Object(Qm.d)(e),total:Object(Jm.b)(e),status:Object(Qm.f)(e),isFilterOpen:Object(bm.g)(e),filterActive:Object(bm.f)(e)}}),(function(e,{match:t,location:a}){const n=Object(Rn.parse)(a.search),{prefilter:r}=t.params;return{fetch:()=>e(Object(Em.g)({prefilter:r,...n},!1)),clearFilter:()=>e(Object(Em.d)())}}))(Xm);a(1090);var td=Object(c.a)((function(e,{genomes:t}){const a=Object(wm.e)(e);return{isSelected:t.every(e=>e.id in a)}}),(function(e,{genomes:t,index:a,onClick:n}){return{onClick:n||(n=>n.stopPropagation()||e(Object(O.n)(t,a)))}}))(({isSelected:e,onClick:t,className:a})=>r.a.createElement("button",{className:m()("wgsa-genome-checkbox",a),onClick:t,title:e?"Remove from selection":"Add to selection"},r.a.createElement("i",{className:"material-icons"},e?"check_box":"check_box_outline_blank"))),ad=({genome:e})=>{const{speciesName:t,subspecies:a,serotype:n}=e;return t?r.a.createElement(D.a,{abbreviated:!0,speciesName:t,subspecies:a,serotype:n}):r.a.createElement("span",null," ")};const nd=({title:e,icon:t,children:a,onClick:n})=>r.a.createElement("span",{className:"wgsa-genome-list-cell wgsa-overflow-fade",title:e,onClick:n},t&&r.a.createElement("i",{title:e,className:"material-icons"},t),a),rd=r.a.createElement("span",{className:"wgsa-genome-list-cell wgsa-overflow-fade"});var sd=Object(c.a)((function(e){return{lastSelectedIndex:Object(wm.b)(e)}}),null,(function(e,{dispatch:t},a){const{lastSelectedIndex:n}=e,{genome:r,index:s}=a;return{...a,onViewGenome:e=>e.stopPropagation()||t(Object(gn.d)(r.id,r.name)),onClick:e=>{e.stopPropagation(),e.shiftKey&&null!==n?t(Object(O.k)(n,s)):t(Object(O.n)([r],s))}}}))(({index:e,genome:t,onClick:a,style:n,onViewGenome:s,className:o,onMouseOver:l})=>{const{name:i,st:c,st2:u,country:d}=t,p=d?Object(G.b)(d):null,h=t.year?Object(z.c)(t):null;return r.a.createElement("div",{className:m()(o,"wgsa-genome-list-item wgsa-genome-list-item--selectable"),style:n,onClick:a,onMouseOver:l},r.a.createElement(nd,{title:i},r.a.createElement(td,{genomes:[t],index:e,onClick:a}),r.a.createElement("button",{title:"View report",className:"wgsa-link-button",onClick:s},i)),r.a.createElement(nd,null,r.a.createElement(ad,{genome:t})),c?r.a.createElement(nd,null,r.a.createElement(Xa.b,{id:c}),!!u&&r.a.createElement(r.a.Fragment,null," / ",r.a.createElement(Xa.b,{id:u}))):rd,d?r.a.createElement(nd,{title:p},r.a.createElement("strong",null,d.toUpperCase())," – ",p):rd,h?r.a.createElement(nd,{title:h},h):rd,(f=t).reference?r.a.createElement(nd,{title:"Access",icon:"book"},"Reference"):f.public?r.a.createElement(nd,{title:"Access",icon:"public"},"Public"):r.a.createElement(nd,{title:`Uploaded at ${f.uploadedAt}`,icon:"person"},"Private"));var f});const od={UNCHECKED:"check_box_outline_blank",CHECKED:"check_box",INDETERMINATE:"indeterminate_check_box"};function ld(e,t){return t?'"Select All" is not available on the unfiltered list, please select at least one filter.':"CHECKED"===e?"Remove from selection":"Add to selection"}var id=Object(c.a)((function(e){return{status:Object(wm.j)(e),disabled:Object(wm.k)(e)}}),(function(e){return{select:()=>e(Object(O.j)())}}))(({status:e,disabled:t,select:a})=>{const[n,s]=r.a.useState(!1);return r.a.createElement("button",{className:m()("wgsa-genome-checkbox",{"wgsa-blink":n}),onClick:()=>{s(!0),a().then(()=>s(!1))},disabled:t,title:ld(e,t)},r.a.createElement("i",{className:"material-icons"},od[e]))}),cd=a(65);const ud=e=>r.a.createElement(cd.a,g()({className:"wgsa-genome-list-cell",stateKey:C.b,update:Em.g},e));var md=({hasScrollbar:e=!0})=>r.a.createElement("div",{className:"wgsa-list-header-container"},r.a.createElement("div",{className:"wgsa-genome-list-item wgsa-genome-list-header"},r.a.createElement("span",{className:"wgsa-genome-list-cell"},r.a.createElement(id,null),r.a.createElement(cd.a,{stateKey:C.b,update:Em.g,sortKey:"name"},"Name")),r.a.createElement(ud,{sortKey:"organism"},"Organism"),r.a.createElement(ud,{sortKey:"mlst"},"MLST"),r.a.createElement(ud,{sortKey:"country"},"Country"),r.a.createElement(ud,{sortKey:"date"},"Date"),r.a.createElement(ud,{sortKey:"access"},"Access")),e&&r.a.createElement("div",{style:{overflowY:"scroll",visibility:"hidden",height:0}}));const{pagination:dd={min:100}}=ee.a,pd=r.a.createClass({displayName:"ListView",propTypes:{items:r.a.PropTypes.object.isRequired,indices:r.a.PropTypes.object.isRequired,total:r.a.PropTypes.number.isRequired},getInitialState:()=>({mouseOverIndex:null}),getRowClassName(e){const{lastSelectedIndex:t}=this.props,{mouseOverIndex:a,range:n}=this.state;if(null!==t&&n&&null!==a){const n=Math.min(t,a),r=Math.max(t,a);if(n<=e&&e<=r)return"active"}return""},hasScrollbar(){const{total:e}=this.props;return 40*e>=window.innerHeight-145},render(){const{items:e,total:t,fetch:a,indices:n}=this.props;return r.a.createElement("div",{className:"wgsa-genome-list-view",tabIndex:"0",onKeyDown:e=>{this.setState({range:e.shiftKey})},onKeyUp:()=>{this.setState({range:!1})}},r.a.createElement(md,{hasScrollbar:this.hasScrollbar()}),r.a.createElement(ul.c,{isRowLoaded:({index:e})=>n[e],loadMoreRows:a,rowCount:t,minimumBatchSize:dd.min},({onRowsRendered:a,registerChild:s})=>r.a.createElement(ul.a,null,({width:o,height:l})=>r.a.createElement(ul.d,{height:l-25,onRowsRendered:a,ref:s,rowCount:t,rowHeight:40,rowRenderer:({key:t,index:a,style:s})=>{const o=n[a],l={...s,width:"calc(100% - 32px"};return"string"==typeof o?r.a.createElement(sd,{key:t,style:l,genome:e[o],index:a,className:this.getRowClassName(a),onMouseOver:e=>{this.setState({mouseOverIndex:a})}}):r.a.createElement("div",{key:t,style:l,className:"wgsa-genome-list-placeholder"},r.a.createElement("span",{style:{width:Math.floor(200*Math.random())}}))},width:o}))))}});var hd=Object(c.a)((function(e){return{items:Object(Qm.c)(e),indices:Object(Qm.e)(e),total:Object(Jm.c)(e),lastSelectedIndex:Object(wm.b)(e)}}),(function(e){return{fetch:({startIndex:t,stopIndex:a})=>e(Object(S.e)(t,a))}}))(pd),fd=(a(1092),a(172)),gd=a(188);const bd=r.a.createClass({displayName:"Marker",render(){const{marker:e,style:t,popup:a}=this.props,n=a.position===e.position;return r.a.createElement("div",{className:m()("wgsa-marker-cluster",{"has-popup":n}),ref:e=>{this.ref=e},style:t,onClick:t=>{t.stopPropagation(),t.nativeEvent.stopImmediatePropagation(),n?this.props.closePopup():this.props.showMarkerPopup(e)}},e.genomes.length)}}),yd=({list:e,onItemClick:t,close:a})=>e.length?r.a.createElement("aside",{className:"wgsa-genomes-map-popup mdl-shadow--2dp"},r.a.createElement("header",null,r.a.createElement(td,{genomes:e}),r.a.createElement("h2",{className:"h4"},e.length," Genome",1===e.length?"":"s"),r.a.createElement("button",{className:"mdl-button mdl-button--icon",onClick:a},r.a.createElement("i",{className:"material-icons"},"close"))),r.a.createElement("ul",null,e.map(e=>r.a.createElement("li",{key:e.id},r.a.createElement(td,{genomes:[e]}),r.a.createElement("span",{className:"wgsa-checklist-content"},r.a.createElement("button",{title:`${e.name} - view report`,className:"wgsa-link-button",onClick:()=>t(e.id)},e.name),r.a.createElement(Ua.a,{organismId:e.organismId,title:e.speciesName},r.a.createElement("em",null,e.speciesName))))))):r.a.createElement("aside",{className:"wgsa-genomes-map-popup mdl-shadow--2dp is-loading"},r.a.createElement(R.a,null)),Ed=r.a.createClass({displayName:"MapView",componentDidMount(){const{filter:e,previousFilter:t,fetch:a}=this.props;e!==t&&a()},componentWillReceiveProps(e){e.filter!==this.props.filter&&this.props.fetch()},shouldComponentUpdate(e){return e.markers!==this.props.markers||e.popup!==this.props.popup||e.lassoPath!==this.lassoPath},render(){const{stateKey:e,lassoPath:t,markers:a,onLassoPathChange:n,popup:s,popupList:o}=this.props;return r.a.createElement("div",{className:"wgsa-genomes-map"},r.a.createElement(Zl,{className:"wgsa-hub-map-view",lassoPath:t,markers:a,markerIds:a,markerComponent:bd,markerProps:{popup:s,closePopup:this.props.closePopup,showGenomeReport:this.props.showGenomeReport,showMarkerPopup:this.props.showMarkerPopup},onClick:()=>{t&&this.props.onLassoPathChange(null)},onLassoPathChange:n,stateKey:e}),s.open&&r.a.createElement(yd,{list:o,onItemClick:this.props.showGenomeReport,close:this.props.closePopup}))}});var vd=Object(c.a)((function(e,t){return{filter:Object(bm.a)(e),previousFilter:Object(gd.a)(e),markers:Object(gd.b)(e),lassoPath:Object(fl.b)(e,t),popup:Object(gd.c)(e),popupList:Object(gd.d)(e)}}),(function(e,{stateKey:t}){return{onLassoPathChange:a=>e(Object(fd.d)(t,a)),showGenomeReport:t=>e(Object(gn.d)(t)),showMarkerPopup:({position:t})=>e(Object(fd.e)([t])),fetch:()=>e(Object(S.f)()),closePopup:()=>e(Object(fd.c)())}}))(Ed);function Cd(e){return e?`GENOME_${e.params.prefilter}`:null}var wd=({match:e})=>r.a.createElement(vd,{stateKey:Cd(e)}),Sd=(a(1094),r.a.createClass({displayName:"chart-resizer",componentDidUpdate(e){const{width:t,height:a,chart:n}=this.props;n&&(t===e.width&&a===e.height||n.resize())},render(){const{width:e,height:t}=this.props;return r.a.createElement("div",{className:this.props.className,style:{width:e,height:t}},this.props.children)}}));const Nd=e=>Object(Qm.b)(e).stats.metric,Od=e=>Object(Qm.b)(e).stats.entities,xd=e=>Object(Qm.b)(e).stats.filter;function kd(e,t){return e.reduce((e,a)=>e+Number(t?a[t]:a),0)/(e.length||1)}const _d=Object(ce.createSelector)(Od,Nd,(e,t)=>kd(e,t).toFixed(1)),Id=Object(ce.createSelector)(Od,Nd,_d,(e,t,a)=>{const n=e.map(e=>{const n=e[t]-a;return n*n});return Math.sqrt(kd(n)).toFixed(2)}),Td=Object(ce.createSelector)(Od,Nd,(e,t)=>e.reduce(({min:e,max:a},n)=>({min:e?Math.min(e,n[t]):n[t],max:a?Math.max(a,n[t]):n[t]}),{min:0,max:0})),Ld=Object(ce.createSelector)(Od,wm.c,(e,t)=>e.reduce((e,a,n)=>(a.index=n,-1===t.indexOf(a.id)?e.unselected.push(a):e.selected.push(a),e),{selected:[],unselected:[]}));function jd(e,t){return e.map(e=>({x:e.index+1,y:Number(e[t]),label:e.name,id:e.id}))}const Ad=Object(ce.createSelector)(Ld,Nd,(e,t)=>[{label:`${t} (selected)`,data:jd(e.selected,t),backgroundColor:"#673c90",borderColor:"#673c90"},{label:`${t} (unselected)`,data:jd(e.unselected,t),backgroundColor:e.selected.length?"#ddd":"#a386bd",borderColor:e.selected.length?"#ddd":"#a386bd"}]),Pd=Object(ce.createSelector)(Od,e=>e.length);var Rd=a(321);const Md=[{title:"Genome Length",metric:"length"},{title:"N50",metric:"N50"},{title:"No. Contigs",metric:"contigs"},{title:"Non-ATCG",metric:"nonATCG"},{title:"GC Content",metric:"gcContent"}];const Dd=Object(c.a)((e,t)=>({className:Nd(e)===t.metric?"active":""}),(function(e,t){return{onClick:()=>e(Object(Rd.b)(t.metric))}}))(({title:e,className:t,onClick:a})=>r.a.createElement("button",{className:m()("wgsa-button-group__item",t),onClick:a},e));function Fd(e,t){return(a,[n])=>{if(n){const a=e[n._datasetIndex].data[n._index];t(a)}}}const zd=r.a.createClass({displayName:"StatsView",componentDidMount(){const{chartData:e=[],previousFilter:t,filter:a,fetch:n,count:r}=this.props;let s;t!==a?n():s={datasets:e},this.chart=new Na.a(this.canvas,{type:"line",data:s,options:{animation:!1,responsive:!1,elements:{points:{borderWidth:1,backgroundColor:"#a386bd",borderColor:"#a386bd"}},hover:{mode:"point",intersect:!0},legend:{display:!1},maintainAspectRatio:!1,onClick:Fd(e,this.props.onPointClick),showLines:!1,scales:{xAxes:[{type:"linear",position:"bottom",ticks:{display:!1,min:0,max:r+1},scaleLabel:{display:!1},beginAtZero:!0}]},tooltips:{displayColors:!1,callbacks:{title:(e,{datasets:t})=>e.map(({index:e,datasetIndex:a})=>t[a].data[e].label).join(", "),label:({index:e,datasetIndex:t},{datasets:a})=>a[t].data[e].y}}}})},componentDidUpdate(e){const{chartData:t,onPointClick:a,filter:n,fetch:r,count:s}=this.props;e.filter===n?t!==e.chartData&&(this.chart.data.datasets=t,this.chart.options.onClick=Fd(t,a),this.chart.options.scales.xAxes[0].ticks.max=s+1,this.chart.update(),this.chart.resize()):r()},render(){const{average:e,stDev:t,range:a={}}=this.props;return r.a.createElement("div",{className:"wgsa-genome-stats"},r.a.createElement(ul.a,null,({height:n,width:s})=>r.a.createElement("div",{style:{height:n,width:s,position:"relative"}},r.a.createElement("nav",{className:"wgsa-button-group"},r.a.createElement("i",{title:"Metric",className:"material-icons"},"timeline"),Md.map(e=>r.a.createElement(Dd,g()({key:e.metric},e)))),r.a.createElement(Sd,{className:"wgsa-stats-chart",height:n-184,width:s-8,chart:this.chart},r.a.createElement("canvas",{ref:e=>{this.canvas=e}})),r.a.createElement("div",{className:"wgsa-hub-stats-group"},r.a.createElement("dl",{className:"wgsa-hub-stats-section"},r.a.createElement("dt",{className:"wgsa-hub-stats-heading"},"Average"),r.a.createElement("dd",{className:"wgsa-hub-stats-value"},e)),r.a.createElement("dl",{className:"wgsa-hub-stats-section"},r.a.createElement("dt",{className:"wgsa-hub-stats-heading"},"Standard Deviation"),r.a.createElement("dd",{className:"wgsa-hub-stats-value"},t)),r.a.createElement("dl",{className:"wgsa-hub-stats-section"},r.a.createElement("dt",{className:"wgsa-hub-stats-heading"},"Range"),r.a.createElement("dd",{className:"wgsa-hub-stats-value"},a.min," – ",a.max))))))}});var Gd=Object(c.a)((function(e){return{average:_d(e),stDev:Id(e),range:Td(e),chartData:Ad(e),count:Pd(e),filter:Object(bm.a)(e),previousFilter:xd(e)}}),(function(e){return{onPointClick:t=>e(Object(gn.d)(t.id,t.label)),fetch:()=>e(Object(S.g)())}}))(zd);const Ud="/genomes/:prefilter(all|user|bin)",Bd=r.a.createElement(o.a,{path:Ud,component:Ln});var $d=r.a.createElement(o.a,{path:Ud,component:e=>r.a.createElement(ed,e,r.a.createElement(Cn.a,null,r.a.createElement(o.a,{path:`${Ud}/map`,component:wd}),r.a.createElement(o.a,{path:`${Ud}/stats`,component:Gd}),r.a.createElement(o.a,{component:hd})))});a(1096);var Hd=Object(c.a)((function(e){return{collection:Object(An.a)(e)}}),(function(e,{match:t,location:a}){const n=Object(Rn.parse)(a.search);return{fetch:()=>e(Object(Iu.c)(t.params.id,n.threshold)),reset:()=>e(Object(du.e)())}}))(Vu);const Vd=r.a.createElement(o.a,{path:"/clustering/:id",component:ol});var Kd=r.a.createElement(o.a,{path:"/clustering/:id",component:Hd}),qd=()=>r.a.createElement(Cn.a,null,Bd,fm,qu,Vd,jn),Wd=a(891),Yd=(a(1098),a(487)),Zd=a(514),Xd=({authMessage:e,...t})=>ee.a.user?r.a.createElement(Yd.a,t):r.a.createElement(Zd.a,{to:{pathname:"/sign-in",search:`?redirect=${t.path}`,state:{message:e}}}),Qd=a(509),Jd=a.n(Qd),ep=a(158);const tp={genome:"cloud_upload",collection:"collections"},ap={genome:({count:e,date:t})=>r.a.createElement(J.a,{to:`/genomes/user?uploadedAt=${t}`},"Uploaded ",r.a.createElement("strong",null,e)," genome",1===e?"":"s"),collection:({size:e,organismId:t,title:a,token:n})=>r.a.createElement(J.a,{to:`/collection/${n}`},"Created collection ",r.a.createElement(ep.a,{tag:"strong"},a)," (",r.a.createElement(Ua.a,{organismId:t}),", ",r.a.createElement("strong",null,e)," genomes)")};var np=e=>r.a.createElement("li",{className:"wgsa-activity-item"},r.a.createElement("i",{className:"material-icons"},tp[e.type]),ap[e.type](e),r.a.createElement("span",{className:"wgsa-activity-item__time",title:e.formattedDate},Jd()(e.date)," ago"));const rp=({account:e})=>e,sp=e=>rp(e).activity;var op=a(240),lp=a(167);const ip=r.a.createClass({displayName:"ActivityList",componentDidMount(){this.props.fetch()},render(){const{activity:e}=this.props;return e===lp.a.LOADING?r.a.createElement(R.a,null):e===lp.a.ERROR?r.a.createElement("p",null,"Failed to fetch recent activity 😔"):e&&Array.isArray(e)?r.a.createElement("ul",{className:"wgsa-activity-list"},e.map(e=>r.a.createElement(np,g()({key:e.date},e)))):null}});var cp=Object(c.a)((function(e){return{activity:sp(e)}}),(function(e){return{fetch:()=>e(Object(op.b)())}}))(ip);const{user:up={photo:"/images/user.svg"}}=ee.a,mp=up.photo||"/images/user-signed-in.svg";var dp=()=>r.a.createElement("img",{src:mp,className:"cgps-avatar__image"}),pp=a(95);const hp=r.a.createClass({displayName:"ProfileContentComponent",componentDidMount(){const{summary:e}=this.props;e.loaded&&this.props.fetch()},render(){const{status:e,summary:t}=this.props;if(e===lp.a.LOADING||!t.loaded)return null;const{userCollections:a,userGenomes:n}=t;return 0===a&&0===n?r.a.createElement("div",{className:"wgsa-profile-section wgsa-profile-onboarding"},r.a.createElement("p",null,"Welcome to ",r.a.createElement("strong",null,"Pathogenwatch"),"!"),r.a.createElement("p",null,"This is your account page, here you'll be able to see:"),r.a.createElement("ul",null,r.a.createElement("li",null,"The number of genomes you've uploaded"),r.a.createElement("li",null,"The number of collections you've created"),r.a.createElement("li",null,"A list of your recent activity")),r.a.createElement("p",null,"To get started, ",r.a.createElement(J.a,{to:"/upload"},"upload genomes")," or ",r.a.createElement(J.a,{to:"/genomes"},"browse the public dataset"),".")):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"wgsa-hub-stats-group wgsa-profile-section"},r.a.createElement(J.a,{className:"wgsa-hub-stats-section wgsa-profile-counter",to:"/genomes/user",title:"Click to view genomes"},r.a.createElement("h3",{className:"wgsa-hub-stats-heading"},"Genomes"),r.a.createElement("p",{className:"wgsa-hub-stats-value wgsa-hub-stats-value--large"},n)),r.a.createElement(J.a,{className:"wgsa-hub-stats-section wgsa-profile-counter",to:"/collections/user",title:"Click to view collections"},r.a.createElement("h3",{className:"wgsa-hub-stats-heading"},"Collections"),r.a.createElement("p",{className:"wgsa-hub-stats-value wgsa-hub-stats-value--large"},a))),r.a.createElement("div",{className:"wgsa-hub-stats-group wgsa-profile-section"},r.a.createElement("div",{className:"wgsa-hub-stats-section"},r.a.createElement("div",{className:"wgsa-hub-stats-heading"},"Recent Activity"),r.a.createElement(cp,null))))}});const fp=Object(c.a)((function(e){return{status:rp(e),summary:Object(pp.c)(e)}}),(function(e){return{fetch:()=>e(Object(N.b)())}}))(hp);var gp=()=>{const{user:e}=ee.a;return e?r.a.createElement("div",{className:"wgsa-hipster-style"},r.a.createElement("div",{className:"cgps-avatar cgps-avatar--centered wgsa-profile-avatar"},r.a.createElement(dp,null),r.a.createElement("div",{className:"cgps-avatar__name title-font",title:e.name},e.name),r.a.createElement("div",{className:"cgps-avatar__contact",title:e.email},e.email)),r.a.createElement(fp,null)):null},bp=r.a.createElement(Xd,{authMessage:"Please sign in to visit your account.",path:"/account",component:()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(q.a,null,"Account"),r.a.createElement(gp,null))});a(1100);const yp=r.a.createClass({displayName:"Marker",render(){const{style:e,marker:t,selectedCollection:a,setCollection:n}=this.props,{token:s,uuid:o=s}=t.collection;return r.a.createElement(J.a,{ref:e=>{this.ref=e},style:{...e,animationDelay:`${.125*t.index}s`},to:`/collection/${o}`,className:m()("showcase__link",{"active wgsa-sonar-effect":a===o,inactive:a&&a!==o}),onMouseEnter:()=>n(o),onMouseLeave:()=>n(null)})}}),Ep=({collection:e})=>r.a.createElement("div",{className:"wgsa-showcase-tooltip"},r.a.createElement(lo.a,{level:"3"},e.title),r.a.createElement("p",null,e.size," ",r.a.createElement(Ua.a,{organismId:e.organismId})," genomes"));var vp=r.a.createClass({displayName:"Showcase.react",getInitialState:()=>({locations:[],collections:[],focus:!1}),componentDidMount(){Object(j.a)("GET","/api/showcase").then(e=>this.setState({locations:e.reduce((e,{locations:t,...a})=>{for(const[n,[r,s]]of t.entries())null!==r&&null!==s&&e.push({lat:r,lon:s,collection:a,index:n});return e},[]),collections:e}))},componentDidUpdate(e,t){const{collections:a}=this.state;0===t.collections.length&&a.length>0&&(this.setCollection(),this.startCarousel())},componentWillUnmount(){this.stopCarousel()},setCollection(){const{collections:e}=this.state,{token:t,uuid:a=t}=e[Math.floor(Math.random()*e.length)];this.setState({uuid:a})},startCarousel(){this._interval=setInterval(this.setCollection,5e3)},stopCarousel(){clearInterval(this._interval)},renderCollectionLinks(){const{locations:e}=this.state;return r.a.createElement(Ul,{markers:e,latitudeExtractor:e=>e.lat,longitudeExtractor:e=>e.lon,markerComponent:yp,propsForMarkers:{selectedCollection:this.state.uuid,setCollection:e=>{this.setState({uuid:e}),this.stopCarousel()}}})},render(){const{locations:e,uuid:t,collections:a}=this.state;return r.a.createElement("section",{className:"showcase"},r.a.createElement("div",{className:"wgsa-homepage__content"},r.a.createElement(vl.a,{animate:!1,zoomControl:!1,center:[44,13.5],zoom:2,minZoom:2,boundsOptions:{animate:!1},scrollWheelZoom:!1,onFocus:({target:e})=>{e.scrollWheelZoom.enable()},onBlur:({target:e})=>{e.scrollWheelZoom.disable()},onMoveend:({target:e})=>{this.map=e},ref:e=>{this.leafletMap=e},style:{width:"100%",height:"100%"}},r.a.createElement(Cl.a,{noWrap:!0,bounds:[[-90,-180],[90,180]],attribution:"\n  Map data &copy;\n  <a href='http://openstreetmap.org'>OpenStreetMap</a> contributors\n  <a href='http://creativecommons.org/licenses/by-sa/2.0/'>CC-BY-SA</a>,\n  Imagery © <a href='http://mapbox.com'>Mapbox</a>\n",url:`https://api.mapbox.com/styles/v1/cgpsdev/cj5y3b7aq0rru2spdrcdnjxsm/tiles/256/{z}/{x}/{y}?access_token=${ee.a.mapboxKey}`}),this.renderCollectionLinks()),0===e.length&&r.a.createElement(R.a,{singleColour:!0}),r.a.createElement(um.a,{className:"wgsa-showcase-tooltip-wrapper",transitionName:"wgsa-showcase-tooltip",transitionEnterTimeout:280,transitionLeaveTimeout:280},!!t&&r.a.createElement(Ep,{key:t,collection:a.find(e=>e.token===t)}))))}});const{maxCollectionSize:Cp=1e3}=ee.a;const wp=Object(c.a)((function(e){return{deployedOrganisms:new Set(Object(pp.a)(e))}}))(({deployedOrganisms:e})=>r.a.createElement("div",{className:"wgsa-homepage"},r.a.createElement(q.a,null,"A Global Platform for Genomic Surveillance"),r.a.createElement("section",{className:"jumbotron"},r.a.createElement("div",{className:"jumbotron-content"},r.a.createElement(H,null),r.a.createElement("h1",null,"A ",r.a.createElement("strong",null,"Global Platform")," for"," ",r.a.createElement("strong",null,"Genomic Surveillance"),"."))),r.a.createElement(vp,null),r.a.createElement("section",{id:"how-it-works",className:"alt wgsa-how-it-works"},r.a.createElement("div",{className:"wgsa-homepage__content"},r.a.createElement("h2",null,"How ",r.a.createElement(B,null)," Works"),r.a.createElement("ol",null,r.a.createElement("li",null,r.a.createElement("i",{className:"material-icons"},"file_upload"),r.a.createElement("h3",null,"Upload"),r.a.createElement("p",null,"Upload genome assemblies and metadata, or view all publicly available genomes.")),r.a.createElement("li",null,r.a.createElement("i",{className:"material-icons"},"settings"),r.a.createElement("h3",null,"Analyse"),r.a.createElement("p",null,"Generate results including MLST, AMR predictions, clustering of genomes, and interactive visualisation of metadata.")),r.a.createElement("li",null,r.a.createElement("i",{className:"material-icons"},"search"),r.a.createElement("h3",null,"Explore"),r.a.createElement("p",null,"Compare results with publicly available genomes within a species reference tree."))))),r.a.createElement("section",{id:"organisms"},r.a.createElement("div",{className:"wgsa-homepage__content"},r.a.createElement("h2",null,"Organisms"),r.a.createElement("p",{className:"lead"},r.a.createElement("strong",null,r.a.createElement(B,null))," ","provides species and taxonomy prediction for over 60,000 variants of bacteria, viruses, and fungi."),r.a.createElement("p",{className:"lead"},r.a.createElement("strong",null,"MLST")," prediction is available for over 100 species using schemes from ",r.a.createElement("a",{href:"https://pubmlst.org/"},"PubMLST"),","," ",r.a.createElement("a",{href:"http://bigsdb.pasteur.fr/"},"Pasteur"),", and"," ",r.a.createElement("a",{href:"http://enterobase.warwick.ac.uk"},"Enterobase"),"."),r.a.createElement("p",{className:"lead"},r.a.createElement("strong",null,"cgMLST")," calling and clustering is available for the following schemes:"),r.a.createElement("ul",{className:"pw-homepage-cgmlst-organisms"},r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=469&speciesId=470"},"Acinetobacter baumannii")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=194&speciesId=195"},"Campylobacter coli")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=194&speciesId=197"},"Campylobacter jejuni")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=1350&speciesId=1352"},"Enterococcus faecium")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=561"},"Escherichia")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=570&speciesId=573"},"Klebsiella pneumoniae")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=570&speciesId=1463165"},"Klebsiella quasipneumoniae")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=570&speciesId=244366"},"Klebsiella variicola")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=1637"},"Listeria")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=1763&speciesId=33894"},"Mycobacterium africanum")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=1763&speciesId=1765"},"Mycobacterium bovis")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=1763&speciesId=78331"},"Mycobacterium canettii")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=1763&speciesId=1773"},"Mycobacterium tuberculosis")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=482&speciesId=485"},"Neisseria gonorrhoeae")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=482&speciesId=487"},"Neisseria meningitidis")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=590&speciesId=28901"},"Salmonella enterica")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=620"},"Shigella")),r.a.createElement("li",null,r.a.createElement(J.a,{to:"/genomes?genusId=1279&speciesId=1280"},"Staphylococcus aureus"))),r.a.createElement("table",{className:"wgsa-organism-table"},r.a.createElement("caption",null,"Further Analyses"),r.a.createElement("colgroup",null,r.a.createElement("col",{className:"wgsa-title-column"}),r.a.createElement("col",{className:"wgsa-feature-column"}),r.a.createElement("col",{className:"wgsa-feature-column"}),r.a.createElement("col",{className:"wgsa-feature-column"}),r.a.createElement("col",{className:"wgsa-feature-column"})),r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Organism"),r.a.createElement("th",null,"AMR Prediction"),r.a.createElement("th",null,"Core SNP Trees"),r.a.createElement("th",null,"Other"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("em",null,"Campylobacter")),r.a.createElement("td",null,r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null),r.a.createElement("td",null)),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("em",null,"Klebsiella")),r.a.createElement("td",null,r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("small",null,"Kleborate"))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(Ua.a,{organismId:"573"})),r.a.createElement("td",null,r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null,e.has("573")&&r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null,r.a.createElement("small",null,"Kleborate"))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(Ua.a,{organismId:"485"})),r.a.createElement("td",null,r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null,e.has("485")&&r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null,r.a.createElement("small",null,"NG-MAST"),r.a.createElement("br",null),r.a.createElement("small",null,"NG-STAR"))),e.has("1646")&&r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(Ua.a,{organismId:"1646"})),r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null)),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("em",null,"Salmonella")),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("small",null,"SISTR"))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(Ua.a,{organismId:"90370"})),r.a.createElement("td",null,r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null,e.has("90370")&&r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null,r.a.createElement("small",null,"Genotyphi"))),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(Ua.a,{organismId:"1280"})),r.a.createElement("td",null,r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null,e.has("1280")&&r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null)),e.has("1336")&&r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(Ua.a,{organismId:"1336"})),r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null)),r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(Ua.a,{organismId:"1313"})),r.a.createElement("td",null,r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("small",null,"PopPUNK"),r.a.createElement("br",null),r.a.createElement("small",null,"SeroBA"),r.a.createElement("br",null),r.a.createElement("small",null,"PBP Typing"))),e.has("64320")&&r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(Ua.a,{organismId:"64320"})),r.a.createElement("td",null),r.a.createElement("td",null,r.a.createElement("i",{className:"material-icons"},"check")),r.a.createElement("td",null))))),r.a.createElement("footer",null,r.a.createElement(J.a,{to:"/genomes",className:"mdl-button mdl-button--raised mdl-button--colored"},"Browse Genomes"))),r.a.createElement("section",{id:"features",className:"alt"},r.a.createElement("div",{className:"wgsa-homepage__content"},r.a.createElement("h2",null,"Features"),r.a.createElement("table",{className:"wgsa-features-table"},r.a.createElement("colgroup",null,r.a.createElement("col",null),r.a.createElement("col",null)),r.a.createElement("thead",null,r.a.createElement("tr",{className:"title-font"},r.a.createElement("th",null,"Anonymous User"),r.a.createElement("th",null,"Signed-in User"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Access public genomes"),r.a.createElement("td",null,"Upload genomes for analysis")),r.a.createElement("tr",null,r.a.createElement("td",null,"cgMLST clustering",r.a.createElement("br",null),r.a.createElement("small",null,"public genomes only")),r.a.createElement("td",null,"cgMLST clustering",r.a.createElement("br",null),r.a.createElement("small",null,"public and uploaded genomes"))),r.a.createElement("tr",null,r.a.createElement("td",null,"Save collections for offline use",r.a.createElement("br",null),r.a.createElement(J.a,{to:"/offline"},r.a.createElement("small",null,"Find out more"))),r.a.createElement("td",null,"Save collections for offline use",r.a.createElement("br",null),r.a.createElement(J.a,{to:"/offline"},r.a.createElement("small",null,"Find out more")))),r.a.createElement("tr",null,r.a.createElement("td",null,"Access public collections"),r.a.createElement("td",null,"Create collections of up to",r.a.createElement("br",null),r.a.createElement("strong",null,Cp)," genomes"))))),r.a.createElement("footer",null,ee.a.user?r.a.createElement(J.a,{to:"/account",className:"mdl-button mdl-button--raised mdl-button--colored"},"Go to Account"):r.a.createElement(Cm,{className:"mdl-button mdl-button--raised mdl-button--colored"},"Sign in"))),r.a.createElement("footer",{className:"mr-footer"},r.a.createElement("p",null,r.a.createElement("span",null,"Funded by "),r.a.createElement("img",{src:"images/wellcome-logo-white.png",className:"mr-footer-logo-square"})),r.a.createElement("p",null,r.a.createElement("span",null,"Developed at "),r.a.createElement("img",{src:"images/bdi.png",className:"mr-footer-logo-square"}),r.a.createElement("img",{src:"images/sanger.svg",className:"mr-footer-logo"})),r.a.createElement("p",null,r.a.createElement("a",{href:"https://www.pathogensurveillance.net",target:"_blank",rel:"noopener"},r.a.createElement("img",{src:"images/cgps-long-white.svg",className:"mr-footer-logo-cgps"}))),r.a.createElement("p",{className:"cgps-copyright"},"© 2018 Centre for Genomic Pathogen Surveillance"))));var Sp=r.a.createElement(o.a,{exact:!0,path:"/",component:wp}),Np=a(229);a(1108),a(1110),a(1112);const Op=({strategies:e=[],children:t})=>r.a.createElement("div",{className:"cgps-login-links"},e.filter(e=>"passwordless"!==e).map(e=>r.a.createElement("a",{key:e,className:`cgps-login-button cgps-login-button--${e}`,href:`/auth/${e}`},r.a.createElement("div",{className:"cgps-login-button__icon"}),r.a.createElement("div",{className:"cgps-login-button__text"},"Continue with ",r.a.createElement("span",{className:"provider"},e)))),t);Op.propTypes={strategies:lt.a.arrayOf(lt.a.string),children:lt.a.node,contactEmail:lt.a.string};var xp=Op;const kp=({message:e,appName:t="Microreact",strategies:a,additional:n,termsLink:s})=>r.a.createElement("section",{className:"cgps-login"},r.a.createElement("h3",{className:"cgps-heading"},"Sign in to your ",t," account"),e&&r.a.createElement("p",{className:"cgps-login-message"},e),r.a.createElement("div",{className:"cgps-login-links-wrapper"},r.a.createElement(xp,{strategies:a},n)),s&&r.a.createElement("p",{className:"cgps-login-tos"},"By signing in, you are agreeing to our ",s,"."),r.a.createElement("h4",{className:"cgps-heading"},"Access to Information"),r.a.createElement("p",null,t," accesses your ",r.a.createElement("strong",null,"name"),", ",r.a.createElement("strong",null,"email"),", and ",r.a.createElement("strong",null,"profile photo")," when signing in with ",r.a.createElement("strong",null,"Google"),", ",r.a.createElement("strong",null,"Twitter"),", or ",r.a.createElement("strong",null,"Facebook"),"."),r.a.createElement("p",null,"Other information, such as ",r.a.createElement("strong",null,"tweets")," and ",r.a.createElement("strong",null,"Facebook friends"),", will not be accessed or stored by ",t,"."));kp.displayName="Login",kp.propTypes={message:lt.a.string,appName:lt.a.string,strategies:lt.a.arrayOf(lt.a.string),additional:lt.a.node,termsLink:lt.a.node};var _p=kp;a(1114);class Ip extends r.a.Component{constructor(...e){var t;return t=super(...e),this.state={sending:!1,showControls:!1,email:""},this.showControls=e=>{e.stopPropagation(),this.setState({showControls:!0},()=>this.emailInput.focus())},this.emailInputChange=e=>{this.setState({email:e.target.value})},this.emailInputKeyUp=e=>{"Escape"===e.key&&(this.setState({showControls:!1}),e.stopPropagation())},this.submitForm=e=>{e.preventDefault();const{email:t}=this.state;if(!t.length)return;const{getPasswordlessToken:a,showMessage:n}=this.props;this.setState({sending:!0}),a(t).then(()=>{this.setState({showControls:!1,sending:!1}),n(`Your sign-in link has been sent to ${t}.`)}).catch(e=>{this.setState({sending:!1}),console.error(e),n("Something went wrong, please try again later.")})},t}render(){const{showControls:e,email:t}=this.state,a=this.props.spinner;return e?r.a.createElement("form",{className:"cgps-login-controls",onSubmit:this.submitForm},r.a.createElement("input",{type:"email",value:t,placeholder:"Email address",onChange:this.emailInputChange,onKeyUp:this.emailInputKeyUp,disabled:this.state.sending,ref:e=>{this.emailInput=e}}),r.a.createElement("button",{type:"submit"},this.state.sending?r.a.createElement(a,null):r.a.createElement("i",{className:"material-icons"},"send"))):r.a.createElement("a",{className:"cgps-login-button cgps-login-button--passwordless",onClick:this.showControls},r.a.createElement("span",{className:"cgps-login-button__icon"}),r.a.createElement("span",{className:"cgps-login-button__text"},"Sign in with an email"))}}Ip.displayName="SignInPasswordless";var Tp=Ip;function Lp(e){return Object(j.a)("POST","/auth/passwordless",{user:e})}var jp=Object(c.a)(null,(function(e){return{showMessage:t=>e(Object(d.c)({message:t}))}}))(({showMessage:e})=>r.a.createElement(Tp,{getPasswordlessToken:Lp,showMessage:e,spinner:R.a}));const{strategies:Ap=[]}=ee.a||{},Pp=r.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://cgps.gitbook.io/pathogenwatch/privacy-and-tos"},"terms of service");var Rp=({message:e})=>r.a.createElement("div",{className:"pw-signin-page"},r.a.createElement(q.a,null,"Sign In"),r.a.createElement(_p,{appName:"Pathogenwatch",strategies:Ap,additional:Ap.includes("passwordless")?r.a.createElement(jp,null):null,termsLink:Pp,message:e})),Mp=r.a.createElement(o.a,{path:"/sign-in",render:({location:e={}})=>{const{message:t,redirect:a="/account"}=Mn.a.parse(e.search);return t?r.a.createElement(Rp,{message:t}):ee.a.user?r.a.createElement(Wd.a,{to:a}):r.a.createElement(Rp,{message:e.state&&e.state.message})}}),Dp=(a(1116),a(38));const Fp={MISSING_FILES:e=>r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"These files are still missing:"),r.a.createElement("ul",null,e.slice(0,5).map(e=>r.a.createElement("li",null,e)),e.length>5&&r.a.createElement("li",null,"+",e.length-5," more")),r.a.createElement("p",null,"if the problem persists, please try a new upload."))};var zp=Object(c.a)((function(e){return{message:e.upload.errorMessage}}),(function(e){return{clearMessage:()=>e(Object(Dp.g)(null))}}))(({message:e,clearMessage:t})=>r.a.createElement(y,{visible:!!e,hide:t},e&&r.a.createElement("div",{className:"pw-upload-message",onClick:e=>e.stopPropagation()},r.a.createElement("span",{className:"wgsa-file-icon"},r.a.createElement("i",{className:"material-icons"},"warning")),e.type?Fp[e.type](e.data):r.a.createElement("p",null,e),r.a.createElement("footer",null,r.a.createElement("button",{className:"mdl-button mdl-button--raised mdl-button--colored",onClick:t},"Ok")))));a(1118),a(1120);const Gp={position:"fixed",zIndex:-1,opacity:0};var Up=r.a.createClass({displayName:"DragAndDrop",propTypes:{onFiles:r.a.PropTypes.func.isRequired,noAddButton:r.a.PropTypes.bool},getInitialState:()=>({indicatorVisible:!1}),componentWillMount(){this.props.noAddButton&&(this.style.cursor="pointer")},style:{},handleFiles(e){this.props.onFiles(Array.from(e))},handleDrop(e){e.stopPropagation(),e.preventDefault(),this.setState({indicatorVisible:!1}),e.dataTransfer&&e.dataTransfer.files.length>0&&this.handleFiles(e.dataTransfer.files)},showDropIndicator(e){e.stopPropagation(),e.preventDefault(),this.setState({indicatorVisible:!0})},hideDropIndicator(e){e.stopPropagation(),e.preventDefault(),this.setState({indicatorVisible:!1})},handleClick(){this.refs.fileInput.click()},handleFileInputChange(e){const{files:t}=e.target;t&&t.length>0&&(this.handleFiles(t),e.target.value=null)},render(){const{readsEligible:e,accept:t}=this.props;return r.a.createElement("div",{className:`wgsa-drag-and-drop ${this.state.indicatorVisible?"is-dragover":""}`,onDragOver:this.showDropIndicator,onDrop:this.handleDrop,style:this.style,onClick:this.props.noAddButton?this.handleClick:()=>{}},r.a.createElement(y,{visible:this.state.indicatorVisible,className:"wgsa-drop-indicator",onDragLeave:this.hideDropIndicator},r.a.createElement("div",{className:"wgsa-drop-indicator__message"},r.a.createElement("div",{className:"wgsa-drop-indicator__icons"},e&&r.a.createElement("span",{className:"wgsa-file-icon wgsa-file-icon--purple"},r.a.createElement("i",{className:"material-icons"},"file_copy"),r.a.createElement("span",{className:"wgsa-file-icon__label"},".fastq.gz")),r.a.createElement("span",{className:"wgsa-file-icon wgsa-file-icon--purple"},r.a.createElement("i",{className:"material-icons"},"insert_drive_file"),r.a.createElement("span",{className:"wgsa-file-icon__label"},".fasta")),r.a.createElement("span",{className:"wgsa-file-icon wgsa-file-icon--green"},r.a.createElement("i",{className:"material-icons"},"insert_drive_file"),r.a.createElement("span",{className:"wgsa-file-icon__label"},".csv"))),r.a.createElement("p",{className:"wgsa-drop-indicator__title h2 title-font"},"Drop to add to ",r.a.createElement(B,null)))),this.props.children,this.props.noAddButton?null:r.a.createElement("button",{className:"mdl-button mdl-js-button mdl-button--fab wgsa-drag-and-drop__button mdl-shadow--3dp",title:"Add files",onClick:this.handleClick},r.a.createElement("i",{className:"material-icons"},"add")),r.a.createElement("input",{type:"file",multiple:"multiple",ref:"fileInput",accept:t,style:Gp,onChange:this.handleFileInputChange}))}});a(1122);const Bp=({id:e,checked:t,onChange:a,children:n,lhs:s=!1})=>r.a.createElement("label",{className:"wgsa-settings-switch"},!s&&n,r.a.createElement("span",{className:m()("mdl-switch",{"is-checked":t})},r.a.createElement("input",{type:"checkbox",id:e,className:"mdl-switch__input",value:t,onChange:()=>a(!t)}),r.a.createElement("span",{className:"mdl-switch__track"}),r.a.createElement("span",{className:"mdl-switch__thumb"},r.a.createElement("span",{className:"mdl-switch___focus-helper"}))),s&&n);Bp.displayName="Switch",Bp.propTypes={left:r.a.PropTypes.object,right:r.a.PropTypes.object,id:r.a.PropTypes.string,checked:r.a.PropTypes.bool,onChange:r.a.PropTypes.func};var $p=Bp,Hp=a(103);var Vp=Object(c.a)((function(e,{setting:t}){return{checked:Object(Hp.b)(e,t)}}),(function(e,{setting:t}){return{onChange:a=>e(Object(Dp.e)(t,a))}}))(({checked:e,onChange:t,children:a})=>r.a.createElement($p,{checked:e,onChange:t},a)),Kp=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"pw-upload-instructions-column"},r.a.createElement("h2",null,"Genomic Data"),r.a.createElement("p",null,"One or more files in"," ",r.a.createElement("a",{href:"https://en.wikipedia.org/wiki/FASTA_format",target:"_blank",rel:"noopener"},"multi-FASTA format")," ","with one of the following extensions:"),r.a.createElement("ul",{className:"inline"},T.a.map(e=>r.a.createElement("li",{key:e},e))),r.a.createElement("p",null,"Files should contain ",r.a.createElement("strong",null,"assembled DNA sequences")," of"," ",r.a.createElement("strong",null,"whole genomes"),". Please ensure that there is"," ",r.a.createElement("strong",null,"one file per genome")," as metagenomic samples are not supported."),r.a.createElement("h2",null,"Settings"),r.a.createElement("p",null,r.a.createElement(Vp,{setting:"compression"},r.a.createElement("strong",null,"Compress files")),r.a.createElement("small",null,"Recommended for slow connections.")),r.a.createElement("p",null,r.a.createElement(Vp,{setting:"individual"},r.a.createElement("strong",null,"Upload files individually")),r.a.createElement("small",null,"Recommended for unstable connections."))),r.a.createElement("div",{className:"pw-upload-instructions-column"},r.a.createElement("h2",null,"Metadata"),r.a.createElement("p",null,"One or more files in"," ",r.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Comma-separated_values",target:"_blank",rel:"noopener"},"CSV format")," ","with the extension ",r.a.createElement("strong",null,".csv"),"."),r.a.createElement("p",null,"Files should contain a ",r.a.createElement("strong",null,"filename")," column to match each row to its respective genomic data. Please use the name of the file"," ",r.a.createElement("strong",null,"including extension"),"."),r.a.createElement("p",null,"To make full use of metadata, we strongly recommend including the following columns:"),r.a.createElement("ul",{className:"inline"},r.a.createElement("li",null,"latitude"),r.a.createElement("li",null,"longitude"),r.a.createElement("li",null,"year"),r.a.createElement("li",null,"month"),r.a.createElement("li",null,"day")),r.a.createElement("p",null,"When providing a date, month and day are optional. Coordinates should be provided in decimal degrees. Additional metadata may be included and will be saved."),r.a.createElement("h3",null,"CSV Templates"),r.a.createElement("ul",{className:"bulleted"},r.a.createElement("li",null,r.a.createElement("a",{href:"/pathogenwatch-metadata-template-minimal.csv",download:"pathogenwatch-metadata-template-minimal.csv"},"Minimal")),r.a.createElement("li",null,r.a.createElement("a",{href:"/pathogenwatch-metadata-template-typhi.csv",download:"pathogenwatch-metadata-template-typhi.csv"},r.a.createElement(Ua.a,{organismId:"90370"})))))),qp=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"pw-upload-instructions-column"},r.a.createElement("h2",null,"Genomic Data"),r.a.createElement("p",null,"One or more ",r.a.createElement("strong",null,"pairs of files")," in gzip-compressed"," ",r.a.createElement("a",{href:"https://en.wikipedia.org/wiki/FASTQ_format",target:"_blank",rel:"noopener"},"FASTQ format")," ","with one of the following extensions:"),r.a.createElement("table",{cellPadding:"0",cellSpacing:"0"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"_1.fastq.gz"),r.a.createElement("td",null,"_2.fastq.gz")),r.a.createElement("tr",null,r.a.createElement("td",null,".1.fastq.gz"),r.a.createElement("td",null,".2.fastq.gz")),r.a.createElement("tr",null,r.a.createElement("td",null,"_R1.fastq.gz"),r.a.createElement("td",null,"_R2.fastq.gz")),r.a.createElement("tr",null,r.a.createElement("td",null,".R1.fastq.gz"),r.a.createElement("td",null,".R2.fastq.gz")))),r.a.createElement("p",null,"Files should contain ",r.a.createElement("strong",null,"short read DNA sequences")," of"," ",r.a.createElement("strong",null,"whole genomes"),". Please ensure that there are"," ",r.a.createElement("strong",null,"two files per genome")," as metagenomic samples are not supported.")),r.a.createElement("div",{className:"pw-upload-instructions-column"},r.a.createElement("h2",null,"Metadata"),r.a.createElement("p",null,"One or more files in"," ",r.a.createElement("a",{href:"https://en.wikipedia.org/wiki/Comma-separated_values",target:"_blank",rel:"noopener"},"CSV format")," ","with the extension ",r.a.createElement("strong",null,".csv"),"."),r.a.createElement("p",null,"Files should contain a ",r.a.createElement("strong",null,"filename")," column to match each row to its respective genomic data. Please use either the common prefix (e.g. the ",r.a.createElement("strong",null,"lane ID")," or the ",r.a.createElement("strong",null,"strain name"),"), or ",r.a.createElement("strong",null,"one of")," the names of the files including extension."),r.a.createElement("p",null,"To make full use of metadata, we strongly recommend including the following columns:"),r.a.createElement("ul",{className:"inline"},r.a.createElement("li",null,"latitude"),r.a.createElement("li",null,"longitude"),r.a.createElement("li",null,"year"),r.a.createElement("li",null,"month"),r.a.createElement("li",null,"day")),r.a.createElement("p",null,"When providing a date, month and day are optional. Coordinates should be provided in decimal degrees. Additional metadata may be included and will be saved."),r.a.createElement("h3",null,"CSV Templates"),r.a.createElement("ul",{className:"bulleted"},r.a.createElement("li",null,r.a.createElement("a",{href:"/pathogenwatch-metadata-template-reads-minimal.csv",download:"pathogenwatch-metadata-template-reads-minimal.csv"},"Minimal")),r.a.createElement("li",null,r.a.createElement("a",{href:"/pathogenwatch-metadata-template-reads-typhi.csv",download:"pathogenwatch-metadata-template-reads-typhi.csv"},r.a.createElement(Ua.a,{organismId:"90370"})))))),Wp=(a(1124),({children:e,color:t="purple",text:a,circular:n=!1})=>r.a.createElement("span",{className:m()("pw-badge",`pw-badge-${t}`,{circular:n}),"data-text":a},e)),Yp=a(108);const Zp=e=>{r.a.useEffect(()=>{const t=Yp.a.getState();e&&!t.auth.pending&&Yp.a.dispatch(Object(Dp.f)(e))},[e])};var Xp=a(189);function Qp(e=!1){const t=Yp.a.getState(),{token:a,pending:r}=t.auth;Object(n.useEffect)(()=>{a||r||Yp.a.dispatch(Object(Xp.b)())},[a,r]),Object(n.useEffect)(()=>{a&&e&&Yp.a.dispatch(Object(Xp.b)())},[])}var Jp=Object(c.a)((function(e){return{usage:Object(Hp.a)(e),token:e.auth.token}}))(({usage:e,token:t})=>{Qp(!0),Zp(t);const a=r.a.useRef();return r.a.useEffect(()=>{a.current&&!a.current.MaterialTabs&&componentHandler.upgradeElement(a.current)},[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,{className:"pw-upload-assembler-usage"},e&&r.a.createElement("aside",null,r.a.createElement("p",null,r.a.createElement("strong",null,"Processing reads is a trial service with fair-use limits.")),r.a.createElement("p",null,0===e.remaining?r.a.createElement(r.a.Fragment,null,"You have no assemblies remaining, check back soon."):r.a.createElement(r.a.Fragment,null,"You are currently limited to ",r.a.createElement("strong",null,e.remaining," assemblies"),"."),r.a.createElement("br",null),r.a.createElement("a",{href:"https://cgps.gitbook.io/pathogenwatch/technical-descriptions/short-read-assembly",target:"_blank",rel:"noopener"},"How the service works")))),r.a.createElement("div",{ref:e=>{a.current=e},className:"mdl-tabs mdl-js-tabs mdl-js-ripple-effect"},r.a.createElement("div",{className:"mdl-tabs__tab-bar"},r.a.createElement("a",{href:"#assemblies-panel",className:"mdl-tabs__tab is-active"},"Assemblies"),r.a.createElement("a",{href:"#reads-panel",className:"mdl-tabs__tab"},r.a.createElement(Wp,{text:"Beta",color:"turquoise"},"Reads"))),r.a.createElement("div",{className:"mdl-tabs__panel is-active",id:"assemblies-panel"},r.a.createElement(Kp,null)),r.a.createElement("div",{className:"mdl-tabs__panel",id:"reads-panel"},r.a.createElement(qp,null))))}),eh=a(892);var th=Object(c.a)((function(e){return{hasIncomplete:Object(Hp.c)(e)}}))(({children:e,hasIncomplete:t})=>r.a.createElement(Ju,{className:"wgsa-upload-summary pw-upload-page"},e||r.a.createElement(r.a.Fragment,null,r.a.createElement(eh.a,{activeClassName:"mdl-button--primary",className:"mdl-button",exact:!0,to:"/upload"},"New Upload"),r.a.createElement(eh.a,{activeClassName:"mdl-button--primary",className:"mdl-button",exact:!0,to:"/upload/previous"},"Previous Uploads",t&&r.a.createElement("span",{title:"You have incomplete uploads.",className:"pw-blipper wgsa-blink"})))));const ah=e=>Object(rs.readAsText)(e).then(fs),nh=e=>e.reduce((e,{data:t={}})=>e.concat(t),[]);var rh=a(89);const sh=/^(.*)[_\.]R?[12]\.fastq\.gz$/,oh=new RegExp(`(${T.a.join("|")})$`,"i"),{maxGenomeFileSize:lh=20}=ee.a,ih=1048576*lh;function ch(e){if(0===e.size)throw new Error(`${e.name} is an empty file.`);if(e.size>ih)throw new Error(`${e.name} is too large, the limit is ${lh} MB.`);return e}var uh=function(e,t){const a=[],n=[],r=[],s=mh();for(const t of e)if(ps.test(t.name))a.push(t);else if(oh.test(t.name)){try{ch(t)}catch(e){return Promise.reject(e)}n.push(t)}else s&&sh.test(t.name)&&r.push(t);if(0===n.length&&r.length<=1)return Promise.reject({message:"Please ensure that your files include at least one genome with the supported file extensions."});let o={};try{o=function(e,t,a){const n={},{maxSizeMB:r=500}=a||{},s=1048576*r;for(const a of e){if(a.size>s)throw new Error(`${a.name} is too large, the limit is ${r} MB.`);const e=a.name.match(t)[1];n[e]=n[e]||{},n[e][a.name]=a}for(const[e,t]of Object.entries(n))if(2!==Object.keys(t).length)throw new Error(`No pair found for files starting ${e}, please check and try again.`);if(a&&Object.keys(n).length>a.remaining)throw new Error("You do not have enough remaining assemblies to complete this upload.");return n}(r,sh,t)}catch(e){return Promise.reject(e)}return(e=>Promise.all(e.map(ah)).then(nh))(a).then(e=>[...n.map((t,a)=>{const n=t.name.replace(oh,""),r=e.find(e=>e.filename===t.name||e.filename===n);return{files:[t],id:`${t.name}__${Date.now()}_${a}`,metadata:r?gs(r,n):null,name:n,type:rh.a.ASSEMBLY}}),...Object.entries(o).map(([t,a],n)=>{const r=Object.keys(a),s=e.find(e=>e.filename===t||r.includes(e.filename));return{files:Object.values(a),id:`${t}__${Date.now()}_${n}`,metadata:s?gs(s):null,name:t,type:rh.a.READS}})])};function mh(){return"assemblerAddress"in ee.a}function dh(e=mh()){let t=T.a;return e&&(t=T.a.concat(".fastq.gz")),t.join(",")}function ph(e=mh()){return`${dh(e)},.csv`}var hh=a(168);var fh=Object(c.a)(null,(function(e){return{onFiles:t=>e(function(e){const t=(new Date).toISOString();return(a,n)=>{const r=n(),s=Object(Hp.a)(r);uh(e,s).then(e=>{a(Object(Dp.d)(e,t)).then(()=>Nf.push(`/upload/${t}`))}).catch(e=>{e.toast?a(Object(d.c)(e.toast)):e.message?a(Object(Dp.g)(e.message)):a(Object(Dp.g)("Sorry, something went wrong."))})}}(t)),fetchPreviousUploads:()=>e(Object(hh.b)())}}))(({onFiles:e,fetchPreviousUploads:t})=>{r.a.useEffect(()=>{t()},[]);const a=mh();return r.a.createElement(Up,{onFiles:e,readsEligible:a,accept:ph(a)},r.a.createElement(q.a,null,"Upload"),r.a.createElement(th,null),r.a.createElement("section",{className:"wgsa-page wgsa-compact-page wgsa-upload-instructions"},r.a.createElement("h1",null,"Drag and drop files to begin."),a?r.a.createElement(Jp,null):r.a.createElement(Kp,null)))});a(1126);const gh=({item:e})=>{const{uploadedAt:t,total:a,complete:n}=e;return r.a.createElement(J.a,{className:"wgsa-genome-list-item wgsa-genome-list-item--selectable",to:`/upload/${t}`},r.a.createElement("span",null,Object(z.b)(t)),r.a.createElement("span",null,a),r.a.createElement("span",null,a===n?r.a.createElement("span",{className:"pw-upload-session-status uploaded"},"Uploaded"):r.a.createElement("span",{className:"pw-upload-session-status incomplete"},"Incomplete")))},bh=()=>r.a.createElement("header",{className:"wgsa-genome-list-item wgsa-genome-list-header"},r.a.createElement("h3",{className:"wgsa-list-header-cell"},"Date Uploaded"),r.a.createElement("h3",{className:"wgsa-list-header-cell"},"Genomes"),r.a.createElement("h3",{className:"wgsa-list-header-cell"},"Status"));var yh=Object(c.a)((function(e){return e.upload.previous}),(function(e){return{fetch:()=>e(Object(hh.b)())}}))(e=>(r.a.useEffect(()=>{e.fetch()},[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(q.a,null,"Previous Uploads"),r.a.createElement(th,null),r.a.createElement(M,{complete:e.uploads.length>0||e.error,placeholder:r.a.createElement("div",{className:"pw-flex-center"},r.a.createElement(R.a,null))},function({loading:e,error:t,uploads:a}){return t?r.a.createElement("p",{className:"pw-upload-page pw-centre-text"},"Failed to fetch previous uploads."):e||0!==a.length?r.a.createElement(Zu,{className:"wgsa-genome-list-view wgsa-previous-uploads",template:gh,items:a,columnCount:1,rowHeight:40,header:r.a.createElement(bh,null),headerHeight:25}):r.a.createElement("p",{className:"pw-upload-page pw-centre-text"},"No previous uploads found.")}(e))))),Eh=(a(1128),a(894)),vh=(a(1130),a(856),a(121)),Ch=a(54),wh=a(147);const Sh=r.a.createClass({displayName:"AnalysisChart",componentDidMount(){this.chart=new Na.a(this.canvas,{type:"doughnut",data:{datasets:this.props.datasets},options:{responsive:!1,maintainAspectRatio:!1,animation:{animateRotate:!0,animateScale:!0},tooltips:{displayColors:!1,callbacks:{title:(e,{datasets:t})=>e.map(({index:e,datasetIndex:a})=>t[a].labels[e]).join(", "),label:({index:e,datasetIndex:t},{datasets:a})=>{const n=a[t];return n.tooltips?n.tooltips[e]:`${n.data[e]} / ${n.total}, ${(100*n.data[e]/n.total).toFixed(1)}%`}}},pieceLabel:{render:({dataset:e,index:t})=>(e.shortLabels||e.labels)[t],precision:2,fontColor:"#fff",fontSize:13,fontStyle:"400",fontFamily:"Roboto"}}})},componentDidUpdate(){const e=[];for(const t of this.props.datasets){const a=this.chart.data.datasets.find(e=>e.label===t.label);a?(a.data=t.data,a.backgroundColor=t.backgroundColor,a.organismIds=t.organismIds,a.labels=t.labels,a.shortLabels=t.shortLabels,a.parents=t.parents,a.total=t.total,a.tooltips=t.tooltips):e.unshift(t)}for(const t of e)this.chart.data.datasets.unshift(t);this.chart.update()},getGenomesLink(){const{uploadedAt:e,selectedOrganism:t}=this.props;let a=`/genomes?uploadedAt=${e}`;return t&&(a+=`&organismId=${t}`),a},render(){return r.a.createElement("div",{className:"wgsa-analysis-chart"},r.a.createElement(ul.a,null,({width:e,height:t})=>r.a.createElement(Sd,{height:t,width:e,chart:this.chart},r.a.createElement("canvas",{ref:e=>{this.canvas=e}}))),this.props.specieationComplete&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"pw-analysis-chart-hover-trigger"}),r.a.createElement(J.a,{className:m()("mdl-shadow--2dp wgsa-view-genomes-button",{"wgsa-sonar-effect":this.props.sonar}),to:this.getGenomesLink()},"View Genomes")))}});var Nh=Object(c.a)((function(e){return{datasets:Object(vh.b)(e),specieationComplete:Object(Ch.i)(e),sonar:Object(Ch.g)(e)&&!Object(Ch.f)(e),selectedOrganism:Object(vh.d)(e)}}),(function(e){return{selectOrganism:t=>e(Object(wh.f)(t))}}))(Sh),Oh=r.a.memo(({uploadedAt:e})=>{r.a.useEffect(()=>{const t=`${ee.a.clientId}-analysis`;return re(t,e,e=>Yp.a.dispatch(Object(wh.e)(e))),()=>se(t)},[e]),r.a.useEffect(()=>{const t=setInterval(()=>Yp.a.dispatch(Object(wh.d)(e)),6e4);return()=>clearInterval(t)},[e])}),xh=(a(859),a(99)),kh=a(148),_h=a(227);var Ih=Object(c.a)((function(e){return{listening:Object(xh.h)(e),assemblyInProgress:Object(xh.g)(e),token:e.auth.token}}),(function(e){return{handleStatusUpdate:t=>{switch(t.type){case"ERROR":e(Object(kh.d)(t.payload));break;case"STATUS":e(Object(kh.e)(t.payload));break;default:console.log("[Assembly] Unknown message type:",t)}},progressTick:()=>e(Object(kh.f)())}}))(({assemblyInProgress:e,handleStatusUpdate:t,listening:a,progressTick:n,token:s,uploadedAt:o})=>(Qp(),r.a.useEffect(()=>{if(a&&s){Object(_h.a)(o,s).then(e=>{t({type:"STATUS",payload:e})}).catch(console.error);const e=`${ee.a.clientId}-assembly`;return re(e,o,t),()=>se(e)}},[a,s]),r.a.useEffect(()=>{if(e){const e=setInterval(n,2e3);return()=>clearInterval(e)}},[e]),null)),Th=a(32);const Lh=e=>{e.preventDefault(),window.location.reload()};var jh=Object(c.a)((function(e){return{assemblerErrors:Object(xh.a)(e),numOtherErrors:Object(Th.b)(e),uploadPending:Object(Th.k)(e),validationErrors:Object(Th.j)(e)}}))(({assemblerErrors:e,validationErrors:t,numOtherErrors:a,uploadPending:n})=>r.a.createElement("section",null,e.map(({name:e})=>r.a.createElement("article",{key:e,className:"pw-upload-file-error"},r.a.createElement("i",{className:"material-icons"},"error_outline"),r.a.createElement("div",null,r.a.createElement("h5",null,e),r.a.createElement("p",null,"There was a problem during assembly")))),t.map(({filename:e,error:t})=>r.a.createElement("article",{key:e,className:"pw-upload-file-error"},r.a.createElement("i",{className:"material-icons"},"error_outline"),r.a.createElement("div",null,r.a.createElement("h5",null,e),r.a.createElement("p",null,t.message)))),a>0&&r.a.createElement("article",{className:"pw-upload-file-error"},r.a.createElement("i",{className:"material-icons"},"error_outline"),r.a.createElement("div",null,r.a.createElement("h5",null,a," genome",1===a?" was ":"s were ","interrupted during upload"))),r.a.createElement("footer",{className:"pw-upload-file-error-footer"},!n&&(t.length>0||a>0)&&r.a.createElement("a",{className:"mdl-button mdl-button--raised mdl-button--colored",href:"#",onClick:Lh},"Reload page")))),Ah=(a(1132),a(1134),r.a.createClass({displayName:"Progress Bar",propTypes:{className:r.a.PropTypes.string,progress:r.a.PropTypes.number,indeterminate:r.a.PropTypes.bool,label:r.a.PropTypes.string},componentDidMount(){const{progressBar:e}=this.refs;e.addEventListener("mdl-componentupgraded",e=>{this.progressBar=e.target.MaterialProgress,this.setProgress()}),componentHandler.upgradeElement(e)},componentDidUpdate(){this.setProgress()},setProgress(){"progress"in this.props&&this.progressBar.setProgress(this.props.progress)},render(){const{className:e,indeterminate:t,children:a,label:n=a}=this.props;return r.a.createElement("div",{className:"wgsa-progress-bar"},n?r.a.createElement("label",{className:"wgsa-progress-bar__label"},n):null,r.a.createElement("div",{ref:"progressBar",className:m()(e,"mdl-progress mdl-js-progress",{"mdl-progress__indeterminate":t})}))}})),Ph=a(53);const Rh={IDENTIFY:"Identifying",PREPARE:"Preparing",UPLOAD:"Uploading"};var Mh=({genome:e})=>r.a.createElement("div",{className:"wgsa-genome-card"},r.a.createElement("header",{className:"wgsa-card-header"},r.a.createElement("h2",{className:"wgsa-card-title wgsa-overflow-fade",title:e.name},e.name)),e.type===Ph.b.READS?function(e){return e.files.map(e=>r.a.createElement(r.a.Fragment,{key:e.name},r.a.createElement(Ah,{key:e.stage,progress:e.progress||0}),r.a.createElement(b.a,null,r.a.createElement("small",{key:e.stage},Rh[e.stage]||"Pending"))))}(e):function(e){switch(e.status){case Ph.a.COMPRESSING:return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ah,{indeterminate:!0}),r.a.createElement("small",null,"Compressing"));case Ph.a.UPLOADING:{const[t]=e.files;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ah,{progress:t.progress||0}),r.a.createElement("small",null,"Uploading"))}case Ph.a.SUCCESS:return r.a.createElement(Ah,{progress:100});case Ph.a.QUEUED:default:return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ah,{progress:0}),r.a.createElement("small",null,"Pending"))}}(e)),Dh=({uploadsInProgress:e,pending:t})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(um.a,{className:"wgsa-upload-card-list",transitionName:"wgsa-upload-card",transitionEnterTimeout:280,transitionLeave:!1},e.map(e=>r.a.createElement(Mh,{key:e.id,genome:e}))),e.length>0&&t>0&&r.a.createElement("p",null,"+",t," genome",1===t?"":"s")),Fh=a(58);const zh=({complete:e,total:t,hasErrors:a})=>e===t?r.a.createElement("p",{className:m()("pw-with-icon",{success:!a})},r.a.createElement("i",{className:"material-icons"},a?"error_outline":"check_circle"),t.toLocaleString()," genome",1===t?"":"s"," assembled"):r.a.createElement("p",{className:"pw-with-icon"},"Assembly",r.a.createElement("span",{className:"wgsa-upload-legend-count"},r.a.createElement("strong",null,e.toLocaleString())," of ",r.a.createElement("strong",null,t.toLocaleString()))),Gh=({complete:e,total:t,hasErrors:a})=>e===t?r.a.createElement("p",{className:m()("pw-with-icon",{success:!a})},r.a.createElement("i",{className:"material-icons"},a?"error_outline":"check_circle"),t.toLocaleString()," ",1===t?"analysis":"analyses"," completed"):r.a.createElement("p",{className:"pw-with-icon"},"Analysis",r.a.createElement("span",{className:"wgsa-upload-legend-count"},r.a.createElement("strong",null,e.toLocaleString())," of ",r.a.createElement("strong",null,t.toLocaleString()))),Uh=({position:e})=>0===e?r.a.createElement("p",{className:"wgsa-blink"},"Results processing"):e?r.a.createElement("p",null,e.toLocaleString()," job",1===e?"":"s"," till next result"):null;var Bh=Object(c.a)((function(e){return{assemblyQueued:Object(xh.c)(e),hasErrors:Ch.f(e),sessionHasReads:Object(Fh.f)(e),position:Object(vh.c)(e),progress:Ch.b(e),totalGenomes:Object(Fh.a)(e)}}))(e=>{const{assemblyQueued:t,hasErrors:a,sessionHasReads:n,position:s,progress:o,totalGenomes:l,completedUploads:i}=e;if(0===l)return null;const{assembly:c,analyses:u,speciation:d}=o,p=!n||c.done===c.total,h=d.done===l,f=i>0&&(!n||c.complete>0)&&(0===u.total||u.done<u.total);return r.a.createElement("div",{className:"wgsa-upload-progress-overview"},r.a.createElement("p",{className:m()("pw-with-icon",{success:i===l})},r.a.createElement("i",{className:"material-icons"},i===l?"check_circle":"error_outline"),0===i?"No successful uploads":`${i.toLocaleString()} genome${1===i?"":"s"} uploaded`),n&&i>0&&r.a.createElement(zh,{complete:c.done,total:c.total,hasErrors:c.failed>0}),h&&u.total>0&&r.a.createElement(Gh,{complete:u.done,total:u.total,hasErrors:a}),t>0&&r.a.createElement("p",{className:"wgsa-blink"},t," job",1===t?"":"s"," queued"),p&&f&&r.a.createElement(Uh,{position:s}))});var $h=Object(c.a)((function(e){return{data:Object(vh.e)(e),speciesPredictionComplete:Object(Ch.i)(e)}}))(({data:e,speciesPredictionComplete:t})=>r.a.createElement("ul",{className:"wgsa-upload-legend"},e.map(({key:e,label:a,total:n,colour:s,analyses:o=[]})=>r.a.createElement("li",{key:e},r.a.createElement("span",{className:"pw-with-icon wgsa-upload-legend-header"},r.a.createElement("i",{className:"material-icons",style:{color:s}},"lens"),r.a.createElement("strong",{className:"wgsa-upload-legend-organism",title:a},a),r.a.createElement("span",{className:"wgsa-upload-legend-count"},n.toLocaleString())),r.a.createElement("ul",null,o.map(e=>"speciator"===e.key?null:e.label?r.a.createElement("li",{key:e.key,className:"pw-with-icon"},e.label,!!e.source&&r.a.createElement(r.a.Fragment,null," ",r.a.createElement("small",null,"(",e.source,")")),r.a.createElement("span",{className:"wgsa-upload-legend-count aligned"},e.errors>0&&r.a.createElement("span",{className:"wgsa-upload-legend-count-errors"}," ",e.errors," error",1===e.errors?"":"s"),t&&e.total===n?r.a.createElement("i",{className:m()("material-icons",{success:!(e.errors>0)})},e.errors>0?"error_outline":"check_circle"):e.total)):null))))));const Hh=Object(ce.createSelector)(Th.a,xh.e,(e,t)=>e+t),Vh=Object(ce.createSelector)(Th.c,Th.a,Fh.a,e=>(({upload:e})=>e.progress.errors)(e).showing,(e,t,a,n)=>a>0&&0===e&&t===a||!!n);var Kh=Object(c.a)((function(e){return{files:Object(Th.f)(e),sessionIsLoading:Object(Ch.h)(e),sessionHasReads:Object(Fh.f)(e),showErrors:Vh(e),showSpeciesBreakdown:Object(vh.f)(e),uploadsInProgress:Object(Ch.e)(e),uploadsPending:Object(Th.k)(e)}}))(({files:e,sessionIsLoading:t,sessionHasReads:a,showErrors:n,showSpeciesBreakdown:s,uploadedAt:o,uploadsInProgress:l,uploadsPending:i})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Oh,{uploadedAt:o}),a&&r.a.createElement(Ih,{uploadedAt:o}),r.a.createElement(M,{complete:!t,placeholder:r.a.createElement("div",{className:"pw-centre-text"},r.a.createElement(R.a,null))},r.a.createElement("div",{className:"wgsa-upload-progress pw-upload-page"},r.a.createElement(Eh.a,{when:i,message:'\n          Your upload is not complete.\n          Return to "Previous Uploads" to resume this session at a later date.\n        '}),r.a.createElement("div",null,r.a.createElement("div",{className:"wgsa-section-divider"},i?r.a.createElement(Dh,{pending:e.pending,uploadsInProgress:l}):r.a.createElement(Bh,{completedUploads:e.completed})),s&&r.a.createElement("div",{className:"wgsa-section-divider"},r.a.createElement($h,null))),r.a.createElement("div",{className:"wgsa-section-divider wgsa-flex-section"},r.a.createElement(b.a,{className:"pw-expand"},n?r.a.createElement(jh,{key:"errors"}):r.a.createElement(Nh,{key:"analysis",uploadedAt:o}))))))),qh=a(322);var Wh=Object(c.a)((function(e){const t=Hh(e);return{numProblems:t,visible:!Object(Ch.h)(e)&&t>0}}),(function(e){return{onClick:()=>e(Object(qh.b)())}}))(({visible:e,numProblems:t,onClick:a})=>r.a.createElement(b.a,null,e&&r.a.createElement("button",{className:"pw-pill pw-pill-danger pw-uppercase",onClick:a},t," problem",1===t?"":"s")));const Yh=r.a.createClass({displayName:"Component",getTitle(){const{summary:e}=this.props;return[e.total?`(${e.completed}/${e.total})`:"","Upload"].join(" ")},render(){const{uploadedAt:e,isUploading:t}=this.props;return r.a.createElement(r.a.Fragment,null,r.a.createElement(q.a,null,this.getTitle()),r.a.createElement(th,null,!t&&r.a.createElement("a",{className:"mdl-button",onClick:()=>window.history.back()},r.a.createElement("i",{className:"material-icons"},"arrow_back")," Go back"),r.a.createElement("div",{className:"pw-upload-summary-column"},r.a.createElement(Wh,null),r.a.createElement("p",{className:"pw-upload-session-time"},Object(z.b)(e)))))}});var Zh=Object(c.a)((function(e){return{summary:Th.f(e),isUploading:Th.l(e)}}))(Yh),Xh=(a(1136),a(226)),Qh=a(59);const Jh=mh();var ef=Object(c.a)((function(e){return{numSuccessful:Object(Th.d)(e),remainingFiles:Object(Xh.c)(e)}}),(function(e,{session:t}){return{onFiles:a=>e(function(e,t=[]){return(a,n)=>{const r=n(),s=Object(Hp.a)(r),o=Object(Xh.b)(r),l=new Set(Object.keys(o)),i=e.filter(e=>l.has(e.name));0!==i.length?uh(i,s).then(e=>{for(const a of e){let e;if(a.files)for(const t of a.files)l.delete(t.name),e=e||o[t.name];if(e){a.id=e;const n=t.find(t=>t.genomeId===e);n&&(a.recovery=n.files)}}l.size>0?a({type:"UPLOAD_ERROR_MESSAGE",payload:{type:"MISSING_FILES",data:Array.from(l)}}):(a({type:Dp.a.SUCCESS,payload:{genomes:e}}),a(Object(Qh.e)()))}).catch(e=>{a({type:"UPLOAD_ERROR_MESSAGE",payload:e.message})}):a({type:"UPLOAD_ERROR_MESSAGE",payload:"No matching files for this session, please try again."})}}(a,t))}}))(({onFiles:e,numSuccessful:t,remainingFiles:a})=>r.a.createElement(Up,{onFiles:e,readsEligible:Jh,accept:dh(Jh)},r.a.createElement("section",{className:"pw-upload-page pw-upload-recovery"},r.a.createElement("h1",null,"Recover this session."),t>0&&r.a.createElement("p",{className:"pw-with-icon success"},r.a.createElement("i",{className:"material-icons"},"check_circle"),t," genome",1===t?"":"s"," uploaded successfully"),r.a.createElement("p",null,"Please drag and drop these files to continue:"),r.a.createElement("ul",{className:"pw-upload-recovery-files"},a.map(e=>r.a.createElement("li",{key:e[0]},r.a.createElement("span",{className:"wgsa-file-icon"},r.a.createElement("i",{className:"material-icons"},1===e.length?"insert_drive_file":"file_copy")),r.a.createElement("ul",null,e.map(e=>r.a.createElement("li",{key:e},e)))))))));var tf=Object(c.a)((function(e){return{token:e.auth.token}}))(({uploadedAt:e,token:t})=>{Qp(),Zp(t);const[a,n]=((e,t)=>{const[a,n]=r.a.useState(null),[s,o]=r.a.useState(null);return r.a.useEffect(()=>{t&&Object(_h.b)(e,t).then(e=>n(e.progress)).catch(e=>{"NOT_FOUND"===e.type?o({message:r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,"We couldn't find the details of this upload session."),r.a.createElement("p",null,"If the problem persists, you may need to start a new upload."))}):o(e)})},[e,t]),[a,s]})(e,t);return r.a.createElement(M,{complete:a||n,placeholder:r.a.createElement("section",{className:"pw-upload-page pw-centre-text"},r.a.createElement(R.a,null))},n?r.a.createElement("section",{key:"error",className:"pw-upload-page"},r.a.createElement("h1",null,"Sorry, there's a problem."),"string"==typeof n.message?r.a.createElement("p",null,n.message):n.message):r.a.createElement(ef,{key:"loaded",session:a}))});var af=Object(c.a)((function(e){return{sessionHasReads:Object(Fh.f)(e)}}))(({uploadedAt:e,sessionHasReads:t})=>mh()&&t?r.a.createElement(tf,{uploadedAt:e}):r.a.createElement(ef,null)),nf=a(80);const rf=r.a.createClass({displayName:"Component",componentWillMount(){const{isUploading:e,startUpload:t,fetch:a}=this.props;e?t():a()},componentDidUpdate(e){const t=e.isUploading&&!this.props.isUploading,a=!1===e.isSpecieationComplete&&this.props.isSpecieationComplete;(t||a)&&this.props.fetch()},componentWillUnmount(){this.props.reset()},renderContent(){const{match:e,uploadedAt:t}=this.props;if(e.params.uploadedAt!==t)return null;switch(this.props.view){case rh.b.RECOVERY:return r.a.createElement(af,{uploadedAt:t});case rh.b.PROGRESS:return r.a.createElement(Kh,{uploadedAt:t});default:return null}},render(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Zh,{uploadedAt:this.props.uploadedAt}),this.renderContent())}});var sf=Object(c.a)((function(e){return{uploadedAt:Object(Ch.d)(e),isUploading:Object(Th.k)(e),isSpecieationComplete:Object(Ch.i)(e),view:Object(Ch.c)(e)}}),(function(e,{match:t}){const{uploadedAt:a}=t.params;return{fetch:()=>e(Object(nf.c)(a)),startUpload:()=>e(Object(Qh.e)()),reset:()=>e(Object(nf.d)())}}))(rf);const of=Object(c.a)((function(e){return{uploading:Object(Th.l)(e),uploadedAt:Object(Ch.d)(e)}}))(({uploading:e,uploadedAt:t,match:a})=>a.isExact&&e?r.a.createElement(Wd.a,{to:`/upload/${t}`}):r.a.createElement("div",{className:"wgsa-hipster-style"},r.a.createElement(Cn.a,null,r.a.createElement(o.a,{path:"/upload/previous",component:yh}),r.a.createElement(o.a,{path:"/upload/:uploadedAt",component:sf}),r.a.createElement(o.a,{component:fh})),r.a.createElement(zp,null)));var lf=r.a.createElement(Xd,{authMessage:"Please sign in to upload genomes.",path:"/upload",component:of}),cf=Object(c.a)()(r.a.createClass({goBack(e){window.history&&(e.preventDefault(),window.history.back())},render(){return r.a.createElement("div",{className:"mdl-layout wgsa-loading-container wgsa-not-found"},r.a.createElement("div",{className:"wgsa-loading-content"},r.a.createElement("a",{href:"/"},r.a.createElement(H,{className:"wgsa-loading-logo"})),r.a.createElement("h1",null,"These aren't the bacteria you're looking for."),r.a.createElement("p",null,"(This page could not be found)"),r.a.createElement("a",{className:"mdl-button",onClick:this.goBack,href:"#"},"Go back")))}}));const uf=({from:e,to:t})=>r.a.createElement(o.a,{exact:!0,path:e,render:({location:e})=>r.a.createElement(Wd.a,{to:`${t}${e.search}`})}),mf=({from:e,to:t})=>r.a.createElement(o.a,{exact:!0,path:e,render:()=>{window&&window.location&&(window.location=t)}});var df=()=>r.a.createElement(Cn.a,null,bp,Wu,Kd,gm,$d,Sp,xn.a,Np.a,Np.c,Mp,lf,r.a.createElement(mf,{from:"/documentation",to:"https://cgps.gitbook.io/pathogenwatch/"}),r.a.createElement(Wd.a,{from:"/index.html",to:"/"}),r.a.createElement(Wd.a,{from:"/collections/*",to:"/collections/all"}),r.a.createElement(uf,{from:"/collections",to:"/collections/all"}),",",r.a.createElement(Wd.a,{from:"/genomes/*",to:"/genomes/all"}),r.a.createElement(uf,{from:"/genomes",to:"/genomes/all"}),r.a.createElement(Wd.a,{from:"/:organism/upload",to:"/upload"}),Np.b,r.a.createElement(o.a,{exact:!0,path:"/:organism/collection/:token",render:({match:e})=>{const t={pathname:`/collection/${e.params.token}`,state:{organism:e.params.organism}};return r.a.createElement(Wd.a,{to:t})}}),r.a.createElement(o.a,{path:"/",component:cf}));a(1138);const pf=({appName:e="Microreact",visible:t=!0,policyLink:a,onAccept:n,className:s})=>r.a.createElement(ut.a,{visible:t,transitionAppear:!0,removeOnLeave:!0,motionName:"libmr"},t=>r.a.createElement("aside",{className:m()("libmr-CookieConsent",s,t.className)},r.a.createElement("div",{className:"libmr-CookieConsent-message"},r.a.createElement("h2",null,"We use cookies to give you the best online experience."),r.a.createElement("p",null,"By using ",e,", you agree to our use of cookies in accordance with our cookie policy."),r.a.createElement("div",{className:"libmr-CookieConsent-actions"},a,r.a.createElement("button",{onClick:n},"Accept")))));pf.propTypes={appName:lt.a.string,className:lt.a.string,onAccept:lt.a.func,policyLink:lt.a.node,visible:lt.a.bool};var hf=pf;const ff="cookie-consent-given";var gf=r.a.createClass({displayName:"Cookies",getInitialState:()=>({checked:!1,consented:!1}),componentWillMount(){localforage.getItem(ff).then(e=>{this.setState({checked:!0,consented:e})})},onAccept(){localforage.setItem(ff,!0).then(()=>this.setState({consented:!0}))},render(){return this.state.checked?r.a.createElement(hf,{visible:!this.state.consented,onAccept:this.onAccept,appName:"Pathogenwatch",theme:"purple",policyLink:r.a.createElement("a",{target:"_blank",rel:"noopener",href:"https://cgps.gitbook.io/pathogenwatch/privacy-and-tos",className:"mdl-button"},"Read our policy")}):null}});a(1140);function bf({user:e}){return e?r.a.createElement(J.a,{className:"cgps-avatar cgps-avatar--top wgsa-account-header",to:"/account"},r.a.createElement(dp,null),r.a.createElement("div",{className:"cgps-avatar__name",title:e.name},e.name),r.a.createElement("div",{className:"cgps-avatar__contact",title:e.email},e.email)):r.a.createElement("div",{className:"cgps-avatar cgps-avatar--top wgsa-account-header"},r.a.createElement(dp,null),r.a.createElement("div",{className:"cgps-avatar__name"},r.a.createElement(B,null)),r.a.createElement("div",{className:"cgps-avatar__contact",title:"Browsing anonymously"},"Browsing anonymously"))}var yf=a(295);const{user:Ef}=ee.a,vf=r.a.createClass({displayName:"UserDrawer",propTypes:{visible:r.a.PropTypes.bool,closeMenu:r.a.PropTypes.func},componentDidMount(){window.addEventListener("keyup",this.handleEscKey)},componentDidUpdate(e){e.location!==this.props.location&&this.props.visible&&this.props.closeMenu()},componentWillUnmount(){window.removeEventListener("keyup",this.handleEscKey)},handleEscKey(e){27===e.keyCode&&this.props.visible&&this.props.closeMenu()},handleSignOut(e){e.preventDefault(),Object(yn.e)().then(()=>{window.location.pathname="/signout"})},render(){const{summary:e}=this.props,{allCollections:t,allGenomes:a,binnedGenomes:n,userCollections:s,userGenomes:o,offlineCollections:l=0,binnedCollections:i,numOrganisms:c}=e;return r.a.createElement("div",{className:m()("mdl-layout__obfuscator",{"is-visible":this.props.visible}),onClick:this.props.closeMenu,onKeyUp:this.handleEscKey},r.a.createElement("div",{className:m()("mdl-layout__drawer",{"is-visible":this.props.visible}),onClick:e=>e.stopPropagation()},r.a.createElement("div",{className:"wgsa-drawer-content"},r.a.createElement("span",{className:"mdl-layout-title"},r.a.createElement(bf,{user:Ef}),r.a.createElement(K,null),ee.a.version&&r.a.createElement("a",{href:`https://cgps.gitbook.io/pathogenwatch/release-notes/#${ee.a.version}`,target:"_blank",rel:"noopener",className:"wgsa-version"},ee.a.version)),r.a.createElement("nav",{className:"mdl-navigation"},Ef?r.a.createElement(On.d,{to:"/account",icon:"account_circle"},"My Account"):r.a.createElement(On.d,{to:"/sign-in",icon:"verified_user"},"Sign In")),r.a.createElement("hr",null),r.a.createElement("nav",{className:"mdl-navigation"},r.a.createElement("h2",{className:"wgsa-navigation-header"},"Genomes"),r.a.createElement(On.d,{to:"/genomes/all",badge:a,icon:r.a.createElement(yf.a,null)},Ef?"All":"Public"," Genomes"),Ef&&r.a.createElement(On.d,{to:"/genomes/user",badge:o,icon:"person"},"My Genomes"),Ef&&r.a.createElement(On.d,{to:"/genomes/bin",badge:n,icon:"delete"},"Bin"),r.a.createElement(On.d,{to:"/upload",icon:"cloud_upload"},"Upload")),r.a.createElement("hr",null),r.a.createElement("nav",{className:"mdl-navigation"},r.a.createElement("h2",{className:"wgsa-navigation-header"},"Collections"),r.a.createElement(On.d,{to:"/collections/all",badge:t,icon:"collections"},Ef?"All":"Public"," Collections"),Ef&&r.a.createElement(On.d,{to:"/collections/user",badge:s,icon:"person"},"My Collections"),r.a.createElement(On.d,{to:"/offline",badge:l,icon:"signal_wifi_off"},"Offline Collections"),Ef&&r.a.createElement(On.d,{to:"/collections/bin",badge:i,icon:"delete"},"Bin")),r.a.createElement("hr",null),r.a.createElement("nav",{className:"mdl-navigation"},r.a.createElement(On.d,{to:"https://cgps.gitbook.io/pathogenwatch",external:!0,icon:"help"},"Documentation"),r.a.createElement(On.d,{to:"https://gitlab.com/cgps/pathogenwatch/roadmap",external:!0,icon:"feedback"},"Feedback")),Ef&&r.a.createElement("nav",{className:"mdl-navigation"},r.a.createElement("a",{href:"/signout",className:"mdl-navigation__link",onClick:this.handleSignOut},r.a.createElement("i",{className:"material-icons"},"exit_to_app"),r.a.createElement("span",null,"Sign Out"))),r.a.createElement("footer",{className:"wgsa-menu-footer"},r.a.createElement("a",{className:"cgps-logo",target:"_blank",rel:"noopener",href:"http://www.pathogensurveillance.net"},r.a.createElement("img",{src:"/images/cgps-short.svg"})),r.a.createElement("a",{className:"contact-email",href:"mailto:cgps@sanger.ac.uk"},"cgps@sanger.ac.uk")))))}});var Cf=Object(c.a)((function(e){return{summary:Object(pp.b)(e),location:e.location}}),(function(e){return{closeMenu:()=>e(Object(wn.c)(!1))}}))(vf);function wf(){return e=>{localforage.getItem("cookie-consent-given").then(t=>{t||e(Object(d.c)({message:r.a.createElement("span",null,"🍪 This website uses cookies for a better browsing experience."),action:{label:r.a.createElement("span",null,"That's OK"),onClick:()=>function(e){localforage.setItem("cookie-consent-given",!0).then(()=>e(Object(d.b)()))}(e)},closeButton:!1,autohide:!1}))})}}var Sf=Object(c.a)((function({location:e,header:t}){return{pageSlug:e.slug,userDrawerVisible:t.userDrawerVisible}}),(function(e,{location:t}){return{onLocationChange:()=>e(Object(On.e)(t)),fetchSummary:()=>e(Object(N.b)()),showIntroToast:()=>e(wf())}}))(r.a.createClass({displayName:"App",propTypes:{children:r.a.PropTypes.element},componentDidMount(){componentHandler.upgradeDom(),this.menuButton=document.querySelector(".mdl-layout__drawer-button"),this.onLocationChange(),this.props.fetchSummary()},componentDidUpdate(e){this.props.location!==e.location&&this.onLocationChange()},onLocationChange(){const{location:e,history:t}=this.props;navigator.onLine||/^\/(offline|collection\/)/.test(e.pathname)?this.props.onLocationChange():"/offline"!==e.pathname&&t.replace("/offline")},componentDidCatch(e){console.log(e)},render(){const{pageSlug:e,userDrawerVisible:t}=this.props;return r.a.createElement("div",{className:"mdl-layout__container"},r.a.createElement("div",{ref:"layout",className:m()("mdl-layout",`wgsa-page--${e}`,{"user-drawer-visible":t})},r.a.createElement(qd,null),r.a.createElement("main",{className:"mdl-layout__content"},r.a.createElement(df,null)),r.a.createElement(Cf,{visible:t}),r.a.createElement(d.a,null),r.a.createElement(bn,null),r.a.createElement(vn,null),r.a.createElement(gf,null)))}}));a.d(t,"b",(function(){return Nf}));const Nf=i()();t.a=()=>r.a.createElement(s.a,{history:Nf},r.a.createElement(o.a,{component:Sf}))},function(e,t,a){"use strict";var n=a(17),r=a.n(n),s=a(0),o=a.n(s),l=a(891),i=a(486),c=(a(963),a(3)),u=a(375),m=a(10),d=a(90),p=a(266),h=a(42),f=a(50),g=a(2);const b=e=>e.organisms,y=(e,t)=>e>t?1:e<t?-1:0,E=Object(g.createSelector)(b,({supportedOrganisms:e})=>e.sort((e,t)=>y(m.d.get(e.organismId).name,m.d.get(t.organismId).name))),v=Object(g.createSelector)(b,({allSpecies:e})=>e.sort((e,t)=>y(e.speciesName,t.speciesName)));var C=a(185);const w=({item:{organismId:e,totalCollections:t,totalGenomes:a,organism:n=m.d.get(e)}})=>o.a.createElement(u.a,{key:e,className:"wgsa-organism-card wgsa-card wgsa-card--bordered",to:`/organisms/${n.nickname}`,title:`${n.name} Homepage`},o.a.createElement("h3",{className:"wgsa-section-title"},o.a.createElement(m.a,{organismId:e})),o.a.createElement(d.a,{icon:"wgsa_genome"},o.a.createElement(u.a,{to:`/genomes?organismId=${e}`,title:"Browse Genomes"},a," Genome",1===a?"":"s")),o.a.createElement(d.a,{icon:"collections"},o.a.createElement(u.a,{to:`/collections?organismId=${e}`,title:"Browse Collections"},t," Collection",1===t?"":"s"))),S=({item:{speciesId:e,speciesName:t,totalGenomes:a}})=>o.a.createElement("div",{key:e,className:"wgsa-organism-card wgsa-card wgsa-card--bordered"},o.a.createElement("h3",{className:"wgsa-section-title"},o.a.createElement("em",null,t)),o.a.createElement(d.a,{icon:"wgsa_genome"},o.a.createElement(u.a,{to:`/genomes?speciesId=${e}`,title:"Browse Genomes"},a," Genome",1===a?"":"s"))),N=o.a.createClass({displayName:"Index",componentDidMount(){this.props.fetch()},render(){const{loading:e,supportedOrganisms:t,allSpecies:a}=this.props;return o.a.createElement("div",{className:"wgsa-page"},o.a.createElement(f.a,null,"Organisms"),o.a.createElement("h1",null,"Organisms"),e&&o.a.createElement(h.a,null),!!t.length&&o.a.createElement("h2",null,"Supported Organisms"),o.a.createElement(p.a,{density:"compact",items:t,template:w,keyProp:"organismId"}),!!a.length&&o.a.createElement("h2",null,"All Species"),o.a.createElement(p.a,{density:"compact",items:a,template:S,keyProp:"organismId"}))}});var O=Object(c.a)((function(e){return{loading:e.organisms.loading,supportedOrganisms:E(e),allSpecies:v(e)}}),(function(e){return{fetch:()=>e(Object(C.b)())}}))(N),x=(a(969),({children:e})=>o.a.createElement("div",{className:"wgsa-page-breadcrumb"},e.map((t,a)=>a<e.length-1?o.a.createElement("span",{key:a},t," » "):o.a.createElement("span",{key:a},t))));const k=o.a.createClass({displayName:"Details",componentDidMount(){this.props.fetch()},render(){const{organismId:e,totalGenomes:t,totalCollections:a}=this.props,{nickname:n,formattedName:r,definitionText:s,desc:l,imageCredit:i,taxonomy:c,name:d}=m.d.get(e);return o.a.createElement("div",{className:"wgsa-page mdl-grid"},o.a.createElement(f.a,null,d),o.a.createElement("div",{className:"mdl-cell mdl-cell--12-col"},o.a.createElement(x,null,o.a.createElement(u.a,{to:"/organisms"},"Organisms"),r),o.a.createElement("h1",{className:"wgsa-page-divider wgsa-page-title"},r),o.a.createElement("p",null,s)),o.a.createElement("div",{className:"mdl-cell mdl-cell--3-col"},o.a.createElement("div",{className:"wgsa-section-divider mdl-typography--text-center"},o.a.createElement("p",{className:"wgsa-avatar-image"},o.a.createElement("img",{src:`/images/${n}.jpg`})),i&&o.a.createElement("p",null,o.a.createElement("strong",null,"Image:")," ",i),o.a.createElement("p",null,o.a.createElement("strong",null,"Taxonomy ID:")," ",e),o.a.createElement("p",null,o.a.createElement("a",{href:`https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Tree&id=${e}`,target:"_blank",rel:"noopener"},"View in NCBI taxonomy browser")))),o.a.createElement("div",{className:"mdl-cell mdl-cell--6-col"},o.a.createElement("div",{className:"wgsa-section-divider"},o.a.createElement("h2",{className:"wgsa-section-title"},"About"),l),o.a.createElement("div",{className:"wgsa-section-divider"},o.a.createElement("h2",{className:"wgsa-section-title"},"Taxonomy"),o.a.createElement("ul",null,c.map(({taxId:e,scientificName:t,rank:a})=>o.a.createElement("li",{key:e},o.a.createElement("a",{href:`https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=Info&id=${e}`,target:"_blank",rel:"noopener"},t),"no rank"!==a&&` (${a})`))))),o.a.createElement("div",{className:"mdl-cell mdl-cell--3-col"},o.a.createElement("div",{className:"wgsa-section-divider"},o.a.createElement("h3",{className:"wgsa-section-title"},"Genomes"),o.a.createElement(u.a,{className:"wgsa-figure",to:`/genomes?organismId=${e}`,title:"Browse Genomes"},t)),o.a.createElement("div",{className:"wgsa-section-divider"},o.a.createElement("h3",{className:"wgsa-section-title"},"Collections"),o.a.createElement(u.a,{className:"wgsa-figure",to:`/collections?organismId=${e}`,title:"Browse Collections"},a)),o.a.createElement("div",{className:"wgsa-section-divider"},o.a.createElement("h3",{className:"wgsa-section-title"},"Reference Downloads"),o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement("a",{href:`/download/organism/${n}/core_representatives.csv`},"Core Representatives")),o.a.createElement("li",null,o.a.createElement("a",{href:`/download/organism/${n}/reference_fastas.zip`},"Sequences")),o.a.createElement("li",null,o.a.createElement("a",{href:`/download/organism/${n}/reference_annotations.zip`},"Annotations")),o.a.createElement("li",null,o.a.createElement("a",{href:`/download/organism/${n}/reference_metadata.csv`},"Metadata"))))))}});var _=Object(c.a)((function(e,{organismId:t}){return{...E(e).find(e=>e.organismId===t.toString())}}),(function(e){return{fetch:()=>e(Object(C.b)())}}))(k);a.d(t,"b",(function(){return L})),a.d(t,"a",(function(){return j}));const I=a(380),T="/organisms",L=I.map(({nickname:e})=>o.a.createElement(l.a,{key:`${e}-redirect`,exact:!0,from:`/${e}`,to:`${T}/${e}`})),j=I.map(({id:e,nickname:t})=>o.a.createElement(i.a,{key:t,path:`${T}/${t}`,component:t=>o.a.createElement(_,r()({},t,{organismId:e}))}));t.c=o.a.createElement(i.a,{exact:!0,path:T,component:O})},,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={LOADING:0,SUCCESS:1}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=(e,t,a)=>{const n=t.length,r=t.map(()=>0);for(let s=n-1;s>=0;s--)a[s]>e?r[s]=s:r[s]=r[t[s]];return r}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return l}));var n=a(14),r=a(13),s=a(6);const o=Object(n.b)("COLLECTION_CHANGE_ACCESS_LEVEL");function l(e){return(t,a)=>{const n=a(),{token:l}=Object(r.a)(n);t({type:o,payload:{promise:Object(s.a)("POST",`/api/collection/${l}/access`,{access:e}),access:e}})}}},,,,function(e,t,a){"use strict";var n=a(14),r=a(6);a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));const s=Object(n.b)("FETCH_ACCOUNT_ACTIVITY");function o(){return{type:s,payload:{promise:Object(r.a)("GET","/api/account/activity")}}}},,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(6);function r(e){return Object(n.a)("GET","/api/collection",e)}function s(e){return Object(n.a)("GET","/api/collection/summary",e)}function o(e,t){return Object(n.a)("POST",`/api/collection/${e}/binned`,{status:t})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(13),r=a(62),s=a(6),o=a(91),l=a(71);const i="SET_OFFLINE_STATUS";function c(e){return{type:i,payload:{status:e}}}function u(){return(e,t)=>{const a=t(),{uuid:r}=Object(n.a)(a);return e(c(o.a.SAVING)),Promise.all([navigator.serviceWorker.getRegistrations(),caches.has(Object(l.a)(r))]).then(([e,t])=>e.length&&t).then(t=>e(c(t?o.a.SAVED:o.a.UNSAVED))).catch(t=>{console.error(t),e(c(o.a.ERRORED))})}}function m(e,t){const a=Object(s.c)(`/api/collection/${t}`);return fetch(a,{credentials:"include"}).then(t=>t.ok?e.put(a,t):Promise.reject(new Error("Failed to fetch collection data")))}function d(){return(e,t)=>{const a=t(),i=Object(n.a)(a),{uuid:u,token:d}=i,p=Object(r.c)(a),h=Object(l.a)(u);e(c(o.a.SAVING)),navigator.serviceWorker.register("/service-worker.js").then(()=>caches.open(h)).then(e=>Promise.all([m(e,d),e.addAll(p.map(e=>Object(s.c)(`/api/collection/${d}/tree/${encodeURIComponent(e)}`)))])).then(()=>Object(l.f)(i)).then(()=>window.location.reload()).catch(t=>{throw caches.delete(h),e(c(o.a.ERRORED)),t})}}},,function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return i}));var n=a(6),r=a(15);const{clientId:s}=r.a;function o({id:e},t,a){return Object(n.b)("PUT",`/api/genome/${e}/assembly?${$.param({clientId:s})}`,t instanceof Uint8Array?"application/zip":"text/plain",t,a)}function l(e){return Object(n.a)("POST",`/api/genome/${e}/uploaded`)}function i(e,t){return Object(n.a)("POST",`/api/genome/${e}`,t)}},function(e,t,a){"use strict";a(967);var n=a(0),r=a.n(n),s=a(4),o=a.n(s),l=({items:e,template:t,keyProp:a,density:n="comfortable"})=>r.a.createElement("div",{className:o()("wgsa-static-grid",`wgsa-${n}-grid`)},e.map(e=>r.a.createElement(t,{key:e[a],item:e})));a.d(t,"a",(function(){return l}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));const n="COLLECTION",r="GENOME"},,,,,,,function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(3),o=a(95),l=a(164),i=a(126);t.default=Object(s.a)((function(e,{organismId:t,title:a}){const n=Object(o.a)(e);return{isDeployed:Object(l.b)()||!a?i.taxIdMap.has(t):n&&n.has(t)}}))(({isDeployed:e,organismId:t,title:a,shortName:n=!1,children:s=a})=>r.a.createElement("span",{title:a},e?i.taxIdMap.get(t)[n?"formattedShortName":"formattedName"]:s))},,,function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(4),o=a.n(s);const l=({item:e,onClick:t,renderLabel:a})=>{const{value:n,label:s=n,title:l=s,count:i,active:c}=e;return r.a.createElement("button",{title:l,className:o()("mdl-chip mdl-chip--contact",{"mdl-chip--active":c}),onClick:()=>t(n)},r.a.createElement("span",{className:"mdl-chip__contact"},function(e){return e>9999?`${Math.round(e/1e3)}K`:e}(i)),r.a.createElement("span",{className:"mdl-chip__text"},a(e)))};function i({autoSelect:e=!0,filterActive:t,summary:a=[],totalVisible:n}){return t&&1===a.length&&a[0].count===n&&e?a[0]:a.find(e=>e.active)}function c({children:e,disabled:t,hidden:a,summary:n=[]}){return!e&&(!!a||!t&&0===n.length)}const u=r.a.createClass({displayName:"FilterSection",getInitialState(){return{activeItem:i(this.props),isHidden:c(this.props),isOpen:!1}},componentWillReceiveProps(e){const{activeItem:t,isHidden:a,isOpen:n}=this.state;this.setState({activeItem:e.isLoading&&!t?t:i(e),isHidden:e.isLoading?a:c(e),isOpen:!e.isLoading&&n})},componentDidUpdate(e,t){!t.isOpen&&this.state.isOpen&&this.itemFilterInput&&(componentHandler.upgradeElement(this.itemFilterInput.parentElement),this.itemFilterInput.focus())},toggle(e){this.setState({isOpen:!e})},render(){if(this.state.isHidden)return null;const{children:e,filterKey:t,heading:a,icon:n,summary:s=[],updateFilter:i,renderLabel:c=(({value:e,label:t=e})=>t)}=this.props,{activeItem:u,isOpen:m}=this.state,d=e=>i(t,e);if(u){const{value:e,label:t=e,title:s,activeTitle:o=s}=u,l=!u.active;let i=o||`${a}: ${t}`;return l&&(i+=" (selected automatically)"),r.a.createElement("section",{className:"wgsa-filter-section is-active",style:l?void 0:{cursor:"pointer"}},r.a.createElement("header",{title:i,onClick:l?null:()=>d(e)},r.a.createElement("i",{className:"material-icons",title:a},n),r.a.createElement("span",null,c({...u,active:!0})),!l&&r.a.createElement("i",{className:"material-icons"},"filter_list")))}const{disabled:p,disabledText:h,className:f,headerComponent:g}=this.props;return p?r.a.createElement("section",{className:"wgsa-filter-section is-disabled"},r.a.createElement("header",{title:h},r.a.createElement("i",{className:"material-icons",title:a},n),r.a.createElement("span",null,a))):r.a.createElement("section",{className:o()("wgsa-filter-section",f,{"is-open":m})},r.a.createElement("header",{onClick:()=>this.toggle(m)},r.a.createElement("i",{className:"material-icons",title:a},n),g?r.a.createElement(g,{...this.props,isOpen:m}):r.a.createElement("span",null,a),r.a.createElement("button",{className:"mdl-button mdl-button--icon"},r.a.createElement("i",{className:"material-icons"},m?"expand_less":"expand_more"))),m&&r.a.createElement(r.a.Fragment,null,e||s.map(e=>e.active?null:r.a.createElement(l,{key:e.value,item:e,onClick:d,renderLabel:c}))))}});t.a=u},,,,,,,,function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(82);t.a=r.a.createClass({displayName:"Hit.react",componentDidMount(){const{id:e}=this.props;Object(s.b)(e)&&window&&window.Clipboard&&(this.clipboard=new window.Clipboard(this.el,{text:()=>e}))},render(){const{id:e,showNovelHash:t}=this.props;return Object(s.b)(e)?r.a.createElement("span",{ref:e=>{this.el=e},onClick:e=>e.stopPropagation(),className:"wgsa-mlst-profile-hit is-novel",title:`Novel allele: ${e}\n(click to copy)`},"(",t?e.slice(0,4):"novel",")"):r.a.createElement("span",{className:"wgsa-mlst-profile-hit"},e)}})},function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(4),o=a.n(s);t.a=({moveToBin:e,restoreFromBin:t,primary:a,className:n,item:s={}})=>"me"!==s.owner?null:s.binned?r.a.createElement("button",{className:"mdl-button mdl-button--icon",onClick:t,title:"Restore from bin"},r.a.createElement("i",{className:"material-icons"},"restore")):a?r.a.createElement("button",{className:"mdl-button mdl-button--primary wgsa-button--text",onClick:e,title:"Move to bin"},"Move to Bin"):r.a.createElement("button",{className:o()("mdl-button mdl-button--icon",n),onClick:e,title:"Move to bin"},r.a.createElement("i",{className:"material-icons"},"delete"))},,,,,,,,,function(e,t,a){"use strict";var n=a(0),r=a.n(n);t.a=({title:e,viewBox:t="0 0 64 64"})=>r.a.createElement("svg",{className:"material-icons",title:e,viewBox:t,y:"0px",x:"0px"},r.a.createElement("path",{style:{fill:"currentColor",fillOpacity:1,strokeWidth:.83934414},d:"M 35.804746,32.000009 C 39.48276,29.315777 43.105355,26.464515 45.98011,23.029095 50.083665,18.125646 52.077953,12.685841 52.077953,6.4 H 32 16.373933 11.922047 c 0,6.285841 1.994288,11.725646 6.097843,16.629095 2.874755,3.43542 6.496511,6.286682 10.175364,8.970914 -3.678013,2.684215 -7.300609,5.535475 -10.175364,8.970897 C 13.916335,45.874354 11.922047,51.314159 11.922047,57.6 H 32 47.625242 52.07711 c 0,-6.285841 -1.994288,-11.725646 -6.097,-16.629094 C 43.105355,37.535484 39.4836,34.684224 35.804746,32.000009 Z M 20.260937,18.643515 c -0.982885,-1.376524 -1.813823,-2.848738 -2.452576,-4.451873 -0.419674,-1.053381 -0.754573,-2.16384 -0.996302,-3.338929 H 32 47.187941 c -0.241729,1.175089 -0.576628,2.285548 -0.996301,3.338929 H 32 17.808361 c 0.638753,1.603135 1.469691,3.075349 2.452576,4.451873 H 32 43.739904 c -0.842692,1.180954 -1.79704,2.290572 -2.8353,3.349823 v -0.01045 H 32 23.096238 v 0.01045 c -1.039102,-1.059251 -1.99345,-2.168869 -2.835301,-3.349823 z m 7.928449,7.791641 H 32 35.810614 C 34.577627,27.389482 33.298457,28.324521 32,29.25954 30.701544,28.323681 29.422373,27.389482 28.189386,26.435156 Z M 32,34.741301 c 1.298457,0.935019 2.577627,1.870058 3.810614,2.824384 H 32 28.189386 C 29.422373,36.611359 30.701544,35.67632 32,34.741301 Z m -8.914678,7.276277 H 32 40.913838 c 1.034915,1.055884 1.985055,2.162137 2.825226,3.338907 H 32 20.260937 c 0.839344,-1.17677 1.789468,-2.283023 2.824385,-3.338907 z M 47.187941,53.148114 H 32 16.812059 C 17.053788,51.97304 17.388687,50.862581 17.808361,49.8092 H 32 46.19164 c 0.419673,1.053381 0.754572,2.16384 0.996301,3.338914 z"}))},,function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));const n=Symbol("STALE_RESULT"),r=()=>e=>t=>{const{type:a,payload:r}=t;if(!r||!r.promise||!r.promise.then)return e(t);const{promise:s,...o}=r;return e(e=>(e({type:a.ATTEMPT,payload:{...o}}),s.then(t=>(t!==n&&e({type:a.SUCCESS,payload:{result:t,...o}}),t),t=>(e({type:a.FAILURE,payload:{error:t,...o}}),t))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(2);const r=e=>e.viewer.metadata,s=Object(n.createSelector)(r,e=>Object.keys(e).length)},,,function(e,t,a){"use strict";var n=a(102),r=a.n(n),s=a(33);const o={ids:null,lasso:!1,maxBlockLength:160,maxFontSize:64,maxNodeSize:64,minBlockLength:1,minFontSize:1,minNodeSize:1,path:null,subtreeIds:null,phylocanvas:{...r.a.defaults,fontSize:s.a.FONT_SIZE,fontFamily:s.a.FONT,metadata:{blockLength:14,headerFontWeight:"500",showLabels:!1,showHeaders:!1},nodeSize:s.a.NODE_SIZE,padding:32,renderInternalLabels:!1,renderLeafBorders:!0,renderLeafLabels:!1,styleInternalNodes:!1,styleLeafNodes:!0,styleNodeLines:!1,type:"rc"}};t.a=(e=o,t)=>{switch(t.type){case"LIBMR PHYLOCANVAS STATE":{let a=e.ids,n=e.subtreeIds;return t.payload.rootId&&t.payload.rootId!==e.phylocanvas.rootId?(n=t.payload.ids,a=null):Array.isArray(t.payload.ids)&&(a=t.payload.ids),null===t.payload.rootId&&e.phylocanvas.rootId&&(a=null,n=null),{...e,ids:a,subtreeIds:n,phylocanvas:{...e.phylocanvas,...t.payload,metadata:{...e.phylocanvas.metadata,...t.payload.metadata||{}}}}}case"LIBMR TREE FILTER":return{...e,ids:t.payload.ids||null,path:void 0!==t.payload?t.payload.path:e.path};case"LIBMR TREE LASSO":return{...e,lasso:t.payload.lasso,ids:!1===t.payload.lasso?null:e.ids,path:!1===t.payload.lasso?null:e.path};default:return e}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));const n="TOGGLE_ABOUT_COLLECTION";function r(e){return{type:n,payload:{isOpen:e}}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));const n="COLLECTION_SUMMARY_TOGGLE";function r(e){return{type:n,payload:e}}},,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));const n="SHOW_TIMELINE";function r(){return{type:n,payload:{}}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(6),r=a(161);function s(e,t){return Object(n.a)("GET",`/api/collection/${e}/tree/${encodeURIComponent(t)}`).then(e=>({...e,genomes:Object(r.a)(e.genomes)}))}function o(e){return Object(n.a)("GET",`/api/collection/position/${e}`)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(6);function r(e){return Object(n.a)("GET",`/api/upload/${e}/position`)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));var n=a(6);function r(e,t,a){return Object(n.a)("PUT","/api/collection",{organismId:t,...a,genomeIds:e.map(e=>e.id)})}function s(e,t){return Object(n.a)("POST","/api/collection/verify",{organismId:t,genomeIds:e.map(e=>e.id)})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));const n="SHOW_METRIC";function r(e){return{type:n,payload:{metric:e}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r}));const n="UPLOAD_TOGGLE_ERRORS";function r(){return{type:n}}},function(e,t,a){"use strict";function n(e){this.message=e}a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return o}));const r=/^[ACGTURYKMSWBDHVN]+$/i,s=/^>|^;/;function o(e){const t=e.replace(/\r/g,""),a=t.split("\n");let o=!1;for(let e=0;e<a.length;e++){const t=a[e];if(0===t.length)continue;if(!o&&">"===t[0]){o=!0;continue}if(s.test(t))continue;const l=r.test(t);if(!o&&l)throw new n("First contig header not found");if(!l)throw new n(`Invalid sequence data at line ${e+1}`)}return t}},,,function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(478),o=a.n(s),l=a(479),i=a.n(l),c=a(165),u=(a(955),a(957),a(480)),m=a.n(u),d=a(4),p=a.n(d),h=a(233),f=a.n(h),g=a(242),b=a.n(g),y=a(243),E=a.n(y),v=a(481),C=a.n(v),w=a(482),S=a.n(w),N=a(49),O=r.a.createClass({displayName:"MonthYearSelector.react",getInitialState(){return{...this.parseDates(this.props)}},componentWillReceiveProps(e){this.props.editing&&!e.editing?this.update():this.setState(this.parseDates(e))},setMonth(e){const t=parseInt(e.target.value,10);this.setState({month:t})},setYear(e){const t=parseInt(e.target.value,10);this.setState({year:t})},parseDates:({date:e,min:t,max:a})=>({year:b()(e),minYear:b()(t),maxYear:b()(a),month:E()(e),minMonth:E()(t),maxMonth:E()(a)}),update(){const{year:e,month:t}=this.state,a=new Date(e,t),n=C()(this.props.max,S()(a,this.props.min)),r=b()(n),s=E()(n),o=b()(this.props.date),l=E()(this.props.date);r===o&&s===l||this.props.update(n)},renderMonths:()=>N.e.map(({text:e,value:t})=>r.a.createElement("option",{key:e,value:t},e.slice(0,3))),render(){if(!this.props.date)return null;if(this.props.editing){const{year:e,minYear:t,maxYear:a,month:n}=this.state;return r.a.createElement("form",{ref:e=>{this.form=e},className:"wgsa-month-year-selector",onSubmit:e=>e.preventDefault(),onClick:e=>e.stopPropagation()},r.a.createElement("select",{name:"month",value:n,onChange:this.setMonth},this.renderMonths()),r.a.createElement("input",{name:"year",type:"number",min:t,max:a,value:e,onChange:this.setYear}),r.a.createElement("button",{type:"submit",title:"Set Date"},r.a.createElement("i",{className:"material-icons"},"checked")))}return r.a.createElement("button",{onClick:this.props.onClick,title:"Edit Date"},f()(this.props.date,"MMM YYYY"))}}),x=r.a.createClass({displayName:"DateFilter.react",getInitialState(){const[e,t]=this.props.values;return{min:e,max:t}},componentWillReceiveProps(e){const[t,a]=e.values;this.setState({min:t,max:a})},isInactive(){const[e,t]=this.props.values;return!e&&!t},render(){const{bounds:e,values:t=e,onChangeMin:a,onChangeMax:n}=this.props,s=Object(N.a)(e[0]),o=Object(N.a)(e[1]),l=this.state.min||e[0],i=this.state.max||e[1],c=Object(N.a)(l),u=Object(N.a)(i);return r.a.createElement("div",{className:"wgsa-date-range"},r.a.createElement(m.a,{id:"genome-date-filter",min:s,max:o,value:[c,u],onChange:([e,t])=>this.setState({min:Object(N.d)(e),max:Object(N.d)(t)}),onAfterChange:([e,r])=>{e!==(t[0]?Object(N.a)(t[0]):s)&&a(Object(N.d)(e)),r!==(t[1]?Object(N.a)(t[1]):o)&&n(Object(N.d)(r))},className:p()({"rc-slider--inactive":this.isInactive()})}),r.a.createElement("label",{htmlFor:"genome-date-filter",onSubmit:()=>this.setState({editing:null})},r.a.createElement(O,{date:l,min:e[0],max:i,update:a,onClick:()=>this.setState({editing:"min"}),editing:"min"===this.state.editing}),r.a.createElement(O,{date:i,min:l,max:e[1],update:n,onClick:()=>this.setState({editing:"max"}),editing:"max"===this.state.editing})))}}),k=({summary:e,updateFilter:t})=>{if(e){const a=!(!e.values[0]&&!e.values[1]);return r.a.createElement(c.a,{heading:"Date",icon:"date_range",expanded:a},r.a.createElement(x,{bounds:e.bounds,values:e.values,onChangeMin:e=>t("minDate",o()(e).toISOString()),onChangeMax:e=>t("maxDate",i()(e).toISOString())}))}return null};a.d(t,"a",(function(){return k}))},function(e,t,a){"use strict";var n=a(0),r=a.n(n),s=a(375),o=a(213),l=a.n(o),i=a(259),c=a.n(i),u=a(90),m=a(10),d=a(214),p=a(17),h=a.n(p),f=a(3),g=a(286),b=a(73),y=a(120),E=a(63),v=a(75),C=a(262),w=a(158);function S(e,t,a=!0){return(n,s)=>{const o=Object(v.b)(s()),l=()=>n(S(e,!t,!1));return Object(C.a)(e.token,t).then(()=>Promise.all([n(b.c(o)),n(b.d(o)),n(Object(y.b)())])).then(()=>a&&n(Object(E.c)(function({title:e,binned:t},a){return{action:{label:"Undo",onClick:a},message:r.a.createElement("span",null,e?r.a.createElement(w.a,{tag:"strong"},e):"Collection"," ",t?"restored from":"moved to"," bin.")}}(e,l)))).catch(e=>{throw n(Object(E.c)({message:"Something went wrong, please try again later."})),e})}}var N=Object(f.a)(null,(function(e,{collection:t}){return{moveToBin:()=>e(S(t,!0)),restoreFromBin:()=>e(S(t,!1))}}))(({collection:e={},...t})=>r.a.createElement(g.a,h()({item:e},t))),O=a(215);const x={READY:"done",PROCESSING:"hourglass_empty",FAILED:"warning"},k={READY:"Ready",PROCESSING:"In progress",FAILED:"Failed"};t.a=({item:e,footerLink:t})=>{const a=new Date,{createdAt:n,status:o,size:i}=e;return r.a.createElement(u.b,{className:"wgsa-card--bordered"},r.a.createElement("span",{className:"wgsa-card-metadata-overview"},r.a.createElement(u.a,{title:"Size",icon:"wgsa_genome"},i," genome",1===i?"":"s"),r.a.createElement(u.a,{tooltip:n.toLocaleString(),icon:"access_time"},c()(n,a)," ago"),"READY"!==o&&r.a.createElement(u.a,{title:"Status",icon:x[o]},k[o])),e.title?r.a.createElement(O.a,{level:"2",className:"wgsa-card-title wgsa-overflow-fade"},e.title):r.a.createElement("h2",{className:"wgsa-card-title"},"(Untitled Collection)"),r.a.createElement("p",{className:"wgsa-card-subtitle"},r.a.createElement(m.a,{organismId:e.organismId})),e.description?r.a.createElement(l.a,{className:"wgsa-card-description",source:e.description}):r.a.createElement("p",null,"(no description)"),r.a.createElement("div",{className:"wgsa-card-footer wgsa-card-footer--fixed"},r.a.createElement(s.a,{className:"mdl-button mdl-button--primary wgsa-button--text",to:`/collection/${e.token}`},"View Collection"),t||("other"===(p=e).owner?r.a.createElement(d.a,{className:"mdl-button wgsa-button--text",pmid:p.pmid}):r.a.createElement(N,{collection:p}))));var p}},,function(e,t,a){"use strict";a(951);var n=a(0),r=a.n(n),s=a(4),o=a.n(s),l=a(209),i=a.n(l);class c extends r.a.Component{constructor(e){super(e),this.onChange=e=>{this.props.textOnChange(e),this.textOnChangeEffect(e)},this.textOnChangeEffect=i()(e.textOnChangeEffect,250)}render(){const{active:e,children:t,clear:a,headerComponent:n,prefilter:s,summary:l,textValue:i,updateFilter:c}=this.props;return r.a.createElement("aside",{className:o()("wgsa-filter",{"wgsa-filter--active":e})},r.a.createElement("header",{className:"wgsa-filter__header"},r.a.createElement("label",{className:"wgsa-filter__search"},r.a.createElement("i",{className:"material-icons"},"search"),r.a.createElement("input",{type:"text",placeholder:"Search",value:i,onChange:e=>this.onChange(e.target.value)}))),r.a.createElement("div",{className:"wgsa-filter__content"},t.map(t=>t?r.a.cloneElement(t,{filterActive:e,headerComponent:n,isLoading:l.loading,summary:t.props.summary||l[t.props.filterKey],totalVisible:l.visible,updateFilter:t.props.updateFilter||c}):null),"bin"===s&&r.a.createElement("p",{className:"pw-bin-notice"},"Binned items are removed after 30 days.")),r.a.createElement("footer",{className:"wgsa-filter__footer"},r.a.createElement("button",{className:"mdl-button mdl-js-button mdl-button--primary",onClick:a},"Clear Filters")))}}var u=c;a.d(t,"a",(function(){return u}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=[{id:"485",speciesId:"485",genusId:"482",nickname:"neigo"},{id:"666",speciesId:"666",genusId:"662",nickname:"vibcl"},{id:"1280",speciesId:"1280",genusId:"1279",nickname:"saureus"},{id:"1313",speciesId:"1313",genusId:"1301",nickname:"strpn"},{id:"1336",speciesId:"1336",genusId:"1301",nickname:"sequi"},{id:"1646",speciesId:"1646",genusId:"1645",nickname:"rensm"},{id:"573",speciesId:"573",genusId:"570",nickname:"klepn"},{id:"498019",speciesId:"498019",genusId:"36910",nickname:"canar"},{id:"64320",speciesId:"64320",genusId:"11051",nickname:"zikv",simple:!0},{id:"90370",speciesId:"28901",genusId:"590",nickname:"salty"}]},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n);const s="Candida auris",o=r.a.createElement("em",null,s),l=r.a.createElement("em",null,"C. auris");t.default={name:s,formattedName:o,shortName:"C. auris",formattedShortName:l,maxGenomeSize:4*Math.pow(10,6),desc:r.a.createElement("p",null,r.a.createElement("strong",null,o)," https://en.wikipedia.org/wiki/Candida_auris"),taxonomy:[{taxId:131567,scientificName:"Cellular organisms",rank:"no rank"},{taxId:2759,scientificName:"Eukaryota",rank:"superkingdom"},{taxId:4890,scientificName:"Ascomycota",rank:"phylum"},{taxId:4891,scientificName:"Saccharomycetes",rank:"class"},{taxId:4892,scientificName:"Saccharomycetales",rank:"order"},{taxId:27319,scientificName:"Metschnikowiaceae",rank:"family"},{taxId:36910,scientificName:"Clavispora",rank:"genus"},{taxId:498019,scientificName:"Candida auris",rank:"species"}],publicMetadataColumnNames:[],collections:[],uiOptions:{noMLST:!0}}},,,,function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n);const s="Klebsiella pneumoniae",o=r.a.createElement("em",null,s),l=r.a.createElement("em",null,"K. pneumoniae");t.default={name:s,formattedName:o,shortName:"K. pneumoniae",formattedShortName:l,maxGenomeSize:4*Math.pow(10,6),desc:r.a.createElement("p",null,r.a.createElement("strong",null,o)," ","https://en.wikipedia.org/wiki/Klebsiella_pneumoniae"),taxonomy:[{taxId:131567,scientificName:"Cellular organisms",rank:"no rank"},{taxId:2,scientificName:"Bacteria",rank:"superkingdom"},{taxId:1224,scientificName:"Proteobacteria",rank:"phylum"},{taxId:1236,scientificName:"Gammaproteobacteria",rank:"class"},{taxId:91347,scientificName:"Enterobacteriales",rank:"order"},{taxId:543,scientificName:"Enterobacteriaceae",rank:"family"},{taxId:570,scientificName:"Klebsiella",rank:"genus"},{taxId:573,scientificName:"Klebsiella pneumoniae",rank:"species"}],publicMetadataColumnNames:[],collections:[],uiOptions:{noPopulation:!0,noAMR:!0,kleborate:!0,inctyper:!0}}},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n);const s="Neisseria gonorrhoeae",o=r.a.createElement("em",null,s),l=r.a.createElement("em",null,"N. gonorrhoeae");t.default={name:s,formattedName:o,shortName:"N. gonorrhoeae",formattedShortName:l,maxGenomeSize:4*Math.pow(10,6),desc:r.a.createElement("p",null,r.a.createElement("strong",null,o)," is a species of gram-negative coffee bean-shaped diplococci bacteria responsible for the sexually transmitted infection gonorrhea."),taxonomy:[{taxId:131567,scientificName:"Cellular organisms",rank:"no rank"},{taxId:2,scientificName:"Bacteria",rank:"superkingdom"},{taxId:1224,scientificName:"Proteobacteria",rank:"phylum"},{taxId:28216,scientificName:"Betaproteobacteria",rank:"class"},{taxId:206351,scientificName:"Neisseriales",rank:"order"},{taxId:481,scientificName:"Neisseriaceae",rank:"family"},{taxId:482,scientificName:"Neisseria",rank:"genus"},{taxId:485,scientificName:"Neisseria gonorrhoeae",rank:"species"}],publicMetadataColumnNames:[],collections:[],uiOptions:{ngMast:!0,noPopulation:!0}}},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n);const s="Renibacterium salmoninarum",o=r.a.createElement("em",null,s),l=r.a.createElement("em",null,"R. salmoninarum");t.default={name:s,formattedName:o,shortName:"R. salmoninarum",formattedShortName:l,desc:r.a.createElement("p",null,o," is a member of the Micrococcaceae family. It is a Gram-positive, intracellular bacterium that causes disease in young salmonid fish."),taxonomy:[{taxId:131567,scientificName:"Cellular organisms",rank:"no rank"},{taxId:2,scientificName:"Bacteria",rank:"superkingdom"},{taxId:1783272,scientificName:"Terrabacteria group",rank:"no rank"},{taxId:201174,scientificName:"Actinobacteria",rank:"phylum"},{taxId:1760,scientificName:"Actinobacteria",rank:"class"},{taxId:85006,scientificName:"Micrococcales",rank:"order"},{taxId:1268,scientificName:"Micrococcaceae",rank:"family"},{taxId:1645,scientificName:"Renibacterium",rank:"genus"},{taxId:1646,scientificName:"Renibacterium salmoninarum",rank:"species"}],maxGenomeSize:4*Math.pow(10,6),publicMetadataColumnNames:[],collections:[],uiOptions:{noMLST:!0,noAMR:!0}}},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n);const s="Salmonella Typhi",o=(()=>{const[e,t]=s.split(" ");return r.a.createElement("span",null,r.a.createElement("em",null,e)," ",t)})(),l=(()=>{const[e,t]=s.split(" ");return r.a.createElement("span",null,r.a.createElement("em",null,e[0],".")," ",t)})();t.default={name:s,formattedName:o,shortName:"S. Typhi",formattedShortName:l,definitionText:r.a.createElement("span",null,"A common serovar of ",r.a.createElement("em",null,"Salmonella enterica")," subsp. ",r.a.createElement("em",null,"enterica"),"."),desc:r.a.createElement("span",null,r.a.createElement("p",null,r.a.createElement("strong",null,r.a.createElement("em",null,"Salmonella enterica")," subsp. ",r.a.createElement("em",null,"enterica")," serovar Typhi")," causes typhoid (enteric) fever, a disease that affects approximately 20-30 million of new patients every year,",r.a.createElement("sup",null,"[1,2]")," predominantly in Asia and sub-Saharan Africa. Mortality rates in patients who are not administered antibiotic treatment can be as high as 26%.",r.a.createElement("sup",null,"[1]")," The emergence of multi-drug resistant Salmonella Typhi and the shortage of local surveillance data from endemic regions both challenge the management of typhoid fever."),r.a.createElement("p",null,"For more information go to ",r.a.createElement("a",{href:"http://www.stoptyphoid.org",target:"_blank",rel:"noopener"},"www.stoptyphoid.org"),"."),r.a.createElement("ol",{className:"wgsa-species-citations"},r.a.createElement("li",null,r.a.createElement("cite",null,"Wain J., Hendriksen R.S., Mikoleit M.L., Keddy K.H. and Ochiai R.L. 2015. Typhoid Fever. Lancet 385:1136-1145.")),r.a.createElement("li",null,r.a.createElement("cite",null,"Crump J.A. and Mintz E.D. 2010. Global trends in typhoid and paratyphoid fever. Clinical Infectious Diseases 50:241-246.")))),imageCredit:"Dave Goulding",taxonomy:[{taxId:131567,scientificName:"Cellular organisms",rank:"no rank"},{taxId:2,scientificName:"Bacteria",rank:"superkingdom"},{taxId:1224,scientificName:"Proteobacteria",rank:"phylum"},{taxId:1236,scientificName:"Gammaproteobacteria",rank:"class"},{taxId:91347,scientificName:"Enterobacterales",rank:"order"},{taxId:543,scientificName:"Enterobacteriaceae",rank:"family"},{taxId:590,scientificName:"Salmonella",rank:"genus"},{taxId:28901,scientificName:"Salmonella enterica",rank:"species"},{taxId:59201,scientificName:"Salmonella enterica subsp. enterica",rank:"subspecies"},{taxId:90370,scientificName:"Salmonella enterica subsp. enterica serovar Typhi",rank:"no rank"}],publicMetadataColumnNames:[],collections:[],amrOptions:{customLabels:{SIL:"OTHER"},hiddenColumns:new Set(["SIL"]),paarOverrides:[{gene:"tetR(A)",from:"SIL",to:"TCY"},{gene:"tetR(B)",from:"SIL",to:"TCY"}]},uiOptions:{genotyphi:!0,inctyper:!0}}},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n);const s="Staphylococcus aureus",o=r.a.createElement("em",null,s),l=r.a.createElement("em",null,"S. aureus");t.default={name:s,formattedName:o,shortName:"S. aureus",formattedShortName:l,desc:r.a.createElement("p",null,r.a.createElement("strong",null,o)," is a Gram-positive microorganism. While the nasal colonisation by ",r.a.createElement("em",null,"Staphylococcus aureus")," is fairly widespread and occurs asymptomatically, ",r.a.createElement("em",null,"Staphylococcus aureus")," can also transform into a pathogen causing a diverse infections ranging from mild skin infections to life-threatening conditions. ",r.a.createElement("em",null,"Staphylococcus aureus")," in its methicillin-sensitive (MSSA) form but especially in its methicillin-resistant (MRSA) or even multi-resistant form are threatening the community and healthcare system worldwide and it has reached the status of being one of the most common causative agents for infectious disease."),taxonomy:[{taxId:131567,scientificName:"Cellular organisms",rank:"no rank"},{taxId:2,scientificName:"Bacteria",rank:"superkingdom"},{taxId:1783272,scientificName:"Terrabacteria group",rank:"no rank"},{taxId:1239,scientificName:"Firmicutes",rank:"phylum"},{taxId:91061,scientificName:"Bacilli",rank:"class"},{taxId:1385,scientificName:"Bacillales",rank:"order"},{taxId:90964,scientificName:"Staphylococcaceae",rank:"family"},{taxId:1279,scientificName:"Staphylococcus",rank:"genus"},{taxId:1280,scientificName:"Staphylococcus aureus",rank:"species"}],maxGenomeSize:3.5*Math.pow(10,6),gcRange:{min:31,max:35},uiOptions:{inctyper:!0},publicMetadataColumnNames:["ena study","ena run","alternative isolate id","country","city","geo accuracy","host","mlst","mrsa"]}},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n);const s="Streptococcus equi",o=r.a.createElement("em",null,s),l=r.a.createElement("em",null,"S. equi");t.default={name:s,formattedName:o,shortName:"S. equi",formattedShortName:l,desc:r.a.createElement("p",null,"The bacterium, ",r.a.createElement("strong",null,"Streptococcus equi"),", is what causes the disease in equine species (horses, donkeys, mules) called strangles. It got its name because historically, affected horses were sometimes suffocated from inflamed lymph nodes in their upper airway and trachea."),taxonomy:[{taxId:131567,scientificName:"Cellular organisms",rank:"no rank"},{taxId:2,scientificName:"Bacteria",rank:"superkingdom"},{taxId:1783272,scientificName:"Terrabacteria group",rank:"no rank"},{taxId:1239,scientificName:"Firmicutes",rank:"phylum"},{taxId:91061,scientificName:"Bacilli",rank:"class"},{taxId:148942,scientificName:"Lactobacillales",rank:"order"},{taxId:1300,scientificName:"Staphylococcaceae",rank:"family"},{taxId:1301,scientificName:"Staphylococcus",rank:"genus"},{taxId:119603,scientificName:"Staphylococcus",rank:"genus"},{taxId:1280,scientificName:"Streptococcus dysgalactiae group",rank:"species group"},{taxId:1336,scientificName:"Streptococcus equi",rank:"species"}],maxGenomeSize:15*Math.pow(10,3),publicMetadataColumnNames:[],uiOptions:{noPopulation:!0,noAMR:!0}}},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n);const s="Streptococcus pneumoniae",o=r.a.createElement("em",null,s),l=r.a.createElement("em",null,"S. pneumoniae");t.default={name:s,formattedName:o,shortName:"S. pneumoniae",formattedShortName:l,desc:r.a.createElement("p",null,o,", or pneumococcus, is a Gram-positive, alpha-hemolytic, facultative anaerobic member of the genus ",r.a.createElement("em",null,"Streptococcus"),". A significant human pathogenic bacterium, ",l," was recognized as a major cause of pneumonia in the late 19th century, and is the subject of many humoral immunity studies."),taxonomy:[{taxId:131567,scientificName:"Cellular organisms",rank:"no rank"},{taxId:2,scientificName:"Bacteria",rank:"superkingdom"},{taxId:1783272,scientificName:"Terrabacteria group",rank:"no rank"},{taxId:1239,scientificName:"Firmicutes",rank:"phylum"},{taxId:91061,scientificName:"Bacilli",rank:"class"},{taxId:186826,scientificName:"Lactobacillales",rank:"order"},{taxId:1300,scientificName:"Streptococcaceae",rank:"family"},{taxId:1301,scientificName:"Streptococcus",rank:"genus"},{taxId:1313,scientificName:"Streptococcus pneumoniae",rank:"species"}],maxGenomeSize:3*Math.pow(10,6),publicMetadataColumnNames:[],collections:[],uiOptions:{}}},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n);const s="Vibrio cholerae",o=r.a.createElement("em",null,s),l=r.a.createElement("em",null,"V. cholerae");t.default={name:s,formattedName:o,shortName:"V. cholerae",formattedShortName:l,desc:r.a.createElement("p",null,"TBD."),taxonomy:[{taxId:131567,scientificName:"Cellular organisms",rank:"no rank"},{taxId:2,scientificName:"Bacteria",rank:"superkingdom"},{taxId:1224,scientificName:"Proteobacteria",rank:"phylum"},{taxId:1236,scientificName:"Gammaproteobacteria",rank:"class"},{taxId:135623,scientificName:"Vibrionales",rank:"order"},{taxId:641,scientificName:"Vibrionaceae",rank:"family"},{taxId:662,scientificName:"Vibrio",rank:"genus"},{taxId:666,scientificName:"Vibrio cholerae",rank:"species"}],maxGenomeSize:7*Math.pow(10,6),publicMetadataColumnNames:[],collections:[],uiOptions:{}}},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n);const s=r.a.createElement("em",null,"Zika virus"),o=r.a.createElement("em",null,"Zika");t.default={name:"Zika virus",formattedName:s,shortName:"Zika",formattedShortName:o,desc:r.a.createElement("p",null,r.a.createElement("strong",null,"Zika virus (ZIKV)")," is a member of the virus family ",r.a.createElement("em",null,"Flaviviridae"),". It is spread by daytime-active ",r.a.createElement("em",null,"Aedes")," mosquitoes, such as ",r.a.createElement("em",null,"A. aegypti")," and ",r.a.createElement("em",null,"A. albopictus"),". Its name comes from the Zika Forest of Uganda, where the virus was first isolated in 1947."),taxonomy:[{taxId:10239,scientificName:"Viruses",rank:"superkingdom"},{taxId:439488,scientificName:"ssRNA viruses",rank:"no rank"},{taxId:35278,scientificName:"ssRNA positive-strand viruses, no DNA stage",rank:"no rank"},{taxId:11050,scientificName:"Flaviviridae",rank:"family"},{taxId:11051,scientificName:"Flavivirus",rank:"genus"},{taxId:64320,scientificName:"Zika virus",rank:"species"}],maxGenomeSize:15*Math.pow(10,3),publicMetadataColumnNames:[],uiOptions:{noPopulation:!0,noMLST:!0,noAMR:!0}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports=function(e){const{name:t="",year:a=null,month:n=null,day:r=null,latitude:s=null,longitude:o=null,pmid:l="",userDefined:i={}}=e;let c;if(t&&"string"!=typeof t)c="name is wrong type";else if(t&&t.length>256)c="name is too long";else if(l&&"string"!=typeof l)c="pmid is wrong type";else if(l&&l.length>16)c="pmid is too long";else if(null===s||!isNaN(s)&&"object"!=typeof s)if(null===o||!isNaN(o)&&"object"!=typeof o)if(null!==s&&null===o)c="latitude without longitude";else if(null===s&&null!==o)c="longitude without latitude";else if(null===a||!isNaN(a)&&"object"!=typeof a)if(null===n||!isNaN(n)&&"object"!=typeof n)if(null===r||!isNaN(r)&&"object"!=typeof r)if(null!==r&&null===n)c="day provided without month";else if(null!==r&&null===a)c="day provided without year";else if(null!==n&&null===a)c="month provided without year";else if(Object.keys(i).length>64)c="more than 64 user-defined columns";else for(const[e,t]of Object.entries(i)){if("object"==typeof t){c="user-defined value is wrong type";break}if(t.length>256){c="user-defined value is too long";break}if(e.length>256){c="user-defined column heading is too long";break}}else c="day is not a number";else c="month is not a number";else c="year is not a number";else c="longitude is not a number";else c="latitude is not a number";if(c)throw new Error(`Invalid metadata: ${c}`)}},,,,,,,,,,,,,,,,,,,,function(e,t,a){var n=a(460),r=["compress"];e.exports=function(){var e=new Worker(a.p+"compress.a8c0f8265a1260e171d8.worker.js",{name:"compress.[hash].worker.js"});return n(e,r),e}},,,,,,,,,,,,function(e,t,a){var n;window,e.exports=(n=a(102),function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/dist/",a(a.s=1)}([function(e,t){e.exports=n},function(e,t,a){"use strict";a.r(t);var n=a(0);function r(e){e.contextMenu.el.classList.remove("visible"),e.contextMenu.isOpen=!1}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===t.length)return e;var a=e.map((function(e){return Array.from(e)})),n=!0,r=!1,s=void 0;try{for(var o,l=function(){var e=o.value;a[e.section].splice(e.index,0,{text:e.text,handler:e.handler?e.handler:function(t,a){return t.trigger(e.method,[t,a])},isActive:e.isActive})},i=t[Symbol.iterator]();!(n=(o=i.next()).done);n=!0)l()}catch(e){r=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(r)throw s}}return a}function o(e,t,a){var n=e.contextMenu.el,r=document.createElement("ul"),s=!0,o=!1,l=void 0;try{for(var i,c=t[Symbol.iterator]();!(s=(i=c.next()).done);s=!0){var u=i.value,m=null;if(u instanceof HTMLElement)(m=document.createElement("li")).appendChild(u);else if("function"==typeof u){var d=u(e,a);d&&(m=document.createElement("li")).appendChild(d)}else!function(){var t=u.text,n=u.handler,r=u.visible,s=u.isActive;if(!r||r(e)){m=document.createElement("li");var o="function"==typeof s,l=document.createElement("button");l.addEventListener("click",(function(){o&&(e.contextMenu.invalidate=!1),n(e,a)}));var i="function"==typeof t?t(e,a):t;if(l.appendChild(document.createTextNode(i)),o){var c=document.createElement("span");c.classList.add("phylocanvas-context-menu-toggle"),s(e,a)&&c.classList.add("is-active"),l.appendChild(c),l.classList.add("phylocanvas-context-menu-has-toggle"),m.addEventListener("click",(function(){s(e,a)?c.classList.add("is-active"):c.classList.remove("is-active")}))}m.appendChild(l)}}();m&&(u.isActive||m.addEventListener("click",(function(){return e.contextMenu.close()})),m.addEventListener("contextmenu",(function(e){return e.preventDefault(),!1})),r.appendChild(m))}}catch(e){o=!0,l=e}finally{try{s||null==c.return||c.return()}finally{if(o)throw l}}r.hasChildNodes()&&n.appendChild(r)}function l(e,t,a,n){return e+t<a+n?e:e-t>a?e-t:a}function i(e,t,a,n){var r=n?e.getNodeById(n):null;!function(e,t){for(var a=e.contextMenu.el;a.hasChildNodes();)a.removeChild(a.firstChild);var n=t&&!t.isLeaf?e.contextMenu.nodeMenuItems:e.contextMenu.treeMenuItems,r=!0,s=!1,l=void 0;try{for(var i,c=n[Symbol.iterator]();!(r=(i=c.next()).done);r=!0)o(e,i.value,t||void 0)}catch(e){s=!0,l=e}finally{try{r||null==c.return||c.return()}finally{if(s)throw l}}}(e,r),function(e,t,a){var n=e.el,r=e.parent;n.classList.remove("visible","top","bottom","left","right"),n.style.top=n.style.bottom=n.style.left=n.style.right=null;var s=n.offsetWidth,o=n.offsetHeight,i=l(a,o,window.scrollY,window.innerHeight),c=l(t,s,window.scrollX,window.innerWidth),u=i+o/2>a,m=c+s/2>t;n.style.left="".concat(c,"px"),n.style.top="".concat(i,"px"),n.style.transformOrigin="".concat(u?"top":"bottom"," ").concat(m?"left":"right"),r.removeChild(n),r.appendChild(n),n.offsetWidth,n.classList.add("visible")}(e.contextMenu,t,a),e.contextMenu.isOpen=!0}var c,u,m=[(c=document.createElement("a"),u=document.createElement("img"),u.src="data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20id%3D%22Micro%22%20viewBox%3D%220%200%20433.16%20103.04%22%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bisolation%3Aisolate%3B%7D.cls-2%7Bfill%3A%233b7383%3B%7D.cls-3%7Bopacity%3A0.53%3B%7D%3C%2Fstyle%3E%3C%2Fdefs%3E%3Ctitle%3ELOGOS%20OCT%202018%3C%2Ftitle%3E%3Cg%20class%3D%22cls-1%22%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M110.22%2C28.17H126c3.28%2C0%2C5.75.58%2C7.39%2C1.73a7.58%2C7.58%2C0%2C0%2C1%2C3.14%2C4.54%2C32.31%2C32.31%2C0%2C0%2C1%2C.67%2C7.3%2C31.25%2C31.25%2C0%2C0%2C1-.7%2C7.2%2C7.87%2C7.87%2C0%2C0%2C1-3.14%2C4.61c-1.62%2C1.17-4.08%2C1.76-7.36%2C1.76h-12.1V72.2h-3.71Zm15%2C23.81a10.15%2C10.15%2C0%2C0%2C0%2C5.47-1.15A5.25%2C5.25%2C0%2C0%2C0%2C133%2C47.6a26%2C26%2C0%2C0%2C0%2C.51-5.86%2C27.48%2C27.48%2C0%2C0%2C0-.48-5.89%2C5%2C5%2C0%2C0%2C0-2.27-3.17%2C10.71%2C10.71%2C0%2C0%2C0-5.51-1.12H113.93V52Z%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M165.45%2C52.75a29.42%2C29.42%2C0%2C0%2C0-.57-6.91A4%2C4%2C0%2C0%2C0%2C162.73%2C43a13.56%2C13.56%2C0%2C0%2C0-5.15-.7q-4%2C0-5.86%2C1.56a6.85%2C6.85%2C0%2C0%2C0-2.27%2C4.1%2C44.88%2C44.88%2C0%2C0%2C0-.45%2C7.33V72.2h-3.58V24.65H149V43.92h.26a7.06%2C7.06%2C0%2C0%2C1%2C3-3.52q2.17-1.35%2C6.59-1.35a13.48%2C13.48%2C0%2C0%2C1%2C6.53%2C1.25%2C6.16%2C6.16%2C0%2C0%2C1%2C2.91%2C3.87A29%2C29%2C0%2C0%2C1%2C169%2C51.6V72.2h-3.59Z%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M180.17%2C84.75V81.68q4.94.31%2C9%2C.32c3%2C0%2C5.24-.41%2C6.65-1.22A5.74%2C5.74%2C0%2C0%2C0%2C198.6%2C77a34.38%2C34.38%2C0%2C0%2C0%2C.64-7.71V67.72h-.32A6.69%2C6.69%2C0%2C0%2C1%2C196%2C71.31q-2.17%2C1.34-6.66%2C1.34c-2.9%2C0-5.06-.42-6.49-1.28a6.32%2C6.32%2C0%2C0%2C1-2.88-4%2C30.7%2C30.7%2C0%2C0%2C1-.74-7.68V39.56h3.59V59a29.12%2C29.12%2C0%2C0%2C0%2C.57%2C6.85%2C4%2C4%2C0%2C0%2C0%2C2.15%2C2.81%2C13.28%2C13.28%2C0%2C0%2C0%2C5.08.71q4%2C0%2C5.89-1.54a6.59%2C6.59%2C0%2C0%2C0%2C2.31-4.09%2C46.38%2C46.38%2C0%2C0%2C0%2C.44-7.3V39.56h3.59V67.85a43%2C43%2C0%2C0%2C1-1%2C10.4%2C8.37%2C8.37%2C0%2C0%2C1-3.71%2C5.28q-2.76%2C1.66-8.32%2C1.67A94.52%2C94.52%2C0%2C0%2C1%2C180.17%2C84.75Z%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M213.13%2C72.2V24.65h3.59V72.2Z%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M229.77%2C71.4a6.29%2C6.29%2C0%2C0%2C1-3.26-4.6A58.17%2C58.17%2C0%2C0%2C1%2C225.8%2C56%2C58.48%2C58.48%2C0%2C0%2C1%2C226.51%2C45a6.38%2C6.38%2C0%2C0%2C1%2C3.26-4.64c1.71-.9%2C4.52-1.35%2C8.45-1.35s6.79.45%2C8.48%2C1.35A6.52%2C6.52%2C0%2C0%2C1%2C250%2C45%2C56.15%2C56.15%2C0%2C0%2C1%2C250.7%2C56%2C55.85%2C55.85%2C0%2C0%2C1%2C250%2C66.8a6.42%2C6.42%2C0%2C0%2C1-3.26%2C4.6c-1.69.88-4.51%2C1.32-8.48%2C1.32S231.48%2C72.28%2C229.77%2C71.4Zm14.72-2.78a4.48%2C4.48%2C0%2C0%2C0%2C2.21-3.49%2C66%2C66%2C0%2C0%2C0%2C.42-9.18%2C67%2C67%2C0%2C0%2C0-.42-9.22%2C4.61%2C4.61%2C0%2C0%2C0-2.21-3.55c-1.19-.66-3.29-1-6.27-1s-5.07.33-6.24%2C1a4.61%2C4.61%2C0%2C0%2C0-2.18%2C3.52%2C69.07%2C69.07%2C0%2C0%2C0-.41%2C9.25%2C68.13%2C68.13%2C0%2C0%2C0%2C.41%2C9.18A4.5%2C4.5%2C0%2C0%2C0%2C232%2C68.62q1.76%2C1%2C6.24%2C1C241.2%2C69.58%2C243.3%2C69.26%2C244.49%2C68.62Z%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M274.28%2C72.46a38.71%2C38.71%2C0%2C0%2C1-4.32.26c-3.63%2C0-6.3-.58-8-1.73a7.86%2C7.86%2C0%2C0%2C1-3.33-5.12%2C50.73%2C50.73%2C0%2C0%2C1-.73-10%2C43.71%2C43.71%2C0%2C0%2C1%2C.86-10%2C8.36%2C8.36%2C0%2C0%2C1%2C3.42-5.18q2.57-1.7%2C7.68-1.7a37.92%2C37.92%2C0%2C0%2C1%2C4.29.26%2C26.45%2C26.45%2C0%2C0%2C1%2C3.71.64v4.93a35.76%2C35.76%2C0%2C0%2C0-6.46-.58%2C9.62%2C9.62%2C0%2C0%2C0-4.77.9%2C4.57%2C4.57%2C0%2C0%2C0-2%2C3.23%2C41%2C41%2C0%2C0%2C0-.48%2C7.45%2C39.8%2C39.8%2C0%2C0%2C0%2C.51%2C7.56%2C4.47%2C4.47%2C0%2C0%2C0%2C2%2C3.2%2C10.53%2C10.53%2C0%2C0%2C0%2C4.83.83%2C35.91%2C35.91%2C0%2C0%2C0%2C6.59-.58v4.93A28.78%2C28.78%2C0%2C0%2C1%2C274.28%2C72.46Z%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M285.48%2C70.54q-2.21-2.17-2.21-7.42a16.46%2C16.46%2C0%2C0%2C1%2C.84-5.89%2C5.51%2C5.51%2C0%2C0%2C1%2C2.81-3.07%2C13.06%2C13.06%2C0%2C0%2C1%2C5.57-1c2.18%2C0%2C5.31.08%2C9.41.25V51.72a15.23%2C15.23%2C0%2C0%2C0-.58-5%2C3.09%2C3.09%2C0%2C0%2C0-2.17-1.92%2C22.33%2C22.33%2C0%2C0%2C0-5.38-.45c-1.19%2C0-2.69.06-4.48.19s-3.18.28-4.16.45V40a57.8%2C57.8%2C0%2C0%2C1%2C10.62-.9q5.31%2C0%2C7.94%2C1.22a6.38%2C6.38%2C0%2C0%2C1%2C3.52%2C3.87%2C25.3%2C25.3%2C0%2C0%2C1%2C.9%2C7.71V72.2h-5.64L302.22%2C68h-.39a6.59%2C6.59%2C0%2C0%2C1-3.68%2C3.78%2C15.69%2C15.69%2C0%2C0%2C1-5.72%2C1Q287.69%2C72.72%2C285.48%2C70.54ZM298.7%2C67a4%2C4%2C0%2C0%2C0%2C2.17-1.92%2C13.75%2C13.75%2C0%2C0%2C0%2C1-6V57.55H294a9.3%2C9.3%2C0%2C0%2C0-2.95.35%2C2.19%2C2.19%2C0%2C0%2C0-1.34%2C1.41%2C10.18%2C10.18%2C0%2C0%2C0-.39%2C3.29%2C8.78%2C8.78%2C0%2C0%2C0%2C.42%2C3.14%2C2.44%2C2.44%2C0%2C0%2C0%2C1.6%2C1.41%2C13.17%2C13.17%2C0%2C0%2C0%2C3.68.38A10.93%2C10.93%2C0%2C0%2C0%2C298.7%2C67Z%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M335.62%2C54a33.45%2C33.45%2C0%2C0%2C0-.41-6.37%2C3.33%2C3.33%2C0%2C0%2C0-1.57-2.46%2C9.56%2C9.56%2C0%2C0%2C0-4-.58%2C6.79%2C6.79%2C0%2C0%2C0-4.35%2C1.15%2C5.33%2C5.33%2C0%2C0%2C0-1.79%2C3.33%2C37.72%2C37.72%2C0%2C0%2C0-.38%2C6.21V72.2h-6.21V39.56h5.63l.26%2C4.36h.44a7.45%2C7.45%2C0%2C0%2C1%2C3.2-3.62%2C11.88%2C11.88%2C0%2C0%2C1%2C5.89-1.25%2C11.25%2C11.25%2C0%2C0%2C1%2C6.05%2C1.31%2C6.53%2C6.53%2C0%2C0%2C1%2C2.72%2C3.94%2C29.52%2C29.52%2C0%2C0%2C1%2C.7%2C7.3V72.2h-6.21Z%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M357.32%2C72.2l-9.86-32.64h6.4l7.3%2C26.05h.51l7.23-26h6.34L365.38%2C72.2Z%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M380.71%2C70.54q-2.2-2.17-2.21-7.42a16.46%2C16.46%2C0%2C0%2C1%2C.84-5.89%2C5.51%2C5.51%2C0%2C0%2C1%2C2.81-3.07%2C13.06%2C13.06%2C0%2C0%2C1%2C5.57-1c2.18%2C0%2C5.31.08%2C9.41.25V51.72a15.23%2C15.23%2C0%2C0%2C0-.58-5%2C3.09%2C3.09%2C0%2C0%2C0-2.17-1.92A22.33%2C22.33%2C0%2C0%2C0%2C389%2C44.3c-1.19%2C0-2.69.06-4.48.19s-3.18.28-4.16.45V40a57.8%2C57.8%2C0%2C0%2C1%2C10.62-.9c3.55%2C0%2C6.19.41%2C7.94%2C1.22a6.38%2C6.38%2C0%2C0%2C1%2C3.52%2C3.87%2C25.3%2C25.3%2C0%2C0%2C1%2C.9%2C7.71V72.2H397.7L397.45%2C68h-.39a6.59%2C6.59%2C0%2C0%2C1-3.68%2C3.78%2C15.69%2C15.69%2C0%2C0%2C1-5.72%2C1Q382.92%2C72.72%2C380.71%2C70.54ZM393.93%2C67a4%2C4%2C0%2C0%2C0%2C2.17-1.92%2C13.75%2C13.75%2C0%2C0%2C0%2C1-6V57.55h-7.87a9.3%2C9.3%2C0%2C0%2C0-2.95.35A2.19%2C2.19%2C0%2C0%2C0%2C385%2C59.31a10.18%2C10.18%2C0%2C0%2C0-.39%2C3.29%2C8.78%2C8.78%2C0%2C0%2C0%2C.42%2C3.14%2C2.44%2C2.44%2C0%2C0%2C0%2C1.6%2C1.41%2C13.17%2C13.17%2C0%2C0%2C0%2C3.68.38A10.93%2C10.93%2C0%2C0%2C0%2C393.93%2C67Z%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M416.58%2C72.46c-2-.17-3.73-.36-5.18-.58v-5a77.88%2C77.88%2C0%2C0%2C0%2C9.79.58A12.66%2C12.66%2C0%2C0%2C0%2C425.1%2C67a2.63%2C2.63%2C0%2C0%2C0%2C1.66-1.34%2C6.93%2C6.93%2C0%2C0%2C0%2C.38-2.63%2C10.13%2C10.13%2C0%2C0%2C0-.25-2.72%2C1.7%2C1.7%2C0%2C0%2C0-.9-1.09%2C8.75%2C8.75%2C0%2C0%2C0-2.24-.48l-7-1c-2.43-.29-4.07-1.14-4.93-2.52s-1.28-3.58-1.28-6.56a10.91%2C10.91%2C0%2C0%2C1%2C1.41-6.08%2C6.88%2C6.88%2C0%2C0%2C1%2C3.87-2.85%2C22.85%2C22.85%2C0%2C0%2C1%2C6.37-.74c1.62%2C0%2C3.32.09%2C5.09.26a27%2C27%2C0%2C0%2C1%2C4.32.7v4.93a60.27%2C60.27%2C0%2C0%2C0-9-.64%2C10%2C10%2C0%2C0%2C0-4.74.8c-.89.53-1.34%2C1.7-1.34%2C3.49a9.81%2C9.81%2C0%2C0%2C0%2C.22%2C2.49%2C1.65%2C1.65%2C0%2C0%2C0%2C.87%2C1.09%2C6.53%2C6.53%2C0%2C0%2C0%2C2.05.51l7.23.9a9.89%2C9.89%2C0%2C0%2C1%2C3.61%2C1.09%2C4.77%2C4.77%2C0%2C0%2C1%2C2%2C2.65%2C17.4%2C17.4%2C0%2C0%2C1%2C.67%2C5.54A12.27%2C12.27%2C0%2C0%2C1%2C431.91%2C69a6.46%2C6.46%2C0%2C0%2C1-3.65%2C3%2C20.26%2C20.26%2C0%2C0%2C1-6.24.8C420.4%2C72.72%2C418.59%2C72.63%2C416.58%2C72.46Z%22%2F%3E%3C%2Fg%3E%3Cg%20class%3D%22cls-3%22%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M77.84.07h-.33a14.31%2C14.31%2C0%2C0%2C0-14%2C14.63v0h0v0a28.13%2C28.13%2C0%2C0%2C1-1.29%2C9.09%2C28.63%2C28.63%2C0%2C0%2C1-5.42%2C9.92%2C28.56%2C28.56%2C0%2C0%2C1-35.57%2C6.69h0A14.3%2C14.3%2C0%2C1%2C0%2C14.37%2C67.3a14.45%2C14.45%2C0%2C0%2C0%2C7-1.82c.15-.11.31-.21.47-.31h0l.48-.29A28.53%2C28.53%2C0%2C0%2C1%2C36.71%2C61a28%2C28%2C0%2C0%2C1%2C5%2C.45%2C28.45%2C28.45%2C0%2C0%2C1%2C7.65%2C2.49l0%2C0c.72.35%2C1.44.74%2C2.13%2C1.16h0a27.94%2C27.94%2C0%2C0%2C1%2C6.19%2C5.07%2C28.86%2C28.86%2C0%2C0%2C1%2C3.4%2C4.5%2C28.81%2C28.81%2C0%2C0%2C1%2C4.15%2C13.53c0%2C.22%2C0%2C.44%2C0%2C.66s0%2C.49%2C0%2C.74A14.3%2C14.3%2C0%2C1%2C0%2C86.46%2C76.09L86.34%2C76h0A28.6%2C28.6%2C0%2C0%2C1%2C72.86%2C42.53a29.14%2C29.14%2C0%2C0%2C1%2C2.23-5.24%2C28.57%2C28.57%2C0%2C0%2C1%2C3.19-4.68%2C28.25%2C28.25%2C0%2C0%2C1%2C6.92-6h0A14.3%2C14.3%2C0%2C0%2C0%2C77.84.07%22%2F%3E%3C%2Fg%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M14.37%2C38.56a14.39%2C14.39%2C0%2C1%2C0%2C12.3%2C6.9%2C14.28%2C14.28%2C0%2C0%2C0-12.3-6.9%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M79.58%2C74.27a14.39%2C14.39%2C0%2C1%2C0%2C12.3%2C6.9%2C14.36%2C14.36%2C0%2C0%2C0-12.3-6.9%22%2F%3E%3Cpath%20class%3D%22cls-2%22%20d%3D%22M77.87%2C0A14.39%2C14.39%2C0%2C1%2C0%2C90.16%2C6.9%2C14.37%2C14.37%2C0%2C0%2C0%2C77.87%2C0%22%2F%3E%3C%2Fsvg%3E",c.appendChild(u),c.title="About Phylocanvas...",c.href="http://phylocanvas.org/",c.target="_blank",c.className="phylocanvas-context-menu-about",c)],d=window.URL||window.webkitURL;function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text/plain;charset=utf-8",a=new Blob([e],{type:t});return d.createObjectURL(a)}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"link",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file",a=arguments.length>2?arguments[2]:void 0,n=document.createElement("a");return n.appendChild(document.createTextNode(e)),n.download=t,n.addEventListener("click",(function(){n.href=a()})),n}function f(e,t,a){return h(a,e.contextMenu.filenames.leafLabels,(function(){return p(e.getLeafLabels(t).join("\n"))}))}function g(e,t,a){return h(a,e.contextMenu.filenames.newick,(function(){return p(e.getNewick(t))}))}var b=[[{text:"Show labels",handler:function(e){return e.toggleLeafLabels()},isActive:function(e){return e.state.renderLeafLabels}},{text:"Align labels",handler:function(e){return e.toggleAlignLeafLabels()},isActive:function(e){return e.state.alignLabels}}],[{text:"Fit in panel",handler:function(e){return e.fitInPanel()}},{text:"Expand collapsed subtrees",visible:function(e){return e.state.collapsedIds.length>0},handler:function(e){return e.resetCollapsedNodes({refit:!0})}},{text:"Redraw original tree",handler:function(e){return e.setSource(e.nodes.originalSource)}}],[function(e,t){return f(e,t,"Export leaf labels")},function(e,t){return function(e,t,a){var n=e.contextMenu,r=e.state.selectedIds,s=n.filenames;return 0===r.length?null:h("Export selected labels",s.leafLabels,(function(){return p(e.getNodeLabels(r).join("\n"))}))}(e)},function(e,t){return g(e,t,"Export as newick file")},function(e,t){return function(e,t,a){return h("Export as image",e.contextMenu.filenames.image,(function(){return e.ctx.canvas.toDataURL()}))}(e)}],m],y=[[{text:function(e,t){return-1===e.state.collapsedIds.indexOf(t.id)?"Collapse subtree":"Expand subtree"},handler:function(e,t){return e.collapseNode(t,{refit:!0})}},{text:"Rotate subtree",handler:function(e,t){return e.rotateNode(t,{refit:!1})}}],[{text:"View subtree",handler:function(e,t){return e.setRoot(t)}},{text:"Re-root tree",handler:function(e,t){return e.rerootNode(t)}}],[function(e,t){return f(e,t,"Export subtree leaf labels")},function(e,t){return g(e,t,"Export subtree as newick file")}],m],E={image:"phylocanvas.png",leafLabels:"phylocanvas-leaf-labels.txt",newick:"phylocanvas.nwk"};function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function C(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function w(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}t.default=function(e,t){function a(t){var a=n.utils.mapPoint(e,t.offsetX,t.offsetY),r=e.getNodeAtPoint(a.x,a.y);e.contextMenu.open(t.pageX,t.pageY,r?r.id:null)}t("init",(function(t,a){var n=t.apply(void 0,w(a)),o=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],n=!0,r=!1,s=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}return a}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(a,1)[0].contextMenu,l=void 0===o?{}:o;return e.contextMenu={},e.contextMenu.invalidate=!0,l&&"string"==typeof l.parent?e.contextMenu.parent=document.querySelector(l.parent):l&&(e.contextMenu.parent=l.parent),e.contextMenu.parent||(e.contextMenu.parent=document.body),e.contextMenu.el=document.createElement("ul"),e.contextMenu.el.className="phylocanvas-context-menu",e.contextMenu.parent.appendChild(e.contextMenu.el),e.contextMenu.treeMenuItems=s(b,l.treeMenuItems),e.contextMenu.nodeMenuItems=s(y,l.nodeMenuItems),e.contextMenu.filenames=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){C(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},E,{},l.filenames),e.contextMenu.open=i.bind(null,e),e.contextMenu.close=r.bind(null,e),n}));var o=function(){e.contextMenu.touching=!0};e.ctx.canvas.addEventListener("touchstart",o);var l=function(t){t.preventDefault(),e.contextMenu.touching&&(a(t),e.contextMenu.touching=!1)};e.ctx.canvas.addEventListener("contextmenu",l);var c=function(t){(e.contextMenu.isOpen||!e.contextMenu.isOpen&&2===t.button)&&t.stopImmediatePropagation()};e.ctx.canvas.addEventListener("mousedown",c);var u=function(t){2===t.button?(t.stopImmediatePropagation(),a(t)):e.contextMenu.isOpen&&(t.stopImmediatePropagation(),e.contextMenu.close())};e.ctx.canvas.addEventListener("mouseup",u),t("mergeState",(function(t,a){var n=e.contextMenu;n.isOpen&&n.invalidate&&n.close(),n.invalidate=!0,t.apply(void 0,w(a))})),t("destroy",(function(t,a){e.contextMenu.parent.removeChild(e.contextMenu.el),e.ctx.canvas.removeEventListener("touchstart",o),e.ctx.canvas.removeEventListener("contextmenu",l),e.ctx.canvas.removeEventListener("mousedown",c),e.ctx.canvas.removeEventListener("mouseup",u),t.apply(void 0,w(a))}))}}]))},function(e,t,a){var n;window,e.exports=(n=a(102),function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/dist/",a(a.s=12)}([function(e,t){e.exports=n},function(e,t,a){"use strict";var n,r="object"==typeof Reflect?Reflect:null,s=r&&"function"==typeof r.apply?r.apply:function(e,t,a){return Function.prototype.apply.call(e,t,a)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function l(){l.init.call(this)}e.exports=l,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var i=10;function c(e){return void 0===e._maxListeners?l.defaultMaxListeners:e._maxListeners}function u(e,t,a,n){var r,s,o,l;if("function"!=typeof a)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof a);if(void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,a.listener?a.listener:a),s=e._events),o=s[t]),void 0===o)o=s[t]=a,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[a,o]:[o,a]:n?o.unshift(a):o.push(a),(r=c(e))>0&&o.length>r&&!o.warned){o.warned=!0;var i=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");i.name="MaxListenersExceededWarning",i.emitter=e,i.type=t,i.count=o.length,l=i,console&&console.warn&&console.warn(l)}return e}function m(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,s(this.listener,this.target,e))}function d(e,t,a){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:a},r=m.bind(n);return r.listener=a,n.wrapFn=r,r}function p(e,t,a){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"==typeof r?a?[r.listener||r]:[r]:a?function(e){for(var t=new Array(e.length),a=0;a<t.length;++a)t[a]=e[a].listener||e[a];return t}(r):f(r,r.length)}function h(e){var t=this._events;if(void 0!==t){var a=t[e];if("function"==typeof a)return 1;if(void 0!==a)return a.length}return 0}function f(e,t){for(var a=new Array(t),n=0;n<t;++n)a[n]=e[n];return a}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");i=e}}),l.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},l.prototype.getMaxListeners=function(){return c(this)},l.prototype.emit=function(e){for(var t=[],a=1;a<arguments.length;a++)t.push(arguments[a]);var n="error"===e,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var l=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw l.context=o,l}var i=r[e];if(void 0===i)return!1;if("function"==typeof i)s(i,this,t);else{var c=i.length,u=f(i,c);for(a=0;a<c;++a)s(u[a],this,t)}return!0},l.prototype.addListener=function(e,t){return u(this,e,t,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(e,t){return u(this,e,t,!0)},l.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,d(this,e,t)),this},l.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,d(this,e,t)),this},l.prototype.removeListener=function(e,t){var a,n,r,s,o;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(a=n[e]))return this;if(a===t||a.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,a.listener||t));else if("function"!=typeof a){for(r=-1,s=a.length-1;s>=0;s--)if(a[s]===t||a[s].listener===t){o=a[s].listener,r=s;break}if(r<0)return this;0===r?a.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(a,r),1===a.length&&(n[e]=a[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(e){var t,a,n;if(void 0===(a=this._events))return this;if(void 0===a.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==a[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete a[e]),this;if(0===arguments.length){var r,s=Object.keys(a);for(n=0;n<s.length;++n)"removeListener"!==(r=s[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=a[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},l.prototype.listeners=function(e){return p(this,e,!0)},l.prototype.rawListeners=function(e){return p(this,e,!1)},l.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},l.prototype.listenerCount=h,l.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t){var a={left:0,top:0};e.exports=function(e,t,n){t=t||e.currentTarget||e.srcElement,Array.isArray(n)||(n=[0,0]);var r,s=e.clientX||0,o=e.clientY||0,l=(r=t)===window||r===document||r===document.body?a:r.getBoundingClientRect();return n[0]=s-l.left,n[1]=o-l.top,n}},function(e,t,a){"use strict";const n=a(4),r=a(5),s=a(8),o=a(11);e.exports=function(e,t){if(!(e&&t instanceof Function))return!1;let a,l=o({element:e}),i=0,c=0;a=new n({source:e,update:(e,a)=>{let n={type:"mouse",dx:e-c,dy:a-i,dz:0,x:l[0],y:l[1]};c=e,i=a,t(n)},multiplier:1,friction:.75}),r(e,(e,a,n,r)=>{r.preventDefault(),t({type:"mouse",dx:0,dy:0,dz:a,x:l[0],y:l[1],event:r})});let u,m=s(e);m.on("start",e=>{a&&a.pause();let[t,n]=m.fingers;u=[.5*n.position[0]+.5*t.position[0],.5*n.position[1]+.5*t.position[1]]}),m.on("end",()=>{u=null,a&&a.resume()}),m.on("change",(e,a)=>{m.pinching&&u&&t({type:"touch",dx:0,dy:0,dz:2*-(e-a),x:u[0],y:u[1]})})}},function(e,t,a){var n,r;void 0===(r="function"==typeof(n=function(e,t){"use strict";window.addEventListener("touchmove",(function(){})),t.exports=function e(t){var r,s,o,l,i,c,u,m,d,p,h,f=t.source,g=void 0===f?document:f,b=t.update,y=t.multiplier,E=void 0===y?1:y,v=t.friction,C=void 0===v?.92:v,w=t.initialValues,S=t.boundX,N=t.boundY,O=t.bounce,x=void 0===O||O;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var k=0,_=0,I=.3*E,T=!1,L=!1,j=!1,A=!1,P=[];function R(){b.call(g,k,_)}function M(e){if("touchmove"===e.type||"touchstart"===e.type||"touchend"===e.type){var t=e.targetTouches[0]||e.changedTouches[0];return{x:t.clientX,y:t.clientY,id:t.identifier}}return{x:e.clientX,y:e.clientY,id:null}}function D(e){var t=M(e);L||j||(L=!0,A=!1,d=t.id,i=u=t.x,c=m=t.y,P=[],U(i,c),document.addEventListener("touchmove",F,!!n()&&{passive:!1}),document.addEventListener("touchend",z),document.addEventListener("touchcancel",G),document.addEventListener("mousemove",F,!!n()&&{passive:!1}),document.addEventListener("mouseup",z))}function F(e){e.preventDefault();var t=M(e);L&&t.id===d&&(u=t.x,m=t.y,U(i,c),T||a(B),T=!0)}function z(e){var t=M(e);L&&t.id===d&&G()}function G(){L=!1,U(i,c),function(){var e=P[0],t=P[P.length-1],n=t.x-e.x,r=t.y-e.y,s=(t.time-e.time)/15/E;p=n/s||0,h=r/s||0;var o=H();(Math.abs(p)>1||Math.abs(h)>1||!o.inBounds)&&(A=!0,a(V))}(),document.removeEventListener("touchmove",F),document.removeEventListener("touchend",z),document.removeEventListener("touchcancel",G),document.removeEventListener("mouseup",z),document.removeEventListener("mousemove",F)}function U(e,t){for(var a=Date.now();P.length>0&&!(a-P[0].time<=100);)P.shift();P.push({x:e,y:t,time:a})}function B(){var e=u-i,t=m-c;if(k+=e*E,_+=t*E,x){var a=H();0!==a.x&&(k-=e*$(a.x)*E),0!==a.y&&(_-=t*$(a.y)*E)}else H(!0);R(),i=u,c=m,T=!1}function $(e){return 5e-6*Math.pow(e,2)+1e-4*e+.55}function H(e){var t=0,a=0;return void 0!==r&&k<r?t=r-k:void 0!==s&&k>s&&(t=s-k),void 0!==o&&_<o?a=o-_:void 0!==l&&_>l&&(a=l-_),e&&(0!==t&&(k=t>0?r:s),0!==a&&(_=a>0?o:l)),{x:t,y:a,inBounds:0===t&&0===a}}function V(){if(A){k+=p*=C,_+=h*=C;var e=H();if(Math.abs(p)>I||Math.abs(h)>I||!e.inBounds){if(x){if(0!==e.x)if(e.x*p<=0)p+=.04*e.x;else{var t=e.x>0?2.5:-2.5;p=.11*(e.x+t)}0!==e.y&&(e.y*h<=0?h+=.04*e.y:(t=e.y>0?2.5:-2.5,h=.11*(e.y+t)))}else 0!==e.x&&(k=e.x>0?r:s,p=0),0!==e.y&&(_=e.y>0?o:l,h=0);R(),a(V)}else A=!1}}!function(){if(!(g="string"==typeof g?document.querySelector(g):g))throw new Error("IMPETUS: source not found.");if(!b)throw new Error("IMPETUS: update function not defined.");w&&(w[0]&&(k=w[0]),w[1]&&(_=w[1]),R()),S&&(r=S[0],s=S[1]),N&&(o=N[0],l=N[1]),g.addEventListener("touchstart",D),g.addEventListener("mousedown",D)}(),this.destroy=function(){return g.removeEventListener("touchstart",D),g.removeEventListener("mousedown",D),null},this.pause=function(){L=!1,j=!0},this.resume=function(){j=!1},this.setValues=function(e,t){"number"==typeof e&&(k=e),"number"==typeof t&&(_=t)},this.setMultiplier=function(e){I=.3*(E=e)},this.setBoundX=function(e){r=e[0],s=e[1]},this.setBoundY=function(e){o=e[0],l=e[1]}};var a=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};function n(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t)}catch(e){}return n=function(){return e},e}})?n.apply(t,[t,e]):n)||(e.exports=r)},function(e,t,a){"use strict";var n=a(6);e.exports=function(e,t,a){"function"==typeof e&&(a=!!t,t=e,e=window);var r=n("ex",e),s=function(e){a&&e.preventDefault();var n=e.deltaX||0,s=e.deltaY||0,o=e.deltaZ||0,l=1;switch(e.deltaMode){case 1:l=r;break;case 2:l=window.innerHeight}if(s*=l,o*=l,(n*=l)||s||o)return t(n,s,o,e)};return e.addEventListener("wheel",s),s}},function(e,t,a){"use strict";var n=a(7);function r(e,t){var a=n(getComputedStyle(e).getPropertyValue(t));return a[0]*s(a[1],e)}function s(e,t){switch(t=t||document.body,e=(e||"px").trim().toLowerCase(),t!==window&&t!==document||(t=document.body),e){case"%":return t.clientHeight/100;case"ch":case"ex":return function(e,t){var a=document.createElement("div");a.style["font-size"]="128"+e,t.appendChild(a);var n=r(a,"font-size")/128;return t.removeChild(a),n}(e,t);case"em":return r(t,"font-size");case"rem":return r(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}e.exports=s},function(e,t){e.exports=function(e,t){t||(t=[0,""]),e=String(e);var a=parseFloat(e,10);return t[0]=a,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},function(e,t,a){var n=a(9),r=a(1).EventEmitter,s=a(10),o=a(2);function l(){this.position=[0,0],this.touch=null}e.exports=function(e){e=e||window;var t=new r,a=[null,null],i=0,c=0,u=!1,m=!1;return Object.defineProperties(t,{pinching:s((function(){return 2===i})),fingers:s((function(){return a}))}),p(),t.enable=p,t.disable=function(){m&&(m=!1,i=0,a[0]=null,a[1]=null,c=0,u=!1,e.removeEventListener("touchstart",h,!1),e.removeEventListener("touchmove",f,!1),e.removeEventListener("touchend",g,!1),e.removeEventListener("touchcancel",g,!1))},t.indexOfTouch=d,t;function d(e){for(var t=e.identifier,n=0;n<a.length;n++)if(a[n]&&a[n].touch&&a[n].touch.identifier===t)return n;return-1}function p(){m||(m=!0,e.addEventListener("touchstart",h,!1),e.addEventListener("touchmove",f,!1),e.addEventListener("touchend",g,!1),e.addEventListener("touchcancel",g,!1))}function h(n){for(var r=0;r<n.changedTouches.length;r++){var s=n.changedTouches[r];if(-1===d(s.identifier)&&i<2){var m=0===i,p=a[0]?1:0,h=a[0]?0:1,f=new l;a[p]=f,i++,f.touch=s,o(s,e,f.position);var g=a[h]?a[h].touch:void 0;if(t.emit("place",s,g),!m){var y=b();u=!1,t.emit("start",y),c=y}}}}function f(n){for(var r=!1,s=0;s<n.changedTouches.length;s++){var l=n.changedTouches[s],u=d(l);-1!==u&&(r=!0,a[u].touch=l,o(l,e,a[u].position))}if(2===i&&r){var m=b();t.emit("change",m,c),c=m}}function g(e){for(var n=0;n<e.changedTouches.length;n++){var r=e.changedTouches[n],s=d(r);if(-1!==s){a[s]=null,i--;var o=0===s?1:0,l=a[o]?a[o].touch:void 0;t.emit("lift",r,l)}}u||2===i||(u=!0,t.emit("end"))}function b(){return i<2?0:n(a[0].position,a[1].position)}}},function(e,t){e.exports=function(e,t){var a=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(a*a+n*n)}},function(e,t){e.exports=function(e,t){return{configurable:!0,enumerable:!0,get:e,set:t}}},function(e,t,a){var n=a(2),r=a(1).EventEmitter;function s(e){var t=(e=e||{}).element||window,a=new r,s=e.position||[0,0];return!1!==e.touchstart&&(t.addEventListener("mousedown",l,!1),t.addEventListener("touchstart",o,!1)),t.addEventListener("mousemove",l,!1),t.addEventListener("touchmove",o,!1),a.position=s,a.dispose=function(){t.removeEventListener("mousemove",l,!1),t.removeEventListener("mousedown",l,!1),t.removeEventListener("touchmove",o,!1),t.removeEventListener("touchstart",o,!1)},a;function o(e){l(e.targetTouches[0])}function l(e){n(e,t,s),a.emit("move",e)}}e.exports=function(e){return s(e).position},e.exports.emitter=function(e){return s(e)}},function(e,t,a){"use strict";a.r(t);var n={highlight:!0,pan:!0,selection:!0,tooltip:!0,zoom:!0},r=a(3),s=a.n(r),o=a(0),l="phylocanvas-tooltip-visible";function i(e){e.classList.remove(l)}function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){m(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function m(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function d(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}t.default=function(e,t){var a,r={mousedown:!1,offsetX:void 0,offsetY:void 0},c={visible:!1,element:(a=document.createElement("div"),a.className="phylocanvas-tooltip",a.style.position="absolute",a.style.pointerEvents="none",a)};function m(t){1===t.button&&t.preventDefault(),r.mousedown=!0,r.offsetX=e.state.offsetX,r.offsetY=e.state.offsetY}function p(t){if(r.mousedown)e.state.interactions.tooltip&&c.visible&&(i(c.element),c.visible=!1);else{var a=o.utils.mapPoint(e,t.offsetX,t.offsetY),n=e.getNodeAtPoint(a.x,a.y);e.state.interactions.highlight&&e.highlightNode(n),e.state.interactions.tooltip&&(n&&!n.isLeaf?(function(e,t,a,n){e.innerHTML=n,e.style.left="".concat(t,"px"),e.style.top="".concat(a,"px"),e.classList.add(l)}(c.element,t.clientX,t.clientY,n.totalLeaves),c.visible=!0):c.visible&&(i(c.element),c.visible=!1))}}function h(t){r.mousedown=!1;var a=e.state.offsetX-r.offsetX,n=e.state.offsetY-r.offsetY,s=0!==a||0!==n;if(e.state.interactions.selection&&0===t.button&&!s){var l=o.utils.mapPoint(e,t.offsetX,t.offsetY),i=e.getNodeAtPoint(l.x,l.y);e.selectNode(i,t.metaKey||t.ctrlKey)}}t("mergeState",(function(t,a){c.visible&&(i(c.element),c.visible=!1),e.state.interactions.highlight&&e.highlightNode(null),t.apply(void 0,d(a))})),e.ctx.canvas.addEventListener("mousemove",p),e.ctx.canvas.addEventListener("mousedown",m),e.ctx.canvas.addEventListener("touchstart",m),e.ctx.canvas.addEventListener("mouseup",h),e.ctx.canvas.addEventListener("touchend",h),s()(e.ctx.canvas,(function(t){var a=t.dx,n=t.dy,r=t.dz,s=t.x,o=t.y,l=t.event;0!==r&&0===a&&0===n?e.state.interactions.zoom&&(l&&(l.metaKey||l.ctrlKey)?e.changeBranchScale(r<0?1:-1,{x:s,y:o}):l&&(l.altKey||l.shiftKey)?e.changeStepScale(r<0?1:-1,{x:s,y:o}):r>0&&e.state.scale>e.state.minScale*e.pixelRatio?e.transform(0,0,-1,{x:s,y:o}):r<0&&e.state.scale<e.state.maxScale*e.pixelRatio&&e.transform(0,0,1,{x:s,y:o})):e.state.interactions.pan&&e.transform(a,n,0,{x:s,y:o})})),e.ctx.canvas.onselectstart=function(){return!1},t("getInitialState",(function(e,t){var a=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],n=!0,r=!1,s=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}return a}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,1)[0],r=a.interactions,s=void 0===r?{}:r;return("string"==typeof a.parent?document.querySelector(a.parent):a.parent||document.body).appendChild(c.element),u({},e.apply(void 0,d(t)),{interactions:u({},n,{},s)})})),t("destroy",(function(t,a){e.ctx.canvas.removeEventListener("mousemove",p),e.ctx.canvas.removeEventListener("mousedown",m),e.ctx.canvas.removeEventListener("touchstart",m),e.ctx.canvas.removeEventListener("mouseup",h),e.ctx.canvas.removeEventListener("touchend",h),i(c.element),t.apply(void 0,d(a))}))}}]))},function(e,t,a){var n;window,e.exports=(n=a(102),function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/dist/",a(a.s=1)}([function(e,t){e.exports=n},function(e,t,a){"use strict";a.r(t);var n=a(0),r={blockFontSize:null,blockLength:16,blockSize:null,blockPadding:0,columns:[],fillStyle:"black",headerFontWeight:"bold",showLabels:!0,showHeaders:!0,textPadding:4,values:{}};function s(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],n=!0,r=!1,s=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}return a}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var u=n.utils.mapScalar,m=n.constants.Angles,d=n.constants.TreeTypes;function p(e,t){for(var a={},n=0,r=Object.keys(t);n<r.length;n++){var s=r[n];a[s]=t[s]/e.state.scale}return a}t.default=function(e,t){t("getInitialState",(function(e,t){var a=c(t,1)[0].metadata,n=void 0===a?{}:a;return l({},e.apply(void 0,s(t)),{metadata:l({},r,{},n)})})),t("layout",(function(t,a){var n=e.state,r=t.apply(void 0,s(a));if(r.metadata||(r.metadata={}),r.metadata.values!==n.metadata.values||r.metadata.columns!==n.metadata.columns||r.metadata.blockPadding!==n.metadata.blockPadding||r.metadata.blockLength!==n.metadata.blockLength||r.metadata.fontSize!==n.fontSize){r.metadata.columnWidths={},r.metadata.headerWidths={};var o=!0,l=!1,i=void 0;try{for(var c,u=n.metadata.columns[Symbol.iterator]();!(o=(c=u.next()).done);o=!0){var m=c.value,d="",p=!0,h=!1,f=void 0;try{for(var g,b=r.leafNodes[Symbol.iterator]();!(p=(g=b.next()).done);p=!0){var y=g.value;if(y.id in n.metadata.values){var E=n.metadata.values[y.id][m];E&&("string"==typeof E.label?E.label.length>d.length&&(d=E.label):console.error("Invalid metadata label for node ",y.id," column ",m))}}}catch(e){h=!0,f=e}finally{try{p||null==b.return||b.return()}finally{if(h)throw f}}d.length?r.metadata.columnWidths[m]=e.measureTextWidth(d):r.metadata.columnWidths[m]=0,r.metadata.headerWidths[m]=2*n.fontSize+e.measureTextWidth(m,n.metadata.headerFontWeight)}}catch(e){l=!0,i=e}finally{try{o||null==u.return||u.return()}finally{if(l)throw i}}}return r.metadata.blockLength=n.metadata.blockLength,r.metadata.blockPadding=n.metadata.blockPadding,r.metadata.columns=n.metadata.columns,r.metadata.values=n.metadata.values,r.metadata.fontSize=n.fontSize,r})),t("postRender",(function(t,a){var r=e.ctx,o=e.state,l=c(a,1)[0],i=u(e,o.metadata.blockLength),h=u(e,o.metadata.blockPadding),f=p(e,l.metadata.headerWidths),g=p(e,l.metadata.columnWidths),b=u(e,o.metadata.textPadding),y=new Set(Object.keys(o.metadata.values)),E=n.types[o.type],v=o.metadata.showHeaders&&E.mainAxis&&(!E.alignableLabels||E.alignableLabels&&e.state.alignLabels),C=o.metadata.showLabels,w=o.metadata.columns||[];r.save(),r.fillStyle=o.metadata.fillStyle;var S=b;if(o.showNodes&&(S+=e._.actualNodeSize),o.renderLeafLabels&&(S+=e._.actualMaxLabelWidth),v){r.textAlign="left",r.textBaseline="middle",r.font="".concat(o.metadata.headerFontWeight," ").concat(e._.actualFontSize,"px ").concat(o.fontFamily);var N=l.leafNodes[0];N.angle,o.metadata.showLabels||m.Degrees90,r.translate(N.x,N.y),r.rotate(N.angle);var O=S;E.alignableLabels&&(O+=e.state.branchScale*(l.rootNode.longestLeaf-N.distanceFromRoot));for(var x=-.5*o.stepScale,k=0;k<w.length;k++){var _=w[k],I=h;I+=C?Math.max(f[_],h+i+g[_]):i;var T=C?O+h+i+b:O+h+i/2,L=C?x-e._.actualFontSize/2:x-b;r.translate(T,L),C||r.rotate(-m.Degrees90),r.fillText(_,0,0),C||r.rotate(m.Degrees90),r.translate(-1*T,-1*L),O+=I}r.rotate(-N.angle),r.translate(-N.x,-N.y)}var j=o.stepScale,A=0;if(o.type===d.Circular&&e.state.alignLabels){var P=m.Degrees360/l.rootNode.totalLeaves;j=P*(l.rootNode.totalLeafLength*e.state.branchScale+e._.actualNodeSize+e._.actualMaxLabelWidth),A=P*(i+h)}else o.type===d.Radial&&(j=e._.actualNodeSize);var R=Math.min(j,o.blockSize||j);r.font="".concat(e._.actualFontSize,"px ").concat(o.fontFamily);var M=!0,D=!1,F=void 0;try{for(var z,G=l.leafNodes[Symbol.iterator]();!(M=(z=G.next()).done);M=!0){var U=z.value;if(y.has(U.id)){var B=o.metadata.values[U.id];r.translate(U.x,U.y),r.rotate(U.angle),r.beginPath();var $=S;E.alignableLabels&&e.state.alignLabels&&($+=e.state.branchScale*(l.rootNode.longestLeaf-U.distanceFromRoot));for(var H=0;H<w.length;H++){var V=w[H];if(void 0!==B[V]&&!U.isHidden&&(r.fillStyle=B[V].colour||B[V],r.fillRect($+h,0-R/2,i,R+H*A),r.fillStyle=o.metadata.fillStyle,e._.renderLabels&&C&&"string"==typeof B[V].label)){var K=U.angle>m.Degrees90&&U.angle<m.Degrees270;K&&r.rotate(m.Degrees180),r.textAlign=K?"right":"left",r.textBaseline="middle",r.fillText(B[V].label,(K?-1:1)*($+h+i+b),0),K&&r.rotate(-m.Degrees180)}$+=h+Math.max(v&&C?f[V]:0,C?h+i+g[V]:i)}r.closePath(),r.rotate(-U.angle),r.translate(-U.x,-U.y)}}}catch(e){D=!0,F=e}finally{try{M||null==G.return||G.return()}finally{if(D)throw F}}r.restore(),t.apply(void 0,s(a))})),t("getDrawingArea",(function(t,a){var r=t.apply(void 0,s(a)),o=n.types[e.state.type],l=e.layout(),i=e.state.metadata.blockLength,c=e.state.metadata.blockPadding,u=l.metadata.headerWidths,m=l.metadata.columnWidths,p=e.state.metadata.showLabels,h=e.state.metadata.showHeaders&&o.mainAxis&&(!o.alignableLabels||o.alignableLabels&&e.state.alignLabels),f=0;e.state.renderLeafLabels&&(f+=l.maxLabelWidth);var g=!0,b=!1,y=void 0;try{for(var E,v=e.state.metadata.columns[Symbol.iterator]();!(g=(E=v.next()).done);g=!0){var C=E.value;f+=c+Math.max(h&&p?u[C]:0,p?c+i+m[C]:i)}}catch(e){b=!0,y=e}finally{try{g||null==v.return||v.return()}finally{if(b)throw y}}var w=0,S=0,N=0,O=0;switch(e.state.type){case d.Rectangular:case d.Diagonal:N=h?e.state.stepScale:0,S=f;break;case d.Hierarchical:w=h?e.state.stepScale:0,O=f;break;case d.Circular:case d.Radial:w=f,N=f,S=f,O=f}return{width:r.width,height:r.height,left:r.left+w,top:r.top+N,right:r.right-S,bottom:r.bottom-O}}))}}]))},function(e,t,a){var n;window,e.exports=(n=a(102),function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/dist/",a(a.s=1)}([function(e,t){e.exports=n},function(e,t,a){"use strict";a.r(t);var n={background:"rgba(255, 255, 255, 0.87)",digits:2,fillStyle:"#222",fontSize:13,height:16,lineWidth:1,padding:8,position:{left:8,bottom:8},strokeStyle:"#222",textAlign:"center",textBaseline:"bottom",textBaselineOffset:2,width:80},r=a(0);function s(e){return function(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}t.default=function(e,t){t("getInitialState",(function(e,t){var a=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],n=!0,r=!1,s=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done)&&(a.push(o.value),!t||a.length!==t);n=!0);}catch(e){r=!0,s=e}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}return a}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,1)[0].scalebar,r=void 0===a?{}:a;return l({},e.apply(void 0,s(t)),{scalebar:l({},n,{},r)})})),t("render",(function(t,a){t.apply(void 0,s(a)),function(e){var t=e.state.scalebar,a=t.position,n=e.ctx,s=r.utils.getPixelRatio(n),o=t.lineWidth,l=t.fontSize,i=t.padding,c=t.height,u=t.width,m=t.digits,d=u/e.state.branchScale/e.state.scale,p=0;if(Number.isInteger(d))p=d;else for(;0===p;)0===(p=parseFloat(d.toFixed(m),10))&&m++;var h=u*p/d;n.save(),n.scale(s,s);var f=n.canvas.width/s,g=n.canvas.height/s,b=0;void 0!==a.left?b=a.left:void 0!==a.centre?b=f/2-h/2-i+a.centre:void 0!==a.right?b=f-h-a.right-2*i:e.error("Invalid horizontal position specified. Supported values are `left`, `centre`, or `right`");var y=0;void 0!==a.top?y=a.top+i:void 0!==a.middle?y=g/2-c+a.middle+i:void 0!==a.bottom?y=g-c-a.bottom-i:e.error("Invalid vertical position specified. Supported values are `top`, `middle`, or `bottom`"),n.fillStyle=t.background,n.fillRect(b,y-i,h+2*i,c+2*i),n.font="".concat(l,"px ").concat(t.fontFamily||e.state.fontFamily),n.fillStyle=t.fillStyle,n.strokeStyle=t.strokeStyle,n.lineWidth=o,n.textBaseline=t.textBaseline,n.textAlign=t.textAlign,n.beginPath(),n.moveTo(b+i+o,y+o),n.lineTo(b+h+i-o,y+o),n.moveTo(b+i+o,y+o),n.lineTo(b+i+o,y+c),n.moveTo(b+h+i-o,y+o),n.lineTo(b+h+i-o,y+c),n.stroke(),n.closePath(),n.fillText(p,b+(h+2*i)/2,y+c+t.textBaselineOffset),n.restore()}(e)}))}}]))},function(e,t,a){window,e.exports=function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/dist/",a(a.s=1)}([function(e,t,a){!function(){"use strict";var t,a,n,r,s;function o(e,t){var a,n=Object.keys(t);for(a=0;a<n.length;a++)e=e.replace(new RegExp("\\{"+n[a]+"\\}","gi"),t[n[a]]);return e}function l(e){var t,a,n;if(!e)throw new Error("cannot create a random attribute name for an undefined object");t="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",a="";do{for(a="",n=0;n<12;n++)a+=t[Math.floor(Math.random()*t.length)]}while(e[a]);return a}function i(e){var t={alphabetic:"alphabetic",hanging:"hanging",top:"text-before-edge",bottom:"text-after-edge",middle:"central"};return t[e]||t.alphabetic}s=function(e,t){var a,n,r,s={};for(e=e.split(","),t=t||10,a=0;a<e.length;a+=2)n="&"+e[a+1]+";",r=parseInt(e[a],t),s[n]="&#"+r+";";return s["\\xa0"]="&#160;",s}("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),t={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"}},(n=function(e,t){this.__root=e,this.__ctx=t}).prototype.addColorStop=function(e,t){var a,n=this.__ctx.__createElement("stop");n.setAttribute("offset",e),-1!==t.indexOf("rgba")?(a=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(t),n.setAttribute("stop-color",o("rgb({r},{g},{b})",{r:a[1],g:a[2],b:a[3]})),n.setAttribute("stop-opacity",a[4])):n.setAttribute("stop-color",t),this.__root.appendChild(n)},r=function(e,t){this.__root=e,this.__ctx=t},(a=function(e){var t,n={width:500,height:500,enableMirroring:!1};if(arguments.length>1?((t=n).width=arguments[0],t.height=arguments[1]):t=e||n,!(this instanceof a))return new a(t);this.width=t.width||n.width,this.height=t.height||n.height,this.enableMirroring=void 0!==t.enableMirroring?t.enableMirroring:n.enableMirroring,this.canvas=this,this.__document=t.document||document,this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d"),this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.width),this.__root.setAttribute("height",this.height),this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS("http://www.w3.org/2000/svg","g"),this.__root.appendChild(this.__currentElement)}).prototype.__createElement=function(e,t,a){void 0===t&&(t={});var n,r,s=this.__document.createElementNS("http://www.w3.org/2000/svg",e),o=Object.keys(t);for(a&&(s.setAttribute("fill","none"),s.setAttribute("stroke","none")),n=0;n<o.length;n++)r=o[n],s.setAttribute(r,t[r]);return s},a.prototype.__setDefaultStyles=function(){var e,a,n=Object.keys(t);for(e=0;e<n.length;e++)this[a=n[e]]=t[a].canvas},a.prototype.__applyStyleState=function(e){var t,a,n=Object.keys(e);for(t=0;t<n.length;t++)this[a=n[t]]=e[a]},a.prototype.__getStyleState=function(){var e,a,n={},r=Object.keys(t);for(e=0;e<r.length;e++)n[a=r[e]]=this[a];return n},a.prototype.__applyStyleToCurrentElement=function(e){var a,s,l,i,c,u=Object.keys(t);for(a=0;a<u.length;a++)if(s=t[u[a]],l=this[u[a]],s.apply)if(-1!==s.apply.indexOf("fill")&&l instanceof r){if(l.__ctx)for(;l.__ctx.__defs.childNodes.length;)i=l.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[i]=i,this.__defs.appendChild(l.__ctx.__defs.childNodes[0]);this.__currentElement.setAttribute("fill",o("url(#{id})",{id:l.__root.getAttribute("id")}))}else-1!==s.apply.indexOf("fill")&&l instanceof n?this.__currentElement.setAttribute("fill",o("url(#{id})",{id:l.__root.getAttribute("id")})):-1!==s.apply.indexOf(e)&&s.svg!==l&&("stroke"!==s.svgAttr&&"fill"!==s.svgAttr||-1===l.indexOf("rgba")?this.__currentElement.setAttribute(s.svgAttr,l):(c=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(l),this.__currentElement.setAttribute(s.svgAttr,o("rgb({r},{g},{b})",{r:c[1],g:c[2],b:c[3]})),this.__currentElement.setAttribute(s.svgAttr+"-opacity",c[4])))},a.prototype.__closestGroupOrSvg=function(e){return"g"===(e=e||this.__currentElement).nodeName||"svg"===e.nodeName?e:this.__closestGroupOrSvg(e.parentNode)},a.prototype.getSerializedSvg=function(e){var t,a,n,r,o,l=(new XMLSerializer).serializeToString(this.__root);if(/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(l)&&(l=l.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),e)for(t=Object.keys(s),a=0;a<t.length;a++)n=t[a],r=s[n],(o=new RegExp(n,"gi")).test(l)&&(l=l.replace(o,r));return l},a.prototype.getSvg=function(){return this.__root},a.prototype.save=function(){var e=this.__createElement("g"),t=this.__closestGroupOrSvg();this.__groupStack.push(t),t.appendChild(e),this.__currentElement=e,this.__stack.push(this.__getStyleState())},a.prototype.restore=function(){this.__currentElement=this.__groupStack.pop();var e=this.__stack.pop();this.__applyStyleState(e)},a.prototype.__addTransform=function(e){var t=this.__closestGroupOrSvg();if(t.childNodes.length>0){var a=this.__createElement("g");t.appendChild(a),this.__currentElement=a}var n=this.__currentElement.getAttribute("transform");n?n+=" ":n="",n+=e,this.__currentElement.setAttribute("transform",n)},a.prototype.scale=function(e,t){void 0===t&&(t=e),this.__addTransform(o("scale({x},{y})",{x:e,y:t}))},a.prototype.rotate=function(e){var t=180*e/Math.PI;this.__addTransform(o("rotate({angle},{cx},{cy})",{angle:t,cx:0,cy:0}))},a.prototype.translate=function(e,t){this.__addTransform(o("translate({x},{y})",{x:e,y:t}))},a.prototype.transform=function(e,t,a,n,r,s){this.__addTransform(o("matrix({a},{b},{c},{d},{e},{f})",{a:e,b:t,c:a,d:n,e:r,f:s}))},a.prototype.beginPath=function(){var e;this.__currentDefaultPath="",this.__currentPosition={},e=this.__createElement("path",{},!0),this.__closestGroupOrSvg().appendChild(e),this.__currentElement=e},a.prototype.__applyCurrentDefaultPath=function(){if("path"!==this.__currentElement.nodeName)throw new Error("Attempted to apply path command to node "+this.__currentElement.nodeName);var e=this.__currentDefaultPath;this.__currentElement.setAttribute("d",e)},a.prototype.__addPathCommand=function(e){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=e},a.prototype.moveTo=function(e,t){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.__currentPosition={x:e,y:t},this.__addPathCommand(o("M {x} {y}",{x:e,y:t}))},a.prototype.closePath=function(){this.__addPathCommand("Z")},a.prototype.lineTo=function(e,t){this.__currentPosition={x:e,y:t},this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(o("L {x} {y}",{x:e,y:t})):this.__addPathCommand(o("M {x} {y}",{x:e,y:t}))},a.prototype.bezierCurveTo=function(e,t,a,n,r,s){this.__currentPosition={x:r,y:s},this.__addPathCommand(o("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:e,cp1y:t,cp2x:a,cp2y:n,x:r,y:s}))},a.prototype.quadraticCurveTo=function(e,t,a,n){this.__currentPosition={x:a,y:n},this.__addPathCommand(o("Q {cpx} {cpy} {x} {y}",{cpx:e,cpy:t,x:a,y:n}))};var c=function(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]};a.prototype.arcTo=function(e,t,a,n,r){var s=this.__currentPosition&&this.__currentPosition.x,o=this.__currentPosition&&this.__currentPosition.y;if(void 0!==s&&void 0!==o){if(r<0)throw new Error("IndexSizeError: The radius provided ("+r+") is negative.");if(s===e&&o===t||e===a&&t===n||0===r)this.lineTo(e,t);else{var l=c([s-e,o-t]),i=c([a-e,n-t]);if(l[0]*i[1]!=l[1]*i[0]){var u=l[0]*i[0]+l[1]*i[1],m=Math.acos(Math.abs(u)),d=c([l[0]+i[0],l[1]+i[1]]),p=r/Math.sin(m/2),h=e+p*d[0],f=t+p*d[1],g=[-l[1],l[0]],b=[i[1],-i[0]],y=function(e){var t=e[0];return e[1]>=0?Math.acos(t):-Math.acos(t)},E=y(g),v=y(b);this.lineTo(h+g[0]*r,f+g[1]*r),this.arc(h,f,r,E,v)}else this.lineTo(e,t)}}},a.prototype.stroke=function(){"path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")},a.prototype.fill=function(){"path"===this.__currentElement.nodeName&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")},a.prototype.rect=function(e,t,a,n){"path"!==this.__currentElement.nodeName&&this.beginPath(),this.moveTo(e,t),this.lineTo(e+a,t),this.lineTo(e+a,t+n),this.lineTo(e,t+n),this.lineTo(e,t),this.closePath()},a.prototype.fillRect=function(e,t,a,n){var r;r=this.__createElement("rect",{x:e,y:t,width:a,height:n},!0),this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("fill")},a.prototype.strokeRect=function(e,t,a,n){var r;r=this.__createElement("rect",{x:e,y:t,width:a,height:n},!0),this.__closestGroupOrSvg().appendChild(r),this.__currentElement=r,this.__applyStyleToCurrentElement("stroke")},a.prototype.clearRect=function(e,t,a,n){var r,s=this.__closestGroupOrSvg();r=this.__createElement("rect",{x:e,y:t,width:a,height:n,fill:"#FFFFFF"},!0),s.appendChild(r)},a.prototype.createLinearGradient=function(e,t,a,r){var s=this.__createElement("linearGradient",{id:l(this.__ids),x1:e+"px",x2:a+"px",y1:t+"px",y2:r+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(s),new n(s,this)},a.prototype.createRadialGradient=function(e,t,a,r,s,o){var i=this.__createElement("radialGradient",{id:l(this.__ids),cx:r+"px",cy:s+"px",r:o+"px",fx:e+"px",fy:t+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(i),new n(i,this)},a.prototype.__parseFont=function(){var e=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\"\sa-z]+?)\s*$/i.exec(this.font),t={style:e[1]||"normal",size:e[4]||"10px",family:e[6]||"sans-serif",weight:e[3]||"normal",decoration:e[2]||"normal",href:null};return"underline"===this.__fontUnderline&&(t.decoration="underline"),this.__fontHref&&(t.href=this.__fontHref),t},a.prototype.__wrapTextLink=function(e,t){if(e.href){var a=this.__createElement("a");return a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.href),a.appendChild(t),a}return t},a.prototype.__applyText=function(e,t,a,n){var r,s,o=this.__parseFont(),l=this.__closestGroupOrSvg(),c=this.__createElement("text",{"font-family":o.family,"font-size":o.size,"font-style":o.style,"font-weight":o.weight,"text-decoration":o.decoration,x:t,y:a,"text-anchor":(r=this.textAlign,s={left:"start",right:"end",center:"middle",start:"start",end:"end"},s[r]||s.start),"dominant-baseline":i(this.textBaseline)},!0);c.appendChild(this.__document.createTextNode(e)),this.__currentElement=c,this.__applyStyleToCurrentElement(n),l.appendChild(this.__wrapTextLink(o,c))},a.prototype.fillText=function(e,t,a){this.__applyText(e,t,a,"fill")},a.prototype.strokeText=function(e,t,a){this.__applyText(e,t,a,"stroke")},a.prototype.measureText=function(e){return this.__ctx.font=this.font,this.__ctx.measureText(e)},a.prototype.arc=function(e,t,a,n,r,s){if(n!==r){(n%=2*Math.PI)==(r%=2*Math.PI)&&(r=(r+2*Math.PI-.001*(s?-1:1))%(2*Math.PI));var l,i=e+a*Math.cos(r),c=t+a*Math.sin(r),u=e+a*Math.cos(n),m=t+a*Math.sin(n),d=s?0:1,p=r-n;p<0&&(p+=2*Math.PI),l=s?p>Math.PI?0:1:p>Math.PI?1:0,this.lineTo(u,m),this.__addPathCommand(o("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:a,ry:a,xAxisRotation:0,largeArcFlag:l,sweepFlag:d,endX:i,endY:c})),this.__currentPosition={x:i,y:c}}},a.prototype.clip=function(){var e=this.__closestGroupOrSvg(),t=this.__createElement("clipPath"),a=l(this.__ids),n=this.__createElement("g");e.removeChild(this.__currentElement),t.setAttribute("id",a),t.appendChild(this.__currentElement),this.__defs.appendChild(t),e.setAttribute("clip-path",o("url(#{id})",{id:a})),e.appendChild(n),this.__currentElement=n},a.prototype.drawImage=function(){var e,t,n,r,s,o,l,i,c,u,m,d,p,h,f=Array.prototype.slice.call(arguments),g=f[0],b=0,y=0;if(3===f.length)e=f[1],t=f[2],n=s=g.width,r=o=g.height;else if(5===f.length)e=f[1],t=f[2],n=f[3],r=f[4],s=g.width,o=g.height;else{if(9!==f.length)throw new Error("Inavlid number of arguments passed to drawImage: "+arguments.length);b=f[1],y=f[2],s=f[3],o=f[4],e=f[5],t=f[6],n=f[7],r=f[8]}if(l=this.__closestGroupOrSvg(),m=this.__currentElement,g instanceof a){for(c=(i=g.getSvg()).childNodes[0];c.childNodes.length;)h=c.childNodes[0].getAttribute("id"),this.__ids[h]=h,this.__defs.appendChild(c.childNodes[0]);u=i.childNodes[1],l.appendChild(u),this.__currentElement=u,this.translate(e,t),this.__currentElement=m}else"CANVAS"!==g.nodeName&&"IMG"!==g.nodeName||((d=this.__createElement("image")).setAttribute("width",n),d.setAttribute("height",r),d.setAttribute("preserveAspectRatio","none"),(b||y||s!==g.width||o!==g.height)&&((p=this.__document.createElement("canvas")).width=n,p.height=r,p.getContext("2d").drawImage(g,b,y,s,o,0,0,n,r),g=p),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===g.nodeName?g.toDataURL():g.getAttribute("src")),l.appendChild(d),this.__currentElement=d,this.translate(e,t),this.__currentElement=m)},a.prototype.createPattern=function(e,t){var n,s=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),o=l(this.__ids);return s.setAttribute("id",o),s.setAttribute("width",e.width),s.setAttribute("height",e.height),"CANVAS"===e.nodeName||"IMG"===e.nodeName?((n=this.__document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("width",e.width),n.setAttribute("height",e.height),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","CANVAS"===e.nodeName?e.toDataURL():e.getAttribute("src")),s.appendChild(n),this.__defs.appendChild(s)):e instanceof a&&(s.appendChild(e.__root.childNodes[1]),this.__defs.appendChild(s)),new r(s,this)},a.prototype.drawFocusRing=function(){},a.prototype.createImageData=function(){},a.prototype.getImageData=function(){},a.prototype.putImageData=function(){},a.prototype.globalCompositeOperation=function(){},a.prototype.setTransform=function(){},"object"==typeof window&&(window.C2S=a),"object"==typeof e.exports&&(e.exports=a)}()},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n);function s(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=e.ctx,s=n.canvas,o=s.width,l=s.height,i=new r.a(o,l);e.ctx=i,e.render();var c=i[t].apply(i,a);return e.ctx=n,e.render(),c}t.default=function(e){e.exportSVG=function(){return s(e,"getSvg")},e.exportSerialisedSVG=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return s(e,"getSerializedSvg",[t])}}}])},,,function(e,t,a){var n=a(460),r=["hash"];e.exports=function(){var e=new Worker(a.p+"hash.b4daac5b2b2af8bbdfd0.worker.js",{name:"hash.[hash].worker.js"});return n(e,r),e}},,,,function(e,t,a){var n=a(381),r=a(382);if(void 0===n)throw Error("create-react-class could not find the React object. If you are using script tags, make sure that React is being loaded before create-react-class.");var s=(new n.Component).updater;e.exports=r(n.Component,n.isValidElement,s)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){var n={"./":126,"./FormattedName.react":274,"./FormattedName.react.js":274,"./canar":404,"./canar.js":404,"./index":126,"./index.js":126,"./klepn":408,"./klepn.js":408,"./neigo":409,"./neigo.js":409,"./rensm":410,"./rensm.js":410,"./salty":411,"./salty.js":411,"./saureus":412,"./saureus.js":412,"./sequi":413,"./sequi.js":413,"./strpn":414,"./strpn.js":414,"./vibcl":415,"./vibcl.js":415,"./zikv":416,"./zikv.js":416};function r(e){var t=s(e);return a(t)}function s(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=s,e.exports=r,r.id=628},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){L.FeatureGroup.LassoSelect=L.FeatureGroup.extend({options:{activeTooltip:"Click and release to place your first point.",startedTooltip:"Click on the map to draw an edge.",readyTooltip:"Continue placing points or click on the first point to finish shape.",finishedTooltip:"",polyline:{},initialPath:null},initialize(e){L.Util.setOptions(this,e)},onAdd(e){if(this.map=e,this.disable(),this.options.control&&(this.control=L.control.lassoSelect(this,this.options.control),this.control.addTo(e)),this.options.initialPath)for(var t=0;t<this.options.initialPath.length;t++)this.addPointToPath(this.options.initialPath[t]);this.options.noClickEvent||this.map.on("click",this.onClick,this)},onRemove(){this.map=null,this.off("click")},enable(){this.isActive=!0,this.reset(),this.bringToFront()},disable(){this.isActive=!1,this.reset()},toggle(){this.isActive?this.disable():this.enable()},reset(){if(this.polygon&&this.map.removeLayer(this.polygon),this.polygon=null,this.polyline&&this.map.removeLayer(this.polyline),this.polyline=null,this.markers)for(var e=0;e<this.markers.length;e++)this.map.removeLayer(this.markers[e]);this.markers=[],this.isStarted=!1,this.isFinished=!1,this.setMapTooltip()},getPath(){return this.isStarted?this.polyline.getLatLngs():null},getBounds(){return this.isFinished?this.polyline.getBounds():null},contains(e){for(var t=this.getPath(),a=e.lat,n=e.lng,r=!1,s=0,o=t.length-1;s<t.length;o=s++){var l=t[s].lat,i=t[s].lng,c=t[o].lat,u=t[o].lng;i>n!=u>n&&a<(c-l)*(n-i)/(u-i)+l&&(r=!r)}return r},setMapTooltip(){var e="",t="";this.isActive&&(this.isFinished?e=this.options.finishedTooltip:this.isStarted?this.getPath().length<3?(t="crosshair",e=this.options.startedTooltip):(t="crosshair",e=this.options.readyTooltip):(t="crosshair",e=this.options.activeTooltip)),this.map._container.style.cursor=t,this.map._container.title=e},onClick(e){this.isActive&&(this.isFinished&&!1!==this.controlled||(this.addPointToPath(e.latlng),this.setMapTooltip()))},addPointToPath(e){this.isStarted||(this.polyline=L.polyline([],this.options.polyline).addTo(this.map),this.markers=[],this.isStarted=!0),this.polyline.addLatLng(e);const t=L.marker(e,{draggable:!0,icon:L.divIcon({html:""})}).addTo(this.map);0===this.markers.length&&t.on("click",this.completePath.bind(this)),t.on("dragend",this.fire.bind(this,"pathchange")),t.on("drag",this.updatePath.bind(this)),this.markers.push(t)},updatePath(){for(var e=[],t=0;t<this.markers.length;t++)e.push(this.markers[t].getLatLng());e.push(this.markers[0].getLatLng()),this.polyline.setLatLngs(e)},completePath(){this.isFinished||this.markers.length<3||(this.polyline.addLatLng(this.markers[0].getLatLng()),this.isFinished=!0,this.setMapTooltip(),this.fire("pathchange"))}}),L.featureGroup.lassoSelect=function(e){return new L.FeatureGroup.LassoSelect(e)},L.Control.LassoSelect=L.Control.extend({options:{content:"Lasso",className:"leaflet-lasso-select-control"},initialize(e,t){this.lasso=e,L.Util.setOptions(this,t)},onAdd(e){this.map=e;var t=L.DomUtil.create("button");return t.innerHTML=this.options.content,t.className=this.options.className,this._onClick=this.onClick.bind(this),t.addEventListener("click",this._onClick),this.button=t,t},onRemove(){this.map=null,button.removeEventListener("click",this._onClick)},onClick(e){e.stopPropagation(),this.lasso.toggle(),this.button.classList.toggle("active")}}),L.control.lassoSelect=function(e,t){return new L.Control.LassoSelect(e,t)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(19),o=(a(15),a(915),a(921),a(923),a(473)),l=a.n(o),i=a(228),c=a(108),u=a(106);var m={primaryColour:"#673c90"};Object(u.a)(m);var d=()=>r.a.createElement(l.a,{store:c.a},r.a.createElement(i.a,null));Object(s.render)(r.a.createElement(d,null),document.getElementById("pathogenwatch"))},,,,,,,,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,,,,,,,,,,,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,,,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,,,function(e,t){},,,function(e,t){},,,function(e,t){},,function(e,t){},,function(e,t){},,,,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,,function(e,t){},,function(e,t){},,,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,,,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,,,,,,,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){},,function(e,t){}],[[858,1,2]]]);